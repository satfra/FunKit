(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    207231,       4852]
NotebookOptionsPosition[    199369,       4701]
NotebookOutlinePosition[    199820,       4719]
CellTagsIndexPosition[    199777,       4716]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"AutoGeneratedPackage", "->", "\"\<COEN.m\>\""}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.933907062001917*^9, 3.933907088477437*^9}, 
   3.9356618434708548`*^9, 3.935744927606638*^9, {3.935833716539812*^9, 
   3.93583371672362*^9}, {3.9507222866535883`*^9, 3.95072228934137*^9}, {
   3.950850838405504*^9, 3.950850842475651*^9}, {3.95163261282847*^9, 
   3.951632615369035*^9}, {3.952708017947483*^9, 3.952708018471147*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"33cd48af-4550-42b3-9c95-127f2f1ee635"],

Cell[CellGroupData[{

Cell["COEN - Code Output of  Expressions for Numerics", "Title",
 CellChangeTimes->{{3.9516327002842617`*^9, 3.9516327244520073`*^9}, {
  3.9527079982512913`*^9, 
  3.95270801249515*^9}},ExpressionUUID->"45e0855c-4bc3-42ae-aaff-\
d5b51f4ff40a"],

Cell[CellGroupData[{

Cell["Exports", "Section",
 CellChangeTimes->{{3.9509597231601686`*^9, 3.950959732923991*^9}, {
  3.951108540108012*^9, 3.9511085438759727`*^9}, {3.951210853720582*^9, 
  3.95121085660688*^9}, {3.951839308727314*^9, 
  3.951839310008635*^9}},ExpressionUUID->"e11489d7-57c3-46f3-92a7-\
9bd632e0d9ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetLoopMomentumName", "::", "usage"}], "=", "\"\<\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"JuliaCode", "::", "usage"}], "=", "\"\<\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CppCode", "::", "usage"}], "=", "\"\<\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UseCppPowr", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FORMCode", "::", "usage"}], "=", "\"\<\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FortranCode", "::", "usage"}], "=", "\"\<\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeCppClass", "::", "usage"}], "=", "\"\<\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeCppHeader", "::", "usage"}], "=", "\"\<\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeCppBlock", "::", "usage"}], "=", "\"\<\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeCppFunction", "::", "usage"}], "=", "\"\<\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeJuliaFunction", "::", "usage"}], "=", "\"\<\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeFortranFunction", "::", "usage"}], "=", "\"\<\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DefineCppNames", "::", "usage"}], "=", "\"\<\>\""}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CppForm", "::", "usage"}], "=", "\"\<\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FormatCode", "::", "usage"}], "=", "\"\<\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeParameterString", "::", "usage"}], "=", "\"\<\>\""}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.95183931636378*^9, 3.951839381192008*^9}, {
  3.952058405271412*^9, 3.9520584193976583`*^9}, {3.952080985264083*^9, 
  3.952080987823354*^9}, {3.952708041399891*^9, 3.952708041939623*^9}, {
  3.953437293477951*^9, 3.9534373741377163`*^9}, {3.953444089418995*^9, 
  3.9534440897020884`*^9}, {3.9564083590836*^9, 3.956408388691449*^9}, {
  3.9564100059992857`*^9, 3.95641002125377*^9}, {3.957414797171832*^9, 
  3.9574148106635513`*^9}, {3.957517536252043*^9, 3.957517537980075*^9}, {
  3.9578612657549553`*^9, 
  3.95786127247367*^9}},ExpressionUUID->"0d5d392c-52cd-44ef-853d-\
02a6cf9d51ce"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Begin Private", "Section",
 CellChangeTimes->{{3.9509597231601686`*^9, 3.950959732923991*^9}, {
  3.951108540108012*^9, 3.9511085438759727`*^9}, {3.951210853720582*^9, 
  3.95121085660688*^9}, {3.951719085230523*^9, 3.951719086330667*^9}, {
  3.95339039462521*^9, 3.953390408535656*^9}, {3.953391063947679*^9, 
  3.953391064411661*^9}},ExpressionUUID->"b32957eb-7ce4-4c31-859c-\
202f0f63a0ff"],

Cell[BoxData[
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]], "Code",
 CellChangeTimes->{
  3.933840441045422*^9, {3.953390410137535*^9, 3.953390412999981*^9}, {
   3.9533910663320923`*^9, 
   3.95339107121176*^9}},ExpressionUUID->"c9c77b3e-c91a-4a0e-b21b-\
3ceea3d06b71"]
}, Closed]],

Cell[CellGroupData[{

Cell["Global variables", "Section",
 CellChangeTimes->{{3.9509597231601686`*^9, 3.950959732923991*^9}, {
  3.951108540108012*^9, 3.9511085438759727`*^9}, {3.951210853720582*^9, 
  3.95121085660688*^9}},ExpressionUUID->"d65e8f2b-6500-4348-8918-\
912b67b13cd9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ModuleLoaded", "::", "dependency"}], "=", 
    "\"\<The module `1` requires `2`, which has not been loaded.\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ModuleLoaded", "[", "FunKit", "]"}], "=!=", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"ModuleLoaded", "::", "dependency"}], ",", "\"\<COEN\>\"", 
        ",", "\"\<FunKit\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ModuleLoaded", "[", "FEDeriK", "]"}], "=!=", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"ModuleLoaded", "::", "dependency"}], ",", "\"\<COEN\>\"", 
        ",", "\"\<FunKit\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ModuleLoaded", "[", "COEN", "]"}], "=", "True"}], ";"}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.951279357886877*^9, 3.951279421240814*^9}, {
   3.9512794606622543`*^9, 3.951279475842711*^9}, {3.951279581390761*^9, 
   3.9512796956111917`*^9}, {3.951279782883439*^9, 3.9512797869913473`*^9}, {
   3.9516326303484573`*^9, 3.951632637292129*^9}, {3.951829731107336*^9, 
   3.9518297457785177`*^9}, 3.9518298128083982`*^9, {3.951829875255785*^9, 
   3.951829915394566*^9}, {3.951832913059966*^9, 3.9518329170830593`*^9}, {
   3.952708070243766*^9, 3.95270807277516*^9}, {3.953391199340392*^9, 
   3.953391201600048*^9}},ExpressionUUID->"0a00f2e0-9e12-4855-8a8a-\
da6773cee6a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$FunKitDirectory", "=", 
   RowBox[{
    RowBox[{"SelectFirst", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
            "$UserBaseDirectory", ",", "\"\<Applications\>\"", ",", 
             "\"\<FunKit\>\""}], "}"}], "]"}], ",", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
            "$BaseDirectory", ",", "\"\<Applications\>\"", ",", 
             "\"\<FunKit\>\""}], "}"}], "]"}], ",", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
            "$InstallationDirectory", ",", "\"\<AddOns\>\"", ",", 
             "\"\<Applications\>\"", ",", "\"\<FunKit\>\""}], "}"}], "]"}], 
          ",", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
            "$InstallationDirectory", ",", "\"\<AddOns\>\"", ",", 
             "\"\<Packages\>\"", ",", "\"\<FunKit\>\""}], "}"}], "]"}], ",", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
            "$InstallationDirectory", ",", "\"\<AddOns\>\"", ",", 
             "\"\<ExtraPackages\>\"", ",", "\"\<FunKit\>\""}], "}"}], "]"}]}],
          "}"}], ",", 
        RowBox[{"Select", "[", 
         RowBox[{"$Path", ",", 
          RowBox[{
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"#", ",", "\"\<FunKit\>\""}], "]"}], "&"}]}], "]"}]}], 
       "]"}], ",", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", "#", "]"}], "&"}]}], "]"}], "<>", 
    "\"\</\>\""}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951226996707944*^9, 3.951227003475544*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"66c68510-764b-433f-bf11-01c5d6a5e9c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeTemporaryFileName", "[", "]"}], ":=", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"AbsoluteTime", "[", "]"}], "*", 
      SuperscriptBox["10", "6"]}], "//", "Round"}], "]"}], "<>", "\"\<_\>\"", 
   "<>", 
   RowBox[{"ToString", "[", 
    RowBox[{"RandomInteger", "[", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["10", "6"], ",", 
       SuperscriptBox["10", "7"]}], "}"}], "]"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9527639836941347`*^9, 3.952764000181924*^9}, {
  3.952764375773304*^9, 3.952764413329646*^9}},
 CellLabel->
  "In[401]:=",ExpressionUUID->"0820655e-3796-4a1d-a0e1-c7b33751bb4e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["C++", "Section",
 CellChangeTimes->{{3.9509597231601686`*^9, 3.950959732923991*^9}, {
  3.951108540108012*^9, 3.9511085438759727`*^9}, {3.951210853720582*^9, 
  3.95121085660688*^9}, {3.952761524926857*^9, 
  3.952761526260778*^9}},ExpressionUUID->"35443d0b-bd7f-4341-8864-\
3262d730e796"],

Cell[CellGroupData[{

Cell["C++ formatting", "Subsection",
 CellChangeTimes->{{3.918570624414493*^9, 
  3.918570646019106*^9}},ExpressionUUID->"fabc2f95-fb25-45ca-aee6-\
ad9fe9e31827"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<SymbolicC`\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"UseCppPowr", "[", "True", "]"}], ":=", 
   RowBox[{"Set", "[", 
    RowBox[{"$CppPowr", ",", "True"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"UseCppPowr", "[", "False", "]"}], ":=", 
   RowBox[{"Set", "[", 
    RowBox[{"$CppPowr", ",", "False"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$CppPowr", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$CppPrecision", "=", "20"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CppForm", "[", "expr_", "]"}], ":=", 
   RowBox[{"Internal`InheritedBlock", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"processedExpr", ",", "nest", ",", 
       RowBox[{"$MinPrecision", "=", "$CppPrecision"}], ",", 
       RowBox[{"$MaxPrecision", "=", "$CppPrecision"}], ",", "CExpression"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"processedExpr", "=", 
       RowBox[{"N", "[", "expr", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nest", ":=", 
       RowBox[{
        RowBox[{"GenerateCode", "[", 
         RowBox[{"CExpression", "[", "#", "]"}], "]"}], "&"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", "associativity", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Times", "[", 
          RowBox[{"a__", ",", 
           RowBox[{"Plus", "[", 
            RowBox[{"b_", ",", "c__"}], "]"}], ",", "d__"}], "]"}], "]"}], 
        "]"}], ":=", 
       RowBox[{
        RowBox[{"nest", "[", 
         RowBox[{"Times", "[", "a", "]"}], "]"}], "<>", "\"\< * (\>\"", "<>", 
        
        RowBox[{"nest", "[", 
         RowBox[{"Plus", "[", 
          RowBox[{"b", ",", "c"}], "]"}], "]"}], "<>", "\"\<) * \>\"", "<>", 
        RowBox[{"nest", "[", 
         RowBox[{"Times", "[", "d", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Times", "[", 
          RowBox[{
           RowBox[{"Plus", "[", 
            RowBox[{"b_", ",", "c__"}], "]"}], ",", "d__"}], "]"}], "]"}], 
        "]"}], ":=", 
       RowBox[{"\"\<(\>\"", "<>", 
        RowBox[{"nest", "[", 
         RowBox[{"Plus", "[", 
          RowBox[{"b", ",", "c"}], "]"}], "]"}], "<>", "\"\<) * \>\"", "<>", 
        RowBox[{"nest", "[", 
         RowBox[{"Times", "[", "d", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"recursion", " ", "for"}], " ", "+", " ", 
        RowBox[{"and", " ", "*"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Plus", "[", 
          RowBox[{"a_", ",", "b__"}], "]"}], "]"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\< + \>\"", "<>", 
        RowBox[{"nest", "[", 
         RowBox[{"Plus", "[", "b", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Times", "[", 
          RowBox[{"a_", ",", "b__"}], "]"}], "]"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\< * \>\"", "<>", 
        RowBox[{"nest", "[", 
         RowBox[{"Times", "[", "b", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{
        RowBox[{"GenerateCode", "[", 
         RowBox[{"CExpression", "[", 
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "b_", ",", "a__"}], "]"}], "]"}], "]"}], 
        "/;", 
        RowBox[{
         RowBox[{"Head", "[", "b", "]"}], "=!=", "Plus"}]}], ":=", 
       RowBox[{"\"\<(-\>\"", "<>", 
        RowBox[{"nest", "[", "b", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Times", "[", 
          RowBox[{"a__", ",", 
           RowBox[{"Power", "[", 
            RowBox[{"b_", ",", 
             RowBox[{"-", "1"}]}], "]"}]}], "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<) / (\>\"", "<>", 
        RowBox[{"nest", "[", "b", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Times", "[", 
          RowBox[{"a__", ",", 
           RowBox[{"Plus", "[", 
            RowBox[{"b_", ",", "c__"}], "]"}], ",", "d__"}], "]"}], "]"}], 
        "]"}], ":=", 
       RowBox[{
        RowBox[{"nest", "[", 
         RowBox[{"Times", "[", "a", "]"}], "]"}], "<>", "\"\< * (\>\"", "<>", 
        
        RowBox[{"nest", "[", 
         RowBox[{"Plus", "[", 
          RowBox[{"b", ",", "c"}], "]"}], "]"}], "<>", "\"\<) * \>\"", "<>", 
        RowBox[{"nest", "[", 
         RowBox[{"Times", "[", "d", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Times", "[", 
          RowBox[{
           RowBox[{"Plus", "[", 
            RowBox[{"b_", ",", "c__"}], "]"}], ",", 
           RowBox[{"Power", "[", 
            RowBox[{"d_", ",", 
             RowBox[{"-", "1"}]}], "]"}]}], "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<(\>\"", "<>", 
        RowBox[{"nest", "[", 
         RowBox[{"Plus", "[", 
          RowBox[{"b", ",", "c"}], "]"}], "]"}], "<>", "\"\<) / (\>\"", "<>", 
        
        RowBox[{"nest", "[", "d", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Times", "[", 
          RowBox[{"a__", ",", 
           RowBox[{"Plus", "[", 
            RowBox[{"b_", ",", "c__"}], "]"}], ",", 
           RowBox[{"Power", "[", 
            RowBox[{"d_", ",", 
             RowBox[{"-", "1"}]}], "]"}]}], "]"}], "]"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"nest", "[", 
         RowBox[{"Times", "[", "a", "]"}], "]"}], "<>", "\"\< * (\>\"", "<>", 
        
        RowBox[{"nest", "[", 
         RowBox[{"Plus", "[", 
          RowBox[{"b", ",", "c"}], "]"}], "]"}], "<>", "\"\<) / (\>\"", "<>", 
        
        RowBox[{"nest", "[", "d", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", "functions", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"a_", "[", "args_", "]"}], "]"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<(\>\"", "<>", 
        RowBox[{"nest", "[", "args", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"number", " ", "conversion"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", "I", "]"}], "]"}], ":=", 
       "\"\<complex<double>(0,1)\>\""}], ";", "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", "a_Real", "]"}], "]"}], ":=", 
       RowBox[{"ToString", "[", 
        RowBox[{"NumberForm", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"a", ",", "$CppPrecision"}], "]"}], ",", "$CppPrecision", 
          ",", 
          RowBox[{"NumberFormat", "->", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"#3", "===", "\"\<\>\""}], ",", "#1", ",", 
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{"#1", ",", "\"\<e\>\"", ",", "#3"}], "}"}], "]"}]}], 
              "]"}], "&"}], ")"}]}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Rational", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], "]"}], "]"}], ":=", 
       RowBox[{"nest", "[", 
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{"a", "/", "b"}], ",", "$CppPrecision"}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", "a_Complex", "]"}], "]"}], ":=", 
       RowBox[{"\"\<(\>\"", "<>", 
        RowBox[{"nest", "[", 
         RowBox[{"Re", "@", "a"}], "]"}], "<>", 
        "\"\< + complex<double>(0,1) * \>\"", "<>", 
        RowBox[{"nest", "[", 
         RowBox[{"Im", "@", "a"}], "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{
        RowBox[{"GenerateCode", "[", 
         RowBox[{"CExpression", "[", "a_Complex", "]"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"Re", "[", "a", "]"}], "===", "0"}]}], ":=", 
       RowBox[{"\"\<complex<double>(0,\>\"", "<>", 
        RowBox[{"nest", "[", 
         RowBox[{"Im", "[", "a", "]"}], "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{
        RowBox[{"GenerateCode", "[", 
         RowBox[{"CExpression", "[", "a_", "]"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"NumericQ", "[", "a", "]"}], "&&", 
         RowBox[{"Not", "@", 
          RowBox[{"IntegerQ", "[", "a", "]"}]}]}]}], ":=", 
       RowBox[{"nest", "[", 
        RowBox[{"N", "[", 
         RowBox[{"a", ",", "$CppPrecision"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Powers", " ", "and", " ", "such"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Sqrt", "[", "arg_", "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<sqrt(\>\"", "<>", 
        RowBox[{"nest", "[", "arg", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"$CppPowr", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"CExpression", "/:", 
          RowBox[{"GenerateCode", "[", 
           RowBox[{"CExpression", "[", 
            RowBox[{"Power", "[", 
             RowBox[{"a_", ",", "b_Integer"}], "]"}], "]"}], "]"}], ":=", 
          RowBox[{"\"\<powr<\>\"", "<>", 
           RowBox[{"ToString", "[", "b", "]"}], "<>", "\"\<>(\>\"", "<>", 
           RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<)\>\""}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"CExpression", "/:", 
          RowBox[{"GenerateCode", "[", 
           RowBox[{"CExpression", "[", 
            RowBox[{"Power", "[", 
             RowBox[{"a_", ",", 
              RowBox[{"b_", "/;", 
               RowBox[{"Element", "[", 
                RowBox[{
                 RowBox[{"b", "+", 
                  RowBox[{"1", "/", "2"}]}], ",", "Integers"}], "]"}]}]}], 
             "]"}], "]"}], "]"}], ":=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"b", "===", 
             RowBox[{"1", "/", "2"}]}], ",", 
            RowBox[{"\"\<sqrt(\>\"", "<>", 
             RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<)\>\""}], ",", 
            RowBox[{"\"\<sqrt(powr<\>\"", "<>", 
             RowBox[{"nest", "[", 
              RowBox[{"2", "b"}], "]"}], "<>", "\"\<>(\>\"", "<>", 
             RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<))\>\""}]}], "]"}]}],
          ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"CExpression", "/:", 
          RowBox[{"GenerateCode", "[", 
           RowBox[{"CExpression", "[", 
            RowBox[{"Power", "[", 
             RowBox[{"a_", ",", "b_Integer"}], "]"}], "]"}], "]"}], ":=", 
          RowBox[{"\"\<pow(\>\"", "<>", 
           RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<, \>\"", "<>", 
           RowBox[{"ToString", "[", "b", "]"}], "<>", "\"\<)\>\""}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Power", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<pow(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<,\>\"", "<>", 
        RowBox[{"nest", "[", "b", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Power", "[", 
          RowBox[{"E", ",", "b_"}], "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<exp(\>\"", "<>", 
        RowBox[{"nest", "[", "b", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Power", "[", 
          RowBox[{"E", ",", "b_Integer"}], "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<exp(\>\"", "<>", 
        RowBox[{"nest", "[", "b", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Exp", "[", "a_", "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<exp(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{
          RowBox[{"Exp", "[", "a_", "]"}], "-", "1"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<expm1(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"1", "-", 
          RowBox[{"Exp", "[", "a_", "]"}]}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<-expm1(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Plus", "[", 
          RowBox[{
           RowBox[{"Exp", "[", "a_", "]"}], ",", 
           RowBox[{"-", "1"}], ",", "c__"}], "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<expm1(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<) + \>\"", "<>", 
        RowBox[{"nest", "[", 
         RowBox[{"Plus", "[", "c", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Plus", "[", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Exp", "[", "a_", "]"}]}], ",", "1", ",", "c__"}], "]"}], 
         "]"}], "]"}], ":=", 
       RowBox[{"\"\<(-expm1(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<)) + \>\"", "<>", 
        RowBox[{"nest", "[", 
         RowBox[{"Plus", "[", "c", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Log", "[", "a_", "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<log(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", "trigonometric", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Sin", "[", "a_", "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<sin(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Cos", "[", "a_", "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<cos(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Tan", "[", "a_", "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<tan(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Cot", "[", "a_", "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<powr<-1>(tan(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<))\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"ArcSin", "[", "a_", "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<asin(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"ArcCos", "[", "a_", "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<acos(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"ArcTan", "[", "a_", "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<atan(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"ArcTan", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<atan2(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<, \>\"", "<>", 
        RowBox[{"nest", "[", "b", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"ArcCot", "[", "a_", "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<atan(powr<-1>(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<))\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Sinh", "[", "a_", "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<sinh(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Cosh", "[", "a_", "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<cosh(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Tanh", "[", "a_", "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<tanh(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Coth", "[", "a_", "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<powr<-1>(tanh(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<))\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"ArcSinh", "[", "a_", "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<asinh(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"ArcCosh", "[", "a_", "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<acosh(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"ArcTanh", "[", "a_", "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<atanh(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"ArcCoth", "[", "a_", "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<atanh(powr<-1>(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<))\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"min", ",", " ", "max", ",", " ", "abs"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Abs", "[", "a_", "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<abs(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Min", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<min(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<,\>\"", "<>", 
        RowBox[{"nest", "[", "b", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Min", "[", 
          RowBox[{"a_", ",", "b_", ",", "c__"}], "]"}], "]"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"\"\<min({\>\"", "<>", 
         RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"nest", "[", "b", "]"}], "<>", 
         RowBox[{"StringRiffle", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"nest", ",", 
             RowBox[{"{", "c", "}"}]}], "]"}], ",", "\"\<,\>\""}], "]"}]}], 
        "\"\<})\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Max", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<max(\>\"", "<>", 
        RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<,\>\"", "<>", 
        RowBox[{"nest", "[", "b", "]"}], "<>", "\"\<)\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CExpression", "/:", 
       RowBox[{"GenerateCode", "[", 
        RowBox[{"CExpression", "[", 
         RowBox[{"Max", "[", 
          RowBox[{"a_", ",", "b_", ",", "c__"}], "]"}], "]"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"\"\<max({\>\"", "<>", 
         RowBox[{"nest", "[", "a", "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"nest", "[", "b", "]"}], "<>", 
         RowBox[{"StringRiffle", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"nest", ",", 
             RowBox[{"{", "c", "}"}]}], "]"}], ",", "\"\<,\>\""}], "]"}]}], 
        "\"\<})\>\""}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ToCCodeString", "[", 
       RowBox[{"CExpression", "[", "processedExpr", "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9183227374649057`*^9, 3.9183227894076014`*^9}, {
   3.918322863153208*^9, 3.918322878900425*^9}, {3.918384755143515*^9, 
   3.91838477018717*^9}, {3.918384814882266*^9, 3.918384818322689*^9}, {
   3.918570593189097*^9, 3.918570594333875*^9}, {3.91871998848396*^9, 
   3.918719995851115*^9}, {3.918720708340906*^9, 3.918720716415075*^9}, {
   3.919152458929375*^9, 3.919152461909113*^9}, {3.919161604045773*^9, 
   3.919161623923659*^9}, {3.919927319206914*^9, 3.919927346261128*^9}, {
   3.9252829129765244`*^9, 3.92528292380034*^9}, {3.925283050748022*^9, 
   3.925283060616178*^9}, 3.925560389445086*^9, {3.92570772396732*^9, 
   3.925707746181615*^9}, {3.927259728801195*^9, 3.927259782778897*^9}, {
   3.92726005295629*^9, 3.927260229903634*^9}, {3.9272603747037973`*^9, 
   3.9272603782268*^9}, {3.927260660135363*^9, 3.927260706646351*^9}, {
   3.927260743082341*^9, 3.927260803315909*^9}, {3.9272608739437733`*^9, 
   3.9272609336344757`*^9}, {3.927260980147702*^9, 3.9272609803307877`*^9}, {
   3.927261206282289*^9, 3.927261336658729*^9}, {3.9272614541958857`*^9, 
   3.927261476324284*^9}, {3.927261506641202*^9, 3.927261511145152*^9}, {
   3.927261548537051*^9, 3.9272615539441*^9}, {3.927612046913769*^9, 
   3.927612110210719*^9}, {3.927612194254174*^9, 3.92761219481698*^9}, {
   3.927703447146445*^9, 3.927703453657585*^9}, {3.929586324894317*^9, 
   3.929586340488901*^9}, {3.929762972024137*^9, 3.929762982969396*^9}, {
   3.931401932269908*^9, 3.931401938884918*^9}, {3.9333010557893*^9, 
   3.933301101917397*^9}, {3.933301133804902*^9, 3.933301395756246*^9}, {
   3.9333015142686033`*^9, 3.933301546995504*^9}, {3.9333056467652493`*^9, 
   3.933305654509104*^9}, {3.9359274932754583`*^9, 3.935927495997527*^9}, {
   3.935927527104536*^9, 3.935927553941113*^9}, {3.9359284959172792`*^9, 
   3.935928497175605*^9}, {3.937409070107874*^9, 3.937409070347679*^9}, {
   3.938241390414969*^9, 3.9382414096543713`*^9}, {3.938785626218605*^9, 
   3.938785692516264*^9}, {3.941637908672159*^9, 3.9416379090805197`*^9}, {
   3.941638223745199*^9, 3.9416383100088863`*^9}, {3.941638417493546*^9, 
   3.941638417649281*^9}, {3.941639593732829*^9, 3.941639602405526*^9}, 
   3.9416399657717133`*^9, {3.94648489702761*^9, 3.946484968139174*^9}, {
   3.9464852094918013`*^9, 3.946485312659563*^9}, 3.946485394744317*^9, {
   3.9488261934912663`*^9, 3.948826202298699*^9}, {3.95646421834167*^9, 
   3.956464228141652*^9}, {3.956469759564694*^9, 3.956469895754178*^9}, {
   3.956469936255149*^9, 3.956469952254752*^9}, {3.956470036074923*^9, 
   3.956470262845385*^9}, {3.9564702984047127`*^9, 3.9564710869795237`*^9}, {
   3.956471207760332*^9, 3.9564713614424143`*^9}, {3.956471502744763*^9, 
   3.9564717283447857`*^9}, {3.956471843506295*^9, 3.956471904414488*^9}, {
   3.95647193968974*^9, 3.956471982421673*^9}, {3.95647201911269*^9, 
   3.956472079030397*^9}, {3.956472130211701*^9, 3.956472193154731*^9}, {
   3.9564722271616087`*^9, 3.95647226468887*^9}, {3.956472298587846*^9, 
   3.956472660323865*^9}, {3.956472704880734*^9, 3.956472821157112*^9}, {
   3.956472882546736*^9, 3.956472994445345*^9}, {3.956473150361607*^9, 
   3.956473208351429*^9}, 3.9564732446467533`*^9, {3.9564733092533283`*^9, 
   3.9564733548504868`*^9}, {3.9564735284843807`*^9, 3.956473537834935*^9}, {
   3.956473577242887*^9, 3.9564735786151533`*^9}, {3.956473614101881*^9, 
   3.956473652526545*^9}, {3.956473692643999*^9, 3.956473707495077*^9}, {
   3.9574148152345457`*^9, 
   3.957414974206397*^9}},ExpressionUUID->"50a7ba72-e5bd-4991-81bf-\
b6aff6d27053"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"haveBashrc", "=", 
   RowBox[{"0", "==", 
    RowBox[{
     RowBox[{"RunProcess", "[", 
      RowBox[{"$SystemShell", ",", "All", ",", "\"\<source ~/.bashrc\>\""}], 
      "]"}], "[", "\"\<ExitCode\>\"", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"haveZshrc", "=", 
   RowBox[{"0", "==", 
    RowBox[{
     RowBox[{"RunProcess", "[", 
      RowBox[{"$SystemShell", ",", "All", ",", "\"\<source ~/.zshrc\>\""}], 
      "]"}], "[", "\"\<ExitCode\>\"", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"haveZshProfile", "=", 
   RowBox[{"0", "==", 
    RowBox[{
     RowBox[{"RunProcess", "[", 
      RowBox[{"$SystemShell", ",", "All", ",", "\"\<source ~/.zprofile\>\""}],
       "]"}], "[", "\"\<ExitCode\>\"", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inferredPATH", "=", 
   RowBox[{
    RowBox[{"RunProcess", "[", 
     RowBox[{"$SystemShell", ",", "All", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
        "haveBashrc", ",", "\"\<source ~/.bashrc;\>\"", ",", "\"\<\>\""}], 
        "]"}], "<>", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
        "haveZshrc", ",", "\"\<source ~/.zshrc;\>\"", ",", "\"\<\>\""}], 
        "]"}], "<>", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
        "haveZshProfile", ",", "\"\<source ~/.zprofile;\>\"", ",", 
         "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
       "\"\< echo $PATH\>\""}]}], "]"}], "[", "\"\<StandardOutput\>\"", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetEnvironment", "[", 
    RowBox[{"\"\<PATH\>\"", "->", "inferredPATH"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"clangFormatExists", "=", 
   RowBox[{
    RowBox[{"Quiet", "[", 
     RowBox[{"RunProcess", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<clang-format\>\"", ",", "\"\<--help\>\""}], "}"}], "]"}], 
     "]"}], "=!=", "$Failed"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateClangFormat", "[", 
     RowBox[{"path_", ":", "\"\<./\>\""}], "]"}], ":=", 
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Not", "@", 
       RowBox[{"FileExistsQ", "[", 
        RowBox[{"path", "<>", "\"\<.clang-format\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"path", "<>", "\"\</.clang-format\>\""}], ",", 
        "\[IndentingNewLine]", 
        "\"\<BasedOnStyle: LLVM\nUseTab: Never\nIndentWidth: 2\nTabWidth: 2\n\
BreakBeforeBraces: Linux\nAllowShortIfStatementsOnASingleLine: true\n\
IndentCaseLabels: false\nColumnLimit: 120\nAccessModifierOffset: -2\n\
NamespaceIndentation: All\nAllowShortEnumsOnASingleLine: true\n\>\"", ",", 
        "\"\<Text\>\""}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WriteCodeToFile", "[", 
     RowBox[{"fileName_String", ",", "expression_String"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "tmpfileName", "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"tmpfileName", "=", 
        RowBox[{"fileName", "<>", "\"\<.tmpcode\>\""}]}], ";", "\n", "\t", 
       RowBox[{"Export", "[", 
        RowBox[{"tmpfileName", ",", "expression", ",", "\"\<Text\>\""}], 
        "]"}], ";", "\n", "\t", 
       RowBox[{"If", "[", 
        RowBox[{"clangFormatExists", ",", "\n", "\t\t", 
         RowBox[{
          RowBox[{"CreateClangFormat", "[", "]"}], ";", "\n", "\t\t", 
          RowBox[{"RunProcess", "[", 
           RowBox[{"$SystemShell", ",", " ", "All", ",", " ", 
            RowBox[{
            "\"\<clang-format \>\"", "<>", "tmpfileName", "<>", "\"\< > \>\"",
              "<>", "tmpfileName", "<>", "\"\<_formatted && mv \>\"", "<>", 
             "tmpfileName", "<>", "\"\<_formatted \>\"", "<>", 
             "tmpfileName"}]}], "]"}], ";"}]}], "\n", "\t", "]"}], ";", "\n", 
       "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FileExistsQ", "[", "fileName", "]"}], ",", "\n", "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Import", "[", 
             RowBox[{"fileName", ",", "\"\<Text\>\""}], "]"}], "==", 
            RowBox[{"Import", "[", 
             RowBox[{"tmpfileName", ",", "\"\<Text\>\""}], "]"}]}], ",", "\n",
            "\t\t\t", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"fileName", "<>", "\"\< unchanged\>\""}], "]"}], ";", 
            "\n", "\t\t\t", 
            RowBox[{"RunProcess", "[", 
             RowBox[{"$SystemShell", ",", " ", "All", ",", " ", 
              RowBox[{"\"\<rm \>\"", "<>", "tmpfileName"}]}], "]"}]}], ",", 
           "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Exported to \>\"", "<>", "fileName"}], "]"}], ";", 
            "\n", "\t\t\t", 
            RowBox[{"RunProcess", "[", 
             RowBox[{"$SystemShell", ",", " ", "All", ",", " ", 
              RowBox[{
              "\"\<mv \>\"", "<>", "tmpfileName", "<>", "\"\< \>\"", "<>", 
               "fileName"}]}], "]"}]}]}], "\n", "\t\t", "]"}], ",", "\n", 
         "\t\t", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Exported to \>\"", "<>", "fileName"}], "]"}], ";", 
          "\n", "\t\t", 
          RowBox[{"RunProcess", "[", 
           RowBox[{"$SystemShell", ",", " ", "All", ",", " ", 
            RowBox[{
            "\"\<mv \>\"", "<>", "tmpfileName", "<>", "\"\< \>\"", "<>", 
             "fileName"}]}], "]"}]}]}], "\n", "\t", "]"}]}]}], "\n", "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FormatCode", "[", "expression_String", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tmpfileName1", ",", "tmpfileName2", ",", "output"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tmpfileName1", "=", 
       RowBox[{"\"\</tmp/in_\>\"", "<>", 
        RowBox[{"makeTemporaryFileName", "[", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tmpfileName2", "=", 
       RowBox[{"\"\</tmp/out_\>\"", "<>", 
        RowBox[{"makeTemporaryFileName", "[", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"tmpfileName1", ",", "expression", ",", "\"\<Text\>\""}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"clangFormatExists", ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"RunProcess", "[", 
           RowBox[{
           "$SystemShell", ",", " ", "All", ",", " ", 
            "\"\<rm /tmp/.clang-format\>\""}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"CreateClangFormat", "[", "\"\</tmp/\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"RunProcess", "[", 
          RowBox[{"$SystemShell", ",", " ", "All", ",", " ", 
           RowBox[{
           "\"\<clang-format \>\"", "<>", "tmpfileName1", "<>", "\"\< > \>\"",
             "<>", "tmpfileName2"}]}], "]"}], ";"}]}], "\n", "\t", "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FileExistsQ", "[", "tmpfileName2", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"output", "=", 
          RowBox[{"Import", "[", 
           RowBox[{"tmpfileName2", ",", "\"\<Text\>\""}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"RunProcess", "[", 
          RowBox[{"$SystemShell", ",", " ", "All", ",", " ", 
           RowBox[{
           "\"\<rm \>\"", "<>", "tmpfileName1", "<>", "\"\< \>\"", "<>", 
            "tmpfileName2"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "output", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "expression", "]"}]}]}], "\n", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9533740120161257`*^9, 3.953374026482624*^9}, 
   3.953380016683511*^9, {3.956401286954237*^9, 3.956401295928442*^9}, 
   3.956406028634576*^9, {3.957372913070719*^9, 3.957372920850724*^9}, {
   3.95737295115863*^9, 3.957372990078533*^9}, 3.957373025102605*^9, 
   3.957373057914846*^9, 3.9574560326824417`*^9, 
   3.957506211107667*^9},ExpressionUUID->"a5a7128e-7318-4280-b574-\
f59313a744da"]
}, Open  ]],

Cell[CellGroupData[{

Cell["FORM code creation", "Subsection",
 CellChangeTimes->{{3.918570624414493*^9, 3.918570646019106*^9}, {
  3.952763027549075*^9, 3.952763031444932*^9}, {3.9530462023082333`*^9, 
  3.9530462071562757`*^9}},ExpressionUUID->"8bc99ae2-d9e8-479c-848e-\
7cb606c988e4"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "balancedBracesQ", "]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"balancedBracesQ", "[", "str_String", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cases", ",", "idx"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"StringCount", "[", 
            RowBox[{"str", ",", "\"\<(\>\""}], "]"}], "===", 
           RowBox[{"StringCount", "[", 
            RowBox[{"str", ",", "\"\<)\>\""}], "]"}]}], ")"}]}], ",", 
        RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cases", "=", 
       RowBox[{"StringCases", "[", 
        RowBox[{"str", ",", 
         RowBox[{"\"\<(\>\"", "|", "\"\<)\>\""}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"idx", "=", "1"}], ",", 
        RowBox[{"idx", "<=", 
         RowBox[{"Length", "[", "cases", "]"}]}], ",", 
        RowBox[{"idx", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Count", "[", 
              RowBox[{
               RowBox[{"cases", "[", 
                RowBox[{"[", 
                 RowBox[{";;", "idx"}], "]"}], "]"}], ",", "\"\<(\>\""}], 
              "]"}], "<", 
             RowBox[{"Count", "[", 
              RowBox[{
               RowBox[{"cases", "[", 
                RowBox[{"[", 
                 RowBox[{";;", "idx"}], "]"}], "]"}], ",", "\"\<)\>\""}], 
              "]"}]}], ")"}], ",", 
           RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"balancedRBracesQ", "[", "str_String", "]"}], ":=", 
   RowBox[{
    RowBox[{"StringCount", "[", 
     RowBox[{"str", ",", "\"\<[\>\""}], "]"}], "===", 
    RowBox[{"StringCount", "[", 
     RowBox[{"str", ",", "\"\<]\>\""}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hasNoOperators", "[", "str_String", "]"}], ":=", 
  RowBox[{
   RowBox[{"StringFreeQ", "[", 
    RowBox[{"str", ",", "\"\<)\>\""}], "]"}], "&&", 
   RowBox[{"StringFreeQ", "[", 
    RowBox[{"str", ",", "\"\<(\>\""}], "]"}], "&&", 
   RowBox[{"StringFreeQ", "[", 
    RowBox[{"str", ",", "\"\<[\>\""}], "]"}], "&&", 
   RowBox[{"StringFreeQ", "[", 
    RowBox[{"str", ",", "\"\<]\>\""}], "]"}], "&&", "\[IndentingNewLine]", 
   RowBox[{"StringFreeQ", "[", 
    RowBox[{"str", ",", "\"\<*\>\""}], "]"}], "&&", 
   RowBox[{"StringFreeQ", "[", 
    RowBox[{"str", ",", "\"\</\>\""}], "]"}], "&&", "\[IndentingNewLine]", 
   RowBox[{"StringFreeQ", "[", 
    RowBox[{"str", ",", "\"\<+\>\""}], "]"}], "&&", 
   RowBox[{"StringFreeQ", "[", 
    RowBox[{"str", ",", "\"\<-\>\""}], "]"}], "&&", "\[IndentingNewLine]", 
   RowBox[{"StringFreeQ", "[", 
    RowBox[{"str", ",", "\"\<%\>\""}], "]"}], "&&", 
   RowBox[{"StringFreeQ", "[", 
    RowBox[{"str", ",", "\"\<&\>\""}], "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.953046535309807*^9, 3.953046548675069*^9}, {
   3.953374602130157*^9, 3.9533746776261883`*^9}, 3.953387105463545*^9},
 CellLabel->
  "In[154]:=",ExpressionUUID->"59a9fb42-8cec-4dd4-b89f-fd5a2c265905"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"formatFORMCode", "[", "expr_String", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "start", ",", "res", ",", "pres", ",", "idx", ",", "maxW", ",", 
        "repl"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"start", "=", 
        RowBox[{"StringPosition", "[", 
         RowBox[{"expr", ",", "\"\<\\n\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"start", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "start", "]"}], "<=", "1"}], ",", "1", ",", 
          
          RowBox[{"start", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"StringTake", "[", 
         RowBox[{"expr", ",", 
          RowBox[{"{", 
           RowBox[{"start", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"operation", " ", "replacements"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"pres", "=!=", "res"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"pres", "=", "res"}], ";", "\[IndentingNewLine]", 
          RowBox[{"res", "=", 
           RowBox[{"StringReplace", "[", 
            RowBox[{"res", ",", "\[IndentingNewLine]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Shortest", "[", 
                  RowBox[{"\"\<pow(\>\"", "~~", 
                   RowBox[{"(", "arg1__", ")"}], "~~", "\"\<,\>\"", "~~", 
                   RowBox[{"(", 
                    RowBox[{"arg2", ":", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DigitCharacter", "..."}], "|", "\"\<-\>\""}], "~~", 
                    RowBox[{"(", 
                    RowBox[{"DigitCharacter", "..."}], ")"}]}], ")"}]}], 
                    ")"}], "~~", "\"\<)\>\""}], "]"}], "/;", 
                 RowBox[{
                  RowBox[{"balancedBracesQ", "[", "arg1", "]"}], "&&", 
                  RowBox[{"StringFreeQ", "[", 
                   RowBox[{"arg1", ",", "\"\<;\>\""}], "]"}]}]}], ":>", 
                RowBox[{
                "\"\<powr<\>\"", "~~", "arg2", "~~", "\"\<>(\>\"", "~~", 
                 "arg1", "~~", "\"\<)\>\""}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"Shortest", "[", 
                  RowBox[{"\"\<pow(\>\"", "~~", 
                   RowBox[{"(", "arg1__", ")"}], "~~", "\"\<,\>\"", "~~", 
                   "\"\<1./2.\>\"", "~~", "\"\<)\>\""}], "]"}], "/;", 
                 RowBox[{
                  RowBox[{"balancedBracesQ", "[", "arg1", "]"}], "&&", 
                  RowBox[{"StringFreeQ", "[", 
                   RowBox[{"arg1", ",", "\"\<;\>\""}], "]"}]}]}], ":>", 
                RowBox[{"\"\<sqrt(\>\"", "~~", "arg1", "~~", "\"\<)\>\""}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"\"\< \>\"", "->", "\"\<\>\""}]}], 
              "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "turn", " ", "the", " ", "buffer", " ", "into", " ", "a", " ", "list",
          " ", "of", " ", "definitions", " ", "of", " ", "variables"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"maxW", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ToExpression", "@", 
             RowBox[{"StringTake", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{"3", ",", 
                 RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], "&"}], ",", 
           RowBox[{"StringCases", "[", 
            RowBox[{"res", ",", 
             RowBox[{"Shortest", "[", 
              RowBox[{"\"\<w[\>\"", "~~", 
               RowBox[{"(", 
                RowBox[{"arg1__", "/;", 
                 RowBox[{"balancedRBracesQ", "[", "arg1", "]"}]}], ")"}], 
               "~~", "\"\<]\>\""}], "]"}]}], "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"idx", "=", "1"}], ",", 
         RowBox[{"idx", "<=", "maxW"}], ",", 
         RowBox[{"idx", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"res", "=", 
           RowBox[{"StringReplacePart", "[", 
            RowBox[{"res", ",", 
             RowBox[{"\"\<auto _tmp\>\"", "<>", 
              RowBox[{"ToString", "[", "idx", "]"}], "<>", "\"\<\>\""}], ",", 
             
             RowBox[{"StringPosition", "[", 
              RowBox[{"res", ",", 
               RowBox[{"\"\<w[\>\"", "<>", 
                RowBox[{"ToString", "[", "idx", "]"}], "<>", "\"\<]\>\""}], 
               ",", "1"}], "]"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"StringReplace", "[", 
         RowBox[{"res", ",", "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Shortest", "[", 
              RowBox[{"\"\<w[\>\"", "~~", 
               RowBox[{"(", 
                RowBox[{"arg1__", "/;", 
                 RowBox[{"balancedRBracesQ", "[", "arg1", "]"}]}], ")"}], 
               "~~", "\"\<]\>\""}], "]"}], ":>", 
             RowBox[{"\"\<_tmp\>\"", "~~", "arg1", "~~", "\"\<\>\""}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<expr=\>\"", "->", "\"\<return \>\""}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<\\n\>\"", "->", "\"\<\>\""}]}], 
           "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"FormatCode", "[", "res", "]"}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Get", " ", "rid", " ", "of", " ", "unecessary", " ", "copies"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"repl", "=", 
        RowBox[{"Map", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"StringReplace", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{
               RowBox[{
               "\"\<auto _tmp\>\"", "~~", "a__", "~~", "\"\< = \>\"", "~~", 
                "b__", "~~", "\"\<;\>\""}], "/;", 
               RowBox[{"hasNoOperators", "[", "b", "]"}]}], ":>", 
              RowBox[{
              "\"\<_tmp\>\"", "~~", "a", "~~", "\"\<->\>\"", "~~", "b"}]}]}], 
            "]"}], "&"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{"res", ",", "\"\<\\n\>\""}], "]"}], ",", 
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{"#", ",", 
               RowBox[{
                RowBox[{
                "\"\<auto _tmp\>\"", "~~", "a__", "~~", "\"\<=\>\"", "~~", 
                 "b__", "~~", "\"\<;\>\""}], "/;", 
                RowBox[{"hasNoOperators", "[", "b", "]"}]}]}], "]"}], "&"}]}],
            "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"repl", "=", 
        RowBox[{"Map", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"a_", "/;", 
                  RowBox[{"MatchQ", "[", 
                   RowBox[{"a", ",", 
                    RowBox[{
                    "\"\<(\>\"", "|", "\"\< \>\"", "|", "\"\<-\>\""}]}], 
                   "]"}]}], ")"}], "~~", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "~~", 
                RowBox[{"(", 
                 RowBox[{"b_", "/;", 
                  RowBox[{"MatchQ", "[", 
                   RowBox[{"b", ",", 
                    RowBox[{
                    "\"\<)\>\"", "|", "\"\< \>\"", "|", "\"\<;\>\""}]}], 
                   "]"}]}], ")"}]}], ":>", 
               RowBox[{"a", "~~", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "~~", "b"}]}], "&"}], ")"}], 
            "@", 
            RowBox[{"StringSplit", "[", 
             RowBox[{"#", ",", "\"\<->\>\""}], "]"}]}], "&"}], ",", 
          "\[IndentingNewLine]", "repl"}], "\[IndentingNewLine]", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"StringSplit", "[", 
            RowBox[{"res", ",", "\"\<\\n\>\""}], "]"}], ",", 
           RowBox[{
            RowBox[{"Not", "@", 
             RowBox[{"StringMatchQ", "[", 
              RowBox[{"#", ",", 
               RowBox[{
                RowBox[{
                "\"\<auto _tmp\>\"", "~~", "a__", "~~", "\"\<=\>\"", "~~", 
                 "b__"}], "/;", 
                RowBox[{"hasNoOperators", "[", "b", "]"}]}]}], "]"}]}], 
            "&"}]}], "]"}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"StringReplace", "[", 
         RowBox[{"res", ",", "repl"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "res", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FORMCode", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"origVars", ",", "tmpfileName", ",", "import"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"origVars", "=", 
       RowBox[{"FormTracer`GetExtraVars", "[", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"tmpfileName", "=", 
       RowBox[{"\"\</tmp/FO_\>\"", "<>", 
        RowBox[{"makeTemporaryFileName", "[", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FormTracer`AddExtraVars", "@@", 
       RowBox[{"GetAllCustomSymbols", "[", "expr", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FormTracer`FormTrace", "[", 
       RowBox[{
        RowBox[{"expr", "//", "Rationalize"}], ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"tmpfileName", ",", "\"\<O4\>\""}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FormTracer`DefineExtraVars", "[", "origVars", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"import", "=", 
       RowBox[{"Import", "[", 
        RowBox[{"tmpfileName", ",", "\"\<Text\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RunProcess", "[", 
       RowBox[{"$SystemShell", ",", " ", "All", ",", " ", 
        RowBox[{"\"\<rm \>\"", "<>", "tmpfileName"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"import", "//", "formatFORMCode"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9530462099176083`*^9, 3.953046231945033*^9}, {
   3.9530462654614487`*^9, 3.953046313677492*^9}, {3.9530463992930937`*^9, 
   3.953046498578371*^9}, {3.953046579381949*^9, 3.953046579845359*^9}, {
   3.953046639194944*^9, 3.9530469165428257`*^9}, {3.95304695406637*^9, 
   3.953047008196477*^9}, {3.9530471202430687`*^9, 3.953047136078559*^9}, {
   3.95304719267803*^9, 3.953047202229793*^9}, {3.953047314094357*^9, 
   3.953047342881784*^9}, 3.9530474558219624`*^9, {3.953047486315398*^9, 
   3.9530475247634687`*^9}, 3.953047569433735*^9, {3.9530477156186113`*^9, 
   3.953047752385275*^9}, {3.953047963622744*^9, 3.9530479650453053`*^9}, {
   3.953218874197836*^9, 3.953219027840622*^9}, {3.953373927807229*^9, 
   3.953373928966405*^9}, 3.9533739839606113`*^9, {3.953374382607095*^9, 
   3.953374586430067*^9}, {3.953374715632402*^9, 3.953375137380056*^9}, {
   3.953375224281684*^9, 3.953375321444062*^9}, {3.9533753562960577`*^9, 
   3.9533753982996902`*^9}, {3.953375472776229*^9, 3.953375472986807*^9}, {
   3.953383241275527*^9, 3.9533832429352303`*^9}, {3.9533839784434032`*^9, 
   3.953383985164483*^9}, {3.953384059732826*^9, 3.9533841369046707`*^9}, {
   3.953384174956974*^9, 3.953384203464872*^9}, {3.9533842679091473`*^9, 
   3.953384436705142*^9}, {3.953384948737075*^9, 3.953384950631248*^9}, {
   3.9533856907009287`*^9, 3.953385712464807*^9}, {3.9533857441995296`*^9, 
   3.9533857481370173`*^9}, {3.9533858169894323`*^9, 3.953385884577553*^9}, {
   3.953385926804123*^9, 3.953385932657254*^9}, {3.953385974493829*^9, 
   3.953386021824451*^9}, {3.95338607088098*^9, 3.953386092365346*^9}, {
   3.9533861305927267`*^9, 3.953386141690308*^9}, {3.953386187845368*^9, 
   3.953386260193939*^9}, {3.953386323786574*^9, 3.953386344573286*^9}, {
   3.953386382606895*^9, 3.953386431584141*^9}, 3.953386560397278*^9, {
   3.9533866333922367`*^9, 3.9533866825790443`*^9}, {3.953386741781443*^9, 
   3.953386789725259*^9}, {3.953387169569942*^9, 3.95338718158127*^9}, 
   3.953387609029809*^9, {3.953435471496793*^9, 3.953435476660385*^9}, {
   3.953443966539406*^9, 
   3.9534439810392*^9}},ExpressionUUID->"771842ec-8641-4e2c-b64d-\
1c50115d8c11"]
}, Closed]],

Cell[CellGroupData[{

Cell["C++ code creation", "Subsection",
 CellChangeTimes->{{3.918570624414493*^9, 3.918570646019106*^9}, {
   3.952763027549075*^9, 3.952763031444932*^9}, 3.953347368807349*^9, {
   3.9564057309820538`*^9, 
   3.956405731130683*^9}},ExpressionUUID->"1789937b-2e63-4c39-a57f-\
eaf578006823"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$codeOptimizeFunctions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a_Symbol", "[", "__", "]"}], "/;", 
     RowBox[{"Not", "@", 
      RowBox[{"MatchQ", "[", 
       RowBox[{"a", ",", 
        RowBox[{
        "Times", "|", "Plus", "|", "Power", "|", "Rational", "|", "Complex", "|",
          "Real", "|", "Integer"}]}], "]"}]}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.925707800404338*^9, 3.925707860326218*^9}, {
   3.925707996416679*^9, 3.925708004745759*^9}, {3.925708035938981*^9, 
   3.925708051129855*^9}, 3.925708112103202*^9, {3.92571200808964*^9, 
   3.925712040456319*^9}, {3.9533610971597853`*^9, 3.953361108910926*^9}, {
   3.95336117492789*^9, 3.953361180779585*^9}, {3.953361232284688*^9, 
   3.953361249999296*^9}, {3.9533801166708403`*^9, 3.9533801332304897`*^9}, {
   3.953387621331842*^9, 3.953387624227682*^9}, {3.9533876707439632`*^9, 
   3.953387742255641*^9}, {3.953387784336154*^9, 3.953387788943674*^9}, {
   3.953387822696333*^9, 3.953387843692493*^9}, {3.953387932352206*^9, 
   3.953387939423987*^9}, {3.953388369368134*^9, 3.953388370856181*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"f74de9f1-08b4-4443-aef0-ab0068452dec"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CppCode", "[", "equation_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "optList", ",", "interpObj", ",", "replacementObj", ",", 
       "replacementNames", ",", "replacements", ",", "definitions", ",", 
       "returnStatement"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"optList", "=", "$codeOptimizeFunctions"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"interpObj", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"equation", ",", "#", ",", "Infinity"}], "]"}], "&"}], 
          ",", "optList"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"replacementObj", "=", 
       RowBox[{"Keys", "@", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Counts", "[", "interpObj", "]"}], ",", 
          RowBox[{
           RowBox[{"#", ">", "1"}], "&"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"replacementNames", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\"\<_repl\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "replacementObj", "]"}]}], "}"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"replacements", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"replacementObj", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "->", 
          RowBox[{"replacementNames", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "replacementObj", "]"}]}], "}"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"definitions", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "replacementObj", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"\"\<const auto \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"replacementNames", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", "\"\< = \>\"", "<>", 
              RowBox[{"CppForm", "[", 
               RowBox[{"FullSimplify", "@", 
                RowBox[{"replacementObj", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "<>", 
              "\"\<;\\n\>\""}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "replacementObj", "]"}]}], "}"}]}], 
            "]"}], "]"}], "<>", "\"\<\\n\>\""}], "\[IndentingNewLine]", ",", 
         "\"\<\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"returnStatement", "=", 
       RowBox[{"\"\< return \>\"", "<>", 
        RowBox[{"CppForm", "[", 
         RowBox[{"equation", "//.", "replacements"}], "]"}], "<>", 
        "\"\<;\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"returnStatement", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"returnStatement", ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\"\<\\\"\>\"", "<>", "#", "<>", "\"\<\\\"\>\""}], "->", 
             "#"}], "&"}], ",", "replacementNames"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"definitions", "<>", "returnStatement"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.925707478577066*^9, 3.925707513859118*^9}, {
   3.925707770248493*^9, 3.925707774050929*^9}, {3.925707880518664*^9, 
   3.925707903522541*^9}, {3.925707934432786*^9, 3.9257079348818073`*^9}, {
   3.92570919705335*^9, 3.925709198845766*^9}, {3.925709437368464*^9, 
   3.9257094396079063`*^9}, {3.925710044896023*^9, 3.9257100636592007`*^9}, {
   3.925712252732678*^9, 3.925712255615948*^9}, {3.92590917183536*^9, 
   3.925909211955093*^9}, {3.92590942091114*^9, 3.925909425176322*^9}, {
   3.925909463262588*^9, 3.925909481128065*^9}, {3.92590955682531*^9, 
   3.925909558500592*^9}, {3.931419817534824*^9, 3.931419860007971*^9}, {
   3.931419894486116*^9, 3.931419895405524*^9}, {3.931419975675881*^9, 
   3.931420194158597*^9}, {3.9314202268194838`*^9, 3.931420373049406*^9}, {
   3.93204098578543*^9, 3.932040986204354*^9}, {3.932041044803256*^9, 
   3.9320410501374397`*^9}, {3.9320412127795973`*^9, 3.93204123315661*^9}, {
   3.932041530815583*^9, 3.932041533077765*^9}, {3.9320418556709957`*^9, 
   3.932041959133141*^9}, {3.932041995923657*^9, 3.932041999267761*^9}, {
   3.932042033255431*^9, 3.9320420871912127`*^9}, 3.932042236729015*^9, {
   3.932042322479778*^9, 3.932042355945862*^9}, {3.934166682496434*^9, 
   3.9341666887935147`*^9}, {3.93416672573591*^9, 3.934166738735838*^9}, {
   3.9341672212881813`*^9, 3.9341672296384583`*^9}, {3.936854714485991*^9, 
   3.936854874865799*^9}, {3.937488899850667*^9, 3.9374889804710817`*^9}, {
   3.938783572613789*^9, 3.938783594503048*^9}, {3.938785807715172*^9, 
   3.938785827663423*^9}, {3.9387858588055973`*^9, 3.9387858619333467`*^9}, {
   3.938785895614574*^9, 3.9387858980313797`*^9}, {3.95336098170954*^9, 
   3.953361000342114*^9}, {3.953361048694539*^9, 3.953361086921235*^9}, {
   3.953361118352385*^9, 3.953361162768344*^9}, 3.953361225339902*^9, {
   3.953376164735859*^9, 3.95337618618369*^9}, {3.953380053449445*^9, 
   3.9533800536942177`*^9}, {3.9533876120086603`*^9, 3.953387614729124*^9}, {
   3.9533878638283443`*^9, 3.953387890268984*^9}, 3.953388257528964*^9, {
   3.953388288411961*^9, 3.953388293144047*^9}, {3.953388387129201*^9, 
   3.953388406412842*^9}, {3.953388459772352*^9, 3.9533885426652517`*^9}, {
   3.9533894065042257`*^9, 3.9533894089441357`*^9}, {3.953444181683769*^9, 
   3.953444184478673*^9}, 3.956417554934836*^9, 
   3.9573723082949057`*^9},ExpressionUUID->"d51a9a90-ee68-4e4a-8c62-\
e730741f68c9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["C++ function creation", "Subsection",
 CellChangeTimes->{{3.918570624414493*^9, 3.918570646019106*^9}, {
  3.952763027549075*^9, 
  3.952763031444932*^9}},ExpressionUUID->"c806af20-0dc0-49b0-8aae-\
8d0d656c23c0"],

Cell[CellGroupData[{

Cell["Helper functions", "Subsubsection",
 CellChangeTimes->{{3.9527628313810787`*^9, 
  3.952762834813097*^9}},ExpressionUUID->"37321981-1eb4-4a59-b79f-\
351f28c754cd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"makeCppTemplateParameter", "[", "n_", "]"}], ":=", 
   RowBox[{"\"\<typename T\>\"", "<>", 
    RowBox[{"ToString", "[", "n", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeCppParameter", "[", 
    RowBox[{"t_Association", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "ret", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ret", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"KeyFreeQ", "[", 
           RowBox[{"t", ",", "\"\<Const\>\""}], "]"}], "||", 
          RowBox[{"Not", "@", 
           RowBox[{"t", "[", "\"\<Const\>\"", "]"}]}]}], ",", "\"\<\>\"", 
         ",", "\"\<const \>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ret", "=", 
       RowBox[{"ret", "<>", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"KeyFreeQ", "[", 
            RowBox[{"t", ",", "\"\<Type\>\""}], "]"}], "||", 
           RowBox[{
            RowBox[{"t", "[", "\"\<Type\>\"", "]"}], "===", 
            "\"\<template\>\""}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<T\>\"", "<>", 
           RowBox[{"ToString", "[", "n", "]"}]}], ",", "\[IndentingNewLine]", 
          
          RowBox[{"t", "[", "\"\<Type\>\"", "]"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ret", "=", 
       RowBox[{"ret", "<>", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"KeyExistsQ", "[", 
            RowBox[{"t", ",", "\"\<Reference\>\""}], "]"}], "&&", 
           RowBox[{"t", "[", "\"\<Reference\>\"", "]"}]}], ",", "\"\<& \>\"", 
          ",", "\"\< \>\""}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ret", "=", 
       RowBox[{"ret", "<>", 
        RowBox[{"t", "[", "\"\<Name\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "ret", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"prepParam", "[", "it_String", "]"}], ":=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<Type\>\"", "->", "\"\<auto\>\""}], ",", 
     RowBox[{"\"\<Reference\>\"", "->", "True"}], ",", 
     RowBox[{"\"\<Name\>\"", "->", "it"}], ",", 
     RowBox[{"\"\<Const\>\"", "->", "True"}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"prepParam", "[", "it_Association", "]"}], ":=", "it"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"prepParam", "[", "it_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"it", ",", "\"\< is not a valid C++ parameter!\>\""}], "]"}], 
     ";", 
     RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.952762265746817*^9, 3.95276239083311*^9}, {
   3.952762494729918*^9, 3.9527625275733633`*^9}, {3.952762584789535*^9, 
   3.952762594385315*^9}, {3.9533754983261766`*^9, 3.95337558139433*^9}, {
   3.95337565055573*^9, 3.953375666763167*^9}, {3.953383348668502*^9, 
   3.953383378192906*^9}, 3.956401667469419*^9, {3.957360304657029*^9, 
   3.957360386953252*^9}, {3.9573604319971857`*^9, 3.957360464913971*^9}, {
   3.957361580453843*^9, 3.957361634130291*^9}, {3.957601574456148*^9, 
   3.957601610056575*^9}, {3.9576023976353292`*^9, 
   3.957602405312542*^9}},ExpressionUUID->"0f1a2c07-9fee-4cc0-8b61-\
f5ef33dda0e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeParameterString", "[", "it_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ret", ",", 
      RowBox[{"t", "=", 
       RowBox[{"prepParam", "@", "it"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ret", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KeyFreeQ", "[", 
          RowBox[{"t", ",", "\"\<Const\>\""}], "]"}], "||", 
         RowBox[{"Not", "@", 
          RowBox[{"t", "[", "\"\<Const\>\"", "]"}]}]}], ",", "\"\<\>\"", ",", 
        "\"\<const \>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ret", "=", 
      RowBox[{"ret", "<>", 
       RowBox[{"t", "[", "\"\<Type\>\"", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ret", "=", 
      RowBox[{"ret", "<>", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{"t", ",", "\"\<Reference\>\""}], "]"}], "&&", 
          RowBox[{"t", "[", "\"\<Reference\>\"", "]"}]}], ",", "\"\<& \>\"", 
         ",", "\"\< \>\""}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ret", "=", 
      RowBox[{"ret", "<>", 
       RowBox[{"t", "[", "\"\<Name\>\"", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "ret", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9578611720080442`*^9, 3.957861253206642*^9}, {
  3.957861377102468*^9, 
  3.957861386257938*^9}},ExpressionUUID->"67d3543f-bb83-4d58-8013-\
d9f67d1ad989"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Creating functions", "Subsubsection",
 CellChangeTimes->{{3.9527628313810787`*^9, 
  3.952762842184938*^9}},ExpressionUUID->"2b09806b-9027-4de0-aff2-\
1e5e15a13358"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "MakeCppFunction", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "MakeCppFunction", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Return\>\"", "->", "\"\<auto\>\""}], ",", 
     RowBox[{"\"\<Parameters\>\"", "->", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\"\<Name\>\"", "->", "\"\<function\>\""}], ",", 
     RowBox[{"\"\<Prefix\>\"", "->", "\"\<\>\""}], ",", 
     RowBox[{"\"\<Suffix\>\"", "->", "\"\<\>\""}], ",", 
     RowBox[{"\"\<CodeParser\>\"", "->", "\"\<Cpp\>\""}], ",", 
     RowBox[{"\"\<Body\>\"", "->", "\"\<\>\""}], ",", 
     RowBox[{"\"\<Class\>\"", "->", "\"\<\>\""}], ",", 
     RowBox[{"\"\<Templates\>\"", "->", 
      RowBox[{"{", "}"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeCppFunction", "[", 
    RowBox[{"OptionsPattern", "[", "]"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "functionPrefix", ",", "functionSuffix", ",", "functionName", ",", 
       "\[IndentingNewLine]", "functionParameters", ",", "functionTemplates", 
       ",", "idx", ",", "\[IndentingNewLine]", "functionBody", ",", 
       "parameters"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Create", " ", "prefixe", " ", "for", " ", "the", " ", "function"}], 
       ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"e", ".", "g", ".", " ", "static"}], " ", "or", " ", 
         "such"}], " ", "+", " ", 
        RowBox[{"the", " ", "return", " ", "value"}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"functionPrefix", "=", 
       RowBox[{"OptionValue", "[", "\"\<Prefix\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"functionPrefix", "=", 
       RowBox[{"functionPrefix", "<>", "\"\< \>\"", "<>", 
        RowBox[{"OptionValue", "[", "\"\<Return\>\"", "]"}], "<>", 
        "\"\< \>\""}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"functionSuffix", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<Suffix\>\"", "]"}], "=!=", 
          "\"\<\>\""}], ",", 
         RowBox[{"\"\< \>\"", "<>", 
          RowBox[{"OptionValue", "[", "\"\<Suffix\>\"", "]"}], "<>", 
          "\"\< \>\""}], ",", "\"\<\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"functionName", "=", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "\"\<Class\>\"", "]"}], "===", 
           "\"\<\>\""}], ",", "\"\<\>\"", ",", 
          RowBox[{
           RowBox[{"OptionValue", "[", "\"\<Class\>\"", "]"}], "<>", 
           "\"\<::\>\""}]}], "]"}], "<>", 
        RowBox[{"OptionValue", "[", "\"\<Name\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"parameters", "=", 
       RowBox[{"prepParam", "/@", 
        RowBox[{"OptionValue", "[", "\"\<Parameters\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Create", " ", "both", " ", "a", " ", "template", " ", "list", " ", 
        "and", " ", "a", " ", "parameter", " ", "list"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"functionTemplates", "=", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Select", "[", 
            RowBox[{"parameters", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"KeyFreeQ", "[", 
                RowBox[{"#", ",", "\"\<Type\>\""}], "]"}], "||", 
               RowBox[{
                RowBox[{"#", "[", "\"\<Type\>\"", "]"}], "===", 
                "\"\<template\>\""}]}], "&"}]}], "]"}], "]"}], "===", "0"}], 
         ",", "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"StringRiffle", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Pick", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"makeCppTemplateParameter", "[", "idx", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"idx", ",", "1", ",", 
                 RowBox[{"Length", "[", "parameters", "]"}]}], "}"}]}], "]"}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"KeyFreeQ", "[", 
                 RowBox[{
                  RowBox[{"parameters", "[", 
                   RowBox[{"[", "idx", "]"}], "]"}], ",", "\"\<Type\>\""}], 
                 "]"}], "||", 
                RowBox[{
                 RowBox[{
                  RowBox[{"parameters", "[", 
                   RowBox[{"[", "idx", "]"}], "]"}], "[", "\"\<Type\>\"", 
                  "]"}], "===", "\"\<template\>\""}]}], ",", 
               RowBox[{"{", 
                RowBox[{"idx", ",", "1", ",", 
                 RowBox[{"Length", "[", "parameters", "]"}]}], "}"}]}], 
              "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\"\<, \>\""}], 
          "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"functionTemplates", "=", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "\"\<Templates\>\"", "]"}], "===", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\"\<\>\"", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<typename \>\"", "<>", 
           RowBox[{"StringRiffle", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "\"\<Templates\>\"", "]"}], ",", 
             "\"\<, typename \>\""}], "]"}]}]}], "\[IndentingNewLine]", "]"}],
         "<>", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"functionTemplates", "=!=", "\"\<\>\""}], ",", 
          RowBox[{"\"\<, \>\"", "<>", "functionTemplates"}], ",", 
          "\"\<\>\""}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"functionTemplates", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"functionTemplates", "===", "\"\<\>\""}], ",", 
         "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{
         "\"\<template<\>\"", "<>", "functionTemplates", "<>", 
          "\"\<>\\n\>\""}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"functionParameters", "=", 
       RowBox[{"\"\<(\>\"", "<>", 
        RowBox[{"StringRiffle", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"makeCppParameter", "[", 
             RowBox[{
              RowBox[{"parameters", "[", 
               RowBox[{"[", "idx", "]"}], "]"}], ",", "idx"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"idx", ",", "1", ",", 
              RowBox[{"Length", "[", "parameters", "]"}]}], "}"}]}], "]"}], 
          "\[IndentingNewLine]", ",", "\"\<, \>\""}], "]"}], "<>", 
        "\"\<)\>\""}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"create", " ", "the", " ", "body"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"functionBody", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<Body\>\"", "]"}], "===", "None"}], 
         ",", "\"\<;\>\"", ",", 
         RowBox[{"StringReplace", "[", 
          RowBox[{
           RowBox[{"\"\<{\\n\>\"", "<>", 
            RowBox[{"OptionValue", "[", "\"\<Body\>\"", "]"}], "<>", 
            "\"\<\\n}\>\""}], ",", 
           RowBox[{"\"\<\\n\\n\>\"", "->", "\"\<\>\""}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"FormatCode", "[", "\[IndentingNewLine]", 
        RowBox[{
        "functionTemplates", "<>", "functionPrefix", "<>", "functionName", "<>",
          "functionParameters", "<>", "functionSuffix", "<>", "\"\<\\n\>\"", "<>",
          "functionBody"}], "\[IndentingNewLine]", "]"}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeCppFunction", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"codeParser", ",", "newBody"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"codeParser", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<CodeParser\>\"", "]"}], "===", 
          "\"\<FORM\>\""}], ",", "FORMCode", ",", "CppCode"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newBody", "=", 
       RowBox[{
        RowBox[{"OptionValue", "[", "\"\<Body\>\"", "]"}], "<>", 
        "\"\<\\n\>\"", "<>", 
        RowBox[{"codeParser", "[", "expr", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"MakeCppFunction", "@@", 
       RowBox[{"(", 
        RowBox[{"Evaluate", "@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<Body\>\"", "->", "newBody"}], "}"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"Rule", "@@", 
               RowBox[{"{", 
                RowBox[{"#", ",", 
                 RowBox[{"OptionValue", "[", 
                  RowBox[{"MakeCppFunction", ",", "#"}], "]"}]}], "}"}]}], 
              "]"}], "&"}], "@", 
            RowBox[{"Keys", "[", 
             RowBox[{"Options", "[", "MakeCppFunction", "]"}], "]"}]}]}], 
          "]"}]}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.952761527738603*^9, 3.9527615466089478`*^9}, {
   3.9527616118912973`*^9, 3.952762224757728*^9}, {3.952762395810478*^9, 
   3.952762469873872*^9}, {3.952762537975101*^9, 3.952762565938217*^9}, {
   3.9527626053857937`*^9, 3.952762767942972*^9}, {3.952764982553095*^9, 
   3.9527649853503942`*^9}, {3.9530475944336843`*^9, 3.953047650572978*^9}, {
   3.953048778106143*^9, 3.9530487800268707`*^9}, {3.953347384229507*^9, 
   3.9533474255489073`*^9}, {3.953347787209957*^9, 3.95334790618536*^9}, {
   3.953348311122266*^9, 3.953348413794139*^9}, {3.953375481743616*^9, 
   3.953375482272665*^9}, {3.953375609713024*^9, 3.953375635300383*^9}, {
   3.9533756880236483`*^9, 3.9533757024393387`*^9}, {3.9533768651636744`*^9, 
   3.953376950710722*^9}, {3.953377106843546*^9, 3.953377383930626*^9}, {
   3.953377433848876*^9, 3.953377467579711*^9}, {3.953377584868635*^9, 
   3.953377640063942*^9}, {3.953377720954885*^9, 3.9533777605129137`*^9}, {
   3.953383349611212*^9, 3.953383378737067*^9}, {3.9563973061417007`*^9, 
   3.956397387637001*^9}, {3.956397594767374*^9, 3.956397595053165*^9}, {
   3.956401456326025*^9, 3.9564015119196463`*^9}, 3.956401549750486*^9, {
   3.956401691353828*^9, 3.956401765710685*^9}, {3.957360219466258*^9, 
   3.957360276871912*^9}, 3.957360420242104*^9, {3.957360638551025*^9, 
   3.9573606526109047`*^9}, {3.9573616466793756`*^9, 3.957361764214693*^9}, {
   3.9575170954414377`*^9, 3.957517176523035*^9}, {3.957518559514494*^9, 
   3.957518577375812*^9}, 3.957518668274314*^9, {3.957518702541602*^9, 
   3.957518735001666*^9}, {3.957518780595077*^9, 3.957518843969783*^9}, {
   3.957518943801721*^9, 3.957519011542416*^9}, 3.9575190982080297`*^9, {
   3.9575192101595297`*^9, 3.9575192348141117`*^9}, {3.957602243700551*^9, 
   3.957602269348406*^9}, {3.957886872385051*^9, 3.95788692621796*^9}, {
   3.957886989289055*^9, 3.9578869933636847`*^9}, 
   3.957887039505044*^9},ExpressionUUID->"19bb6be5-817d-48dc-92c5-\
1f0931b759bc"],

Cell[BoxData[
 TemplateBox[{
  "ClearAll", "wrsym", 
   "\"Symbol \\!\\(\\*RowBox[{\\\"MakeCppFunction\\\"}]\\) is Protected.\"", 
   2, 370, 21, 24634461159361993196, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.957519072723194*^9},
 CellLabel->
  "During evaluation of \
In[370]:=",ExpressionUUID->"61a798c5-ff95-4ad8-9347-5022553d86e6"],

Cell[BoxData[
 TemplateBox[{
  "Set", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"MakeCppFunction\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"Options\\\", \\\"[\\\", \\\"MakeCppFunction\\\", \\\"]\\\
\"}]\\) is Protected.\"", 2, 371, 22, 24634461159361993196, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.957519072766645*^9},
 CellLabel->
  "During evaluation of \
In[370]:=",ExpressionUUID->"bb5dd241-ea31-4a98-ab26-be3c543b031c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Creating Headers", "Subsection",
 CellChangeTimes->{{3.953347543528861*^9, 
  3.953347549791205*^9}},ExpressionUUID->"bbe8a29e-ae48-487c-b970-\
5cb4168ce017"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "MakeCppClass", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<TemplateTypes\>\"", "->", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\"\<MembersPublic\>\"", "->", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\"\<MembersPrivate\>\"", "->", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\"\<MembersProtected\>\"", "->", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\"\<Name\>\"", "->", "\"\<Class\>\""}], ",", 
     RowBox[{"\"\<Bases\>\"", "->", 
      RowBox[{"{", "}"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeCppClass", "[", 
    RowBox[{"OptionsPattern", "[", "]"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "classPrefix", ",", "classSuffix", ",", "className", ",", 
       "\[IndentingNewLine]", "classParameters", ",", "classTemplates", ",", 
       "codeParser", ",", "\[IndentingNewLine]", "classBody"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Create", " ", "prefixe", " ", "for", " ", "the", " ", "class"}], ",", 
       " ", 
       RowBox[{
        RowBox[{
         RowBox[{"e", ".", "g", ".", " ", "static"}], " ", "or", " ", 
         "such"}], " ", "+", " ", 
        RowBox[{"the", " ", "return", " ", "value"}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"classPrefix", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"OptionValue", "[", "\"\<TemplateTypes\>\"", "]"}], "]"}], 
          ">", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<template<\>\"", "~~", 
          RowBox[{"StringRiffle", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"\"\<typename \>\"", "~~", "#"}], "&"}], ",", 
              RowBox[{"OptionValue", "[", "\"\<TemplateTypes\>\"", "]"}]}], 
             "]"}], ",", "\"\<, \>\""}], "]"}], "~~", "\"\<>\\n\>\""}], ",", 
         "\[IndentingNewLine]", "\"\<\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"classPrefix", "=", 
       RowBox[{"classPrefix", "<>", "\"\<class \>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"classSuffix", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"OptionValue", "[", "\"\<Bases\>\"", "]"}], "]"}], ">", 
          "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\< : public \>\"", "~~", 
          RowBox[{"StringRiffle", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "\"\<Bases\>\"", "]"}], ",", 
            "\"\<, public \>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
         "\"\<\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"className", "=", 
       RowBox[{"OptionValue", "[", "\"\<Name\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"create", " ", "the", " ", "body"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"classBody", "=", 
       RowBox[{"\"\<{\\n\>\"", "<>", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"OptionValue", "[", "\"\<MembersPublic\>\"", "]"}], "]"}],
            ">", "0"}], ",", 
          RowBox[{"\"\<public: \>\"", "<>", 
           RowBox[{"StringRiffle", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "\"\<MembersPublic\>\"", "]"}], ",", 
             "\"\<\\n\\n\>\""}], "]"}]}], ",", "\"\<\>\""}], "]"}], "<>", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"OptionValue", "[", "\"\<MembersProtected\>\"", "]"}], 
            "]"}], ">", "0"}], ",", 
          RowBox[{"\"\<protected: \>\"", "<>", 
           RowBox[{"StringRiffle", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "\"\<MembersProtected\>\"", "]"}], 
             ",", "\"\<\\n\\n\>\""}], "]"}]}], ",", "\"\<\>\""}], "]"}], "<>",
         "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"OptionValue", "[", "\"\<MembersPrivate\>\"", "]"}], 
            "]"}], ">", "0"}], ",", 
          RowBox[{"\"\<private: \>\"", "<>", 
           RowBox[{"StringRiffle", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "\"\<MembersPrivate\>\"", "]"}], 
             ",", "\"\<\\n\\n\>\""}], "]"}]}], ",", "\"\<\>\""}], "]"}], "<>",
         "\[IndentingNewLine]", "\"\<\\n};\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"classBody", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<;;\>\"", "->", "\"\<;\>\""}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"FormatCode", "[", "\[IndentingNewLine]", 
        RowBox[{
        "classPrefix", "<>", "className", "<>", "classSuffix", "<>", 
         "\"\<\\n\>\"", "<>", "classBody"}], "\[IndentingNewLine]", "]"}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.952761527738603*^9, 3.9527615466089478`*^9}, {
   3.9527616118912973`*^9, 3.952762224757728*^9}, {3.952762395810478*^9, 
   3.952762469873872*^9}, {3.952762537975101*^9, 3.952762565938217*^9}, {
   3.9527626053857937`*^9, 3.952762767942972*^9}, {3.952764982553095*^9, 
   3.9527649853503942`*^9}, {3.9530475944336843`*^9, 3.953047650572978*^9}, {
   3.953048778106143*^9, 3.9530487800268707`*^9}, {3.953347384229507*^9, 
   3.9533474255489073`*^9}, {3.953347637217699*^9, 3.9533477142529078`*^9}, {
   3.953360455017959*^9, 3.953360651339637*^9}, {3.953360695647758*^9, 
   3.953360797034842*^9}, {3.953360849532255*^9, 3.953360867191743*^9}, {
   3.9533609063116703`*^9, 3.9533609112553473`*^9}, {3.953361273855484*^9, 
   3.95336132613789*^9}, {3.9533733202384577`*^9, 3.953373408563806*^9}, {
   3.953373485839609*^9, 3.953373525962309*^9}, 3.953373582894991*^9, {
   3.9533765102951193`*^9, 3.953376594386977*^9}, {3.953376667951894*^9, 
   3.953376672683214*^9}, {3.953376725879615*^9, 3.9533767591109753`*^9}, {
   3.9533833507221937`*^9, 3.953383350900402*^9}, {3.957506224157778*^9, 
   3.957506316173094*^9}, {3.957506905889388*^9, 
   3.957506914517211*^9}},ExpressionUUID->"121124f3-b34f-43fb-b27f-\
8d28cfab0fe9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "MakeCppHeader", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Includes\>\"", "->", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\"\<Body\>\"", "->", 
      RowBox[{"{", "}"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeCppHeader", "[", 
    RowBox[{"OptionsPattern", "[", "]"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"headerPrefix", ",", "headerIncludes", ",", "headerBody"}], 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Create", " ", "prefixe", " ", "for", " ", "the", " ", "header"}], ",",
        " ", 
       RowBox[{
        RowBox[{
         RowBox[{"e", ".", "g", ".", " ", "static"}], " ", "or", " ", 
         "such"}], " ", "+", " ", 
        RowBox[{"the", " ", "return", " ", "value"}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"headerPrefix", "=", "\"\<#pragma once\\n\>\""}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"headerIncludes", "=", 
       RowBox[{
        RowBox[{"StringRiffle", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "\"\<#include \\\"\>\"", "~~", "#", "~~", "\"\<\\\"\>\""}], 
             "&"}], ",", 
            RowBox[{"OptionValue", "[", "\"\<Includes\>\"", "]"}]}], "]"}], 
          ",", "\"\<\\n\>\""}], "]"}], "<>", "\"\<\\n\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"create", " ", "the", " ", "body"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"headerBody", "=", 
       RowBox[{"StringRiffle", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<Body\>\"", "]"}], ",", 
         "\"\<\\n\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"FormatCode", "[", "\[IndentingNewLine]", 
        RowBox[{
        "headerPrefix", "<>", "\"\<\\n\>\"", "<>", "headerIncludes", "<>", 
         "\"\<\\n\>\"", "<>", "headerBody"}], "\[IndentingNewLine]", "]"}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9533735349238043`*^9, 3.9533738217142267`*^9}, {
   3.953374345971013*^9, 3.953374372123459*^9}, 
   3.953377424523286*^9},ExpressionUUID->"0653ed79-d814-4cd3-9636-\
55db96427984"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "MakeCppBlock", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Includes\>\"", "->", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\"\<Body\>\"", "->", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\"\<Namespace\>\"", "->", "\"\<\>\""}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeCppBlock", "[", 
    RowBox[{"OptionsPattern", "[", "]"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "sourcePrefix", ",", "sourcePostfix", ",", "sourceIncludes", ",", 
       "sourceBody"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Create", " ", "prefixe", " ", "for", " ", "the", " ", "source"}], ",",
        " ", 
       RowBox[{
        RowBox[{
         RowBox[{"e", ".", "g", ".", " ", "static"}], " ", "or", " ", 
         "such"}], " ", "+", " ", 
        RowBox[{"the", " ", "return", " ", "value"}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sourcePrefix", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<Namespace\>\"", "]"}], "=!=", 
          "\"\<\>\""}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<namespace \>\"", "<>", 
          RowBox[{"OptionValue", "[", "\"\<Namespace\>\"", "]"}], "<>", 
          "\"\<\\n{\\n\>\""}], ",", "\[IndentingNewLine]", "\"\<\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"sourceIncludes", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<Includes\>\"", "]"}], "=!=", 
          RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"StringRiffle", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "\"\<#include \\\"\>\"", "~~", "#", "~~", "\"\<\\\"\>\""}], 
               "&"}], ",", 
              RowBox[{"OptionValue", "[", "\"\<Includes\>\"", "]"}]}], "]"}], 
            ",", "\"\<\\n\>\""}], "]"}], "<>", "\"\<\\n\\n\>\""}], ",", 
         "\[IndentingNewLine]", "\"\<\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"create", " ", "the", " ", "body"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"sourceBody", "=", 
       RowBox[{
        RowBox[{"StringRiffle", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<Body\>\"", "]"}], ",", 
          "\"\<\\n\>\""}], "]"}], "<>", "\"\<\\n\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"sourcePostfix", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<Namespace\>\"", "]"}], "=!=", 
          "\"\<\>\""}], ",", "\[IndentingNewLine]", "\"\<}\>\"", ",", 
         "\[IndentingNewLine]", "\"\<\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"FormatCode", "[", "\[IndentingNewLine]", 
        RowBox[{
        "sourcePrefix", "<>", "sourceIncludes", "<>", "sourceBody", "<>", 
         "sourcePostfix"}], "\[IndentingNewLine]", "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9533735349238043`*^9, 3.9533738217142267`*^9}, {
   3.953374345971013*^9, 3.953374372123459*^9}, 3.953377424523286*^9, {
   3.957517319672495*^9, 3.957517510988283*^9}, {3.9575177112447166`*^9, 
   3.957517891160542*^9}, {3.9575180431731997`*^9, 
   3.957518043492764*^9}},ExpressionUUID->"32cd0176-cb58-4cc1-95b4-\
396b79882412"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
   "$DefaultRegulatorDefinitions", "=", 
    "\"\<\nstatic __forceinline__ __device__ __host__ auto RB(const auto k2, \
const auto p2) { return REG::RB(k2, p2); }\nstatic __forceinline__ __device__ \
__host__ auto RF(const auto k2, const auto p2) { return REG::RF(k2, p2); }\n\n\
static __forceinline__ __device__ __host__ auto RBdot(const auto k2, const \
auto p2) { return REG::RBdot(k2, p2); }\nstatic __forceinline__ __device__ \
__host__ auto RFdot(const auto k2, const auto p2) { return REG::RFdot(k2, \
p2); }\n\nstatic __forceinline__ __device__ __host__ auto dq2RB(const auto \
k2, const auto p2) { return REG::dq2RB(k2, p2); }\nstatic __forceinline__ \
__device__ __host__ auto dq2RF(const auto k2, const auto p2) { return \
REG::dq2RF(k2, p2); }\n\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "CreateKernelClass", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<integrationVariables\>\"", "->", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\"\<parameters\>\"", "->", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\"\<CodeParser\>\"", "->", "\"\<FORM\>\""}], ",", 
     RowBox[{
     "\"\<PrivateDefinitions\>\"", "->", "$DefaultRegulatorDefinitions"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<integrandBody\>\"", "->", "\"\<\>\""}], ",", 
     RowBox[{"\"\<constantBody\>\"", "->", "\"\<\>\""}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CreateKernelClass", "[", 
   RowBox[{"name_String", ",", "integrand_", ",", 
    RowBox[{"constant_", ":", "0"}], ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ret", ",", "parameters", ",", "parametersIntegrand"}], "}"}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"parameters", "=", 
      RowBox[{"OptionValue", "[", "\"\<parameters\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"parameters", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KeyDrop", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", "\"\<Type\>\"", "}"}]}], "]"}], "&"}], ",", 
        "parameters"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"parametersIntegrand", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"<|", 
            RowBox[{"\"\<Name\>\"", "->", "#"}], "|>"}], "&"}], ",", 
          RowBox[{"OptionValue", "[", "\"\<integrationVariables\>\"", "]"}]}],
          "]"}], ",", "parameters"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ret", "=", 
      RowBox[{"MakeCppHeader", "[", "\[IndentingNewLine]", 
       RowBox[{"\"\<Body\>\"", "->", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"MakeCppClass", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<TemplateTypes\>\"", "->", 
            RowBox[{"{", "\"\<REG\>\"", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<Name\>\"", "->", "name"}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<MembersPublic\>\"", "->", " ", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"MakeCppFunction", "[", 
               RowBox[{"integrand", ",", 
                RowBox[{"\"\<parameters\>\"", "->", "parametersIntegrand"}], 
                ",", 
                RowBox[{"\"\<CodeParser\>\"", "->", 
                 RowBox[{"OptionValue", "[", "\"\<CodeParser\>\"", "]"}]}], 
                ",", 
                RowBox[{"\"\<Name\>\"", "->", "\"\<kernel\>\""}], ",", 
                RowBox[{"\"\<static\>\"", "->", "True"}], ",", 
                RowBox[{"\"\<CUDA\>\"", "->", "True"}], ",", 
                RowBox[{"\"\<const\>\"", "->", "False"}], ",", 
                RowBox[{"\"\<return\>\"", "->", "\"\<auto\>\""}], ",", 
                RowBox[{"\"\<body\>\"", "->", 
                 RowBox[{
                 "OptionValue", "[", "\"\<integrandBody\>\"", "]"}]}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"MakeCppFunction", "[", 
               RowBox[{"constant", ",", 
                RowBox[{"\"\<parameters\>\"", "->", "parameters"}], ",", 
                RowBox[{"\"\<CodeParser\>\"", "->", "\"\<Cpp\>\""}], ",", 
                RowBox[{"\"\<Name\>\"", "->", "\"\<constant\>\""}], ",", 
                RowBox[{"\"\<static\>\"", "->", "True"}], ",", 
                RowBox[{"\"\<CUDA\>\"", "->", "True"}], ",", 
                RowBox[{"\"\<const\>\"", "->", "False"}], ",", 
                RowBox[{"\"\<return\>\"", "->", "\"\<auto\>\""}], ",", 
                RowBox[{"\"\<body\>\"", "->", 
                 RowBox[{
                 "OptionValue", "[", "\"\<constantBody\>\"", "]"}]}]}], 
               "]"}]}], "\[IndentingNewLine]", "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<MembersPrivate\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"OptionValue", "[", "\"\<PrivateDefinitions\>\"", "]"}], 
             "}"}]}]}], "]"}], "\[IndentingNewLine]", "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "ret", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9533757190746927`*^9, 3.953376142622664*^9}, {
   3.953376213563402*^9, 3.953376245338306*^9}, {3.953376612382784*^9, 
   3.953376636256117*^9}, {3.9533766896871758`*^9, 3.953376704150365*^9}, {
   3.953377407639988*^9, 3.953377417603304*^9}, {3.953377486643756*^9, 
   3.953377494711899*^9}, {3.9533775497229033`*^9, 3.953377570864427*^9}, {
   3.953377784351841*^9, 3.953377936566825*^9}, {3.953378572604166*^9, 
   3.953378575433044*^9}, {3.953379612559111*^9, 3.953379619600127*^9}, {
   3.953383146487557*^9, 3.953383205043743*^9}, {3.9533833510448723`*^9, 
   3.953383378908346*^9}, {3.953384640043899*^9, 3.953384640595639*^9}, 
   3.9533851439966516`*^9},ExpressionUUID->"6c698783-46f5-4550-8819-\
fc2e28e8a73f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Julia", "Section",
 CellChangeTimes->{{3.9509597231601686`*^9, 3.950959732923991*^9}, {
  3.951108540108012*^9, 3.9511085438759727`*^9}, {3.951210853720582*^9, 
  3.95121085660688*^9}, {3.952761524926857*^9, 3.952761526260778*^9}, {
  3.956405395036249*^9, 
  3.9564053958285933`*^9}},ExpressionUUID->"d1eae3e3-a1d4-4f43-bc47-\
8b9ad56b43d8"],

Cell[CellGroupData[{

Cell["Julia formatting", "Subsection",
 CellChangeTimes->{{3.918570624414493*^9, 3.918570646019106*^9}, {
  3.9564056444300137`*^9, 
  3.956405645250546*^9}},ExpressionUUID->"bb6db520-7a4d-4f07-b33a-\
43b6335f2d38"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"JuliaForm", "[", "expr_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "Fstr", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Fstr", "=", 
        RowBox[{"ToString", "[", 
         RowBox[{"FortranForm", "[", 
          RowBox[{"expr", "//.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"E", "^", "x_"}], ":>", 
             RowBox[{"exp", "[", "x", "]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"Fstr", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"a_", "~~", "\"\<(i)\>\""}], "->", 
            RowBox[{"a", "~~", "\"\<[i]\>\""}]}], ",", 
           RowBox[{
            RowBox[{"a_", "~~", "\"\<(-1 + i)\>\""}], "->", 
            RowBox[{"a", "~~", "\"\<[i-1]\>\""}]}], ",", 
           RowBox[{
            RowBox[{"a_", "~~", "\"\<(1 + i)\>\""}], "->", 
            RowBox[{"a", "~~", "\"\<[i+1]\>\""}]}], ",", 
           RowBox[{"\"\<**\>\"", "->", "\"\<^\>\""}], ",", 
           RowBox[{"\"\<.*\>\"", "->", "\"\<*\>\""}], ",", 
           RowBox[{"\"\<.+\>\"", "->", "\"\<+\>\""}], ",", 
           RowBox[{"\"\<Pi\>\"", "->", "\"\<\[Pi]\>\""}], ",", 
           RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
           RowBox[{"\"\<Coth\>\"", "->", "\"\<coth\>\""}], ",", 
           RowBox[{"\"\<Tanh\>\"", "->", "\"\<tanh\>\""}]}], "}"}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IndentCode", "[", 
   RowBox[{"code_String", ",", "level_Integer"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ret", "=", "code"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", "level"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ret", "=", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"ret", ",", 
           RowBox[{"\"\<\\n\>\"", "->", "\"\<\\n  \>\""}]}], "]"}]}], ";"}]}],
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Remove", " ", "trailing", " ", "whitespaces"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"ret", ",", 
          RowBox[{"{", 
           RowBox[{"-", "1"}], "}"}]}], "]"}], "===", "\"\< \>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ret", "=", 
         RowBox[{"StringTake", "[", 
          RowBox[{"ret", ",", 
           RowBox[{
            RowBox[{"StringLength", "[", "ret", "]"}], "-", "1"}]}], "]"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "ret", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 TaggingRules-><|"ChatNotebookSettings" -> <||>|>,
 InitializationCell->True,
 CellChangeTimes->{{3.956405622673417*^9, 3.956405622675856*^9}, {
   3.956405658149763*^9, 3.9564056744169083`*^9}, {3.956405711949574*^9, 
   3.956405712912505*^9}, {3.9564060436157846`*^9, 3.9564061715160027`*^9}, {
   3.9564062160708714`*^9, 3.956406219786869*^9}, {3.9564066306973467`*^9, 
   3.9564067177703857`*^9}, 3.956407248446953*^9, 
   3.9564091655425797`*^9},ExpressionUUID->"d8038072-125a-4f25-b2ad-\
9568b4dfd78c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Julia code creation", "Subsection",
 CellChangeTimes->{{3.918570624414493*^9, 3.918570646019106*^9}, {
   3.952763027549075*^9, 3.952763031444932*^9}, 3.953347368807349*^9, {
   3.956405709095414*^9, 
   3.956405728549532*^9}},ExpressionUUID->"d35005be-ae33-4175-8083-\
83cc90b1c312"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"JuliaCode", "[", "equation_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "optList", ",", "interpObj", ",", "replacementObj", ",", 
       "replacementNames", ",", "replacements", ",", "definitions", ",", 
       "returnStatement"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"optList", "=", "$codeOptimizeFunctions"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"interpObj", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"equation", ",", "#", ",", "Infinity"}], "]"}], "&"}], 
          ",", "optList"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"replacementObj", "=", 
       RowBox[{"Keys", "@", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Counts", "[", "interpObj", "]"}], ",", 
          RowBox[{
           RowBox[{"#", ">", "1"}], "&"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"replacementNames", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\"\<_repl\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "replacementObj", "]"}]}], "}"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"replacements", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"replacementObj", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "->", 
          RowBox[{"replacementNames", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "replacementObj", "]"}]}], "}"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"definitions", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "replacementObj", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"replacementNames", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", "\"\< = \>\"", "<>", 
              RowBox[{"JuliaForm", "[", 
               RowBox[{"FullSimplify", "@", 
                RowBox[{"replacementObj", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "<>", 
              "\"\<\\n\>\""}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "replacementObj", "]"}]}], "}"}]}], 
            "]"}], "]"}], "<>", "\"\<\\n\>\""}], "\[IndentingNewLine]", ",", 
         "\"\<\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"returnStatement", "=", 
       RowBox[{"\"\<return \>\"", "<>", 
        RowBox[{"JuliaForm", "[", 
         RowBox[{"equation", "//.", "replacements"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"returnStatement", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"returnStatement", ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\"\<\\\"\>\"", "<>", "#", "<>", "\"\<\\\"\>\""}], "->", 
             "#"}], "&"}], ",", "replacementNames"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"definitions", "<>", "returnStatement"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.925707478577066*^9, 3.925707513859118*^9}, {
   3.925707770248493*^9, 3.925707774050929*^9}, {3.925707880518664*^9, 
   3.925707903522541*^9}, {3.925707934432786*^9, 3.9257079348818073`*^9}, {
   3.92570919705335*^9, 3.925709198845766*^9}, {3.925709437368464*^9, 
   3.9257094396079063`*^9}, {3.925710044896023*^9, 3.9257100636592007`*^9}, {
   3.925712252732678*^9, 3.925712255615948*^9}, {3.92590917183536*^9, 
   3.925909211955093*^9}, {3.92590942091114*^9, 3.925909425176322*^9}, {
   3.925909463262588*^9, 3.925909481128065*^9}, {3.92590955682531*^9, 
   3.925909558500592*^9}, {3.931419817534824*^9, 3.931419860007971*^9}, {
   3.931419894486116*^9, 3.931419895405524*^9}, {3.931419975675881*^9, 
   3.931420194158597*^9}, {3.9314202268194838`*^9, 3.931420373049406*^9}, {
   3.93204098578543*^9, 3.932040986204354*^9}, {3.932041044803256*^9, 
   3.9320410501374397`*^9}, {3.9320412127795973`*^9, 3.93204123315661*^9}, {
   3.932041530815583*^9, 3.932041533077765*^9}, {3.9320418556709957`*^9, 
   3.932041959133141*^9}, {3.932041995923657*^9, 3.932041999267761*^9}, {
   3.932042033255431*^9, 3.9320420871912127`*^9}, 3.932042236729015*^9, {
   3.932042322479778*^9, 3.932042355945862*^9}, {3.934166682496434*^9, 
   3.9341666887935147`*^9}, {3.93416672573591*^9, 3.934166738735838*^9}, {
   3.9341672212881813`*^9, 3.9341672296384583`*^9}, {3.936854714485991*^9, 
   3.936854874865799*^9}, {3.937488899850667*^9, 3.9374889804710817`*^9}, {
   3.938783572613789*^9, 3.938783594503048*^9}, {3.938785807715172*^9, 
   3.938785827663423*^9}, {3.9387858588055973`*^9, 3.9387858619333467`*^9}, {
   3.938785895614574*^9, 3.9387858980313797`*^9}, {3.95336098170954*^9, 
   3.953361000342114*^9}, {3.953361048694539*^9, 3.953361086921235*^9}, {
   3.953361118352385*^9, 3.953361162768344*^9}, 3.953361225339902*^9, {
   3.953376164735859*^9, 3.95337618618369*^9}, {3.953380053449445*^9, 
   3.9533800536942177`*^9}, {3.9533876120086603`*^9, 3.953387614729124*^9}, {
   3.9533878638283443`*^9, 3.953387890268984*^9}, 3.953388257528964*^9, {
   3.953388288411961*^9, 3.953388293144047*^9}, {3.953388387129201*^9, 
   3.953388406412842*^9}, {3.953388459772352*^9, 3.9533885426652517`*^9}, {
   3.9533894065042257`*^9, 3.9533894089441357`*^9}, {3.953444181683769*^9, 
   3.953444184478673*^9}, 3.956405749145542*^9, 3.956405864213334*^9, {
   3.9564059900733833`*^9, 3.95640600781925*^9}, {3.956408467101454*^9, 
   3.9564084693906612`*^9}, {3.9564091334420023`*^9, 3.956409154959385*^9}, {
   3.957345916132113*^9, 
   3.957345963506649*^9}},ExpressionUUID->"a64eafc7-3cd5-4e30-a2e9-\
1a7bcffcd2ff"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Julia function creation", "Subsection",
 CellChangeTimes->{{3.918570624414493*^9, 3.918570646019106*^9}, {
  3.952763027549075*^9, 3.952763031444932*^9}, {3.9564062414415083`*^9, 
  3.956406241953754*^9}},ExpressionUUID->"31f3fcb4-4749-48bc-81cc-\
4be53512fe24"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "MakeJuliaFunction", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "MakeJuliaFunction", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Parameters\>\"", "->", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\"\<Name\>\"", "->", "\"\<kernel\>\""}], ",", 
     RowBox[{"\"\<Prefix\>\"", "->", "\"\<\>\""}], ",", 
     RowBox[{"\"\<Body\>\"", "->", "\"\<\>\""}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeJuliaFunction", "[", 
    RowBox[{"OptionsPattern", "[", "]"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "functionPrefix", ",", "functionName", ",", "\[IndentingNewLine]", 
       "functionParameters", ",", "idx", ",", "\[IndentingNewLine]", 
       "functionBody"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Create", " ", "prefixe", " ", "for", " ", "the", " ", "function"}], 
       ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"e", ".", "g", ".", " ", "static"}], " ", "or", " ", 
         "such"}], " ", "+", " ", 
        RowBox[{"the", " ", "return", " ", "value"}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"functionPrefix", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<Prefix\>\"", "]"}], "===", 
          "\"\<\>\""}], ",", "\"\<\>\"", ",", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<Prefix\>\"", "]"}], "<>", 
          "\"\< \>\""}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"functionName", "=", 
       RowBox[{"\"\<function \>\"", "<>", 
        RowBox[{"OptionValue", "[", "\"\<Name\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"functionParameters", "=", 
       RowBox[{"\"\<(\>\"", "<>", 
        RowBox[{"StringRiffle", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"AssociationQ", "[", "#", "]"}], ",", 
               RowBox[{"#", "[", "\"\<Name\>\"", "]"}], ",", 
               RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "&"}], ",", 
            RowBox[{"OptionValue", "[", "\"\<Parameters\>\"", "]"}]}], "]"}], 
          ",", "\[IndentingNewLine]", "\"\<, \>\""}], "]"}], "<>", 
        "\"\<)\>\""}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"create", " ", "the", " ", "body"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"functionBody", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"\"\<\\n\>\"", "<>", 
          RowBox[{"OptionValue", "[", "\"\<Body\>\"", "]"}], "<>", 
          "\"\<\\n\>\""}], ",", 
         RowBox[{"\"\<\\n\\n\>\"", "->", "\"\<\\n\>\""}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"functionBody", "=", 
       RowBox[{"IndentCode", "[", 
        RowBox[{"functionBody", ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "\[IndentingNewLine]", 
       RowBox[{
       "functionPrefix", "<>", "functionName", "<>", "functionParameters", "<>",
         "functionBody", "<>", "\"\<end\>\""}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeJuliaFunction", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "newBody", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newBody", "=", 
       RowBox[{
        RowBox[{"OptionValue", "[", "\"\<Body\>\"", "]"}], "<>", 
        "\"\<\\n\>\"", "<>", 
        RowBox[{"JuliaCode", "[", "expr", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"MakeJuliaFunction", "@@", 
       RowBox[{"(", 
        RowBox[{"Evaluate", "@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<Body\>\"", "->", "newBody"}], "}"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"Rule", "@@", 
               RowBox[{"{", 
                RowBox[{"#", ",", 
                 RowBox[{"OptionValue", "[", 
                  RowBox[{"MakeJuliaFunction", ",", "#"}], "]"}]}], "}"}]}], 
              "]"}], "&"}], "@", 
            RowBox[{"Keys", "[", 
             RowBox[{"Options", "[", "MakeJuliaFunction", "]"}], "]"}]}]}], 
          "]"}]}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.952761527738603*^9, 3.9527615466089478`*^9}, {
   3.9527616118912973`*^9, 3.952762224757728*^9}, {3.952762395810478*^9, 
   3.952762469873872*^9}, {3.952762537975101*^9, 3.952762565938217*^9}, {
   3.9527626053857937`*^9, 3.952762767942972*^9}, {3.952764982553095*^9, 
   3.9527649853503942`*^9}, {3.9530475944336843`*^9, 3.953047650572978*^9}, {
   3.953048778106143*^9, 3.9530487800268707`*^9}, {3.953347384229507*^9, 
   3.9533474255489073`*^9}, {3.953347787209957*^9, 3.95334790618536*^9}, {
   3.953348311122266*^9, 3.953348413794139*^9}, {3.953375481743616*^9, 
   3.953375482272665*^9}, {3.953375609713024*^9, 3.953375635300383*^9}, {
   3.9533756880236483`*^9, 3.9533757024393387`*^9}, {3.9533768651636744`*^9, 
   3.953376950710722*^9}, {3.953377106843546*^9, 3.953377383930626*^9}, {
   3.953377433848876*^9, 3.953377467579711*^9}, {3.953377584868635*^9, 
   3.953377640063942*^9}, {3.953377720954885*^9, 3.9533777605129137`*^9}, {
   3.953383349611212*^9, 3.953383378737067*^9}, {3.9563973061417007`*^9, 
   3.956397387637001*^9}, {3.956397594767374*^9, 3.956397595053165*^9}, {
   3.956401456326025*^9, 3.9564015119196463`*^9}, 3.956401549750486*^9, {
   3.956401691353828*^9, 3.956401765710685*^9}, {3.956406247532056*^9, 
   3.956406523960545*^9}, {3.956406557991647*^9, 3.956406600862859*^9}, {
   3.956406754411323*^9, 3.9564068570307713`*^9}, {3.956406934736847*^9, 
   3.956407132761386*^9}},
 CellLabel->
  "In[194]:=",ExpressionUUID->"aae42b7b-87cf-4909-a1b7-8b0a1e48becf"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fortran", "Section",
 CellChangeTimes->{{3.9509597231601686`*^9, 3.950959732923991*^9}, {
  3.951108540108012*^9, 3.9511085438759727`*^9}, {3.951210853720582*^9, 
  3.95121085660688*^9}, {3.952761524926857*^9, 3.952761526260778*^9}, {
  3.956405395036249*^9, 3.9564053958285933`*^9}, {3.956408423861677*^9, 
  3.956408427727852*^9}},ExpressionUUID->"fd091b76-1595-46ac-9769-\
c9fc9edc6bc4"],

Cell[CellGroupData[{

Cell["Fortran code creation", "Subsection",
 CellChangeTimes->{{3.918570624414493*^9, 3.918570646019106*^9}, {
   3.952763027549075*^9, 3.952763031444932*^9}, 3.953347368807349*^9, {
   3.956405709095414*^9, 3.956405728549532*^9}, {3.9564084477118597`*^9, 
   3.956408448724455*^9}},ExpressionUUID->"45e1ec2c-4f80-426d-b4be-\
097ebee3e119"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FortranCode", "[", 
    RowBox[{"equation_", ",", 
     RowBox[{"name_", ":", "\"\<result\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "optList", ",", "interpObj", ",", "replacementObj", ",", 
       "replacementNames", ",", "replacements", ",", "definitions", ",", 
       "returnStatement"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"optList", "=", "$codeOptimizeFunctions"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"interpObj", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"equation", ",", "#", ",", "Infinity"}], "]"}], "&"}], 
          ",", "optList"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"replacementObj", "=", 
       RowBox[{"Keys", "@", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Counts", "[", "interpObj", "]"}], ",", 
          RowBox[{
           RowBox[{"#", ">", "1"}], "&"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"replacementNames", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\"\<repl\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "replacementObj", "]"}]}], "}"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"replacements", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"replacementObj", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "->", 
          RowBox[{"Symbol", "@", 
           RowBox[{"replacementNames", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "replacementObj", "]"}]}], "}"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"definitions", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "replacementObj", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"\"\<real, parameter :: \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"replacementNames", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", "\"\< = \>\"", "<>", 
              RowBox[{"ToString", "@", 
               RowBox[{"FortranForm", "[", 
                RowBox[{"FullSimplify", "@", 
                 RowBox[{"replacementObj", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "<>", 
              "\"\<\\n\>\""}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "replacementObj", "]"}]}], "}"}]}], 
            "]"}], "]"}], "<>", "\"\<\\n\>\""}], "\[IndentingNewLine]", ",", 
         "\"\<\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"returnStatement", "=", 
       RowBox[{"name", "<>", "\"\< = \>\"", "<>", 
        RowBox[{"ToString", "@", 
         RowBox[{"FortranForm", "[", 
          RowBox[{"equation", "//.", "replacements"}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"returnStatement", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"returnStatement", ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\"\<\\\"\>\"", "<>", "#", "<>", "\"\<\\\"\>\""}], "->", 
             "#"}], "&"}], ",", "replacementNames"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "definitions", "<>", "\"\<\\n\>\"", "<>", "returnStatement"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.925707478577066*^9, 3.925707513859118*^9}, {
   3.925707770248493*^9, 3.925707774050929*^9}, {3.925707880518664*^9, 
   3.925707903522541*^9}, {3.925707934432786*^9, 3.9257079348818073`*^9}, {
   3.92570919705335*^9, 3.925709198845766*^9}, {3.925709437368464*^9, 
   3.9257094396079063`*^9}, {3.925710044896023*^9, 3.9257100636592007`*^9}, {
   3.925712252732678*^9, 3.925712255615948*^9}, {3.92590917183536*^9, 
   3.925909211955093*^9}, {3.92590942091114*^9, 3.925909425176322*^9}, {
   3.925909463262588*^9, 3.925909481128065*^9}, {3.92590955682531*^9, 
   3.925909558500592*^9}, {3.931419817534824*^9, 3.931419860007971*^9}, {
   3.931419894486116*^9, 3.931419895405524*^9}, {3.931419975675881*^9, 
   3.931420194158597*^9}, {3.9314202268194838`*^9, 3.931420373049406*^9}, {
   3.93204098578543*^9, 3.932040986204354*^9}, {3.932041044803256*^9, 
   3.9320410501374397`*^9}, {3.9320412127795973`*^9, 3.93204123315661*^9}, {
   3.932041530815583*^9, 3.932041533077765*^9}, {3.9320418556709957`*^9, 
   3.932041959133141*^9}, {3.932041995923657*^9, 3.932041999267761*^9}, {
   3.932042033255431*^9, 3.9320420871912127`*^9}, 3.932042236729015*^9, {
   3.932042322479778*^9, 3.932042355945862*^9}, {3.934166682496434*^9, 
   3.9341666887935147`*^9}, {3.93416672573591*^9, 3.934166738735838*^9}, {
   3.9341672212881813`*^9, 3.9341672296384583`*^9}, {3.936854714485991*^9, 
   3.936854874865799*^9}, {3.937488899850667*^9, 3.9374889804710817`*^9}, {
   3.938783572613789*^9, 3.938783594503048*^9}, {3.938785807715172*^9, 
   3.938785827663423*^9}, {3.9387858588055973`*^9, 3.9387858619333467`*^9}, {
   3.938785895614574*^9, 3.9387858980313797`*^9}, {3.95336098170954*^9, 
   3.953361000342114*^9}, {3.953361048694539*^9, 3.953361086921235*^9}, {
   3.953361118352385*^9, 3.953361162768344*^9}, 3.953361225339902*^9, {
   3.953376164735859*^9, 3.95337618618369*^9}, {3.953380053449445*^9, 
   3.9533800536942177`*^9}, {3.9533876120086603`*^9, 3.953387614729124*^9}, {
   3.9533878638283443`*^9, 3.953387890268984*^9}, 3.953388257528964*^9, {
   3.953388288411961*^9, 3.953388293144047*^9}, {3.953388387129201*^9, 
   3.953388406412842*^9}, {3.953388459772352*^9, 3.9533885426652517`*^9}, {
   3.9533894065042257`*^9, 3.9533894089441357`*^9}, {3.953444181683769*^9, 
   3.953444184478673*^9}, 3.956405749145542*^9, 3.956405864213334*^9, {
   3.9564059900733833`*^9, 3.95640600781925*^9}, {3.956408452662531*^9, 
   3.956408477553672*^9}, {3.9564087693272247`*^9, 3.956408792605826*^9}, {
   3.9564090829117393`*^9, 3.9564091138071127`*^9}, {3.956409173732437*^9, 
   3.956409237966998*^9}, {3.956409323885297*^9, 3.9564094209494534`*^9}, {
   3.956409557202941*^9, 3.956409559933859*^9}, {3.9564754233743477`*^9, 
   3.956475427691136*^9}, 
   3.957372317834425*^9},ExpressionUUID->"37c0cded-e660-4d93-93e7-\
bd4a7753decd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fortran function creation", "Subsection",
 CellChangeTimes->{{3.918570624414493*^9, 3.918570646019106*^9}, {
  3.952763027549075*^9, 3.952763031444932*^9}, {3.9564062414415083`*^9, 
  3.956406241953754*^9}, {3.9564084871549273`*^9, 
  3.956408488104287*^9}},ExpressionUUID->"da37cc01-4037-4f8a-95fb-\
ac772916a2d3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "MakeFortranFunction", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "MakeFortranFunction", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Parameters\>\"", "->", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\"\<Name\>\"", "->", "\"\<kernel\>\""}], ",", 
     RowBox[{"\"\<Prefix\>\"", "->", "\"\<\>\""}], ",", 
     RowBox[{"\"\<Body\>\"", "->", "\"\<\>\""}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeFortranFunction", "[", 
    RowBox[{"OptionsPattern", "[", "]"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "functionPrefix", ",", "functionName", ",", "\[IndentingNewLine]", 
       "functionParameters", ",", "idx", ",", "\[IndentingNewLine]", 
       "functionBody"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Create", " ", "prefixe", " ", "for", " ", "the", " ", "function"}], ",",
        " ", 
       RowBox[{
        RowBox[{
         RowBox[{"e", ".", "g", ".", " ", "static"}], " ", "or", " ", 
         "such"}], " ", "+", " ", 
        RowBox[{"the", " ", "return", " ", "value"}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"functionPrefix", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<Prefix\>\"", "]"}], 
          "===", "\"\<\>\""}], ",", "\"\<\>\"", ",", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<Prefix\>\"", "]"}], 
          "<>", "\"\< \>\""}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"functionName", "=", 
       RowBox[{"\"\<function \>\"", "<>", 
        RowBox[{"OptionValue", "[", "\"\<Name\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"functionParameters", "=", 
       RowBox[{"\"\<(\>\"", "<>", 
        RowBox[{"StringRiffle", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\"\<real \>\"", "<>", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"AssociationQ", "[", "#", "]"}], ",", 
                RowBox[{"#", "[", "\"\<Name\>\"", "]"}], ",", 
                RowBox[{"ToString", "[", "#", "]"}]}], "]"}]}], "&"}], ",", 
            RowBox[{"OptionValue", "[", "\"\<Parameters\>\"", "]"}]}], "]"}], 
          ",", "\[IndentingNewLine]", "\"\<, \>\""}], "]"}], 
        "<>", "\"\<)\>\""}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"create", " ", "the", " ", "body"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"functionBody", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"\"\<\\n\>\"", "<>", 
          RowBox[{"OptionValue", "[", "\"\<Body\>\"", "]"}], 
          "<>", "\"\<\\n\>\""}], ",", 
         RowBox[{"\"\<\\n\\n\>\"", "->", "\"\<\\n\>\""}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"functionBody", "=", 
       RowBox[{"IndentCode", "[", 
        RowBox[{"functionBody", ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "\[IndentingNewLine]", 
       RowBox[{
       "functionPrefix", "<>", "functionName", "<>", "functionParameters", "<>",
         "functionBody", "<>", "\"\<end\>\""}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeFortranFunction", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "newBody", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newBody", "=", 
       RowBox[{
        RowBox[{"OptionValue", "[", "\"\<Body\>\"", "]"}], "<>", "\"\<\\n\>\"",
         "<>", 
        RowBox[{"FortranCode", "[", 
         RowBox[{"expr", ",", 
          RowBox[{"OptionValue", "[", "\"\<Name\>\"", "]"}]}], "]"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"MakeFortranFunction", "@@", 
       RowBox[{"(", 
        RowBox[{"Evaluate", "@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<Body\>\"", "->", "newBody"}], "}"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"Rule", "@@", 
               RowBox[{"{", 
                RowBox[{"#", ",", 
                 RowBox[{"OptionValue", "[", 
                  RowBox[{"MakeFortranFunction", ",", "#"}], "]"}]}], "}"}]}],
               "]"}], "&"}], "@", 
            RowBox[{"Keys", "[", 
             RowBox[{"Options", "[", "MakeFortranFunction", "]"}], "]"}]}]}], 
          "]"}]}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.952761527738603*^9, 3.9527615466089478`*^9}, {
   3.9527616118912973`*^9, 3.952762224757728*^9}, {3.952762395810478*^9, 
   3.952762469873872*^9}, {3.952762537975101*^9, 3.952762565938217*^9}, {
   3.9527626053857937`*^9, 3.952762767942972*^9}, {3.952764982553095*^9, 
   3.9527649853503942`*^9}, {3.9530475944336843`*^9, 3.953047650572978*^9}, {
   3.953048778106143*^9, 3.9530487800268707`*^9}, {3.953347384229507*^9, 
   3.9533474255489073`*^9}, {3.953347787209957*^9, 3.95334790618536*^9}, {
   3.953348311122266*^9, 3.953348413794139*^9}, {3.953375481743616*^9, 
   3.953375482272665*^9}, {3.953375609713024*^9, 3.953375635300383*^9}, {
   3.9533756880236483`*^9, 3.9533757024393387`*^9}, {3.9533768651636744`*^9, 
   3.953376950710722*^9}, {3.953377106843546*^9, 3.953377383930626*^9}, {
   3.953377433848876*^9, 3.953377467579711*^9}, {3.953377584868635*^9, 
   3.953377640063942*^9}, {3.953377720954885*^9, 3.9533777605129137`*^9}, {
   3.953383349611212*^9, 3.953383378737067*^9}, {3.9563973061417007`*^9, 
   3.956397387637001*^9}, {3.956397594767374*^9, 3.956397595053165*^9}, {
   3.956401456326025*^9, 3.9564015119196463`*^9}, 3.956401549750486*^9, {
   3.956401691353828*^9, 3.956401765710685*^9}, {3.956406247532056*^9, 
   3.956406523960545*^9}, {3.956406557991647*^9, 3.956406600862859*^9}, {
   3.956406754411323*^9, 3.9564068570307713`*^9}, {3.956406934736847*^9, 
   3.956407132761386*^9}, {3.956409035016943*^9, 3.956409064815036*^9}, {
   3.956409435938714*^9, 3.956409466779956*^9}, {3.956409498323332*^9, 
   3.9564095258038387`*^9}, 3.956409568384426*^9},
 CellLabel->
  "In[259]:=",ExpressionUUID->"9e02a99e-b90c-4d0c-9cd3-469e2aefb62d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["End Private", "Section",
 CellChangeTimes->{{3.9509597231601686`*^9, 3.950959732923991*^9}, {
  3.951108540108012*^9, 3.9511085438759727`*^9}, {3.951210853720582*^9, 
  3.95121085660688*^9}, {3.951719085230523*^9, 3.951719086330667*^9}, {
  3.95339039462521*^9, 3.953390408535656*^9}, {3.953391063947679*^9, 
  3.953391064411661*^9}, {3.953391216699678*^9, 
  3.953391216943687*^9}},ExpressionUUID->"2f860918-e407-42ec-8e71-\
c29969e7113a"],

Cell[BoxData[
 RowBox[{"End", "[", "]"}]], "Code",
 CellChangeTimes->{
  3.933840441045422*^9, {3.953390410137535*^9, 3.953390412999981*^9}, {
   3.9533910663320923`*^9, 3.95339107121176*^9}, {3.953391218596067*^9, 
   3.953391221099728*^9}},ExpressionUUID->"d874146e-0366-43b8-9441-\
de245a7f87f4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing", "Title",
 CellChangeTimes->{{3.9508681098093233`*^9, 
  3.950868110913395*^9}},ExpressionUUID->"f9e38f33-09e7-4f47-aa24-\
24618b810538"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Get", "[", "\"\<FunKit`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fields", "=", " ", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<cField\>\"", "\[Rule]", " ", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"A", "[", 
        RowBox[{"p", ",", 
         RowBox[{"{", 
          RowBox[{"v", ",", " ", "c"}], "}"}]}], "]"}], "\[IndentingNewLine]",
        "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Grassmann\>\"", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cb", "[", 
          RowBox[{"p", ",", 
           RowBox[{"{", "c", "}"}]}], "]"}], ",", 
         RowBox[{"c", "[", 
          RowBox[{"p", ",", 
           RowBox[{"{", "c", "}"}]}], "]"}]}], "}"}], "\[IndentingNewLine]", 
       "}"}]}]}], "\[IndentingNewLine]", "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"truncation", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"GammaN", "->", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"A", ",", "A"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", "A", ",", "A"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", "A", ",", "A", ",", "A"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"A", ",", "cb", ",", "c"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"cb", ",", "c"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Propagator", "->", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"A", ",", "A"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"cb", ",", "c"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Rdot", "->", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"A", ",", "A"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"cb", ",", "c"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"S", "->", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"A", ",", "A"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", "A", ",", "A"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", "A", ",", "A", ",", "A"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"cb", ",", "c"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"cb", ",", "c", ",", "A"}], "}"}]}], "\[IndentingNewLine]", 
       "}"}]}]}], "\[IndentingNewLine]", "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetTexStyles", "[", 
   RowBox[{"cb", "->", "\"\<\\\\bar{c}\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bases", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"GammaN", "->", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"A", ",", "A"}], "}"}], "->", 
         RowBox[{"{", 
          RowBox[{"\"\<AA\>\"", ",", "1"}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"A", ",", "A", ",", "A"}], "}"}], "->", 
         "\"\<AAAClass\>\""}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"A", ",", "A", ",", "A", ",", "A"}], "}"}], "->", 
         "\"\<AAAAClass\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"A", ",", "cb", ",", "c"}], "}"}], "->", 
         RowBox[{"{", 
          RowBox[{"\"\<Acbc\>\"", ",", "1"}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"cb", ",", "c"}], "}"}], "->", "\"\<cbc\>\""}]}], 
       "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Propagator", "->", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"A", ",", "A"}], "}"}], "->", "\"\<AA\>\""}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"cb", ",", "c"}], "}"}], "->", "\"\<cbc\>\""}]}], 
       "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Rdot", "->", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"A", ",", "A"}], "}"}], "->", 
         RowBox[{"{", 
          RowBox[{"\"\<AA\>\"", ",", "1"}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"cb", ",", "c"}], "}"}], "->", "\"\<cbc\>\""}]}], 
       "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Setup", ":=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<FieldSpace\>\"", "->", "fields"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Truncation\>\"", "->", "truncation"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<FeynmanRules\>\"", "->", "bases"}]}], "\[IndentingNewLine]",
     "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetGlobalSetup", "[", "Setup", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"landauGauge", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"#", "/.", 
       RowBox[{
        RowBox[{"dressing", "[", 
         RowBox[{"GammaN", ",", 
          RowBox[{"{", 
           RowBox[{"A", ",", "A"}], "}"}], ",", "2", ",", 
          RowBox[{"{", "__", "}"}]}], "]"}], ":>", 
        FractionBox["1", "\[Xi]"]}]}], "//.", 
      RowBox[{"\[Xi]", "->", "0"}]}], ")"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dressingRules", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dressing", "[", 
       RowBox[{"GammaN", ",", 
        RowBox[{"{", 
         RowBox[{"c", ",", "cb"}], "}"}], ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"p1_", ",", "p2_"}], "}"}]}], "]"}], ":>", 
      RowBox[{
       RowBox[{"ZA", "[", 
        SqrtBox[
         RowBox[{"sp", "[", 
          RowBox[{"p2", ",", "p2"}], "]"}]], "]"}], 
       RowBox[{"sp", "[", 
        RowBox[{"p2", ",", "p2"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dressing", "[", 
       RowBox[{"GammaN", ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", "A"}], "}"}], ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"p1_", ",", "p2_"}], "}"}]}], "]"}], ":>", 
      RowBox[{
       RowBox[{"Zc", "[", 
        SqrtBox[
         RowBox[{"sp", "[", 
          RowBox[{"p2", ",", "p2"}], "]"}]], "]"}], 
       RowBox[{"sp", "[", 
        RowBox[{"p2", ",", "p2"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dressing", "[", 
       RowBox[{"GammaN", ",", 
        RowBox[{"{", 
         RowBox[{"c", ",", "cb", ",", "A"}], "}"}], ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"p1_", ",", "p2_", ",", "p3_"}], "}"}]}], "]"}], ":>", 
      RowBox[{"ZccbA", "[", 
       RowBox[{"p1", ",", "p2"}], "]"}]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dressing", "[", 
       RowBox[{"GammaN", ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", "A", ",", "A"}], "}"}], ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"p1_", ",", "p2_", ",", "p3_"}], "}"}]}], "]"}], ":>", 
      RowBox[{"ZA3", "[", 
       RowBox[{"p1", ",", "p2"}], "]"}]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dressing", "[", 
       RowBox[{"GammaN", ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", "A", ",", "A", ",", "A"}], "}"}], ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"p1_", ",", "p2_", ",", "p3_", ",", "p4_"}], "}"}]}], "]"}], 
      ":>", 
      RowBox[{"ZA4", "[", 
       RowBox[{"p1", ",", "p2", ",", "p3"}], "]"}]}], " ", ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ZccbA", "[", 
       RowBox[{"p1_", ",", "p2_"}], "]"}], ":>", 
      RowBox[{"ZccbA", "[", 
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"sp", "[", 
           RowBox[{"p1", ",", "p1"}], "]"}], "+", 
          RowBox[{"sp", "[", 
           RowBox[{"p2", ",", "p2"}], "]"}], "+", 
          RowBox[{"sp", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "p1"}], "-", "p2"}], ",", 
            RowBox[{
             RowBox[{"-", "p1"}], "-", "p2"}]}], "]"}]}], "3"]], "]"}]}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ZA3", "[", 
       RowBox[{"p1_", ",", "p2_"}], "]"}], ":>", 
      RowBox[{"ZA3", "[", 
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"sp", "[", 
           RowBox[{"p1", ",", "p1"}], "]"}], "+", 
          RowBox[{"sp", "[", 
           RowBox[{"p2", ",", "p2"}], "]"}], "+", 
          RowBox[{"sp", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "p1"}], "-", "p2"}], ",", 
            RowBox[{
             RowBox[{"-", "p1"}], "-", "p2"}]}], "]"}]}], "3"]], "]"}]}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ZA4", "[", 
       RowBox[{"p1_", ",", "p2_", ",", "p3_"}], "]"}], ":>", 
      RowBox[{"ZA4", "[", 
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"sp", "[", 
           RowBox[{"p1", ",", "p1"}], "]"}], "+", 
          RowBox[{"sp", "[", 
           RowBox[{"p2", ",", "p2"}], "]"}], "+", 
          RowBox[{"sp", "[", 
           RowBox[{"p3", ",", "p3"}], "]"}], "+", 
          RowBox[{"sp", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "p1"}], "-", "p2", "-", "p3"}], ",", 
            RowBox[{
             RowBox[{"-", "p1"}], "-", "p2", "-", "p3"}]}], "]"}]}], "4"]], 
       "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"nZA", "->", "6"}], ",", "\[IndentingNewLine]", 
     RowBox[{"evP", ":>", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["k", "nZA"], "+", "1"}], ")"}], 
       RowBox[{"1", "/", "nZA"}]]}], ",", "\[IndentingNewLine]", 
     RowBox[{"devP", ":>", 
      RowBox[{
       SuperscriptBox["k", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "nZA"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["k", "nZA"]}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"1", "/", "nZA"}]}]]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dressing", "[", 
       RowBox[{"Rdot", ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", "A"}], "}"}], ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"p1_", ",", "p2_"}], "}"}]}], "]"}], ":>", 
      RowBox[{
       RowBox[{
        RowBox[{"ZA", "[", "evP", "]"}], 
        RowBox[{"RBdot", "[", 
         RowBox[{
          SuperscriptBox["k", "2"], ",", 
          RowBox[{"sp", "[", 
           RowBox[{"p2", ",", "p2"}], "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"RB", "[", 
         RowBox[{
          SuperscriptBox["k", "2"], ",", 
          RowBox[{"sp", "[", 
           RowBox[{"p2", ",", "p2"}], "]"}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"dtZA", "[", "evP", "]"}], "+", 
          RowBox[{"k", "*", "devP", "*", 
           FractionBox[
            RowBox[{
             RowBox[{"ZA", "[", 
              RowBox[{"1.02", "evP"}], "]"}], "-", 
             RowBox[{"ZA", "[", "evP", "]"}]}], 
            RowBox[{"0.02", "*", "evP"}]]}]}], ")"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dressing", "[", 
       RowBox[{"Rdot", ",", 
        RowBox[{"{", 
         RowBox[{"c", ",", "cb"}], "}"}], ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"p1_", ",", "p2_"}], "}"}]}], "]"}], ":>", 
      RowBox[{
       RowBox[{
        RowBox[{"Zc", "[", "k", "]"}], 
        RowBox[{"RBdot", "[", 
         RowBox[{
          SuperscriptBox["k", "2"], ",", 
          RowBox[{"sp", "[", 
           RowBox[{"p2", ",", "p2"}], "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"RB", "[", 
         RowBox[{
          SuperscriptBox["k", "2"], ",", 
          RowBox[{"sp", "[", 
           RowBox[{"p2", ",", "p2"}], "]"}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"dtZc", "[", "k", "]"}], "+", 
          RowBox[{"k", 
           FractionBox[
            RowBox[{
             RowBox[{"Zc", "[", 
              RowBox[{"1.02", "*", "k"}], "]"}], "-", 
             RowBox[{"Zc", "[", "k", "]"}]}], 
            RowBox[{"0.02", "*", "k"}]]}]}], ")"}]}]}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PropParam", "[", "expr_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"UseLorentzLinearity", "[", "expr", "]"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"sp", "[", 
         RowBox[{"p1", ",", "p1"}], "]"}], "->", 
        SuperscriptBox["p", "2"]}], ",", 
       RowBox[{
        RowBox[{"sp", "[", 
         RowBox[{"l1", ",", "l1"}], "]"}], "->", 
        SuperscriptBox["l1", "2"]}], ",", 
       RowBox[{
        RowBox[{"sp", "[", 
         RowBox[{"l1", ",", "p1"}], "]"}], "->", 
        RowBox[{"l1", " ", "p", " ", "cos1"}]}], ",", 
       RowBox[{
        SqrtBox[
         SuperscriptBox["a_", "2"]], ":>", "a"}]}], "}"}]}], "//", 
    "$StandardQuickSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SPParam", "[", "expr_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"UseLorentzLinearity", "[", "expr", "]"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"sp", "[", 
         RowBox[{"p", ",", "p"}], "]"}], "->", 
        SuperscriptBox["p", "2"]}], ",", 
       RowBox[{
        RowBox[{"sp", "[", 
         RowBox[{"l1", ",", "l1"}], "]"}], "->", 
        SuperscriptBox["l1", "2"]}], ",", 
       RowBox[{
        SqrtBox[
         SuperscriptBox["a_", "2"]], ":>", "a"}]}], "}"}]}], "//", 
    "$StandardQuickSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetNc", "[", "3", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{
    RowBox[{"k", ">", "0"}], "&&", 
    RowBox[{"p", ">", "0"}], "&&", 
    RowBox[{"l1", ">", "0"}], "&&", 
    RowBox[{
     RowBox[{"-", "1"}], "<", "cos1", "<", 
     RowBox[{"1", "-", "1"}], "<", "cos2", "<", "1"}], "&&", 
    RowBox[{
     RowBox[{"-", "1"}], "<", "cos3", "<", "1"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.951659883769759*^9, 3.951659964233618*^9}, {
   3.951660031554185*^9, 3.9516600638258877`*^9}, {3.9516601292549467`*^9, 
   3.951660129386159*^9}, {3.9516760174130907`*^9, 3.951676018676004*^9}, {
   3.951720965595628*^9, 3.951720968371242*^9}, 3.9517325671912127`*^9, {
   3.951741274725477*^9, 3.951741283569273*^9}, {3.951741654243425*^9, 
   3.9517416784769907`*^9}, {3.951741766614184*^9, 3.951741786464788*^9}, {
   3.9517418166941633`*^9, 3.9517418216380787`*^9}, {3.951902922583056*^9, 
   3.951902927289761*^9}, {3.9520810655037613`*^9, 3.952081076035099*^9}, {
   3.952081165459564*^9, 3.952081200271276*^9}, {3.952708110563612*^9, 
   3.952708110964162*^9}, 3.952708156608906*^9, 3.9527082483296413`*^9, {
   3.9527668554931917`*^9, 3.9527668994626093`*^9}, {3.95276693858698*^9, 
   3.9527669427260933`*^9}, {3.9527672162811317`*^9, 
   3.9527672164394073`*^9}, {3.952767449874735*^9, 3.95276753028094*^9}, {
   3.9529378021236973`*^9, 3.9529378369332542`*^9}, 3.952957761357833*^9, {
   3.953032785124257*^9, 3.953032786171085*^9}, {3.953094471160128*^9, 
   3.953094481830413*^9}, {3.953121294686625*^9, 3.953121302688059*^9}, 
   3.953121396721551*^9, {3.9531224609175034`*^9, 3.9531224652806253`*^9}, {
   3.953124162270207*^9, 3.9531241702970247`*^9}, {3.953124375469466*^9, 
   3.9531243796563187`*^9}, {3.953127093933712*^9, 3.9531270952205133`*^9}, {
   3.953134594881542*^9, 3.9531345951801443`*^9}, {3.953214837072935*^9, 
   3.953215165397307*^9}, {3.9532153026146927`*^9, 3.953215416131619*^9}, {
   3.953215494249354*^9, 3.953215495295425*^9}, {3.953216478264649*^9, 
   3.9532164864002237`*^9}, 3.9532171767310762`*^9, {3.953217578373931*^9, 
   3.953217594387125*^9}, 3.9532178423486423`*^9, {3.953217877026951*^9, 
   3.953217913769442*^9}, {3.953218506022711*^9, 3.953218570209464*^9}, {
   3.953267125754562*^9, 3.953267127225792*^9}, {3.9533472260284348`*^9, 
   3.953347237984788*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"464312df-f2a1-4bd7-8d31-5991427d6110"],

Cell[CellGroupData[{

Cell[BoxData["\<\"\\!\\(\\*\\nStyleBox[\\\"Loading\\\",\\nFontSize->10,\\\
nFontWeight->\\\"Plain\\\",\\nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\\
nStyleBox[\\\" \
\\\",\\nFontSize->10,\\nFontWeight->\\\"Plain\\\",\\nFontSlant->\\\"Italic\\\"\
]\\)\\!\\(\\*\\nStyleBox[\\\"modules\\\",\\nFontSize->10,\\nFontWeight->\\\"\
Plain\\\",\\nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"...\\\",\\\
nFontSize->10,\\nFontWeight->\\\"Plain\\\",\\nFontSlant->\\\"Italic\\\"]\\)\"\
\>"], "Print",
 CellChangeTimes->{{3.953032779296788*^9, 3.953032788435112*^9}, 
   3.953094038407902*^9, 3.953094482262491*^9, 3.953121303058329*^9, 
   3.9531213984887047`*^9, 3.953122466197258*^9, 3.953122997978833*^9, 
   3.953124171877193*^9, 3.953124382956216*^9, 3.953127095720778*^9, 
   3.9531275672326527`*^9, 3.9531315962398252`*^9, 3.953133887930148*^9, 
   3.953134596872243*^9, 3.953215166031434*^9, {3.953215376042304*^9, 
   3.9532154164418507`*^9}, 3.95321549924798*^9, 3.953216487104846*^9, {
   3.953217894746108*^9, 3.953217914313046*^9}, 3.953218570933741*^9, 
   3.9532646775006723`*^9, 3.953267128112452*^9, {3.953347228381413*^9, 
   3.9533472406557083`*^9}, 3.953374214699703*^9, 3.953383885440785*^9},
 CellLabel->
  "During evaluation of \
In[2]:=",ExpressionUUID->"641264ef-1243-4837-bbf6-17e7d39562af"],

Cell[BoxData["\<\"\\!\\(\\*\\nStyleBox[\\\"...\\\",\\nFontSize->10,\\\
nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"TensorBases\\\",\\\
nFontSize->10,\\nFontWeight->\\\"Bold\\\",\\nFontSlant->\\\"Italic\\\"]\\)\\!\
\\(\\*\\nStyleBox[\\\" \
\\\",\\nFontSize->10,\\nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\
loaded\\\",\\nFontSize->10,\\nFontWeight->\\\"Plain\\\",\\nFontSlant->\\\"\
Italic\\\"]\\)\"\>"], "Print",
 CellChangeTimes->{{3.953032779296788*^9, 3.953032788435112*^9}, 
   3.953094038407902*^9, 3.953094482262491*^9, 3.953121303058329*^9, 
   3.9531213984887047`*^9, 3.953122466197258*^9, 3.953122997978833*^9, 
   3.953124171877193*^9, 3.953124382956216*^9, 3.953127095720778*^9, 
   3.9531275672326527`*^9, 3.9531315962398252`*^9, 3.953133887930148*^9, 
   3.953134596872243*^9, 3.953215166031434*^9, {3.953215376042304*^9, 
   3.9532154164418507`*^9}, 3.95321549924798*^9, 3.953216487104846*^9, {
   3.953217894746108*^9, 3.953217914313046*^9}, 3.953218570933741*^9, 
   3.9532646775006723`*^9, 3.953267128112452*^9, {3.953347228381413*^9, 
   3.9533472406557083`*^9}, 3.953374214699703*^9, 3.9533838871871777`*^9},
 CellLabel->
  "During evaluation of \
In[2]:=",ExpressionUUID->"9afd9042-46da-4ae3-b9fc-90d75deb26ee"],

Cell[BoxData["\<\"\\!\\(\\*\\nStyleBox[\\\"...\\\",\\nFontSize->10,\\\
nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"FEDeriK\\\",\\\
nFontSize->10,\\nFontWeight->\\\"Bold\\\",\\nFontSlant->\\\"Italic\\\"]\\)\\!\
\\(\\*\\nStyleBox[\\\" \
\\\",\\nFontSize->10,\\nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\
loaded\\\",\\nFontSize->10,\\nFontWeight->\\\"Plain\\\",\\nFontSlant->\\\"\
Italic\\\"]\\)\"\>"], "Print",
 CellChangeTimes->{{3.953032779296788*^9, 3.953032788435112*^9}, 
   3.953094038407902*^9, 3.953094482262491*^9, 3.953121303058329*^9, 
   3.9531213984887047`*^9, 3.953122466197258*^9, 3.953122997978833*^9, 
   3.953124171877193*^9, 3.953124382956216*^9, 3.953127095720778*^9, 
   3.9531275672326527`*^9, 3.9531315962398252`*^9, 3.953133887930148*^9, 
   3.953134596872243*^9, 3.953215166031434*^9, {3.953215376042304*^9, 
   3.9532154164418507`*^9}, 3.95321549924798*^9, 3.953216487104846*^9, {
   3.953217894746108*^9, 3.953217914313046*^9}, 3.953218570933741*^9, 
   3.9532646775006723`*^9, 3.953267128112452*^9, {3.953347228381413*^9, 
   3.9533472406557083`*^9}, 3.953374214699703*^9, 3.9533838873424177`*^9},
 CellLabel->
  "During evaluation of \
In[2]:=",ExpressionUUID->"216819d0-41b0-40de-9fc4-82eff112f423"],

Cell[BoxData["\<\"\\!\\(\\*\\nStyleBox[\\\"...\\\",\\nFontSize->10,\\\
nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"AnSEL\\\",\\nFontSize->\
10,\\nFontWeight->\\\"Bold\\\",\\nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\\
nStyleBox[\\\" \\\",\\nFontSize->10,\\nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\
\\nStyleBox[\\\"loaded\\\",\\nFontSize->10,\\nFontWeight->\\\"Plain\\\",\\\
nFontSlant->\\\"Italic\\\"]\\)\"\>"], "Print",
 CellChangeTimes->{{3.953032779296788*^9, 3.953032788435112*^9}, 
   3.953094038407902*^9, 3.953094482262491*^9, 3.953121303058329*^9, 
   3.9531213984887047`*^9, 3.953122466197258*^9, 3.953122997978833*^9, 
   3.953124171877193*^9, 3.953124382956216*^9, 3.953127095720778*^9, 
   3.9531275672326527`*^9, 3.9531315962398252`*^9, 3.953133887930148*^9, 
   3.953134596872243*^9, 3.953215166031434*^9, {3.953215376042304*^9, 
   3.9532154164418507`*^9}, 3.95321549924798*^9, 3.953216487104846*^9, {
   3.953217894746108*^9, 3.953217914313046*^9}, 3.953218570933741*^9, 
   3.9532646775006723`*^9, 3.953267128112452*^9, {3.953347228381413*^9, 
   3.9533472406557083`*^9}, 3.953374214699703*^9, 3.953383887343182*^9},
 CellLabel->
  "During evaluation of \
In[2]:=",ExpressionUUID->"65a86270-693d-4a03-b50e-afe4478e4071"],

Cell[BoxData["\<\"\\!\\(\\*\\nStyleBox[\\\"...\\\",\\nFontSize->10,\\\
nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"DiANE\\\",\\nFontSize->\
10,\\nFontWeight->\\\"Bold\\\",\\nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\\
nStyleBox[\\\" \\\",\\nFontSize->10,\\nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\
\\nStyleBox[\\\"loaded\\\",\\nFontSize->10,\\nFontWeight->\\\"Plain\\\",\\\
nFontSlant->\\\"Italic\\\"]\\)\"\>"], "Print",
 CellChangeTimes->{{3.953032779296788*^9, 3.953032788435112*^9}, 
   3.953094038407902*^9, 3.953094482262491*^9, 3.953121303058329*^9, 
   3.9531213984887047`*^9, 3.953122466197258*^9, 3.953122997978833*^9, 
   3.953124171877193*^9, 3.953124382956216*^9, 3.953127095720778*^9, 
   3.9531275672326527`*^9, 3.9531315962398252`*^9, 3.953133887930148*^9, 
   3.953134596872243*^9, 3.953215166031434*^9, {3.953215376042304*^9, 
   3.9532154164418507`*^9}, 3.95321549924798*^9, 3.953216487104846*^9, {
   3.953217894746108*^9, 3.953217914313046*^9}, 3.953218570933741*^9, 
   3.9532646775006723`*^9, 3.953267128112452*^9, {3.953347228381413*^9, 
   3.9533472406557083`*^9}, 3.953374214699703*^9, 3.953383887423492*^9},
 CellLabel->
  "During evaluation of \
In[2]:=",ExpressionUUID->"c07e8138-d49e-44ef-a3b4-cde5e27bb3b2"],

Cell[BoxData["\<\"\\!\\(\\*\\nStyleBox[\\\"...\\\",\\nFontSize->10,\\\
nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"DiRK\\\",\\nFontSize->\
10,\\nFontWeight->\\\"Bold\\\",\\nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\\
nStyleBox[\\\" \\\",\\nFontSize->10,\\nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\
\\nStyleBox[\\\"loaded\\\",\\nFontSize->10,\\nFontWeight->\\\"Plain\\\",\\\
nFontSlant->\\\"Italic\\\"]\\)\"\>"], "Print",
 CellChangeTimes->{{3.953032779296788*^9, 3.953032788435112*^9}, 
   3.953094038407902*^9, 3.953094482262491*^9, 3.953121303058329*^9, 
   3.9531213984887047`*^9, 3.953122466197258*^9, 3.953122997978833*^9, 
   3.953124171877193*^9, 3.953124382956216*^9, 3.953127095720778*^9, 
   3.9531275672326527`*^9, 3.9531315962398252`*^9, 3.953133887930148*^9, 
   3.953134596872243*^9, 3.953215166031434*^9, {3.953215376042304*^9, 
   3.9532154164418507`*^9}, 3.95321549924798*^9, 3.953216487104846*^9, {
   3.953217894746108*^9, 3.953217914313046*^9}, 3.953218570933741*^9, 
   3.9532646775006723`*^9, 3.953267128112452*^9, {3.953347228381413*^9, 
   3.9533472406557083`*^9}, 3.953374214699703*^9, 3.9533838874244013`*^9},
 CellLabel->
  "During evaluation of \
In[2]:=",ExpressionUUID->"4ce70eb3-0cb5-4e9f-99df-98836bb8b32e"],

Cell[BoxData["\<\"\\!\\(\\*\\nStyleBox[\\\"...\\\",\\nFontSize->10,\\\
nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"TRACY\\\",\\nFontSize->\
10,\\nFontWeight->\\\"Bold\\\",\\nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\\
nStyleBox[\\\" \\\",\\nFontSize->10,\\nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\
\\nStyleBox[\\\"loaded\\\",\\nFontSize->10,\\nFontWeight->\\\"Plain\\\",\\\
nFontSlant->\\\"Italic\\\"]\\)\"\>"], "Print",
 CellChangeTimes->{{3.953032779296788*^9, 3.953032788435112*^9}, 
   3.953094038407902*^9, 3.953094482262491*^9, 3.953121303058329*^9, 
   3.9531213984887047`*^9, 3.953122466197258*^9, 3.953122997978833*^9, 
   3.953124171877193*^9, 3.953124382956216*^9, 3.953127095720778*^9, 
   3.9531275672326527`*^9, 3.9531315962398252`*^9, 3.953133887930148*^9, 
   3.953134596872243*^9, 3.953215166031434*^9, {3.953215376042304*^9, 
   3.9532154164418507`*^9}, 3.95321549924798*^9, 3.953216487104846*^9, {
   3.953217894746108*^9, 3.953217914313046*^9}, 3.953218570933741*^9, 
   3.9532646775006723`*^9, 3.953267128112452*^9, {3.953347228381413*^9, 
   3.9533472406557083`*^9}, 3.953374214699703*^9, 3.953383887445719*^9},
 CellLabel->
  "During evaluation of \
In[2]:=",ExpressionUUID->"72f4b8dc-1591-4699-849d-14d30c4a49d5"],

Cell[BoxData["\<\"\\!\\(\\*\\nStyleBox[\\\"...\\\",\\nFontSize->10,\\\
nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"COEN\\\",\\nFontSize->\
10,\\nFontWeight->\\\"Bold\\\",\\nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\\
nStyleBox[\\\" \\\",\\nFontSize->10,\\nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\
\\nStyleBox[\\\"loaded\\\",\\nFontSize->10,\\nFontWeight->\\\"Plain\\\",\\\
nFontSlant->\\\"Italic\\\"]\\)\"\>"], "Print",
 CellChangeTimes->{{3.953032779296788*^9, 3.953032788435112*^9}, 
   3.953094038407902*^9, 3.953094482262491*^9, 3.953121303058329*^9, 
   3.9531213984887047`*^9, 3.953122466197258*^9, 3.953122997978833*^9, 
   3.953124171877193*^9, 3.953124382956216*^9, 3.953127095720778*^9, 
   3.9531275672326527`*^9, 3.9531315962398252`*^9, 3.953133887930148*^9, 
   3.953134596872243*^9, 3.953215166031434*^9, {3.953215376042304*^9, 
   3.9532154164418507`*^9}, 3.95321549924798*^9, 3.953216487104846*^9, {
   3.953217894746108*^9, 3.953217914313046*^9}, 3.953218570933741*^9, 
   3.9532646775006723`*^9, 3.953267128112452*^9, {3.953347228381413*^9, 
   3.9533472406557083`*^9}, 3.953374214699703*^9, 3.953383887486174*^9},
 CellLabel->
  "During evaluation of \
In[2]:=",ExpressionUUID->"ed7ec420-0d45-4ea6-ad06-d2b14edbc65b"],

Cell[BoxData["\<\"Welcome to  \
\\!\\(\\*\\nStyleBox[\\\"\:2588\:2580\\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\
\\*\\nStyleBox[\\\" \
\\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\\\"\:2590\:2584\:2588\
\\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\\\" \
\\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\\\"\:2588\:259a\:258c\
\\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\\\" \
\\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\\\"\:2590\
\[FilledLeftTriangle]\\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\
\\\" \\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\\\"\:2588\\\",\\\
nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\\\" \
\\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\\\"\:2580\:2588\:2580\
\\\",\\nFontColor->GrayLevel[0]]\\)\\n\\!\\(\\*\\nStyleBox[\\\"Author\\\",\\\
nFontWeight->\\\"Bold\\\"]\\): Franz Richard \
Sattler\\n\\!\\(\\*\\nStyleBox[\\\"Version\\\",\\nFontWeight->\\\"Bold\\\"]\\)\
: 1.0\\n\\!\\(\\*\\nStyleBox[\\\"Year\\\",\\nFontWeight->\\\"Bold\\\"]\\): \
2025\\nFor more information, call \
\\!\\(\\*\\nStyleBox[\\\"FInfo\\\",\\nFontColor->RGBColor[1, 0.5, 0]]\\)[].\"\
\>"], "Print",
 CellChangeTimes->{{3.953032779296788*^9, 3.953032788435112*^9}, 
   3.953094038407902*^9, 3.953094482262491*^9, 3.953121303058329*^9, 
   3.9531213984887047`*^9, 3.953122466197258*^9, 3.953122997978833*^9, 
   3.953124171877193*^9, 3.953124382956216*^9, 3.953127095720778*^9, 
   3.9531275672326527`*^9, 3.9531315962398252`*^9, 3.953133887930148*^9, 
   3.953134596872243*^9, 3.953215166031434*^9, {3.953215376042304*^9, 
   3.9532154164418507`*^9}, 3.95321549924798*^9, 3.953216487104846*^9, {
   3.953217894746108*^9, 3.953217914313046*^9}, 3.953218570933741*^9, 
   3.9532646775006723`*^9, 3.953267128112452*^9, {3.953347228381413*^9, 
   3.9533472406557083`*^9}, 3.953374214699703*^9, 3.95338388748704*^9},
 CellLabel->
  "During evaluation of \
In[2]:=",ExpressionUUID->"7f6c5237-db2e-4c9b-9fee-f8366927fee7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"DerivativeListcbc", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"cb", "[", "i1", "]"}], ",", 
     RowBox[{"c", "[", "i2", "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"equationcbc", "=", 
   RowBox[{"TakeDerivatives", "[", 
    RowBox[{"Setup", ",", "WetterichEquation", ",", "DerivativeListcbc"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"equationcbc", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"equationcbc", "//", "Truncate"}], "//", "FSimplify"}], "//", 
    "Route"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"traceExprcbc", "=", 
   RowBox[{"F", "[", 
    RowBox[{
     RowBox[{"TBGetProjector", "[", 
      RowBox[{"\"\<cbc\>\"", ",", "1", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i1", ",", "i2"}], "}"}], "/.", 
        RowBox[{"equationcbc", "[", "\"\<externalIndices\>\"", "]"}]}]}], 
      "]"}], ",", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"equationcbc", "[", "\"\<result\>\"", "]"}], "/.", 
        RowBox[{"MakeDiagrammaticRules", "[", "Setup", "]"}]}], "//", 
       "landauGauge"}], ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Flowcbc", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FormTrace", "[", 
      RowBox[{"\"\<cbc\>\"", ",", "traceExprcbc"}], "]"}], "//.", 
     "dressingRules"}], "//", "FORMSimplify"}], "//", 
   "PropParam"}]}]}], "Input",
 CellChangeTimes->{{3.953094078606592*^9, 3.953094142307357*^9}, {
   3.953094175306635*^9, 3.9530942481913843`*^9}, {3.9531192685044928`*^9, 
   3.953119271187134*^9}, {3.953119469605123*^9, 3.95311948470348*^9}, {
   3.953119905270465*^9, 3.9531199116647873`*^9}, 3.953120156265443*^9, 
   3.953121366389641*^9, 3.953121445982039*^9, {3.9531221384166822`*^9, 
   3.9531221637840776`*^9}, {3.953122904484968*^9, 3.953122992983919*^9}, {
   3.953123368476717*^9, 3.953123389292984*^9}, {3.953123715052371*^9, 
   3.953123716295953*^9}, {3.9531238485365133`*^9, 3.953123859315998*^9}, {
   3.953123951560505*^9, 3.9531239588318996`*^9}, {3.953124036240878*^9, 
   3.9531240892921467`*^9}, {3.953127174372879*^9, 3.953127180744153*^9}, {
   3.953127410729027*^9, 3.953127427708156*^9}, {3.953127478361916*^9, 
   3.953127492988172*^9}, {3.953127576728264*^9, 3.953127577517222*^9}, {
   3.953131555736034*^9, 3.953131570498639*^9}, {3.9531339511296387`*^9, 
   3.95313397058521*^9}, {3.9531340042499104`*^9, 3.953134039405343*^9}, {
   3.953134519793778*^9, 3.953134525813345*^9}, {3.9531345620743504`*^9, 
   3.9531346449499283`*^9}, {3.9531727030103292`*^9, 
   3.9531727045860443`*^9}, {3.9531748180752497`*^9, 3.953174824214691*^9}, {
   3.953175160823641*^9, 3.9531751640070744`*^9}, 3.9532151851299667`*^9, {
   3.953215216084112*^9, 3.953215218864333*^9}, {3.953215404167081*^9, 
   3.9532154069548197`*^9}, {3.953218579073207*^9, 3.953218579453802*^9}, {
   3.953221063441168*^9, 3.953221065157251*^9}, 3.953221127329235*^9, {
   3.9532647229565573`*^9, 3.9532647361691027`*^9}, 3.953266955348939*^9, {
   3.953267134845358*^9, 3.95326713544549*^9}, 3.953383908207383*^9},
 CellLabel->"In[15]:=",ExpressionUUID->"93c1c0eb-aebd-4bc5-a6b9-846bf716c5ca"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    SuperscriptBox["l1", "4"], " ", 
    SuperscriptBox[
     RowBox[{"Zc", "[", "l1", "]"}], "2"]}]], 
  RowBox[{"3", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["cos1", "2"]}], ")"}], " ", 
   SuperscriptBox["p", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["k", "6"]}], ")"}], " ", 
          RowBox[{"dtZA", "[", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["k", "6"]}], ")"}], 
            RowBox[{"1", "/", "6"}]], "]"}], " ", 
          RowBox[{"RB", "[", 
           RowBox[{
            SuperscriptBox["k", "2"], ",", 
            SuperscriptBox["l1", "2"]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["k", "6"]}], ")"}], " ", 
          RowBox[{"RBdot", "[", 
           RowBox[{
            SuperscriptBox["k", "2"], ",", 
            SuperscriptBox["l1", "2"]}], "]"}], " ", 
          RowBox[{"ZA", "[", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["k", "6"]}], ")"}], 
            RowBox[{"1", "/", "6"}]], "]"}]}], "-", 
         RowBox[{"50", " ", 
          SuperscriptBox["k", "6"], " ", 
          RowBox[{"RB", "[", 
           RowBox[{
            SuperscriptBox["k", "2"], ",", 
            SuperscriptBox["l1", "2"]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ZA", "[", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["k", "6"]}], ")"}], 
              RowBox[{"1", "/", "6"}]], "]"}], "-", 
            RowBox[{"ZA", "[", 
             RowBox[{
              FractionBox["51", "50"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SuperscriptBox["k", "6"]}], ")"}], 
               RowBox[{"1", "/", "6"}]]}], "]"}]}], ")"}]}]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"ZccbA", "[", 
         RowBox[{
          SqrtBox[
           FractionBox["2", "3"]], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["l1", "2"], "-", 
            RowBox[{"cos1", " ", "l1", " ", "p"}], "+", 
            SuperscriptBox["p", "2"]}]]}], "]"}], "2"]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["k", "6"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["l1", "2"], "-", 
         RowBox[{"2", " ", "cos1", " ", "l1", " ", "p"}], "+", 
         SuperscriptBox["p", "2"]}], ")"}], " ", 
       RowBox[{"ZA", "[", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["l1", "2"], "-", 
          RowBox[{"2", " ", "cos1", " ", "l1", " ", "p"}], "+", 
          SuperscriptBox["p", "2"]}]], "]"}]}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["l1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"dtZc", "[", "k", "]"}], " ", 
          RowBox[{"RB", "[", 
           RowBox[{
            SuperscriptBox["k", "2"], ",", 
            RowBox[{
             SuperscriptBox["l1", "2"], "+", 
             RowBox[{"2", " ", "cos1", " ", "l1", " ", "p"}], "+", 
             SuperscriptBox["p", "2"]}]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"RBdot", "[", 
           RowBox[{
            SuperscriptBox["k", "2"], ",", 
            RowBox[{
             SuperscriptBox["l1", "2"], "+", 
             RowBox[{"2", " ", "cos1", " ", "l1", " ", "p"}], "+", 
             SuperscriptBox["p", "2"]}]}], "]"}], " ", 
          RowBox[{"Zc", "[", "k", "]"}]}], "-", 
         RowBox[{"50", " ", 
          RowBox[{"RB", "[", 
           RowBox[{
            SuperscriptBox["k", "2"], ",", 
            RowBox[{
             SuperscriptBox["l1", "2"], "+", 
             RowBox[{"2", " ", "cos1", " ", "l1", " ", "p"}], "+", 
             SuperscriptBox["p", "2"]}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Zc", "[", "k", "]"}], "-", 
            RowBox[{"Zc", "[", 
             FractionBox[
              RowBox[{"51", " ", "k"}], "50"], "]"}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"Zc", "[", "l1", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"ZccbA", "[", 
         RowBox[{
          SqrtBox[
           FractionBox["2", "3"]], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["l1", "2"], "+", 
            RowBox[{"cos1", " ", "l1", " ", "p"}], "+", 
            SuperscriptBox["p", "2"]}]]}], "]"}], "2"]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["l1", "2"], "+", 
          RowBox[{"2", " ", "cos1", " ", "l1", " ", "p"}], "+", 
          SuperscriptBox["p", "2"]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"ZA", "[", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["l1", "2"], "+", 
           RowBox[{"2", " ", "cos1", " ", "l1", " ", "p"}], "+", 
           SuperscriptBox["p", "2"]}]], "]"}], "2"]}]]}], ")"}]}]}]], "Output",\

 CellChangeTimes->{{3.9532669645630913`*^9, 3.9532669807002163`*^9}, 
   3.95326713706842*^9, 3.9533464626620207`*^9, 3.953346543042762*^9, 
   3.9533472532570553`*^9, 3.9533742228765917`*^9, 3.953383914991774*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"68874709-0d56-408d-9ed7-b05beb42caef"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"DerivativeListAA", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "[", "i1", "]"}], ",", 
     RowBox[{"A", "[", "i2", "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"equationAA", "=", 
   RowBox[{"TakeDerivatives", "[", 
    RowBox[{"Setup", ",", "WetterichEquation", ",", "DerivativeListAA"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"equationAA", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"equationAA", "//", "Truncate"}], "//", "FSimplify"}], "//", 
    "Route"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"traceExprAA", "=", 
   RowBox[{"F", "[", 
    RowBox[{
     RowBox[{"TBGetProjector", "[", 
      RowBox[{"\"\<AA\>\"", ",", "1", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i1", ",", "i2"}], "}"}], "/.", 
        RowBox[{"equationAA", "[", "\"\<externalIndices\>\"", "]"}]}]}], 
      "]"}], ",", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"equationAA", "[", "\"\<result\>\"", "]"}], "/.", 
        RowBox[{"MakeDiagrammaticRules", "[", "Setup", "]"}]}], "//", 
       "landauGauge"}], ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FlowAA", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FormTrace", "[", 
      RowBox[{"\"\<AA\>\"", ",", "traceExprAA"}], "]"}], "//.", 
     "dressingRules"}], "//", "FORMSimplify"}], "//", 
   "PropParam"}]}]}], "Input",
 CellChangeTimes->{{3.953094078606592*^9, 3.953094142307357*^9}, {
   3.953094175306635*^9, 3.9530942481913843`*^9}, {3.9531192685044928`*^9, 
   3.953119271187134*^9}, {3.953119469605123*^9, 3.95311948470348*^9}, {
   3.953119905270465*^9, 3.9531199116647873`*^9}, 3.953120156265443*^9, 
   3.953121366389641*^9, 3.953121445982039*^9, {3.9531221384166822`*^9, 
   3.9531221637840776`*^9}, {3.953122904484968*^9, 3.953122992983919*^9}, {
   3.953123368476717*^9, 3.953123389292984*^9}, {3.953123715052371*^9, 
   3.953123716295953*^9}, {3.9531238485365133`*^9, 3.953123859315998*^9}, {
   3.953123951560505*^9, 3.9531239588318996`*^9}, {3.953124036240878*^9, 
   3.9531240892921467`*^9}, {3.953127174372879*^9, 3.953127180744153*^9}, {
   3.953127410729027*^9, 3.953127427708156*^9}, {3.953127478361916*^9, 
   3.953127492988172*^9}, {3.953127576728264*^9, 3.953127577517222*^9}, {
   3.953131555736034*^9, 3.953131570498639*^9}, {3.9531339511296387`*^9, 
   3.95313397058521*^9}, {3.9531340042499104`*^9, 3.953134039405343*^9}, {
   3.953134519793778*^9, 3.953134525813345*^9}, {3.9531345620743504`*^9, 
   3.953134662500977*^9}, {3.953172707706059*^9, 3.9531727106379766`*^9}, {
   3.953172770198908*^9, 3.953172829591775*^9}, {3.953172879663548*^9, 
   3.9531728891502123`*^9}, 3.9531748300197477`*^9, {3.953215436764615*^9, 
   3.95321546765983*^9}, {3.9532179355986347`*^9, 3.953217951548522*^9}, {
   3.95321799157815*^9, 3.953217992168694*^9}, {3.9532180856454887`*^9, 
   3.953218138840847*^9}, {3.953218171934154*^9, 3.95321823842881*^9}, {
   3.953218377997107*^9, 3.9532184773571997`*^9}, {3.953218617705419*^9, 
   3.9532186285133047`*^9}, {3.953221113977227*^9, 3.953221124833188*^9}, {
   3.9532647398287163`*^9, 3.953264749645321*^9}, 3.953266958060719*^9, {
   3.953267139593381*^9, 3.953267140325507*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"1e9d38f6-3b53-408b-a249-6173a6191de5"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SuperscriptBox["l1", "4"]], 
  RowBox[{"(", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"RBdot", "[", 
       RowBox[{
        SuperscriptBox["k", "2"], ",", 
        SuperscriptBox["l1", "2"]}], "]"}], " ", 
      RowBox[{"ZA", "[", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["k", "6"]}], ")"}], 
        RowBox[{"1", "/", "6"}]], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "7"}], "+", 
           SuperscriptBox["cos1", "2"]}], ")"}], " ", 
         RowBox[{"ZA4", "[", 
          FractionBox[
           SqrtBox[
            RowBox[{
             SuperscriptBox["l1", "2"], "+", 
             SuperscriptBox["p", "2"]}]], 
           SqrtBox["2"]], "]"}]}], "-", 
        FractionBox[
         RowBox[{"4", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["cos1", "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", " ", 
             SuperscriptBox["l1", "4"]}], "-", 
            RowBox[{"6", " ", "cos1", " ", 
             SuperscriptBox["l1", "3"], " ", "p"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"8", "+", 
               SuperscriptBox["cos1", "2"]}], ")"}], " ", 
             SuperscriptBox["l1", "2"], " ", 
             SuperscriptBox["p", "2"]}], "-", 
            RowBox[{"6", " ", "cos1", " ", "l1", " ", 
             SuperscriptBox["p", "3"]}], "+", 
            RowBox[{"3", " ", 
             SuperscriptBox["p", "4"]}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"ZA3", "[", 
            RowBox[{
             SqrtBox[
              FractionBox["2", "3"]], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["l1", "2"], "-", 
               RowBox[{"cos1", " ", "l1", " ", "p"}], "+", 
               SuperscriptBox["p", "2"]}]]}], "]"}], "2"]}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["l1", "2"], "-", 
             RowBox[{"2", " ", "cos1", " ", "l1", " ", "p"}], "+", 
             SuperscriptBox["p", "2"]}], ")"}], "2"], " ", 
          RowBox[{"Zc", "[", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["l1", "2"], "-", 
             RowBox[{"2", " ", "cos1", " ", "l1", " ", "p"}], "+", 
             SuperscriptBox["p", "2"]}]], "]"}]}]]}], ")"}]}], 
     SuperscriptBox[
      RowBox[{"Zc", "[", "l1", "]"}], "2"]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["cos1", "2"]}], ")"}], " ", 
      SuperscriptBox["l1", "2"], " ", 
      RowBox[{"RBdot", "[", 
       RowBox[{
        SuperscriptBox["k", "2"], ",", 
        SuperscriptBox["l1", "2"]}], "]"}], " ", 
      RowBox[{"Zc", "[", "k", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"ZccbA", "[", 
        RowBox[{
         SqrtBox[
          FractionBox["2", "3"]], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["l1", "2"], "-", 
           RowBox[{"cos1", " ", "l1", " ", "p"}], "+", 
           SuperscriptBox["p", "2"]}]]}], "]"}], "2"]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["l1", "2"], "-", 
        RowBox[{"2", " ", "cos1", " ", "l1", " ", "p"}], "+", 
        SuperscriptBox["p", "2"]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"ZA", "[", "l1", "]"}], "2"], " ", 
      RowBox[{"ZA", "[", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["l1", "2"], "-", 
         RowBox[{"2", " ", "cos1", " ", "l1", " ", "p"}], "+", 
         SuperscriptBox["p", "2"]}]], "]"}]}]], "+", 
    RowBox[{
     RowBox[{"RB", "[", 
      RowBox[{
       SuperscriptBox["k", "2"], ",", 
       SuperscriptBox["l1", "2"]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"dtZA", "[", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["k", "6"]}], ")"}], 
           RowBox[{"1", "/", "6"}]], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "7"}], "+", 
              SuperscriptBox["cos1", "2"]}], ")"}], " ", 
            RowBox[{"ZA4", "[", 
             FractionBox[
              SqrtBox[
               RowBox[{
                SuperscriptBox["l1", "2"], "+", 
                SuperscriptBox["p", "2"]}]], 
              SqrtBox["2"]], "]"}]}], "-", 
           FractionBox[
            RowBox[{"4", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["cos1", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", " ", 
                SuperscriptBox["l1", "4"]}], "-", 
               RowBox[{"6", " ", "cos1", " ", 
                SuperscriptBox["l1", "3"], " ", "p"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"8", "+", 
                  SuperscriptBox["cos1", "2"]}], ")"}], " ", 
                SuperscriptBox["l1", "2"], " ", 
                SuperscriptBox["p", "2"]}], "-", 
               RowBox[{"6", " ", "cos1", " ", "l1", " ", 
                SuperscriptBox["p", "3"]}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["p", "4"]}]}], ")"}], " ", 
             SuperscriptBox[
              RowBox[{"ZA3", "[", 
               RowBox[{
                SqrtBox[
                 FractionBox["2", "3"]], " ", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox["l1", "2"], "-", 
                  RowBox[{"cos1", " ", "l1", " ", "p"}], "+", 
                  SuperscriptBox["p", "2"]}]]}], "]"}], "2"]}], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["l1", "2"], "-", 
                RowBox[{"2", " ", "cos1", " ", "l1", " ", "p"}], "+", 
                SuperscriptBox["p", "2"]}], ")"}], "2"], " ", 
             RowBox[{"Zc", "[", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["l1", "2"], "-", 
                RowBox[{"2", " ", "cos1", " ", "l1", " ", "p"}], "+", 
                SuperscriptBox["p", "2"]}]], "]"}]}]]}], ")"}]}], 
        SuperscriptBox[
         RowBox[{"Zc", "[", "l1", "]"}], "2"]], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"50", " ", 
          SuperscriptBox["k", "6"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ZA", "[", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["k", "6"]}], ")"}], 
              RowBox[{"1", "/", "6"}]], "]"}], "-", 
            RowBox[{"ZA", "[", 
             RowBox[{
              FractionBox["51", "50"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SuperscriptBox["k", "6"]}], ")"}], 
               RowBox[{"1", "/", "6"}]]}], "]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["cos1", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", " ", 
                SuperscriptBox["l1", "4"]}], "-", 
               RowBox[{"6", " ", "cos1", " ", 
                SuperscriptBox["l1", "3"], " ", "p"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"8", "+", 
                  SuperscriptBox["cos1", "2"]}], ")"}], " ", 
                SuperscriptBox["l1", "2"], " ", 
                SuperscriptBox["p", "2"]}], "-", 
               RowBox[{"6", " ", "cos1", " ", "l1", " ", 
                SuperscriptBox["p", "3"]}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["p", "4"]}]}], ")"}], " ", 
             SuperscriptBox[
              RowBox[{"ZA3", "[", 
               RowBox[{
                SqrtBox[
                 FractionBox["2", "3"]], " ", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox["l1", "2"], "-", 
                  RowBox[{"cos1", " ", "l1", " ", "p"}], "+", 
                  SuperscriptBox["p", "2"]}]]}], "]"}], "2"]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "7"}], "+", 
               SuperscriptBox["cos1", "2"]}], ")"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["l1", "2"], "-", 
                RowBox[{"2", " ", "cos1", " ", "l1", " ", "p"}], "+", 
                SuperscriptBox["p", "2"]}], ")"}], "2"], " ", 
             RowBox[{"ZA4", "[", 
              FractionBox[
               SqrtBox[
                RowBox[{
                 SuperscriptBox["l1", "2"], "+", 
                 SuperscriptBox["p", "2"]}]], 
               SqrtBox["2"]], "]"}], " ", 
             RowBox[{"Zc", "[", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["l1", "2"], "-", 
                RowBox[{"2", " ", "cos1", " ", "l1", " ", "p"}], "+", 
                SuperscriptBox["p", "2"]}]], "]"}]}]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["k", "6"]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["l1", "2"], "-", 
             RowBox[{"2", " ", "cos1", " ", "l1", " ", "p"}], "+", 
             SuperscriptBox["p", "2"]}], ")"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Zc", "[", "l1", "]"}], "2"], " ", 
          RowBox[{"Zc", "[", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["l1", "2"], "-", 
             RowBox[{"2", " ", "cos1", " ", "l1", " ", "p"}], "+", 
             SuperscriptBox["p", "2"]}]], "]"}]}], ")"}]}], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["cos1", "2"]}], ")"}], " ", 
         SuperscriptBox["l1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dtZc", "[", "k", "]"}], "+", 
           RowBox[{"50", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Zc", "[", "k", "]"}]}], "+", 
              RowBox[{"Zc", "[", 
               FractionBox[
                RowBox[{"51", " ", "k"}], "50"], "]"}]}], ")"}]}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"ZccbA", "[", 
           RowBox[{
            SqrtBox[
             FractionBox["2", "3"]], " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["l1", "2"], "-", 
              RowBox[{"cos1", " ", "l1", " ", "p"}], "+", 
              SuperscriptBox["p", "2"]}]]}], "]"}], "2"]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["l1", "2"], "-", 
           RowBox[{"2", " ", "cos1", " ", "l1", " ", "p"}], "+", 
           SuperscriptBox["p", "2"]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"ZA", "[", "l1", "]"}], "2"], " ", 
         RowBox[{"ZA", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["l1", "2"], "-", 
            RowBox[{"2", " ", "cos1", " ", "l1", " ", "p"}], "+", 
            SuperscriptBox["p", "2"]}]], "]"}]}]]}], ")"}]}], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["cos1", "2"]}], ")"}], " ", 
      SuperscriptBox["l1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"dtZc", "[", "k", "]"}], " ", 
         RowBox[{"RB", "[", 
          RowBox[{
           SuperscriptBox["k", "2"], ",", 
           SuperscriptBox["l1", "2"]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"RBdot", "[", 
          RowBox[{
           SuperscriptBox["k", "2"], ",", 
           SuperscriptBox["l1", "2"]}], "]"}], " ", 
         RowBox[{"Zc", "[", "k", "]"}]}], "-", 
        RowBox[{"50", " ", 
         RowBox[{"RB", "[", 
          RowBox[{
           SuperscriptBox["k", "2"], ",", 
           SuperscriptBox["l1", "2"]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Zc", "[", "k", "]"}], "-", 
           RowBox[{"Zc", "[", 
            FractionBox[
             RowBox[{"51", " ", "k"}], "50"], "]"}]}], ")"}]}]}], ")"}], " ", 
      
      SuperscriptBox[
       RowBox[{"ZccbA", "[", 
        RowBox[{
         SqrtBox[
          FractionBox["2", "3"]], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["l1", "2"], "+", 
           RowBox[{"cos1", " ", "l1", " ", "p"}], "+", 
           SuperscriptBox["p", "2"]}]]}], "]"}], "2"]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["l1", "2"], "+", 
        RowBox[{"2", " ", "cos1", " ", "l1", " ", "p"}], "+", 
        SuperscriptBox["p", "2"]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"ZA", "[", "l1", "]"}], "2"], " ", 
      RowBox[{"ZA", "[", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["l1", "2"], "+", 
         RowBox[{"2", " ", "cos1", " ", "l1", " ", "p"}], "+", 
         SuperscriptBox["p", "2"]}]], "]"}]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{3.953383953290228*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"86672791-7748-4f00-bf11-c316d6bfb9ce"]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->"COEN.m",
WindowSize->{1185, 711},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.8 Inherited,
FrontEndVersion->"14.1 for Linux x86 (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"dfc92765-bf29-47cf-bd50-cf1f31dcd525"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 621, 11, 25, "Input",ExpressionUUID->"33cd48af-4550-42b3-9c95-127f2f1ee635"],
Cell[CellGroupData[{
Cell[1200, 35, 244, 4, 77, "Title",ExpressionUUID->"45e0855c-4bc3-42ae-aaff-d5b51f4ff40a"],
Cell[CellGroupData[{
Cell[1469, 43, 299, 5, 53, "Section",ExpressionUUID->"e11489d7-57c3-46f3-92a7-9bd632e0d9ac"],
Cell[1771, 50, 2773, 74, 531, "Input",ExpressionUUID->"0d5d392c-52cd-44ef-853d-02a6cf9d51ce",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[4581, 129, 399, 6, 53, "Section",ExpressionUUID->"b32957eb-7ce4-4c31-859c-202f0f63a0ff"],
Cell[4983, 137, 276, 6, 41, "Code",ExpressionUUID->"c9c77b3e-c91a-4a0e-b21b-3ceea3d06b71"]
}, Closed]],
Cell[CellGroupData[{
Cell[5296, 148, 259, 4, 42, "Section",ExpressionUUID->"d65e8f2b-6500-4348-8918-912b67b13cd9"],
Cell[5558, 154, 1997, 48, 247, "Input",ExpressionUUID->"0a00f2e0-9e12-4855-8a8a-da6773cee6a6",
 InitializationCell->True],
Cell[7558, 204, 1863, 48, 91, "Input",ExpressionUUID->"66c68510-764b-433f-bf11-01c5d6a5e9c2",
 InitializationCell->True],
Cell[9424, 254, 717, 20, 46, "Input",ExpressionUUID->"0820655e-3796-4a1d-a0e1-c7b33751bb4e",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[10178, 279, 295, 5, 53, "Section",ExpressionUUID->"35443d0b-bd7f-4341-8864-3262d730e796"],
Cell[CellGroupData[{
Cell[10498, 288, 162, 3, 42, "Subsection",ExpressionUUID->"fabc2f95-fb25-45ca-aee6-ad9fe9e31827"],
Cell[10663, 293, 28200, 620, 1589, "Input",ExpressionUUID->"50a7ba72-e5bd-4991-81bf-b6aff6d27053",
 InitializationCell->True],
Cell[38866, 915, 8552, 205, 1144, "Input",ExpressionUUID->"a5a7128e-7318-4280-b574-f59313a744da",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[47455, 1125, 265, 4, 42, "Subsection",ExpressionUUID->"8bc99ae2-d9e8-479c-848e-7cb606c988e4"],
Cell[47723, 1131, 3539, 89, 263, "Input",ExpressionUUID->"59a9fb42-8cec-4dd4-b89f-fd5a2c265905",
 InitializationCell->True],
Cell[51265, 1222, 13915, 307, 1048, "Input",ExpressionUUID->"771842ec-8641-4e2c-b64d-1c50115d8c11",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[65217, 1534, 290, 5, 30, "Subsection",ExpressionUUID->"1789937b-2e63-4c39-a57f-eaf578006823"],
Cell[65510, 1541, 1239, 24, 38, "Input",ExpressionUUID->"f74de9f1-08b4-4443-aef0-ab0068452dec",
 InitializationCell->True],
Cell[66752, 1567, 6144, 126, 254, "Input",ExpressionUUID->"d51a9a90-ee68-4e4a-8c62-e730741f68c9",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[72933, 1698, 218, 4, 42, "Subsection",ExpressionUUID->"c806af20-0dc0-49b0-8aae-8d0d656c23c0"],
Cell[CellGroupData[{
Cell[73176, 1706, 169, 3, 34, "Subsubsection",ExpressionUUID->"37321981-1eb4-4a59-b79f-351f28c754cd"],
Cell[73348, 1711, 3506, 86, 295, "Input",ExpressionUUID->"0f1a2c07-9fee-4cc0-8b61-f5ef33dda0e2",
 InitializationCell->True],
Cell[76857, 1799, 1594, 43, 148, "Input",ExpressionUUID->"67d3543f-bb83-4d58-8013-d9f67d1ad989",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[78488, 1847, 171, 3, 34, "Subsubsection",ExpressionUUID->"2b09806b-9027-4de0-aff2-1e5e15a13358"],
Cell[CellGroupData[{
Cell[78684, 1854, 12013, 266, 964, "Input",ExpressionUUID->"19bb6be5-817d-48dc-92c5-1f0931b759bc",
 InitializationCell->True],
Cell[90700, 2122, 366, 9, 20, "Message",ExpressionUUID->"61a798c5-ff95-4ad8-9347-5022553d86e6"],
Cell[91069, 2133, 446, 10, 20, "Message",ExpressionUUID->"bb5dd241-ea31-4a98-ab26-be3c543b031c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[91576, 2150, 164, 3, 42, "Subsection",ExpressionUUID->"bbe8a29e-ae48-487c-b970-5cb4168ce017"],
Cell[91743, 2155, 6758, 151, 567, "Input",ExpressionUUID->"121124f3-b34f-43fb-b27f-8d28cfab0fe9",
 InitializationCell->True],
Cell[98504, 2308, 2602, 66, 317, "Input",ExpressionUUID->"0653ed79-d814-4cd3-9636-55db96427984",
 InitializationCell->True],
Cell[101109, 2376, 3846, 94, 444, "Input",ExpressionUUID->"32cd0176-cb58-4cc1-95b4-396b79882412",
 InitializationCell->True],
Cell[104958, 2472, 6199, 124, 655, "Input",ExpressionUUID->"6c698783-46f5-4550-8819-fc2e28e8a73f",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[111206, 2602, 348, 6, 53, "Section",ExpressionUUID->"d1eae3e3-a1d4-4f43-bc47-8b9ad56b43d8"],
Cell[CellGroupData[{
Cell[111579, 2612, 215, 4, 42, "Subsection",ExpressionUUID->"bb6db520-7a4d-4f07-b33a-43b6335f2d38"],
Cell[111797, 2618, 3577, 86, 297, "Input",ExpressionUUID->"d8038072-125a-4f25-b2ad-9568b4dfd78c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[115411, 2709, 290, 5, 30, "Subsection",ExpressionUUID->"d35005be-ae33-4175-8083-83cc90b1c312"],
Cell[115704, 2716, 6320, 129, 271, "Input",ExpressionUUID->"a64eafc7-3cd5-4e30-a2e9-1a7bcffcd2ff",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[122061, 2850, 268, 4, 42, "Subsection",ExpressionUUID->"31f3fcb4-4749-48bc-81cc-4be53512fe24"],
Cell[122332, 2856, 6411, 146, 517, "Input",ExpressionUUID->"aae42b7b-87cf-4909-a1b7-8b0a1e48becf",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[128792, 3008, 396, 6, 52, "Section",ExpressionUUID->"fd091b76-1595-46ac-9769-c9fc9edc6bc4"],
Cell[CellGroupData[{
Cell[129213, 3018, 340, 5, 42, "Subsection",ExpressionUUID->"45e1ec2c-4f80-426d-b4be-097ebee3e119"],
Cell[129556, 3025, 6814, 138, 520, "Input",ExpressionUUID->"37c0cded-e660-4d93-93e7-bd4a7753decd",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[136407, 3168, 321, 5, 42, "Subsection",ExpressionUUID->"da37cc01-4037-4f8a-95fb-ac772916a2d3"],
Cell[136731, 3175, 6734, 149, 519, "Input",ExpressionUUID->"9e02a99e-b90c-4d0c-9cd3-469e2aefb62d",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[143514, 3330, 446, 7, 52, "Section",ExpressionUUID->"2f860918-e407-42ec-8e71-c29969e7113a"],
Cell[143963, 3339, 299, 6, 40, "Code",ExpressionUUID->"d874146e-0366-43b8-9441-de245a7f87f4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[144311, 3351, 152, 3, 76, "Title",ExpressionUUID->"f9e38f33-09e7-4f47-aa24-24618b810538"],
Cell[CellGroupData[{
Cell[144488, 3358, 16617, 444, 1487, "Input",ExpressionUUID->"464312df-f2a1-4bd7-8d31-5991427d6110"],
Cell[CellGroupData[{
Cell[161130, 3806, 1311, 20, 19, "Print",ExpressionUUID->"641264ef-1243-4837-bbf6-17e7d39562af"],
Cell[162444, 3828, 1255, 19, 19, "Print",ExpressionUUID->"9afd9042-46da-4ae3-b9fc-90d75deb26ee"],
Cell[163702, 3849, 1251, 19, 19, "Print",ExpressionUUID->"216819d0-41b0-40de-9fc4-82eff112f423"],
Cell[164956, 3870, 1245, 18, 19, "Print",ExpressionUUID->"65a86270-693d-4a03-b50e-afe4478e4071"],
Cell[166204, 3890, 1245, 18, 17, "Print",ExpressionUUID->"c07e8138-d49e-44ef-a3b4-cde5e27bb3b2"],
Cell[167452, 3910, 1246, 18, 17, "Print",ExpressionUUID->"4ce70eb3-0cb5-4e9f-99df-98836bb8b32e"],
Cell[168701, 3930, 1245, 18, 17, "Print",ExpressionUUID->"72f4b8dc-1591-4699-849d-14d30c4a49d5"],
Cell[169949, 3950, 1244, 18, 17, "Print",ExpressionUUID->"ed7ec420-0d45-4ea6-ad06-d2b14edbc65b"],
Cell[171196, 3970, 2010, 31, 77, "Print",ExpressionUUID->"7f6c5237-db2e-4c9b-9fee-f8366927fee7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[173255, 4007, 3207, 66, 104, "Input",ExpressionUUID->"93c1c0eb-aebd-4bc5-a6b9-846bf716c5ca"],
Cell[176465, 4075, 5649, 160, 196, "Output",ExpressionUUID->"68874709-0d56-408d-9ed7-b05beb42caef"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182151, 4240, 3338, 68, 104, "Input",ExpressionUUID->"1e9d38f6-3b53-408b-a249-6173a6191de5"],
Cell[185492, 4310, 13849, 387, 461, "Output",ExpressionUUID->"86672791-7748-4f00-bf11-c316d6bfb9ce"]
}, Open  ]]
}, Open  ]]
}
]
*)

