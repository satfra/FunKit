(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    121198,       2760]
NotebookOptionsPosition[    117576,       2685]
NotebookOutlinePosition[    118027,       2703]
CellTagsIndexPosition[    117984,       2700]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"AutoGeneratedPackage", "->", "\"\<DiANE.m\>\""}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.933907062001917*^9, 3.933907088477437*^9}, 
   3.9356618434708548`*^9, 3.935744927606638*^9, {3.935833716539812*^9, 
   3.93583371672362*^9}, {3.9507222866535883`*^9, 3.95072228934137*^9}, {
   3.950850838405504*^9, 3.950850842475651*^9}, {3.951279221542409*^9, 
   3.9512792233223047`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"33cd48af-4550-42b3-9c95-127f2f1ee635"],

Cell[CellGroupData[{

Cell["Global variables", "Section",
 CellChangeTimes->{{3.9509597231601686`*^9, 3.950959732923991*^9}, {
  3.951108540108012*^9, 3.9511085438759727`*^9}, {3.951210853720582*^9, 
  3.95121085660688*^9}},ExpressionUUID->"d65e8f2b-6500-4348-8918-\
912b67b13cd9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ModuleLoaded", "::", "dependency"}], "=", 
    "\"\<The module `1` requires `2`, which has not been loaded.\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ModuleLoaded", "[", "FunKit", "]"}], "=!=", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"ModuleLoaded", "::", "dependency"}], ",", "\"\<DiANE\>\"", 
        ",", "\"\<FunKit\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ModuleLoaded", "[", "FEDeriK", "]"}], "=!=", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"ModuleLoaded", "::", "dependency"}], ",", "\"\<DiANE\>\"", 
        ",", "\"\<FEDeriK\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ModuleLoaded", "[", "DiANE", "]"}], "=", "True"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951279357886877*^9, 3.951279421240814*^9}, {
  3.9512794606622543`*^9, 3.951279475842711*^9}, {3.951279581390761*^9, 
  3.9512796611981983`*^9}, {3.9512797916680803`*^9, 
  3.9512797949459953`*^9}},ExpressionUUID->"3b72c183-b427-41fc-97f5-\
14c39b5b43de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$FunKitDirectory", "=", 
   RowBox[{
    RowBox[{"SelectFirst", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
            "$UserBaseDirectory", ",", "\"\<Applications\>\"", ",", 
             "\"\<FunKit\>\""}], "}"}], "]"}], ",", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
            "$BaseDirectory", ",", "\"\<Applications\>\"", ",", 
             "\"\<FunKit\>\""}], "}"}], "]"}], ",", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
            "$InstallationDirectory", ",", "\"\<AddOns\>\"", ",", 
             "\"\<Applications\>\"", ",", "\"\<FunKit\>\""}], "}"}], "]"}], 
          ",", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
            "$InstallationDirectory", ",", "\"\<AddOns\>\"", ",", 
             "\"\<Packages\>\"", ",", "\"\<FunKit\>\""}], "}"}], "]"}], ",", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
            "$InstallationDirectory", ",", "\"\<AddOns\>\"", ",", 
             "\"\<ExtraPackages\>\"", ",", "\"\<FunKit\>\""}], "}"}], "]"}]}],
          "}"}], ",", 
        RowBox[{"Select", "[", 
         RowBox[{"$Path", ",", 
          RowBox[{
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"#", ",", "\"\<FunKit\>\""}], "]"}], "&"}]}], "]"}]}], 
       "]"}], ",", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", "#", "]"}], "&"}]}], "]"}], "<>", 
    "\"\</\>\""}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951226996707944*^9, 3.951227003475544*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"66c68510-764b-433f-bf11-01c5d6a5e9c2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Pretty printing and LaTeX", "Section",
 CellChangeTimes->{{3.951227153497263*^9, 
  3.9512271630776052`*^9}},ExpressionUUID->"8a7de2d4-4e3d-41aa-8f92-\
19d8c0694994"],

Cell[CellGroupData[{

Cell["Load packages", "Subsection",
 CellChangeTimes->{{3.951227218290779*^9, 
  3.9512272199386797`*^9}},ExpressionUUID->"fe6211e7-4eaf-4c19-8e0e-\
b2242a07760b"],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "@", 
     RowBox[{"PacletFind", "[", "\"\<MaTeX\>\"", "]"}]}], "===", "0"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ResourceFunction", "[", "\"\<MaTeXInstall\>\"", "]"}], "[", 
    "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", "\"\<MaTeX`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Import", "[", 
  RowBox[{
  "$FunKitDirectory", "<>", "\"\</utils/MathematicaTeXUtilities.m\>\""}], 
  "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951220603320554*^9, 3.9512206398339787`*^9}, {
  3.951222619623927*^9, 3.951222619860894*^9}, {3.951226869940086*^9, 
  3.9512268782989798`*^9}, {3.951226922919786*^9, 3.951226955627511*^9}, {
  3.951227017444984*^9, 3.951227033537813*^9}, {3.9512270906128063`*^9, 
  3.951227103820059*^9}},
 CellLabel->
  "In[1092]:=",ExpressionUUID->"4cb64dde-a02d-401c-87bd-c89d5d2cf484"]
}, Closed]],

Cell[CellGroupData[{

Cell["Index list formatting", "Subsection",
 CellChangeTimes->{{3.951227218290779*^9, 3.951227234130476*^9}, {
  3.951228264410342*^9, 
  3.951228264818948*^9}},ExpressionUUID->"b673667e-d925-4d48-9d93-\
4211a3ceb4cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeTexIndexList", "[", 
   RowBox[{"{", "i__", "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ni", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"{", "i", "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
      "isLower", ",", "\[IndentingNewLine]", 
      RowBox[{"indices", "=", 
       RowBox[{"{", "i", "}"}]}], ",", "\[IndentingNewLine]", "lowerList", 
      ",", "\[IndentingNewLine]", "upperList", ",", "\[IndentingNewLine]", 
      "removeTrailingPhantoms"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"isLower", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"#", ",", 
           RowBox[{"Times", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "_"}], "]"}]}], "]"}], "&"}], ",", 
        RowBox[{"{", "i", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"indices", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"isLower", "[", 
           RowBox[{"[", "idx", "]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"indices", "[", 
            RowBox[{"[", "idx", "]"}], "]"}]}], ",", 
          RowBox[{"indices", "[", 
           RowBox[{"[", "idx", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"idx", ",", "1", ",", "ni"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"lowerList", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"isLower", "[", 
           RowBox[{"[", "idx", "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ToString", "@", 
           RowBox[{"TeXForm", "[", 
            RowBox[{"indices", "[", 
             RowBox[{"[", "idx", "]"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<\\\\phantom{\>\"", "<>", 
           RowBox[{"ToString", "@", 
            RowBox[{"TeXForm", "[", 
             RowBox[{"indices", "[", 
              RowBox[{"[", "idx", "]"}], "]"}], "]"}]}], "<>", 
           "\"\<}\>\""}]}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"idx", ",", "1", ",", "ni"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"upperList", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"isLower", "[", 
           RowBox[{"[", "idx", "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<\\\\phantom{\>\"", "<>", 
           RowBox[{"ToString", "@", 
            RowBox[{"TeXForm", "[", 
             RowBox[{"indices", "[", 
              RowBox[{"[", "idx", "]"}], "]"}], "]"}]}], "<>", "\"\<}\>\""}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ToString", "@", 
           RowBox[{"TeXForm", "[", 
            RowBox[{"indices", "[", 
             RowBox[{"[", "idx", "]"}], "]"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"idx", ",", "1", ",", "ni"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"removeTrailingPhantoms", "[", "l_", "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ret", "=", "l"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{"StringContainsQ", "[", 
            RowBox[{
             RowBox[{"ret", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], ",", "\"\<\\\\phantom\>\""}],
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ret", "=", 
             RowBox[{"Delete", "[", 
              RowBox[{"ret", ",", 
               RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "ret", "]"}], "===", "0"}], ",", 
              RowBox[{"Return", "[", 
               RowBox[{"{", "\"\<\>\"", "}"}], "]"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "ret", "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"upperList", "=", 
      RowBox[{"removeTrailingPhantoms", "@", "upperList"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lowerList", "=", 
      RowBox[{"removeTrailingPhantoms", "@", "lowerList"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"StringJoin", "@@", "lowerList"}], ",", 
        RowBox[{"StringJoin", "@@", "upperList"}]}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9512279900434513`*^9, 3.951228079647861*^9}, {
  3.9512281378398447`*^9, 3.951228205003704*^9}},
 CellLabel->
  "In[1095]:=",ExpressionUUID->"2757d6ff-49bf-4f75-b9da-02f06924b8e7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MakeIdxField", "[", 
   RowBox[{"f_", ",", "i_", ",", "up"}], "]"}], ":=", 
  RowBox[{"MakeIdxField", "[", 
   RowBox[{"f", ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"MatchQ", "[", 
       RowBox[{"i", ",", 
        RowBox[{"Times", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "_"}], "]"}]}], "]"}], ",", 
      RowBox[{"-", "i"}], ",", "i"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeIdxField", "[", 
   RowBox[{"f_", ",", "i_", ",", "down"}], "]"}], ":=", 
  RowBox[{"MakeIdxField", "[", 
   RowBox[{"f", ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"MatchQ", "[", 
       RowBox[{"i", ",", 
        RowBox[{"Times", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "_"}], "]"}]}], "]"}], ",", "i", ",", 
      RowBox[{"-", "i"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeIdxField", "[", 
    RowBox[{"f_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"isLower", ",", "idx"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"isLower", "=", 
       RowBox[{"MatchQ", "[", 
        RowBox[{"i", ",", 
         RowBox[{"Times", "[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "_"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"idx", "=", 
       RowBox[{"If", "[", 
        RowBox[{"isLower", ",", 
         RowBox[{"-", "i"}], ",", "i"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"f", "===", "AnyField"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"ToString", "[", 
          RowBox[{"TeXForm", "[", "idx", "]"}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"isLower", ",", 
        RowBox[{"Return", "[", 
         RowBox[{"ToString", "@", 
          RowBox[{"TeXForm", "[", 
           RowBox[{"Subscript", "[", 
            RowBox[{"f", ",", "idx"}], "]"}], "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"ToString", "@", 
        RowBox[{"TeXForm", "[", 
         RowBox[{"Superscript", "[", 
          RowBox[{"f", ",", "idx"}], "]"}], "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeTexIndexList", "[", 
   RowBox[{
    RowBox[{"{", "f__", "}"}], ",", 
    RowBox[{"{", "i__", "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ni", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"{", "f", "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
      "isLower", ",", "\[IndentingNewLine]", 
      RowBox[{"fields", "=", 
       RowBox[{"{", "f", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"indices", "=", 
       RowBox[{"{", "i", "}"}]}], ",", "\[IndentingNewLine]", "lowerList", 
      ",", "\[IndentingNewLine]", "upperList", ",", "\[IndentingNewLine]", 
      "removeTrailingPhantoms"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"isLower", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"#", ",", 
           RowBox[{"Times", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "_"}], "]"}]}], "]"}], "&"}], ",", 
        RowBox[{"{", "i", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"lowerList", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"isLower", "[", 
           RowBox[{"[", "idx", "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"MakeIdxField", "[", 
           RowBox[{
            RowBox[{"fields", "[", 
             RowBox[{"[", "idx", "]"}], "]"}], ",", 
            RowBox[{"indices", "[", 
             RowBox[{"[", "idx", "]"}], "]"}], ",", "up"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<\\\\phantom{\>\"", "<>", 
           RowBox[{"MakeIdxField", "[", 
            RowBox[{
             RowBox[{"fields", "[", 
              RowBox[{"[", "idx", "]"}], "]"}], ",", 
             RowBox[{"indices", "[", 
              RowBox[{"[", "idx", "]"}], "]"}], ",", "up"}], "]"}], "<>", 
           "\"\<}\>\""}]}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"idx", ",", "1", ",", "ni"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"upperList", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"isLower", "[", 
           RowBox[{"[", "idx", "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<\\\\phantom{\>\"", "<>", 
           RowBox[{"MakeIdxField", "[", 
            RowBox[{
             RowBox[{"fields", "[", 
              RowBox[{"[", "idx", "]"}], "]"}], ",", 
             RowBox[{"indices", "[", 
              RowBox[{"[", "idx", "]"}], "]"}], ",", "up"}], "]"}], "<>", 
           "\"\<}\>\""}], ",", "\[IndentingNewLine]", 
          RowBox[{"MakeIdxField", "[", 
           RowBox[{
            RowBox[{"fields", "[", 
             RowBox[{"[", "idx", "]"}], "]"}], ",", 
            RowBox[{"indices", "[", 
             RowBox[{"[", "idx", "]"}], "]"}], ",", "up"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"idx", ",", "1", ",", "ni"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"removeTrailingPhantoms", "[", "l_", "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ret", "=", "l"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{"StringContainsQ", "[", 
            RowBox[{
             RowBox[{"ret", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], ",", "\"\<\\\\phantom\>\""}],
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ret", "=", 
             RowBox[{"Delete", "[", 
              RowBox[{"ret", ",", 
               RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "ret", "]"}], "===", "0"}], ",", 
              RowBox[{"Return", "[", 
               RowBox[{"{", "\"\<\>\"", "}"}], "]"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "ret", "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"upperList", "=", 
      RowBox[{"removeTrailingPhantoms", "@", "upperList"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lowerList", "=", 
      RowBox[{"removeTrailingPhantoms", "@", "lowerList"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"StringJoin", "@@", "lowerList"}], ",", 
        RowBox[{"StringJoin", "@@", "upperList"}]}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951224453339987*^9, 3.951224504011447*^9}, {
   3.9512245836998873`*^9, 3.951225183586688*^9}, {3.9512252226473923`*^9, 
   3.951225289991295*^9}, {3.951225357167528*^9, 3.95122546150375*^9}, {
   3.95122549194619*^9, 3.951225913224032*^9}, {3.9512259438888283`*^9, 
   3.951226154260346*^9}, {3.951226184420576*^9, 3.9512261923833513`*^9}, {
   3.951226294902279*^9, 3.951226427296379*^9}, {3.95122645762057*^9, 
   3.951226633727709*^9}, 3.9512267993502274`*^9, {3.951227949864423*^9, 
   3.951227987338913*^9}, {3.951374305386952*^9, 
   3.9513743624549017`*^9}},ExpressionUUID->"c206a11f-7558-4843-a213-\
55c609b89e58"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Prettify closed indices", "Subsection",
 CellChangeTimes->{{3.9512282799668913`*^9, 
  3.951228284818677*^9}},ExpressionUUID->"c85a5823-b0b0-4a54-a9b5-\
b6ecf5b7d25d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"prettyIndices", "[", 
    RowBox[{"setup_", ",", "expr_FEq"}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"prettyIndices", "[", 
       RowBox[{"setup", ",", "#"}], "]"}], "&"}], ",", "expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"prettyIndices", "[", 
    RowBox[{"setup_", ",", "expr_FTerm"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "closedIndices", ",", "openIndices", ",", "repl", ",", "indices"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"closedIndices", "=", 
       RowBox[{"GetClosedSuperIndices", "[", 
        RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"openIndices", "=", 
       RowBox[{"GetOpenSuperIndices", "[", 
        RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"indices", "=", 
       RowBox[{"Alphabet", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"indices", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"indices", ",", 
           RowBox[{
            RowBox[{"#", "=!=", 
             RowBox[{"ToString", "[", 
              RowBox[{"openIndices", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "openIndices", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"repl", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"closedIndices", "->", 
         RowBox[{"indices", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", 
            RowBox[{"Length", "[", "closedIndices", "]"}]}], "]"}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"expr", "//.", "repl"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951228520702806*^9, 3.9512287157941008`*^9}, {
   3.9512289543471107`*^9, 3.95122895739114*^9}, {3.95122898752525*^9, 
   3.951229005782969*^9}, {3.9512293949001007`*^9, 3.951229396595858*^9}, {
   3.9512303490830173`*^9, 3.9512307057859497`*^9}, {3.951231190652398*^9, 
   3.951231217683535*^9}, {3.951232463495397*^9, 3.9512325501930227`*^9}, {
   3.95123292322405*^9, 3.951232962305142*^9}, {3.951233478552884*^9, 
   3.951233506821313*^9}, 3.9512372221659317`*^9},
 CellLabel->
  "In[1100]:=",ExpressionUUID->"4689a3d2-e2b9-43c0-abfa-435e5632834b"]
}, Closed]],

Cell[CellGroupData[{

Cell["General formatting definitions", "Subsection",
 CellChangeTimes->{{3.951227218290779*^9, 
  3.951227251130701*^9}},ExpressionUUID->"1c82d10b-061e-41f5-a731-\
b8174ae16e8f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexStyles", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[71]:=",ExpressionUUID->"6bb84f5e-6a14-4388-9a5c-aeffe2a30746"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddTexStyles", "::", "invalidRule"}], "=", 
    "\"\<The given set of style rules does not follow the pattern \
Symbol->String.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddTexStyles", "[", "a__Rule", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Or", "@@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "#", "]"}], "=!=", "String"}], "&"}], ",", 
           RowBox[{"Values", "[", 
            RowBox[{"{", "a", "}"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"AddTexStyles", "::", "invalidRule"}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"$TexStyles", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{"$TexStyles", ",", 
          RowBox[{"{", "a", "}"}]}], "]"}], "]"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetTexStyles", "[", "a__Rule", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Or", "@@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "#", "]"}], "=!=", "String"}], "&"}], ",", 
           RowBox[{"Values", "[", 
            RowBox[{"{", "a", "}"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"AddTexStyles", "::", "invalidRule"}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"$TexStyles", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"{", "a", "}"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetTexStyles", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$TexStyles", "=", 
      RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.95137263181005*^9, 3.951372647385743*^9}, {
  3.951372713714319*^9, 3.951372752297573*^9}, {3.951372830177681*^9, 
  3.951372957961604*^9}, {3.9513730522534437`*^9, 3.9513733154194107`*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"b47c8098-cb50-46d8-b369-2238ea569892"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RenewFormatDefinitions", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Unprotect", "[", 
       RowBox[{
       "FDOp", ",", "GammaN", ",", "Propagator", ",", "Rdot", ",", "FTerm", 
        ",", "FEq", ",", "\[Gamma]", ",", "\[Delta]", ",", "FMinus"}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Field", " ", "formatting"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Map", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Format", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Keys", "[", "#", "]"}], "[", "any__", "]"}], ",", 
             "TeXForm"}], "]"}], ":=", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"head", ",", "arg"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"head", "=", 
               RowBox[{
                RowBox[{"Keys", "[", "#", "]"}], "//.", "$TexStyles"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"arg", "=", 
               RowBox[{
                RowBox[{"Format", "[", 
                 RowBox[{"any", ",", "TeXForm"}], "]"}], "//", "ToString"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"TeXVerbatim", "[", 
               RowBox[{"head", "<>", "arg"}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}]}], ")"}], "&"}], ",", 
        "\[IndentingNewLine]", "$TexStyles"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Map", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Format", "[", 
            RowBox[{
             RowBox[{"Superscript", "[", 
              RowBox[{
               RowBox[{"Keys", "[", "#", "]"}], ",", "any_"}], "]"}], ",", 
             "TeXForm"}], "]"}], ":=", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"head", ",", "arg"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"head", "=", 
               RowBox[{
                RowBox[{"Keys", "[", "#", "]"}], "//.", "$TexStyles"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"arg", "=", 
               RowBox[{
                RowBox[{"Format", "[", 
                 RowBox[{"any", ",", "TeXForm"}], "]"}], "//", "ToString"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"TeXVerbatim", "[", 
               RowBox[{"head", "<>", "\"\<^\>\"", "<>", "arg"}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}]}], ")"}], "&"}], ",", 
        "\[IndentingNewLine]", "$TexStyles"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Map", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Format", "[", 
            RowBox[{
             RowBox[{"Subscript", "[", 
              RowBox[{
               RowBox[{"Keys", "[", "#", "]"}], ",", "any_"}], "]"}], ",", 
             "TeXForm"}], "]"}], ":=", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"head", ",", "arg"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"head", "=", 
               RowBox[{
                RowBox[{"Keys", "[", "#", "]"}], "//.", "$TexStyles"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"arg", "=", 
               RowBox[{
                RowBox[{"Format", "[", 
                 RowBox[{"any", ",", "TeXForm"}], "]"}], "//", "ToString"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"TeXVerbatim", "[", 
               RowBox[{"head", "<>", "\"\<_\>\"", "<>", "arg"}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}]}], ")"}], "&"}], ",", 
        "\[IndentingNewLine]", "$TexStyles"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Other", " ", "formatting"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Format", "[", 
        RowBox[{
         RowBox[{"FDOp", "[", "f_", "]"}], ",", "TeXForm"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"TeXDelimited", "[", 
          RowBox[{
          "\"\<\\\\frac{\\\\delta}{\\\\delta\>\"", ",", "f", ",", 
           "\"\<}\>\""}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Format", "[", 
        RowBox[{
         RowBox[{"GammaN", "[", 
          RowBox[{
           RowBox[{"{", "f__", "}"}], ",", 
           RowBox[{"{", "i__", "}"}]}], "]"}], ",", "TeXForm"}], "]"}], ":=", 
       
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"sub", ",", "sup", ",", "ret"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"sub", ",", "sup"}], "}"}], "=", 
           RowBox[{"MakeTexIndexList", "[", 
            RowBox[{
             RowBox[{"{", "f", "}"}], ",", 
             RowBox[{"{", "i", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"ret", "=", "\"\<\\\\Gamma\>\""}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringLength", "[", "sub", "]"}], "=!=", "0"}], ",", 
            RowBox[{"ret", "=", 
             RowBox[{
             "ret", "<>", "\"\<_{\>\"", "<>", "sub", "<>", "\"\<}\>\""}]}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringLength", "[", "sup", "]"}], "=!=", "0"}], ",", 
            RowBox[{"ret", "=", 
             RowBox[{
             "ret", "<>", "\"\<^{\>\"", "<>", "sup", "<>", "\"\<}\>\""}]}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"TeXVerbatim", "[", "ret", "]"}]}]}], "\[IndentingNewLine]",
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Format", "[", 
        RowBox[{
         RowBox[{"Propagator", "[", 
          RowBox[{
           RowBox[{"{", "f__", "}"}], ",", 
           RowBox[{"{", "i__", "}"}]}], "]"}], ",", "TeXForm"}], "]"}], ":=", 
       
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"sub", ",", "sup", ",", "ret"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"sub", ",", "sup"}], "}"}], "=", 
           RowBox[{"MakeTexIndexList", "[", 
            RowBox[{
             RowBox[{"{", "f", "}"}], ",", 
             RowBox[{"{", "i", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"ret", "=", "\"\<G\>\""}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringLength", "[", "sub", "]"}], "=!=", "0"}], ",", 
            RowBox[{"ret", "=", 
             RowBox[{
             "ret", "<>", "\"\<_{\>\"", "<>", "sub", "<>", "\"\<}\>\""}]}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringLength", "[", "sup", "]"}], "=!=", "0"}], ",", 
            RowBox[{"ret", "=", 
             RowBox[{
             "ret", "<>", "\"\<^{\>\"", "<>", "sup", "<>", "\"\<}\>\""}]}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"TeXVerbatim", "[", "ret", "]"}]}]}], "\[IndentingNewLine]",
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Format", "[", 
        RowBox[{
         RowBox[{"Rdot", "[", 
          RowBox[{
           RowBox[{"{", "f__", "}"}], ",", 
           RowBox[{"{", "i__", "}"}]}], "]"}], ",", "TeXForm"}], "]"}], ":=", 
       
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"sub", ",", "sup", ",", "ret"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"sub", ",", "sup"}], "}"}], "=", 
           RowBox[{"MakeTexIndexList", "[", 
            RowBox[{
             RowBox[{"{", "f", "}"}], ",", 
             RowBox[{"{", "i", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"ret", "=", "\"\<\\\\partial_t R\>\""}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringLength", "[", "sub", "]"}], "=!=", "0"}], ",", 
            RowBox[{"ret", "=", 
             RowBox[{
             "ret", "<>", "\"\<_{\>\"", "<>", "sub", "<>", "\"\<}\>\""}]}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringLength", "[", "sup", "]"}], "=!=", "0"}], ",", 
            RowBox[{"ret", "=", 
             RowBox[{
             "ret", "<>", "\"\<^{\>\"", "<>", "sup", "<>", "\"\<}\>\""}]}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"TeXVerbatim", "[", "ret", "]"}]}]}], "\[IndentingNewLine]",
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Format", "[", 
        RowBox[{
         RowBox[{"\[Delta]", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], ",", "TeXForm"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"isLower", ",", "sub", ",", "sup", ",", "ret"}], "}"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"sub", ",", "sup"}], "}"}], "=", 
           RowBox[{"MakeTexIndexList", "[", 
            RowBox[{"{", 
             RowBox[{"a", ",", "b"}], "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ret", "=", "\"\<\\\\delta\>\""}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringLength", "[", "sub", "]"}], "=!=", "0"}], ",", 
            RowBox[{"ret", "=", 
             RowBox[{
             "ret", "<>", "\"\<_{\>\"", "<>", "sub", "<>", "\"\<}\>\""}]}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringLength", "[", "sup", "]"}], "=!=", "0"}], ",", 
            RowBox[{"ret", "=", 
             RowBox[{
             "ret", "<>", "\"\<^{\>\"", "<>", "sup", "<>", "\"\<}\>\""}]}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"TeXVerbatim", "[", "ret", "]"}]}]}], "\[IndentingNewLine]",
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Format", "[", 
        RowBox[{
         RowBox[{"\[Gamma]", "[", 
          RowBox[{
           RowBox[{"{", "f__", "}"}], ",", 
           RowBox[{"{", "i__", "}"}]}], "]"}], ",", "TeXForm"}], "]"}], ":=", 
       
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"isLower", ",", "sub", ",", "sup", ",", "ret"}], "}"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"sub", ",", "sup"}], "}"}], "=", 
           RowBox[{"MakeTexIndexList", "[", 
            RowBox[{
             RowBox[{"{", "f", "}"}], ",", 
             RowBox[{"{", "i", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"ret", "=", "\"\<\\\\gamma\>\""}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringLength", "[", "sub", "]"}], "=!=", "0"}], ",", 
            RowBox[{"ret", "=", 
             RowBox[{
             "ret", "<>", "\"\<_{\>\"", "<>", "sub", "<>", "\"\<}\>\""}]}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringLength", "[", "sup", "]"}], "=!=", "0"}], ",", 
            RowBox[{"ret", "=", 
             RowBox[{
             "ret", "<>", "\"\<^{\>\"", "<>", "sup", "<>", "\"\<}\>\""}]}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"TeXVerbatim", "[", "ret", "]"}]}]}], "\[IndentingNewLine]",
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Format", "[", 
        RowBox[{
         RowBox[{"FMinus", "[", 
          RowBox[{
           RowBox[{"{", "f__", "}"}], ",", 
           RowBox[{"{", "i__", "}"}]}], "]"}], ",", "TeXForm"}], "]"}], ":=", 
       
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"isLower", ",", "sub", ",", "sup", ",", "ret"}], "}"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"sub", ",", "sup"}], "}"}], "=", 
           RowBox[{"MakeTexIndexList", "[", 
            RowBox[{
             RowBox[{"{", "f", "}"}], ",", 
             RowBox[{"{", "i", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"ret", "=", "\"\<(-1)\>\""}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringLength", "[", "sub", "]"}], "=!=", "0"}], ",", 
            RowBox[{"ret", "=", 
             RowBox[{
             "ret", "<>", "\"\<_{\>\"", "<>", "sub", "<>", "\"\<}\>\""}]}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringLength", "[", "sup", "]"}], "=!=", "0"}], ",", 
            RowBox[{"ret", "=", 
             RowBox[{
             "ret", "<>", "\"\<^{\>\"", "<>", "sup", "<>", "\"\<}\>\""}]}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"TeXVerbatim", "[", "ret", "]"}]}]}], "\[IndentingNewLine]",
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Format", "[", 
        RowBox[{
         RowBox[{"FTerm", "[", "a__", "]"}], ",", "TeXForm"}], "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "a", "}"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"b_", "/;", 
            RowBox[{
             RowBox[{"NumericQ", "[", "b", "]"}], "&&", 
             RowBox[{"b", "<", "0"}]}]}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"TeXDelimited", "[", 
          RowBox[{"\"\<(\>\"", ",", "a", ",", "\"\<)\>\"", ",", 
           RowBox[{"\"\<DelimSeparator\>\"", "->", "\"\<\>\""}], ",", 
           RowBox[{"\"\<BodySeparator\>\"", "->", "\"\<\>\""}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TeXDelimited", "[", 
          RowBox[{"\"\<\>\"", ",", "a", ",", "\"\<\>\"", ",", 
           RowBox[{"\"\<DelimSeparator\>\"", "->", "\"\<\>\""}], ",", 
           RowBox[{"\"\<BodySeparator\>\"", "->", "\"\<\>\""}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Format", "[", 
        RowBox[{
         RowBox[{"FEq", "[", "a___", "]"}], ",", "TeXForm"}], "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"{", "a", "}"}], "]"}], "<=", "3"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TeXDelimited", "[", 
          RowBox[{"\"\<\>\"", ",", "a", ",", "\"\<\>\"", ",", 
           RowBox[{"\"\<DelimSeparator\>\"", "->", "\"\<\>\""}], ",", 
           RowBox[{"\"\<BodySeparator\>\"", "->", "\"\<\\,+\\,\>\""}]}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"TeXDelimited", "[", 
          RowBox[{
          "\"\<\\\\begin{aligned}&\>\"", ",", "a", ",", 
           "\"\<\\\\end{aligned}\>\"", ",", 
           RowBox[{"\"\<DelimSeparator\>\"", "->", "\"\<\>\""}], ",", 
           RowBox[{
           "\"\<BodySeparator\>\"", "->", "\"\<\\\\\\\\ &\\,+\\,\>\""}]}], 
          "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"Map", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Format", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{
               RowBox[{"{", "f__", "}"}], ",", 
               RowBox[{"{", "i__", "}"}]}], "]"}], ",", "TeXForm"}], "]"}], ":=", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"sub", ",", "sup", ",", "ret"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"sub", ",", "sup"}], "}"}], "=", 
               RowBox[{"MakeTexIndexList", "[", 
                RowBox[{
                 RowBox[{"{", "f", "}"}], ",", 
                 RowBox[{"{", "i", "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"ret", "=", 
               RowBox[{
                RowBox[{"TeXForm", "[", "#", "]"}], "//", "ToString"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"StringLength", "[", "sub", "]"}], "=!=", "0"}], ",", 
                RowBox[{"ret", "=", 
                 RowBox[{
                 "ret", "<>", "\"\<_{\>\"", "<>", "sub", "<>", 
                  "\"\<}\>\""}]}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"StringLength", "[", "sup", "]"}], "=!=", "0"}], ",", 
                RowBox[{"ret", "=", 
                 RowBox[{
                 "ret", "<>", "\"\<^{\>\"", "<>", "sup", "<>", 
                  "\"\<}\>\""}]}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TeXVerbatim", "[", "ret", "]"}]}]}], 
            "\[IndentingNewLine]", "]"}]}], ")"}], "&"}], ",", 
        "\[IndentingNewLine]", "$userIndexedObjects"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Protect", "[", 
       RowBox[{
       "FDOp", ",", "GammaN", ",", "Propagator", ",", "Rdot", ",", "FTerm", 
        ",", "FEq", ",", "\[Gamma]", ",", "\[Delta]", ",", "FMinus"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951223302279481*^9, 3.951223365666438*^9}, 
   3.951223448487712*^9, {3.951223520738687*^9, 3.9512235436795464`*^9}, {
   3.951223580644545*^9, 3.951223702875143*^9}, {3.951223781979072*^9, 
   3.9512239278539047`*^9}, {3.951226172034417*^9, 3.951226245691415*^9}, {
   3.95122649515267*^9, 3.95122650002048*^9}, {3.951226539549152*^9, 
   3.951226540239016*^9}, {3.951226672419936*^9, 3.951226788180599*^9}, {
   3.951227127728176*^9, 3.95122713458395*^9}, {3.9512272581117373`*^9, 
   3.951227258523254*^9}, {3.951227545212324*^9, 3.9512275769163637`*^9}, {
   3.9512277385558987`*^9, 3.95122777945168*^9}, {3.9512278585108223`*^9, 
   3.95122793987572*^9}, {3.9512282149424257`*^9, 3.95122821959562*^9}, {
   3.9512335760396547`*^9, 3.951233588723529*^9}, {3.951285981077655*^9, 
   3.951286078310421*^9}, {3.9512885981204576`*^9, 3.951288765653043*^9}, {
   3.951292239838394*^9, 3.951292257905764*^9}, {3.951372787090849*^9, 
   3.9513728140132504`*^9}, {3.951372970471052*^9, 3.951373037847145*^9}, {
   3.951373386749419*^9, 3.951373398207224*^9}, {3.9513734304187098`*^9, 
   3.951373451970018*^9}, {3.951373511587613*^9, 3.951373583588833*^9}, 
   3.951373669147984*^9, {3.951373807966013*^9, 3.951373896111038*^9}, {
   3.951373969907007*^9, 3.951373981665738*^9}, {3.951374057931175*^9, 
   3.95137407584649*^9}, {3.951374109742488*^9, 3.9513741526433973`*^9}, {
   3.9513746064441566`*^9, 3.951374607767682*^9}, {3.951466169353013*^9, 
   3.95146623999717*^9}, {3.951466415677396*^9, 3.951466460044804*^9}, {
   3.951466493504018*^9, 3.95146650916255*^9}, 3.951467220326228*^9, {
   3.95146748725136*^9, 3.9514675358170424`*^9}, {3.951467581445314*^9, 
   3.951467595257019*^9}, {3.951467633295251*^9, 3.951467823541483*^9}, 
   3.951467868479622*^9, {3.951467931937364*^9, 3.95146793313251*^9}, {
   3.951472333605647*^9, 3.951472335186781*^9}, {3.951472365263262*^9, 
   3.951472368768124*^9}, {3.9515439223283777`*^9, 3.951543932575914*^9}, {
   3.951557476625897*^9, 
   3.9515574812944117`*^9}},ExpressionUUID->"54a8c1ed-ea4c-48f3-8ca0-\
31b66c1b5f4b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["FPrint and FTex commands", "Subsection",
 CellChangeTimes->{{3.951227276578141*^9, 
  3.9512272950223837`*^9}},ExpressionUUID->"0d7ca62e-6e69-4f36-a53a-\
dfb5b1d4f0f7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"FPrint", ",", "FTex"}], "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FTex", "[", 
    RowBox[{"setup_", ",", "expr_", ",", 
     RowBox[{"replacements_", ":", 
      RowBox[{"{", "}"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"prExp", "=", 
        RowBox[{"expr", "//.", "replacements"}]}], ",", "fields"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AssertFSetup", "[", "setup", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"RenewFormatDefinitions", "[", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"prExp", "=", 
       RowBox[{"prettyIndices", "[", 
        RowBox[{"setup", ",", "prExp"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"fields", "=", 
       RowBox[{"GetAllFields", "[", "setup", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"prExp", "=", 
       RowBox[{
        RowBox[{"prExp", "//.", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"Times", "[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "a_"}], "]"}], "]"}], ":>", 
             RowBox[{"Subscript", "[", 
              RowBox[{"#", ",", "a"}], "]"}]}], "&"}], ",", "fields"}], 
          "]"}]}], "//.", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", "a_", "]"}], ":>", 
            RowBox[{"Superscript", "[", 
             RowBox[{"#", ",", "a"}], "]"}]}], "&"}], ",", "fields"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"prExp", "//", "TeXForm"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FPrint", "[", 
   RowBox[{"setup_", ",", "expr_", ",", 
    RowBox[{"replacements_", ":", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FTex", "[", 
      RowBox[{"setup", ",", "expr", ",", "replacements"}], "]"}], "//", 
     "MaTeX"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.951227286303012*^9, {3.951228303119562*^9, 3.9512283513756*^9}, {
   3.951228389390807*^9, 3.951228426136969*^9}, {3.951228721777083*^9, 
   3.951228779050777*^9}, {3.951228815247923*^9, 3.9512289293188562`*^9}, {
   3.951228970431391*^9, 3.9512289803586397`*^9}, {3.951229222517618*^9, 
   3.951229333300802*^9}, {3.9512293650158653`*^9, 3.951229412171332*^9}, {
   3.951229444928987*^9, 3.951229582788172*^9}, {3.951229640384007*^9, 
   3.9512297215006104`*^9}, {3.9512297734391537`*^9, 3.951229881327454*^9}, {
   3.951229913367536*^9, 3.9512299416277037`*^9}, {3.951229977681635*^9, 
   3.951230059503622*^9}, {3.951230107314933*^9, 3.951230224783657*^9}, {
   3.9512302576264553`*^9, 3.951230266125228*^9}, {3.951230306720083*^9, 
   3.95123031791667*^9}, {3.951230514287863*^9, 3.951230519751683*^9}, {
   3.9512307119179*^9, 3.951230781095096*^9}, {3.951230845660459*^9, 
   3.951230852027361*^9}, {3.9512308966076593`*^9, 3.9512309257438374`*^9}, {
   3.9512319258913*^9, 3.951231987536601*^9}, {3.9512324462397842`*^9, 
   3.951232454463108*^9}, {3.951233522832571*^9, 3.951233545111067*^9}, {
   3.951233639456409*^9, 3.95123364193568*^9}, {3.9512887786122837`*^9, 
   3.951288780671873*^9}, {3.9513725915739727`*^9, 
   3.9513726300413218`*^9}},ExpressionUUID->"391fa561-d2b8-480b-bb8c-\
11da575eb488"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Diagram drawing", "Section",
 CellChangeTimes->{{3.93221911591842*^9, 
  3.932219119839135*^9}},ExpressionUUID->"e7b15865-c8ea-45b8-8460-\
46b36cdd33e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetEdgeRule", "[", 
    RowBox[{"setup_", ",", "vertices_", ",", "fields_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fermions", ",", "bosons", ",", "sel"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "obj", "]"}], "!=", 
          RowBox[{"Length", "[", "fields", "]"}]}], "||", 
         RowBox[{
          RowBox[{"Length", "[", "obj", "]"}], "!=", "2"}]}], ",", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Mismatch!\>\"", "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"fermions", "=", 
       RowBox[{"GetFermionPairs", "[", "setup", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bosons", "=", 
       RowBox[{"GetBosons", "[", "setup", "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"fermions", ",", 
           RowBox[{"fields", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "Infinity"}], "]"}], "&&", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"fermions", ",", 
           RowBox[{"fields", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "Infinity"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sel", "=", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{"fermions", ",", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"#", ",", 
                RowBox[{"fields", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "Infinity"}], "]"}], 
              "&"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"fields", "===", "sel"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{
             RowBox[{"obj", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "->", 
             RowBox[{"obj", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Return", "[", 
             RowBox[{
              RowBox[{"obj", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "->", 
              RowBox[{"obj", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"bosons", ",", 
           RowBox[{"fields", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "Infinity"}], "]"}], "&&", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"bosons", ",", 
           RowBox[{"fields", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "Infinity"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{"obj", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "<->", 
          RowBox[{"obj", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<fields \>\"", ",", "fields", ",", "\"\< not found!\>\""}],
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.932220245927902*^9, 3.93222026241581*^9}, {
  3.932220756703475*^9, 3.93222138145538*^9}, {3.932222427022163*^9, 
  3.932222533690036*^9}, {3.93227569458318*^9, 3.9322756958102665`*^9}, {
  3.9513250960927896`*^9, 3.951325107228447*^9}, {3.95132516117017*^9, 
  3.951325163928564*^9}},ExpressionUUID->"28c30a2a-e06f-4922-bd1e-\
bd070d89705e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeEdgeStyle", "[", 
    RowBox[{"style_", ",", "setup_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "corStyle", ",", "havePairs", ",", "allPairs", ",", "missingPairs"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"corStyle", "=", 
       RowBox[{"style", "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"a_", "[", 
            RowBox[{"c_", ",", "d_"}], "]"}], "/;", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"a", "===", "Rule"}], "&&", 
            RowBox[{
             RowBox[{"Head", "[", "c", "]"}], "=!=", "List"}]}]}], ":>", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Sort", "[", 
            RowBox[{"{", 
             RowBox[{"c", ",", 
              RowBox[{"GetPartnerField", "[", 
               RowBox[{"c", ",", "setup"}], "]"}]}], "}"}], "]"}], "->", 
           "d"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"corStyle", "=", 
       RowBox[{"corStyle", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"a_", "[", 
            RowBox[{
             RowBox[{"{", "c__", "}"}], ",", "d_"}], "]"}], "/;", 
           RowBox[{"a", "===", "Rule"}]}], ":>", 
          RowBox[{
           RowBox[{"Sort", "[", 
            RowBox[{"{", "c", "}"}], "]"}], "->", "d"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"havePairs", "=", 
       RowBox[{"corStyle", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"a_", "[", 
            RowBox[{
             RowBox[{"{", "c__", "}"}], ",", "d_"}], "]"}], "/;", 
           RowBox[{"a", "===", "Rule"}]}], ":>", 
          RowBox[{"{", "c", "}"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"allPairs", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#", ",", "#"}], "}"}], "&"}], ",", 
           RowBox[{"GetBosons", "[", "setup", "]"}]}], "]"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{"Sort", ",", 
           RowBox[{"GetFermionPairs", "[", "setup", "]"}]}], "]"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"missingPairs", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"allPairs", ",", 
         RowBox[{"Alternatives", "@@", "havePairs"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"corStyle", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"corStyle", ",", 
         RowBox[{"Thread", "[", 
          RowBox[{"missingPairs", "->", 
           RowBox[{
            RowBox[{"ColorData", "[", 
             RowBox[{"97", ",", "\"\<ColorList\>\""}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", 
              RowBox[{"Length", "[", "missingPairs", "]"}]}], "]"}], "]"}]}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "corStyle", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.93222598905088*^9, 3.932226152225779*^9}, {
   3.932226257397224*^9, 3.932226263968811*^9}, 3.932226423455982*^9, {
   3.932226524389546*^9, 3.932226579306307*^9}, 3.932227244378387*^9},
 CellLabel->
  "In[718]:=",ExpressionUUID->"c7cb9c1f-9864-4031-9307-761fb266e315"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"arcFunc", "[", 
    RowBox[{"g_", ",", 
     RowBox[{"r_", ":", "1.5"}]}], "]"}], "[", 
   RowBox[{"list_", ",", 
    RowBox[{"DirectedEdge", "[", 
     RowBox[{"x_", ",", "x_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v", "=", 
      RowBox[{"DynamicLocation", "[", 
       RowBox[{
        RowBox[{"\"\<VertexID$\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"VertexIndex", "[", 
           RowBox[{"g", ",", "x"}], "]"}], "]"}]}], ",", "Automatic", ",", 
        "Center"}], "]"}]}], "}"}], ",", 
    RowBox[{"Arrow", "[", 
     RowBox[{"BezierCurve", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "v", "}"}], ",", 
         RowBox[{
          RowBox[{"ScalingTransform", "[", 
           RowBox[{
            RowBox[{"r", " ", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], ",", 
            RowBox[{"list", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"list", "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{
             "5", ",", "8", ",", "10", ",", "16", ",", "18", ",", "21"}], 
             "}"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", "v", "}"}]}], "]"}], ",", 
       RowBox[{"SplineDegree", "->", "7"}]}], "]"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"arcFuncUn", "[", 
    RowBox[{"g_", ",", 
     RowBox[{"r_", ":", "1.5"}]}], "]"}], "[", 
   RowBox[{"list_", ",", 
    RowBox[{"UndirectedEdge", "[", 
     RowBox[{"x_", ",", "x_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v", "=", 
      RowBox[{"DynamicLocation", "[", 
       RowBox[{
        RowBox[{"\"\<VertexID$\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"VertexIndex", "[", 
           RowBox[{"g", ",", "x"}], "]"}], "]"}]}], ",", "Automatic", ",", 
        "Center"}], "]"}]}], "}"}], ",", 
    RowBox[{"Arrow", "[", 
     RowBox[{"BezierCurve", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "v", "}"}], ",", 
         RowBox[{
          RowBox[{"ScalingTransform", "[", 
           RowBox[{
            RowBox[{"r", " ", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], ",", 
            RowBox[{"list", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"list", "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{
             "5", ",", "8", ",", "10", ",", "16", ",", "18", ",", "21"}], 
             "}"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", "v", "}"}]}], "]"}], ",", 
       RowBox[{"SplineDegree", "->", "7"}]}], "]"}], "]"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.937888679881483*^9, 3.937888679882114*^9}, {
  3.937888831006722*^9, 
  3.9378888464197903`*^9}},ExpressionUUID->"8e5783ec-39b7-4065-a919-\
073dda296067"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PlotOneSuperindexDiagram", "[", 
    RowBox[{"diag_", ",", "setup_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ShowEdgeLabels", ",", "EdgeStyle", ",", "\[IndentingNewLine]", 
       "transformedDiag", ",", "vertices", ",", "edges", ",", "prefactor", 
       ",", "\[IndentingNewLine]", "externalLegs", ",", "externalIndices", 
       ",", "idx", ",", "field", ",", "partnerField", ",", "outerIdx", ",", 
       "externalLeg", ",", "\[IndentingNewLine]", "regulatorVertex", ",", 
       "curVertex", ",", "rules", ",", "corStyle", ",", "cross", ",", 
       "\[IndentingNewLine]", "explVertices", ",", "explEdges", ",", 
       "vertexShapes", ",", "vertexLabels", ",", "edgeLabels", ",", 
       "\[IndentingNewLine]", "graph"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AssertIsSuperindexDiagram", "[", "diag", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"EdgeStyle", "=", 
       RowBox[{"OptionValue", "[", "\"\<EdgeStyle\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ShowEdgeLabels", "=", 
       RowBox[{"OptionValue", "[", "\"\<ShowEdgeLabels\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"transformedDiag", "=", 
       RowBox[{"Map", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "#", "]"}], "===", "Association"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", "\"\<type\>\"", "]"}], "==", 
               "\"\<Propagator\>\""}], ",", "\[IndentingNewLine]", 
              RowBox[{"<|", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"\"\<Rule\>\"", "->", 
                 RowBox[{"GetEdgeRule", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<indices\>\"", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", "[", "\"\<indices\>\"", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<indices\>\"", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", "[", "\"\<indices\>\"", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
                   "setup"}], "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<Style\>\"", "->", 
                 RowBox[{"Sort", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<indices\>\"", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", "[", "\"\<indices\>\"", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], "]"}]}]}],
                "\[IndentingNewLine]", "|>"}], ",", "\[IndentingNewLine]", 
              RowBox[{"<|", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"\"\<Vertex\>\"", "->", 
                 RowBox[{
                  RowBox[{"#", "[", "\"\<indices\>\"", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<Style\>\"", "->", 
                 RowBox[{"#", "[", "\"\<type\>\"", "]"}]}]}], 
               "\[IndentingNewLine]", "|>"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "#"}], "]"}], "&"}], "\[IndentingNewLine]",
          ",", "diag"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"vertices", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"transformedDiag", ",", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Keys", "[", "#", "]"}], ",", "\"\<Vertex\>\"", ",", 
            "Infinity"}], "]"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"edges", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"transformedDiag", ",", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Keys", "[", "#", "]"}], ",", "\"\<Rule\>\"", ",", 
            "Infinity"}], "]"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"prefactor", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\"\<Prefactor\>\"", "/.", 
          RowBox[{"transformedDiag", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"externalLegs", "=", 
       RowBox[{"GetExternalIndices", "[", "diag", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"externalIndices", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"idx", "=", "1"}], ",", 
        RowBox[{"idx", "<=", 
         RowBox[{"Length", "[", "externalLegs", "]"}]}], ",", 
        RowBox[{"idx", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"field", "=", 
          RowBox[{"externalLegs", "[", 
           RowBox[{"[", 
            RowBox[{"idx", ",", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"partnerField", "=", 
          RowBox[{"GetPartnerField", "[", 
           RowBox[{"field", ",", "setup"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"outerIdx", "=", 
          RowBox[{"Unique", "[", "externalLeg", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"externalIndices", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"externalIndices", ",", 
            RowBox[{"{", "outerIdx", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"vertices", "=", 
          RowBox[{"vertices", "\[Union]", 
           RowBox[{"{", 
            RowBox[{"<|", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\"\<Vertex\>\"", "->", 
               RowBox[{"{", 
                RowBox[{"{", "outerIdx", "}"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<Style\>\"", "\[Rule]", 
               RowBox[{"externalLeg", "[", "field", "]"}]}]}], 
             "\[IndentingNewLine]", "|>"}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"edges", "=", 
          RowBox[{"edges", "\[Union]", 
           RowBox[{"{", 
            RowBox[{"\[LeftAssociation]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\"\<Rule\>\"", "\[Rule]", 
               RowBox[{"GetEdgeRule", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"externalLegs", "[", 
                    RowBox[{"[", 
                    RowBox[{"idx", ",", "2"}], "]"}], "]"}], ",", 
                   RowBox[{"{", "outerIdx", "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"field", ",", "partnerField"}], "}"}], ",", 
                 "setup"}], "]"}]}], ",", 
              RowBox[{"\"\<Style\>\"", "\[Rule]", 
               RowBox[{"Sort", "[", 
                RowBox[{"{", 
                 RowBox[{"field", ",", "partnerField"}], "}"}], "]"}]}]}], 
             "\[IndentingNewLine]", "\[RightAssociation]"}], "}"}]}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"regulatorVertex", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"idx", "=", "1"}], ",", 
        RowBox[{"idx", "<=", 
         RowBox[{"Length", "[", "vertices", "]"}]}], ",", 
        RowBox[{"idx", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"curVertex", "=", 
          RowBox[{
           RowBox[{"vertices", "[", 
            RowBox[{"[", "idx", "]"}], "]"}], "[", "\"\<Vertex\>\"", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "curVertex", "]"}], ">", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rules", "=", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "->", 
                 RowBox[{"curVertex", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", 
               RowBox[{"curVertex", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ";;"}], "]"}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"vertices", "=", 
             RowBox[{"vertices", "/.", "rules"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"edges", "=", 
             RowBox[{"edges", "/.", "rules"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"vertices", "[", 
           RowBox[{"[", "idx", "]"}], "]"}], "=", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<Vertex\>\"", "->", 
             RowBox[{
              RowBox[{
               RowBox[{"vertices", "[", 
                RowBox[{"[", "idx", "]"}], "]"}], "[", "\"\<Vertex\>\"", 
               "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"\"\<Style\>\"", "->", 
             RowBox[{
              RowBox[{"vertices", "[", 
               RowBox[{"[", "idx", "]"}], "]"}], "[", "\"\<Style\>\"", 
              "]"}]}]}], "|>"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"vertices", "[", 
              RowBox[{"[", "idx", "]"}], "]"}], "[", "\"\<Style\>\"", "]"}], 
            "==", "\"\<Regulatordot\>\""}], ",", 
           RowBox[{"regulatorVertex", "=", 
            RowBox[{
             RowBox[{"vertices", "[", 
              RowBox[{"[", "idx", "]"}], "]"}], "[", "\"\<Vertex\>\"", 
             "]"}]}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"corStyle", "=", 
       RowBox[{"MakeEdgeStyle", "[", 
        RowBox[{"EdgeStyle", ",", "setup"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
      RowBox[{
       RowBox[{"cross", "[", "r_", "]"}], " ", ":=", " ", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", " ", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"r", " ", "/", " ", 
                RowBox[{"Sqrt", "[", "2", "]"}]}], ",", " ", 
               RowBox[{"r", " ", "/", " ", 
                RowBox[{"Sqrt", "[", "2", "]"}]}]}], "\n", "            ", 
              "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "r"}], " ", "/", " ", 
                RowBox[{"Sqrt", "[", "2", "]"}]}], ",", " ", 
               RowBox[{
                RowBox[{"-", "r"}], " ", "/", " ", 
                RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}]}], "}"}], "]"}], 
          ",", " ", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"r", " ", "/", " ", 
                RowBox[{"Sqrt", "[", "2", "]"}]}], ",", " ", 
               RowBox[{
                RowBox[{"-", "r"}], " ", "/", " ", 
                RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}], ",", "\n", 
             "             ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "r"}], " ", "/", " ", 
                RowBox[{"Sqrt", "[", "2", "]"}]}], ",", " ", 
               RowBox[{"r", " ", "/", " ", 
                RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}]}], "}"}], "]"}], 
          ",", " ", 
          RowBox[{"Circle", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", "r"}], "]"}]}], 
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"explVertices", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", "\"\<Vertex\>\"", "]"}], "&"}], ",", "vertices"}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vertexShapes", "=", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"regulatorVertex", "->", 
          RowBox[{"cross", "[", "1", "]"}]}], "}"}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vertexLabels", "=", 
       RowBox[{"Map", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", "\"\<Vertex\>\"", "]"}], "->", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", "[", "\"\<Style\>\"", "]"}], "/.", 
             RowBox[{
              RowBox[{"a_", "[", "b_", "]"}], ":>", "b"}]}], ")"}]}], "&"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"Select", "[", 
          RowBox[{"vertices", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", 
              RowBox[{"#", "[", "\"\<Style\>\"", "]"}], "]"}], "===", 
             "externalLeg"}], "&"}]}], "]"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"explEdges", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"#", "[", "\"\<Rule\>\"", "]"}], ",", 
            RowBox[{
             RowBox[{"#", "[", "\"\<Style\>\"", "]"}], "/.", "corStyle"}]}], 
           "]"}], "&"}], ",", "edges"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"edgeLabels", "=", 
       RowBox[{"If", "[", 
        RowBox[{"ShowEdgeLabels", ",", "\[IndentingNewLine]", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", "\"\<Rule\>\"", "]"}], "->", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{
                RowBox[{"#", "[", "\"\<Style\>\"", "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{
                RowBox[{"#", "[", "\"\<Style\>\"", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "&"}], ",", 
           "edges"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"prefactor", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"graph", "=", 
           RowBox[{"Graph", "[", 
            RowBox[{"explVertices", ",", "explEdges"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Graph", "[", 
           RowBox[{"graph", ",", "\[IndentingNewLine]", 
            RowBox[{"VertexShape", "->", "vertexShapes"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"VertexLabels", "->", "vertexLabels"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"VertexSize", " ", "->", " ", 
             RowBox[{"{", 
              RowBox[{"regulatorVertex", " ", "->", " ", "Medium"}], "}"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"EdgeLabels", "->", "edgeLabels"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"EdgeShapeFunction", "->", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"x_", "\[DirectedEdge]", "x_"}], ":>", 
                RowBox[{"arcFunc", "[", 
                 RowBox[{"graph", ",", "20.0"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"x_", "\[UndirectedEdge]", "x_"}], ":>", 
                RowBox[{"arcFuncUn", "[", 
                 RowBox[{"graph", ",", "20.0"}], "]"}]}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PerformanceGoal", "->", "\"\<Quality\>\""}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "}"}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "PlotOneSuperindexDiagram", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<ShowEdgeLabels\>\"", "->", "False"}], ",", 
      RowBox[{"\"\<EdgeStyle\>\"", "->", 
       RowBox[{"{", "}"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotSuperindexDiagram", "[", 
    RowBox[{"diags_List", ",", "setup_", ",", "a___"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"AllTrue", "[", 
         RowBox[{"diags", ",", "TestIsSuperindexDiagram"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Return", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"PlotOneSuperindexDiagram", "[", 
              RowBox[{"#", ",", "setup", ",", "a"}], "]"}], "&"}], ",", 
            "diags"}], "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TestIsSuperindexDiagram", "[", "diags", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Return", "[", 
          RowBox[{"PlotOneSuperindexDiagram", "[", 
           RowBox[{"diags", ",", "setup", ",", "a"}], "]"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "Print", "[", 
       "\"\<PlotSuperindexDiagram: diagram argument is not a superindex \
diagram or a list thereof!\>\"", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.932219378410387*^9, 3.932219401729917*^9}, {
   3.93221953711088*^9, 3.932219765506566*^9}, {3.9322197975555973`*^9, 
   3.932219915119028*^9}, {3.932219948668961*^9, 3.932220037797441*^9}, {
   3.932220069658774*^9, 3.932220137491227*^9}, {3.9322201763651667`*^9, 
   3.9322201929662743`*^9}, {3.932220271925158*^9, 3.932220449223991*^9}, {
   3.932220485232848*^9, 3.93222054677315*^9}, {3.932220624210702*^9, 
   3.932220682865519*^9}, {3.932222567077874*^9, 3.9322226499775*^9}, {
   3.932222690915005*^9, 3.932223017840479*^9}, {3.932223051771912*^9, 
   3.93222311557379*^9}, {3.9322231613609743`*^9, 3.932223193688582*^9}, 
   3.932223228399946*^9, {3.932223263351158*^9, 3.932223327794436*^9}, {
   3.932223373121641*^9, 3.93222340385354*^9}, {3.932223508763092*^9, 
   3.932223745204699*^9}, {3.932223823122708*^9, 3.932223945621051*^9}, {
   3.9322240032179317`*^9, 3.932224413151188*^9}, {3.932224477128537*^9, 
   3.9322245624636717`*^9}, {3.932224611895343*^9, 3.932224746549252*^9}, {
   3.932224788585619*^9, 3.93222510682532*^9}, {3.932225153292159*^9, 
   3.932225313526149*^9}, {3.932225356970504*^9, 3.9322253683994627`*^9}, {
   3.9322254419062223`*^9, 3.932225766512817*^9}, {3.9322258658791027`*^9, 
   3.932225979474358*^9}, {3.932226584137904*^9, 3.932226593179884*^9}, {
   3.932226639139077*^9, 3.9322270766431427`*^9}, {3.932227127933094*^9, 
   3.932227347459678*^9}, {3.932227389012507*^9, 3.932227462375696*^9}, 
   3.932227663126498*^9, {3.932227999039544*^9, 3.932228015763687*^9}, 
   3.932233340123426*^9, {3.932362656898089*^9, 3.932362709916745*^9}, 
   3.9323627677445793`*^9, {3.932362803784634*^9, 3.932362888754656*^9}, {
   3.9323631075772953`*^9, 3.93236311162749*^9}, {3.937887828538536*^9, 
   3.937887829451497*^9}, {3.937888066281293*^9, 3.937888069352133*^9}, {
   3.9378882926004333`*^9, 3.937888321935026*^9}, {3.937888401380849*^9, 
   3.9378884061482162`*^9}, {3.937888436367538*^9, 3.9378884679944897`*^9}, {
   3.937888582269229*^9, 3.9378885852994013`*^9}, 3.9378886507737913`*^9, {
   3.9378886927318993`*^9, 3.937888749111827*^9}, {3.9378887913245783`*^9, 
   3.937888809747817*^9}, {3.9378888536807003`*^9, 3.9378888773410063`*^9}, {
   3.9378889543380957`*^9, 3.9378889848208847`*^9}, {3.937889017955717*^9, 
   3.9378890886802893`*^9}, {3.937889187034604*^9, 
   3.937889253275118*^9}},ExpressionUUID->"444a0240-f744-45ec-873c-\
53bebba48ccd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing", "Title",
 CellChangeTimes->{{3.9508681098093233`*^9, 
  3.950868110913395*^9}},ExpressionUUID->"7a24c792-7a48-4e73-8b88-\
7b56966e439b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fields", "=", " ", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<cField\>\"", "\[Rule]", " ", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"p", ",", 
          RowBox[{"{", 
           RowBox[{"v", ",", " ", "c"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Phi]", "[", "p", "]"}], ",", 
          RowBox[{"\[Phi]x", "[", "p", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Grassmann\>\"", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cb", "[", 
          RowBox[{"p", ",", 
           RowBox[{"{", "c", "}"}]}], "]"}], ",", 
         RowBox[{"c", "[", 
          RowBox[{"p", ",", 
           RowBox[{"{", "c", "}"}]}], "]"}]}], "}"}], "\[IndentingNewLine]", 
       "}"}]}]}], "\[IndentingNewLine]", "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"masterEquation", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"A", "[", "x", "]"}], 
        RowBox[{"VBasis", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", "A"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "x"}], ",", 
            RowBox[{"-", "y"}]}], "}"}]}], "]"}], 
        RowBox[{"A", "[", "y", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"cb", "[", "x", "]"}]}], 
         RowBox[{"VBasis", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"cb", ",", "c"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "x"}], ",", 
             RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], ",", 
        RowBox[{"c", "[", "y", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Setup", "=", 
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<MasterEquation\>\"", "->", "masterEquation"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<FieldSpace\>\"", "->", "fields"}]}], "\[IndentingNewLine]",
      "|>"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TakeDerivatives", "[", 
    RowBox[{"Setup", ",", "\[IndentingNewLine]", 
     RowBox[{"FEq", "[", "\[IndentingNewLine]", 
      RowBox[{"FTerm", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Propagator", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"AnyField", ",", "AnyField"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}]}], "]"}], 
        RowBox[{"Rdot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"AnyField", ",", "AnyField"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
       "]"}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"A", "[", 
       RowBox[{"p", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}]}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], "//", 
  RowBox[{
   RowBox[{"FPrint", "[", 
    RowBox[{"Setup", ",", "#"}], "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.9507856762700357`*^9, 3.9507858002547617`*^9}, {
  3.9509731139899683`*^9, 3.950973140087144*^9}, {3.9512274397433567`*^9, 
  3.951227441558628*^9}, {3.951227486267386*^9, 3.951227497450511*^9}, {
  3.951227632078931*^9, 3.951227677663128*^9}, {3.951228330842969*^9, 
  3.951228340299478*^9}},
 CellLabel->
  "In[505]:=",ExpressionUUID->"2632f66f-a425-44c8-b21c-333bdd8417c4"],

Cell[BoxData[
 GraphicsBox[
  {Thickness[0.007666947788085562], 
   FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1,
     3, 3}}}, {{{9.29219, 8.2875}, {9.29219, 8.526560000000002}, {
    9.065629999999997, 8.526560000000002}, {8.898439999999999, 
    8.526560000000002}, {2.3859399999999997`, 8.526560000000002}, {
    2.2187499999999996`, 8.526560000000002}, {1.99219, 8.526560000000002}, {
    1.99219, 8.2875}, {1.99219, 8.04844}, {2.2187499999999996`, 8.04844}, {
    2.3859399999999997`, 8.04844}, {8.898439999999999, 8.04844}, {
    9.065629999999997, 8.04844}, {9.29219, 8.04844}, {9.29219, 8.2875}}}], 
   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0,
     1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
    0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 
    1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIlIGYC4mgFx4/JMoYOMybwV5l1qzqcAQMDh/8gcF/L
ITP/Q+vJKaoYfBbOLvlkPS0IzacG53vsr5W1OK4O588EgZvqDhLz4jRPf9CE
85nB+hD8NgV21TNXJOD8vohuf0YBcbh5X/Z93Jo+TQxuH4wPcw8638QYBEQh
+tXVHKru/7hl7C3qMGeR8s4/7hpwvtzyFx56/xF8nxPstrOvasL5x3ft6GX7
oA3nP4gQ335xgQ7cfBgfZn98SJD6gpfacD7MPBi//rdVwbkTmg4an1ReztIU
h/OD317+OOOhBJw/AxQOlppw/o+3rw9YMmvBzYOFr8TUK5wZj7QQfFA4F+jC
+cVbRX+fjjOA80HOZVhn4OB3cWLMv8caDhpvefcZ3DSAxz96egAAjjnr7A==

    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
     0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1,
      3, 3}}, {{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {CompressedData["
1:eJxTTMoPSmViYGBwAGIQPSG4RGX6enOH67y3xVLNOB1g/DkzgUCSy+GOdE2i
0VQE/0CtrEV6CRqfBcGXmHqFM4PJ3OF57ePs82u4HDbq5S1m/GPm0CBey5rp
xuOg+qR53tkoMweQ8pkvFRwMtFYKXwgxczAGAWdFh4Nty8NPBZk5/AeBeEWQ
MxkYDBB8h6ZHx2dwI/hPEhdeM/lv6sAfG3DfyFzR4RBI/ydTh7VCOnzpfFDz
hIwdvuz7uDV9Gr/DbZB/tho59Ed0+zN+4HL48630wZxEI4czIODD5ZAce8eN
WcII7p/F9/fxzWE2clD/pPJyFieXw/QJ/FVmrw0dtnttsJjzkxPOP9i9r8nk
MQecD/bPZg6I+94bQtz7n93h84aA7FnsRnA+t5tqKZMUgp+eBgRqRg59IPcZ
cMDdC+OD48feGM4v2Sr6+3SeMVx/7W+rgnMVCL4JyB3NCD7Yvwsx+bD4h/Fh
/m1kOdpv2G4MDw9wONUg+MtfeOj9DzR24HHk85qhCVWvbgyPfxjf/4nnJVNh
HjhfA2w+LyQ8zI0d7Esca0/f4XU4fdhpbWYc1D3b+B3qQf55YewQoxohcy5G
2OELSL24GZwPTm9OZhB/fuaG80uWl2z4x8/tECG+/SKDnBncvZEg/j5TOB8c
P/MRfHB6bMHkw+IXxj8A5d8Q+uR4vs0UHp6fQO5bjuCD0/8eBB+c7jnNHGQ2
is1nUuCApGdpM3h8xig4fkyeg+AvAaW/YHM4H5Q80srM4eZB7EfwwemhD8GH
5Wd0Piy+AR2Fz5Q=
     "], {{22.060899999999997`, 5.10313}, {20.0766, 5.10313}, {
     21.726599999999998`, 7.72344}, {22.060899999999997`, 5.10313}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0,
      1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{0, 2, 
     0}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGBQAGIQvUUvbzHjHyuHB67xjrMEJRxg/PsgvqGEg/pb3n0G
P60cWhXYVc+USDg8SVx4zeQ+gj9lAn+V2WkEPyX2jhvzCSuHvohuf8YACYfl
Lzz0/h+0ckhPAwI2CQefixNj/k22cmAAAQcxhx6vVywmilYOZ8BA1EH9SfO8
s7cs4XyQtrQ2BP/UYae1mXaWDiKVk0rOpog5LL6/j2+OsKVD0NvLH2c4ijuo
gvVbQPiJEnD+l30ft6Z/k4Tz37TldhvNlnI4ATLvnBWc/x8E3iP4sPBA58vv
WrAvVU8azk8F+0/WYYv5j0Mpu6wc1gjp8KXfk4fI77GE871PsNvOfmoB588E
AU8Lh15weMnC+f0gfoEUnH8W5P0ccQj/J8w/Ig5/vpU+mHPREs4PF99+kWGd
FZwPc1/l/R+3jLvFHdDjGwBBP+jn
     "], {{26.5484, 6.831250000000001}, {24.867199999999997`, 
     6.831250000000001}, {24.9328, 7.632809999999998}, {25.4828, 7.77656}, {
     25.728099999999998`, 7.77656}, {26.499999999999996`, 7.77656}, {
     26.542199999999994`, 7.00469}, {26.5484, 6.831250000000001}}}], 
   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0,
     1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 
    3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
    0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJpIGYC4qdZ2t+m19o6mBiDgKgDjB/y9vLHGYpiDj1e
r1hMAhF88alXODMu2WDwq+7/uGWcjeB/2fdxa7qZOJx/W1N2zf/DinD+TBDQ
VILz1wrp8KX7KcHtg/Fh7kHn78mveTvzqJKDzwl229mtNg4zQObtVHJ4DpLv
tYbLw/gw/RxuqqVMuxB89be8+wwsbTD4MPfB+DD3w/gw/8H4MP/D+LDwgdkH
48Pcg86HhT/MP2DzvBHxAZMHAFCds8s=
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 3}, {
     0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3,
      3}, {0, 1, 0}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGCQBWIQHSG+/SLDNAcH4cpJJWddJB1g/Jr7P24Zv5ZykHf8
mHym1MEhPQ0Inkk7iE+9wpmR5eAQ8vbyxxmOMg6VEStMz0Y7OPRGdPszbpBx
8D7Bbjvb1MHhTVtut1G0rMPyFx56/yUdHL7s+7g1/ZqswxvefQYzgxwc/oPA
fDmI+loHhzNgIA/nG4PAYQU4P5xTrN34vaLDTemaRCNdB4e1Qjp86X1KDipP
mued3WUP54Pdz4fgp8TecWOusIPw9ynC+e8XrVc426EA54PdN03e4brQJ8fz
2+wg/imQg/C/2cHdv8X8x6EUK3uHGNUImXM2sg43QO65aucgAgq/JTIOV0Hq
3ewg/vGRhvMPdu9rMnksAeeDzRMTc0gFhSubvYMJyL+bRSDu2YHgX86PZz/n
6ADnw+IHbP8cMQf0+AMAKa/BYg==
     "], {{32.64529999999999, 8.374999999999998}, {32.64529999999999, 
     7.914059999999999}, {32.1484, 7.668749999999999}, {31.981299999999994`, 
     7.5843799999999995`}, {31.1203, 8.05156}, {31.107799999999994`, 
     8.057809999999998}, {30.80309999999999, 8.225}, {30.80309999999999, 
     8.499999999999998}, {30.80309999999999, 8.889059999999999}, {
     31.27659999999999, 9.081249999999999}, {31.7188, 9.081249999999999}, {
     32.184400000000004`, 9.081249999999999}, {32.64529999999999, 8.82344}, {
     32.64529999999999, 8.374999999999998}}, {{32.78909999999999, 6.10781}, {
     32.78909999999999, 5.63438}, {32.2391, 5.389060000000001}, {
     31.729699999999994`, 5.389060000000001}, {31.1734, 5.389060000000001}, {
     30.659399999999994`, 5.7125}, {30.659399999999994`, 6.22188}, {
     30.659399999999994`, 6.7296900000000015`}, {31.137500000000003`, 
     7.064060000000001}, {31.467200000000005`, 7.184380000000001}, {
     32.33440000000001, 6.706250000000001}, {32.4609, 6.628129999999999}, {
     32.78909999999999, 6.4484400000000015`}, {32.78909999999999, 6.10781}}}],
    FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {
    1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 
    1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGI9IGYC4o16eYsZY5wczoDAGkmHzxsCsmfZI/iR4tsv
Mtg5OXze93FrepikQ3oaEJg5ORzs3tdkcljc4XdM7tF/Wk4ODCDQIO7gfYLd
draqk8Obttxuo2hxiHnPHeF8sLl3EHywel9HVPXrHR3c1xxdznBD0mEmCJx0
dIhRjZA5VyPlIO/4MfkMr5ODSOWkkrMsMnD7wPJ7ZBwmf2OLn2Hj5NCqwK56
pkTWAdV/cnA+2L0GCnD+WiEdvvR1ig7CnxzPp7FC+X1KDsVbRX+fnucI54PV
2yD4TxIXXjP57gBxZ6cinO88oVkoLUsBzgf7b7a8w38QEHd0+AIKzzJ5Bx7/
9VNSFRB8+6ZHx2cYI/gX8+PZz3k6Qvz7BMFf+e1lxZkEBTj/jqbsmv+LFRyO
a1pNOm3v6JAKiic2RQf9CQt+GMoh+GB5fUeHThvPXWmLFCHxGefowB8bcN9I
XMkhm/PngvTJCH5FxArTs48R/Pk2Oldm8TlB4kdDEc6HhSeMDwvvN7z7DGa+
cnSQ3bVgX+o7GQfWxZOsGLc6QuxNk4bE938HSHyZiEHcBwwvD5D5P0Th4ffA
Nd5x1kcE38QYBEQd2peHnzJycYLz0dMzAMnFM0w=
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 
    3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
    1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxd031IU1EUAPA3s4aBg3QfDtt6T7ZKErG2YAyDs92tRkGLklgQGOE+KmxR
CzFchtKgFiOG0baiIguDCo3SPhmCiIbOGIp/VNCyIA1XuuwDRq3d9/beBQ/c
P37c+94999xzmcPevc4VFEWJ8sOUH0X5MehXGdz1FvgRX+x371cC7yVseSVE
cayxgOrFrbjz21pwu/IxgEDaGvYl7qgge7B5+F+mYIsaHtUe7xZpLDDOxjrB
KWujKfaRFsz+Z5rh/B7Bw7IaiTtUBRSOc8TsuvXEiitTJZ4ZMyzc7qUTs4zg
lqEBazRNC0aXO8tcR2mAjpmRSNYMr7xt6aiV5vJdjQSf6pdlx9TE7HodggRO
v414x4PhHmqW2Inz2s7AfGm8LlqFuP39DDgUT5OUBHF1u8BAz6ytNre54Ooq
WOrbcyzWQnyzvmYqdpZ416h427W7y+anEeRwfGAE8/Xk/R3Xw0CDD58njqCJ
rZsaUnHJdd1JBA3pycWISA1dv1Y1RpoQzAeag1uyKhitNobH7Khwvypo8Gmu
5mzEl3Z+LdabEGzIaOZicyrwZ40nJgwIBoPxDv0nYrYeAWK2HzTke97sfe4m
1n7uvJE4Q9zquLc18ZL4+duLf51fEDzbZ3TkRioF8/3KO0CLteNP5LCyO2wU
9SOgcf4hGRRj+4lL7b1dTg/xoaHJTU4lAr0uH49lcD/4zkP9Nhf6X8H1sRRB
yBG0i+oUEMTnYQrfTxCfx/v7KgSXs+9ByfWXpHBfSSWUZ0xvXD/NgttxvVLE
SW+jeOK1mav3EWL2/O4KwRvxfIkcDuB+U/P5S7l6tBNbtaeLYgvE/Pu24X7+
I4fl7/8/KUvAcA==
    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
     0}}}, {CompressedData["
1:eJxTTMoPSmViYGAwBmIQLTH1CmfGJjeHGNUImXN7eB1g/LVCOnzp8wQcVJ80
zzs7CZMPUw/jy2wUm8+kwO3g0PTo+IxmN4c5M4FAkstBb8KCH4Z5CD6v//op
qR6YfI1PKi9ncfLC+TDzYXyw/XWiqPx5Eg6fNgRkz3ru6vBl38et6WZSDmog
93Qh+Log+83Q5F+5ONx3jXecZSgJ54PlxcTh/JC3lz/OUBRzsLh2NNeEwdVB
YdeCfal9og5vePcZzJRC8J8kLrxmYo4m7+Xq8ABsvhicD5bnE0eVvyjuYGIM
BNauDtEg/8ZIOJwBARVXB5HKSSVnWyTg6h+C1AdKOoCCbWYjgl/326rgXAeC
fyk/nv3cQQT/T0zu0X+/XB1A1hgLS8D5YP+WicL5YHMrRRxOaFpNOr3f1SEI
5P9EEYcczp8L0qtdHXYGW0X8dxdxaFsefsrIxBUSPzHCkPRyy8UhPQ0I1IQc
QkpUpv8/4QLxh48AnM8AAg18cH6TeC1rJhsnRNzA1cGuxLH2dAy7A8iYtDIE
H+y/Awh+yVbR36ffuTps99pgMecnp8NN6ZpEI1Y3hxaQeW08Dg/28c0x5kKk
L0h4ujn0RXT7M25gh/gzEMGvjFhhejYawYelfzD/A4IPS48AvjBUfQ==
     "], {{43.96090000000001, 4.1234399999999996`}, {43.96090000000001, 
     3.3499999999999996`}, {43.30779999999999, 3.14375}, {42.98909999999999, 
     3.14375}, {42.574999999999996`, 3.14375}, {42.2234, 3.42188}, {42.2234, 
     3.8046899999999995`}, {42.2234, 4.32969}, {42.7172, 4.871880000000001}, {
     43.96090000000001, 4.912500000000001}, {43.96090000000001, 
     4.1234399999999996`}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1,
      3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 
     3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGAQA2IQPRMEGD0dgt9e/jjjoZADjJ8GAs/EHFxVS5lmzfBw
OAMCPFIObcvDTxnJIPgOTY+OzzjtDudfzI9nPzfT3UF+14J9qeskHHj9109J
7XB3eNOW220kjeCvFdLhS+dTdOAB8T+4OTxwjXec9VABzq++/+OWcbSCg4Lj
x+Qzpu5wfqT49osMdlD9dgg+2P43cnD+fzBgd/A5wW47OxbBf7CPb45xk7uD
iTEQfOZ2UH3SPO/sLHcH9U8qL2ed5HR4w7vPYOYpdwe7Esfa0zHsEH38HnB+
4uHL2qkTEXxYeNmC+HN4HdDDEwA8laFv
     "], CompressedData["
1:eJxTTMoPSmViYGCQAmIQvab7dgbDcg8H9U8qL2e9FHKA8eV3LdiXqofgf933
cWv6NX6H+/v45hg3eTh8AfN5HIQ+OZ5Pi/Vw2O61wWLOT04H7xPstrN1PRzS
QECN02GDXt5iRh4E/09M7tF/t9zh/Acg8za5O8SoRsic28Pl8GVDQPas6e4O
W0HmWfI65HD+XJDe7e7QG9Htz1jAB+czgEADgn+d97ZY6jZ+OP+Ba7zjLEEx
OP8MCKxB8KPA9ok5qD5pnnd2lrtDH8j8AHEHHv/1U1J3uDtEg+RrJBwsrh3N
NXnh7rAj2Criv7qkg+6EBT8MxTzgfGMQ8Ebwf4H8V+ThUHX/xy1jbQmHnbe6
/qa2Q8PLTNzBVbWUadYMD4c3bbndRtFi8PAF+99G1AE9PgAHJbDX
     "]}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
     3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJzIGYC4g16eYsZp/g4+Jxgt529VcVhPRr/De8+g5mT
fBzSQOCZisMZEGjB5KdC+UtfeOj9r0TIr+m+ncFQ7uOwQfVJ87yzKg5g+0p8
HMxs9gZNO6gC0Wfn43DfNd5xlqKyg6tqKdMsAR+HByB+o6LDjJlA8NMbwt+o
4PAnJvfov1veDjGqETLnbOQd3EHqV3g7bA+2ivjPLu0g8MnxfNpSbwcGEEiQ
dZCYeoUzY5E3xJ42BQfza0dzTTK8HcoPb3OduVYJYr6nt0M4p1i78X1liL9F
vR1+vn19wFJZ1SFcfPtFhmVecP5ykP9eesL52Zw/F6Q3ezoYg0CyIpx/W1N2
zf/DCnA+OJx6FBz0Jiz4YdiH4IODZRKC7wLyzwJM/odF6xXOzoC6fwWU/wLK
P+HpcAdkX7KSw/19fHOMtbwg/p+g7GDf9Oj4jMkIPsz/MH7JVtHfp9u8Hb7s
+7g1fZs8nP+mLbfb6LcUnD8THA/iDu3Lw08Z1Xg7eKw5upzhhxgkPoq8HQ52
72syYRZziACFV5i3w1mQ+3mEHXJA/lf2dvgPAvZccH7AE89LppPZ4Xywf8+w
QdSpezuYgMLzMyvEPhMEH0x7I/ghJSrT/0dA3SfJ6XAhP579XKa3w4vax9nn
3/A4zLfRuTKrz9uh+v6PW8arhRw+bAjInjXd20GkclLJ2SMiDjtudf1Nne/t
oLBrwb7UdWKQ9LnE26FNgV31zBVxiP9+IcIHln5Vrj0KZpij7DAXZH6dDyQ9
/VV2gOUncPpYrOKAnr8AUBOF9A==
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{
     0, 2, 0}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGBQAGIQPWMmEDT6OZzYtaOXLUDNAcZnAIEENYe5NjpXZtX5
OdT+tio416HmEH/4snZqIYKvO2HBD8M0BH+DXt5ixhQ/h1fFW0V/Z6s5LH3h
ofc/0c9BtMfrFUuImoPIJ8fzabZ+DnMWKe/8c1zFwecEu+3sp74QfXtUHEyM
geAygi8AUr8UwQe7p8zX4e+30gdzBFUd/oNAOFBe9UnzvLOqDgkg91n6wt0D
44Ple9Xh/Nkg+9k1HFgWT7JiTPWD8+2bHh2fUY3gw8IDnZ8GBgi+zLw4zdMX
NB2+bAjInuXv52BuszdoWqM2xH37feF8sP2OCD7YP/d8HF5kaX+bflcTzv/1
9vUBy8fqcL4XKJyuqjqcAQEfX4h6WxWHG9I1iUZnEXywej8/OB/mvsBbQIWf
VB3Q4xsAk+rp+w==
     "], {{60.4719, 12.2234}, {58.45629999999999, 12.2234}, {
     58.528099999999995`, 13.3391}, {59.20469999999998, 
     13.529699999999998`}, {59.49999999999999, 13.529699999999998`}, {
     60.43129999999999, 13.529699999999998`}, {60.462500000000006`, 
     12.4063}, {60.4719, 12.2234}}}], 
   FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1,
      3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
     0}, {0, 1, 0}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}, {1, 3, 3}, {0, 1, 0}}}, {CompressedData["
1:eJxTTMoPSmViYGCQAmIQfQYEHAIc0tNAgMkBxmcAgQYWh/v7+OYYyyH4hy9r
p0pKBTiYGAPBZwTf/4nnJVNhDji/N6LbnzFA3qF9efgpozn+Dl/2fdya/k0O
zlf/pPJy1ktZhxkzgeAhgn8hP5793Et/iP4NCP5/EJCXgfN3BFtF/E8XdQgX
336R4Zi/Q4xqhMy5OWIOuhMW/DCc5g9xr4O4Q4/XKxaTRAQfYp8fnM/rv35K
aoGfgwbIfk0ROP8sKBx4BOD8JbeWPzZ05nBIBQXTNSj/MKPDmu7bGQzh/nD+
n5jco/8mIfgsiydZMR71h4RrD7PDXBudK7Oe+Tu0iNeyZh5jhfNh6tHjAwAs
KbAe
     "], CompressedData["
1:eJxTTMoPSmViYGAQB2IQPddG58qsZ/4OZ0DAh8sBxk8DATVOVP4zDocdt7r+
pl73d5DZKDafaQG7g+qT5nlnd/k7BDzxvGQqzOqwQS9vMWMP1LweZoctIH4M
gn9DuibRSBfB31sra5HOgtBfHrHC9OxrP4e+iG5/xgJ2B17/9VNSL/g5vKh9
nH3+DaeDiTEQnPZz0Pik8nIWJy+cL1w5qeQsiwCcv1ZIhy/9nqDDfpD5V/wg
9ukIw80H6/cUgdvvsebocoYKUYe7+/jmGBv5O7xpy+02ihZz0J2w4IdhGoL/
JHHhNZPpCP5/EDju7+AG0j9DFB5evSD3fxB2QA9fAJWoovU=
     "]}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1,
     3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 
    3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
    1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 
    3}, {1, 3, 3}}}, CompressedData["
1:eJx11H0s1GEcAPBDo3/SFue8hLu5k3PKu0m1fdWEUu73MG6jLDqv6Wq0yImR
rPyhVOOOTLWieV1NlupiZprXTNTURibcsEompdI9v9/d79mynu3547Pn/ft8
n0cQr0ByEw6HY6SrUbpqrKu8EOkv61IESYm6MsYHg71xsRDA0/Grv+XFxIo4
s0GbImK7+Sk/2yxiFS4pCLYek054mQkgS1bnOxBDXEiF3s73IrZYChxKHKbY
8XR7LzHd3rnRLxTKRdV9Puvghu5aTjIf3nan++T3UFCyN7Q9MX6jF7ZoPFTj
xA0l75M5PLTBD1e0Wf0exFkTq+Pe9Y5Qr/d5vcUBZX15mxEosftsQcZrG+b8
pGD+cnqJV4wNzLU1m8x+oIDfXqORN1mBBPevoaCIbybqv8ll4ptBTM/nT0yP
fyeFxm1u5kkXeaw7SjQFPl2OrHPw+jkCCHewSj0yL4Ufi/Mdu51ETHx8KXAT
OC6fGtvB3I+cgk8n7oz5lIqh5aP21qMGCoZGoxbcn7nCOi6fiQ/nFLqHHUKs
6TxJRWBbfVzcJ3Vh3du1vzHFwZl1y67T94yei5j9JCEIe2W2r9KXmIPLpJB1
/lrAmcE6IRNfBfF307iKsLPErZeUrx9nE9PrXUAwjc/TLITcpifxebkI5lIl
K+X2IqZ/o2F9Ceu5jFbuWpoERNOF1QMP/m+h3rN6T2jMq7zvknY6/6t07Xh9
dwl7HjpfvcUwivMvAcHR4euxfxLEUFwb3esVqcuXpRZpWoA+nn4IQl7m2vv3
uIIS759L5g8WnTNWL1Os6fenJab7BxHT962Swk58337OrOnt3OCz7sT5c8CG
mf+LFCaD4gLVnpbM/hMo1vT+1MR0fkxQcBC/NxmXiYcp0ue7NSzi92WOwGVJ
qFVfsWLy21F/38CFflyExEF4fRfirhGJ3MYVgWV2WebAyY2+VrPqOaNzrEi2
fVDJhYhMYfm6h349MY+Z3weBBe6/yZqJVyCCYvyeLO3gmy7s6nAEkYsjXys6
HZjzRiOoxO8ilM+MlyFwGpuK4MTymXwoIP/DHrc36pkiYsN/+a8N/+lfa1M7
sQ==
    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
     0}}}, {CompressedData["
1:eJxTTMoPSmViYGAwBmIQHSG+/SLDsWAHrxPstrOvqjrA+D4g/lY1hwf7+OYY
b8Pkw9TD+CycXfLJeqoOb3n3GcxcF+xwBgTeqDg8EZE9+XQxgh9SojL9/wRM
fsNvq4JzK1ThfJj5MH4Lr//6KaqacD7EPVoO7qqlTLMSgh3MbfYGTWvUdrgP
co8Rgv8YZD87mvyjIAf55S889P5rwfl/vpU+mPNRE85vYDnab1iu6fBi+3rm
52+CHNarPmmep6vpcPiydqrkLwR/f62sRTpHMKq8ULCDHMj8egQfLP8WwX+S
uPCaib+WQ3oaEHAFO2Tkf2g9OUXLwRgE/gc51IPDQwtVPb+2w0wQ0EXwe7xe
sZgYIvhbW2oubPZF8L2rm/V9soIdju/a0ctWoAXnm4LCQ1ETzv/59vUBy8Ua
Dhsevpy6ySfYoRHk/+kaDs2BnnMbtIIdtpj/OJTSpeEwYcEPw2dswQ6ZIPeK
aEDSy60ghxkgd1WqO3xni5/hczEIEr89anB+KsifbAj+nEXKO/8sV4GoYwl2
eJGl/W26rYrDfxBQR/DB/vNF8NuXh58ySgl2MNBaKXzhiYrDzltdf1PzgyHm
tas62OhcmfWsEJG+TEDhWR/sEHBLuiYxSAUSflMRfM6fC9I3z0LwYelfYuoV
zowkBB+WHgHuC2oo
     "], {{77.66090000000001, 11.3234}, {77.66090000000001, 
     10.549999999999999`}, {77.00780000000002, 10.343800000000002`}, {
     76.68909999999998, 10.343800000000002`}, {76.27499999999999, 
     10.343800000000002`}, {75.9234, 10.6219}, {75.9234, 11.0047}, {75.9234, 
     11.5297}, {76.4172, 12.0719}, {77.66090000000001, 12.112499999999997`}, {
     77.66090000000001, 11.3234}}}], 
   FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1,
      3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
     0}, {0, 1, 0}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}, {1, 3, 3}, {0, 1, 0}}}, {CompressedData["
1:eJxTTMoPSmViYGCQAmIQPRME3oY4pIGBigOMfwYE3qg4rOm+ncFwGsGfsOCH
4bNjIQ4JIUHqCzhV4fy/30ofzLmI4Gfkf2g9WaIP4VeFOMxZpLzzjzuCb2qz
N2jaQT2IfXMR/K0tNRc2Lwxx0NVaKXxhCYI/pb016vIdXTj/QYT49osNWg4V
EStMz/aHOJy/GvZGX1rb4YmI7Mmn5VD35mg7iHxyPJ8Wi+CD7ZNF8ENKVKb/
fxLsYA6y/6EmnG9kDASX1eH8F1na36bfVXVgAAGJEAjfVsVhySQrRt8IBN+r
ulnfpwzBD5ATy/IFuu/Erh29bBtUHGRePzKTWhDicOqw09pMO1U4H6YePT4A
aE7HZw==
     "], CompressedData["
1:eJxTTMoPSmViYGAQB2IQLfP6kZnUghAHBhBIUHOA8XUV5b/kiCH4qWlAwKbm
oGk16XT9jBCHzPwPrSe3qDo82Mc3x7grxOHvt9IHcwRVHVSfNM87WxTicGLX
jl62DSoOaiB+FIK/81bX31RnBH9N9+0MBn2Efo6fC9I3K4U4NPy2Kji3QtUh
pERl+n+REIc5i5R3/nFXcwA5I00oxOFp4sJrJvzqqPzzCP4GvbzFjHs0IOaL
hzj8evv6gGWyJtz8PyD7PmrC7a8H2deh5WCjc2XWM9cQh5pPGwKyf2k5PBGR
Pfk0HsE/UCtrkV6B4J8BgQkhDtsdmh4dn6EFDy99rZXCF45oOqCHLwDsuaP4

     "]}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1,
     3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 
    3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
    1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 
    3}, {1, 3, 3}}}, CompressedData["
1:eJx11H0slVEYAPBLSn9V416f4b1zL66r5HMlbY9aolG3uOdVkaV8pNCWhrlk
CittlWq4PkZftKiWqaUSySouMrltWiP5avIHa2Kk7nnfe8/Zss72/vHb+XjO
ec5zXnFMyv7YFQKBwEj3Id1nrPtGhHbvR7eyEB+na1oGDPbCzVwM+TVsh6c3
tb/bR/WYB/XE04crxiXUeJk4CxbWRikGPU3FsFN6xli9mlphb5EYOoiIh5rX
lHtlIzKf60+j5vqTl/tlimqq9A5DvKuuvUaQwMDtIj+j0FQEhf7BTXExy/1s
4OLv2ALqjIhan6625b43+z1ds4k6fXBuwOu+A6Trnab37KrokpBGBCrsThuQ
jpyr7LqLYDI/qdDzkDU0nld9aLiAgGmqao59YAFzeHwogjzGVKq5LuLzy1Bz
640qibn5eUqoN3NbE59tSdxS2Jzr3eZAnInjZ4ph/eSwr02JEuanJlu2OEr5
/AwrwU3s8POk1pm/HzMEo0eqtd6XZZD14EnM2QMIevrRD/fnrqDBrZzaKkix
aPWL2hvfgyULNpWHZZ0KF+KOtu31x+2diB9tTL5l9ELK70fIQsg7021lPtQC
3IYkxDkLfqe6ayV8fm2p3/TJY63tqXP3BVfkOFFz8ZxZGMHneSiB3Znn3ENc
WZhIlM8W20n58QcN8eXEE6cbRQsn5DDzSHFCHfZ/T+s9rndd4ecEwV7az9V/
kK4fx3eXk/Nw9eolg5u4/taxsKf3auTSURmEp0qK/whYUOFAfvp8fkMQ9CrL
bvNbVwjG+3+NyPrCmYCeuGpq7v3doObGzyiJufsOVMIGfN++TsTcdq4xxK24
fnZY8+tXKGFoZ3SA2kPI738dIub2t4uaq49LCALxe4sQ8floMNS7FTTh9/Uc
gcuM5Lv6ggVf3xrE3zeIoBS3XmozHL+f+krVnMeYFoEwoyi169hyRyW1Lz3+
hCBSGrG+WyUCJmD6qOaLPp7Mkl//KwJzPN7Eis/XFIIC/J6EttCiS3P8IoLw
qb7pklZ7/rwmLJThecEMP38lC47a4TBBJMPXgztL/g+r56viGzypDf/Lf234
n/4FEoEzaw==
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 
    3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGINIGYC4pkg4BvhcGLXjl62ADUHGP9RhPj2iw1qDmu6
b2cwuCP4Neu2JdW7Ivg2OldmPXNE8P3lxLJ87SMcprS3Rl2uUXOQd/yYfMY2
wkG0x+sVS4iaw/19fHOMrSIcTh12Wpv5T9XhPwhoRzhs0MtbzLhHxSGkRGX6
/x/hcL7QJ8fzaTcRfAYQWBMOoRtU4fwLV8Pe6N9Wh/PT04BATctha0vNhc0X
wx1+vH19wJJZG+Kf7wj+taO5Jg2/Efw3vPsMZopFwPn7a2Ut0jUiHGaAwmWn
lsPhy9qpklIRDhn5H1pPTtFykH79yExKIsKhgeVov6E5gg+2nw3BT46948Y8
Q9NBARQeihEOqSB5N02IvAGC/50tfoaPLYIPDh9g+B8Hxc8EBH+L+Y9DKVxa
cL47yKHs2g7fQPpVIxzMbfYGTWvUhoTf13A4/y3If+vQ+HXhkPjaownnN4L8
c10dzv/7rfTBnIuqDrG5R/9t2hzu8CJL+9t0WxWHJyKyJ59+RvArIlaYnrWO
gPNh6Ul2+QsPPXlE+oKlNwBW0Bhr
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
     0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}}, {{
     1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGAQA2IQfd+/d3peVaRDI8vRfsPr6g4w/oyZQHBT0+HGue/B
j10jHc6AQI62g/vDKpF17Aj+zltdf1PvR8D5TYGecxuORTg8z9L+Nn2vloO8
48fkM3sjHER6vF6xlCD4GfkfWk+W6DsogPiFEQ5zFinv/OOO4Jva7A2adlDP
Qctq0un6KQi+q2op06wZEQ66WiuFLyxB8Ke0t0ZdvqML56eBgYrD/lpZi/QV
CD7nzwXpm3dFOPx6+/qAZbKqw5ru2xkMxyMcdjg0PTp+Q8Whf8EPw2f3Ihxe
gNxvq+IACoaZjJFw/u+VHy/5OiH4sPDaoPqked5ZVQf08AQACtCmiw==
     "], CompressedData["
1:eJxTTMoPSmViYGCQAmIQ3fI6cIecb6TDhathb/RvqzvA+C+ytL9Nr0XwN+nl
LWaMUXNYNvuIwgYrKH+OqsN2udbXgRqRDgZaK4UvPFFxWPnxkm+SQKTDiV07
etk2qDh82hCQPet/BJwv7hHwR+I5gs/xc0H65ksRDj4n2G1ni6o6CH1yPJ92
NMIhM/9D68ktqg7+cmJZvvsjHCSmXuHMYFKD81PTgIANwRft8XrFEoLgP05c
eM0kXxPOn9LeGnV5D4KvD3LvEU2HNd23MxiORziwcHbJJ/NpOcg7fkw+cxUq
v0TLYWtLzYXNbyMcakAe+aXl8FLNkGMNSyScv1omKsVaHsH3752eJ2Qc6bAF
FD41Wg5A2fv+tpEO5jZ7g6YxajncOPc9+LFrJMS9UzTh4QsOPxYEHxYfAEI5
rrY=
     "]}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}}}, {CompressedData["
1:eJxTTMoPSmViYGBQBWIQvf/UQtdtwdEOKbF33JhnqDrA+LW/rQrOcWg6sITx
6W4SjXY4vmtHL9sGbYcpzt05zzdHwfkLXLd9/uuC4GfsKZksoRLlkAYCyzTg
fDObvUHTGBH8LeY/DqWcUndIEIiw3KIR5eB7cWLMP2d1h/XuD6tE7BB8807H
hKcRCL69adwuz5Qoh9mLlHf+YdeA84+B7C9A8NerPmmep6vp8D348dLZPgj+
8tlHFDY4IfguQO/8Toxy8L8lXZP4SQvivjlRDlPaW6Muy2g7uAC9d2UDgg+W
/4Lgf/l7peKlXLSD9Lw4zdMFmnD+r7evD1geVoPzN+jlLWa0UXVY8fGSb5JA
tINAbMB9o3Jlh/8gwB7tIFw5qeTsFCUH9jUyUSnM0Q7V93/cMn6t7FCfBbTw
RZRDC6//+imtqg4b5r5ffmwxgg/Wb47gB+yQa319MtLBeUKzUJqUEpz/pi23
22i2DJz/wDXecdZGSYj/X0L5hiIQfmAUnJ8Oike2aDgflj7A/EAlB/T0AwAw
cQuG
     "], {{107.93299999999998`, 8.932809999999998}, {107.93299999999998`, 
     8.04844}, {107.156, 5.371880000000001}, {105.317, 5.371880000000001}, {
     104.19400000000002`, 5.371880000000001}, {104.00299999999999`, 
     6.2562500000000005`}, {104.00299999999999`, 6.757809999999998}, {
     104.00299999999999`, 7.282809999999998}, {104.33799999999997`, 
     8.514059999999999}, {104.51599999999996`, 8.956249999999999}, {
     104.67200000000001`, 9.31406}, {105.35300000000001`, 
     10.521900000000002`}, {106.59500000000001`, 10.521900000000002`}, {
     107.68299999999998`, 10.521900000000002`}, {107.93299999999998`, 
     9.57813}, {107.93299999999998`, 8.932809999999998}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0,
     1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 
    1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIzIGYC4p7peULND6Id5Hct2JfaJ+QA4+8Mtor4/1zI
YYpzd87z29EO7muOLmf4IeRg3umY8PQGgi9+89z34MsIfgdQ+sIlKP+GkMMa
magU6/PRDtGqETLnYoQcFrhu+/z3SLTDl30ft6ZfE3B4E7hDrnV1tENqGhCo
8Tqo3P5Zl9WD4NfYm8btakTw76iwNU6tjnZQ/6TychYnH5z/wDXecZagAJx/
BgTWCDi0vAZaUBvtkA7SzyboYHPfv3d6HVR9oSDEf4uh/l8n5fD898qPl64i
+CUZE9/W3EfwBZoPnFr4FJMPdo+nNJz/pi2322i3tMOTC0q3f95D8FuA0q7X
EHxQ8NxfjuD/AVrvuyvaYeW3lxVnFBQcQN733BPtsFZIhy89DsEH+6cMN1/5
2qNghjMKDj5JAhGWW6IdhCsnlZz9ogAPbxhfnCWMT3cWgg8On2nRDvyxAfeN
2hUcJPTvqrBNhNo/T97h/fJj3uaNCPdul2t9HRiA4IP1u6H5zx6T/x8E5BF8
WHjC9MP44PTjj+DD4hPG9+Bh0m6Pg6ZXdmGI/6Kh6c1GyOHL3ysVL8Ng9gnC
+bD0AeO3iNeyZrbxQtyTH+1gX+JYezqG26FGZJ37wy4E/4jChqKMgwg+LL+A
zdNB5B9YfgIAOCmDtw==
    "]], FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 
     0}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}}}, {{{120.07, 11.8719}, {120.07, 11.262499999999998`}, {
     119.76099999999997`, 9.50625}, {117.358, 9.50625}, {116.00799999999998`, 
     9.50625}, {116.79699999999998`, 12.6484}, {116.90499999999997`, 
     13.090600000000002`}, {116.95199999999998`, 13.1141}, {
     117.41899999999997`, 13.1141}, {118.27799999999998`, 13.1141}, {
     119.30599999999998`, 13.1141}, {120.07, 12.803099999999999`}, {120.07, 
     11.8719}}, CompressedData["
1:eJx11GtIU1EcAPClkkpiYu5l8zF1ynx8sGnhC/8WPmLITM2G7N5E1AmZFkkM
2YceptkykjJTEx8Q9mFaSIYOmUnkI2xICD1QzERUXIkmpqnYvefu3gMbHbiM
H2f3nvN/nCMtrMguduLxeBeoh/6tLG34qVeR0IyGGFgHmDrMxb/EMPyhM/WN
koQYBTWO+cLYdXO7bzp2bF1KwSJg32g8YyhLJiFsI2SlZUIMny1/chaSSBjI
iVcfaMVgPTfgfyeChBGD+VaMswAyC73UcR4klNAjlA8eThG1gh2C8xf6/UVs
fXIsafpKwCQ9jNg1ga6yyWkhZxTOjgj0Pr3p8z8IZn85fkw8CwTUqw2qQw/9
4Aod7xIB1fT7uQGci+n1arDR/pewDYlnTSV9UphV1TeVmwg4oEdFEKiLEuZU
bQQ8pdcfDILSocpHoj0CerwjPbVkMFS/pTaQRsKzruDBvXQZ50hpwGZZXhhn
BRpyyKLStepOwvK1fv7uajic94zqa2snOL9Y/5RZOKXhjPI3gi10yfOMMjm6
iJhJc9Zh6zdeZV2KD2fqP4zdkz5f5WPBfkyVd2nX0QW52WEd7thaOn+j8v9a
Oe6a1NooZ/pnW8PkK07O1K9BA/kytcQyJIJaanrqngYe0PXyEsJa96jyVJ0G
Ns3r/donAqDLW5WLjep9GjtqNuTwzSRHs/3DGvWHgg90uVzSsKd1K6HRGXbz
edgoPyUaqJrb/qZQ8oHq1uetldhH1XGvxy128zPYy6HRbkYr/h7qp7/Y95vK
vW/zCM4oX26OttZcNpw4LuDMxiujPi9xwk6coxbYwvlAfTvm6Azj+27eNvb3
1IspLVeFsG9ndp49f/2/96d1E7bvnRQx8e1pYK3rZeDHu0FMPGqCM+rXTuxN
6vWVXtv5FUs5o3VUgZzZ82iU5BcldBOgo/N5xJ85L522+2FSwuyn2XYem32Z
/zcR3H3FGtUjQswZ3TejfOa+ekcw8Ub7MPXcwkbxxZCc2fsTLW8Vgf39+g94
L27R
     "]}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
     3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGINIGYC4rv+vdPzrOIdTuza0csWoOYA4z+KEN9+sUHN
YcPc98uPGSP4f1Z+vORrhODLtr4O3KGH4GfsKZksoRPvMKW9NepyjZrDlhNl
++ZrxTuI9ni9YglRc3hyQen2T7V4h1OHndZm/lN1cNn2+e8ViXiHDXp5ixn3
qDg8/w204GkcnD/hbY296TEEH6x+RpwDAwg0qML5F66GvdG/rQ7np6cBgZqW
gwcPk3b7vjiHH29fH7Bk1ob45zGCv10O6IEXCD77GpmoFOZ4OL9033wpfdF4
hxkzgWCnlsOXv1cqXrLFO2Tkf2g9OUXLYX1RxsS3LPEODSxH+w3NEXyw/WwI
fnLsHTfmGZoONveBAcwX75AKknfThMjLIPiqhhxrZLQQ/DMgYBLvcBwUPxMQ
/C3mPw6lcGnB+e77a2Ut2LUh+oXiHcxt9gZNa9R2EGcJ49N9FAfng/03G42f
HQeJrz2acH4jyD/X1eH8v99KH8y5qOrQMz1PqHlBnMOLLO1v021VHBIEIiy3
PEDwa7OACUAjHs6HpSfZ5S889OQR6QuW3gCn5xy5
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{
     0, 2, 0}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGBQAGIQ3eGY8PSCWILDiV07etkC1BxgfAYQSFBzMInb5ckD
5Nf+tio416HmMD1PqPmAEILPr7tp7nt+BJ99jUxUCpD/qnir6O9sNYfPf69U
vORLcBDt8XrFEqLm8FUjpv8Qa4LDnEXKO/8cV3EI5QMacD/eYYNe3mLGPSoO
qWlAcA3BL8mY+LZmP4L/ZOnsIwor4h3+fit9MEdQ1cFlG9CGGUB51SfN886q
OmwFWdgZD3cPjA+W71WH82eD7GfXcDj/PfjxUqB7YfzIFOv7/qIIPiw80Plp
YIDgy8yL0zx9QdPh98qPl3y5EhzMbfYGTWvUdjgDBvFwvu5dFbbGXgQ/Y0/J
ZImYeIcXWdrfpt/VhPN/vX19wPKxOpzvdYLddvZVVQcTYyCYDFVvqwIJ78sI
Pji+gPbD+DD3Bd6Srkn8pOqAHt8AS/nmJA==
     "], {{128.172, 12.2234}, {126.156, 12.2234}, {126.22800000000001`, 
     13.3391}, {126.90499999999997`, 13.529699999999998`}, {
     127.19999999999999`, 13.529699999999998`}, {128.13099999999997`, 
     13.529699999999998`}, {128.16299999999998`, 12.4063}, {128.172, 
     12.2234}}}]},
  AspectRatio->Automatic,
  BaselinePosition->Scaled[0.3169380676693431],
  ImageSize->{130.43270734744706`, 16.723028642590286`},
  PlotRange->{{0., 130.43}, {0., 16.72}}]], "Output",
 CellChangeTimes->{{3.951227480607923*^9, 3.951227498508594*^9}, 
   3.951227590723441*^9, {3.951227661082717*^9, 3.9512276785464973`*^9}, 
   3.951228233968712*^9, {3.951228327360218*^9, 3.951228340718918*^9}, 
   3.9512283821936007`*^9, 3.9512284290396833`*^9, 3.951228862779323*^9, 
   3.951229355860683*^9, 3.951231936508786*^9, 3.951233653649911*^9},
 CellLabel->
  "Out[508]=",ExpressionUUID->"cf057ce8-39cc-4264-ad48-33e5bda69e22"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TakeDerivatives", "[", 
     RowBox[{"Setup", ",", "\[IndentingNewLine]", 
      RowBox[{"FEq", "[", "\[IndentingNewLine]", 
       RowBox[{"FTerm", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Propagator", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"AnyField", ",", "AnyField"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "j"}], "}"}]}], "]"}], 
         RowBox[{"Rdot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"AnyField", ",", "AnyField"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "j"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
        "]"}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"A", "[", 
        RowBox[{"p", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}]}], "]"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "//", 
   RowBox[{
    RowBox[{"FPrint", "[", 
     RowBox[{"Setup", ",", "#"}], "]"}], "&"}]}]}]], "Input",ExpressionUUID->\
"941f6d2d-d60a-473b-b5ed-b3dd98e0d056"]
}, Open  ]]
},
AutoGeneratedPackage->"DiANE.m",
WindowSize->{1440, 900},
WindowMargins->{{1200, -1440}, {Automatic, 0}},
Magnification:>0.9 Inherited,
FrontEndVersion->"14.1 for Linux x86 (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"dfc92765-bf29-47cf-bd50-cf1f31dcd525"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 580, 11, 28, "Input",ExpressionUUID->"33cd48af-4550-42b3-9c95-127f2f1ee635"],
Cell[CellGroupData[{
Cell[1159, 35, 259, 4, 59, "Section",ExpressionUUID->"d65e8f2b-6500-4348-8918-912b67b13cd9"],
Cell[1421, 41, 1680, 44, 282, "Input",ExpressionUUID->"3b72c183-b427-41fc-97f5-14c39b5b43de",
 InitializationCell->True],
Cell[3104, 87, 1862, 48, 144, "Input",ExpressionUUID->"66c68510-764b-433f-bf11-01c5d6a5e9c2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[5003, 140, 172, 3, 47, "Section",ExpressionUUID->"8a7de2d4-4e3d-41aa-8f92-19d8c0694994"],
Cell[CellGroupData[{
Cell[5200, 147, 163, 3, 47, "Subsection",ExpressionUUID->"fe6211e7-4eaf-4c19-8e0e-b2242a07760b"],
Cell[5366, 152, 970, 22, 126, "Input",ExpressionUUID->"4cb64dde-a02d-401c-87bd-c89d5d2cf484",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[6373, 179, 218, 4, 33, "Subsection",ExpressionUUID->"b673667e-d925-4d48-9d93-4211a3ceb4cb"],
Cell[6594, 185, 5434, 131, 836, "Input",ExpressionUUID->"2757d6ff-49bf-4f75-b9da-02f06924b8e7",
 InitializationCell->True],
Cell[12031, 318, 8240, 204, 1044, "Input",ExpressionUUID->"c206a11f-7558-4843-a213-55c609b89e58",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[20308, 527, 173, 3, 47, "Subsection",ExpressionUUID->"c85a5823-b0b0-4a54-a9b5-b6ecf5b7d25d"],
Cell[20484, 532, 2712, 65, 271, "Input",ExpressionUUID->"4689a3d2-e2b9-43c0-abfa-435e5632834b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[23233, 602, 178, 3, 33, "Subsection",ExpressionUUID->"1c82d10b-061e-41f5-a731-b8174ae16e8f"],
Cell[23414, 607, 201, 5, 41, "Input",ExpressionUUID->"6bb84f5e-6a14-4388-9a5c-aeffe2a30746",
 InitializationCell->True],
Cell[23618, 614, 2854, 75, 368, "Input",ExpressionUUID->"b47c8098-cb50-46d8-b369-2238ea569892",
 InitializationCell->True],
Cell[26475, 691, 21202, 495, 2186, "Input",ExpressionUUID->"54a8c1ed-ea4c-48f3-8ca0-31b66c1b5f4b",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[47714, 1191, 174, 3, 47, "Subsection",ExpressionUUID->"0d7ca62e-6e69-4f36-a53a-dfb5b1d4f0f7"],
Cell[47891, 1196, 3782, 88, 347, "Input",ExpressionUUID->"391fa561-d2b8-480b-bb8c-11da575eb488",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[51722, 1290, 159, 3, 59, "Section",ExpressionUUID->"e7b15865-c8ea-45b8-8460-46b36cdd33e6"],
Cell[51884, 1295, 4120, 101, 433, "Input",ExpressionUUID->"28c30a2a-e06f-4922-bd1e-bd070d89705e",
 InitializationCell->True],
Cell[56007, 1398, 3515, 91, 292, "Input",ExpressionUUID->"c7cb9c1f-9864-4031-9307-761fb266e315",
 InitializationCell->True],
Cell[59525, 1491, 3042, 88, 91, "Input",ExpressionUUID->"8e5783ec-39b7-4065-a919-073dda296067"],
Cell[62570, 1581, 21568, 484, 2186, "Input",ExpressionUUID->"444a0240-f744-45ec-873c-53bebba48ccd",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[84175, 2070, 152, 3, 86, "Title",ExpressionUUID->"7a24c792-7a48-4e73-8b88-7b56966e439b"],
Cell[CellGroupData[{
Cell[84352, 2077, 3987, 108, 597, "Input",ExpressionUUID->"2632f66f-a425-44c8-b21c-333bdd8417c4"],
Cell[88342, 2187, 27985, 460, 31, "Output",ExpressionUUID->"cf057ce8-39cc-4264-ad48-33e5bda69e22"]
}, Open  ]],
Cell[116342, 2650, 1218, 32, 194, "Input",ExpressionUUID->"941f6d2d-d60a-473b-b5ed-b3dd98e0d056"]
}, Open  ]]
}
]
*)

