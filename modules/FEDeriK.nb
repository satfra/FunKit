(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    280595,       6427]
NotebookOptionsPosition[    269792,       6221]
NotebookOutlinePosition[    270246,       6239]
CellTagsIndexPosition[    270203,       6236]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"AutoGeneratedPackage", "->", "\"\<FEDeriK.m\>\""}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.933907062001917*^9, 3.933907088477437*^9}, 
   3.9356618434708548`*^9, 3.935744927606638*^9, {3.935833716539812*^9, 
   3.93583371672362*^9}, {3.9507222866535883`*^9, 3.95072228934137*^9}, {
   3.950850838405504*^9, 3.950850842475651*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"33cd48af-4550-42b3-9c95-127f2f1ee635"],

Cell[CellGroupData[{

Cell["Global variables", "Section",
 CellChangeTimes->{{3.9509597231601686`*^9, 3.950959732923991*^9}, {
  3.951108540108012*^9, 3.9511085438759727`*^9}, {3.951210853720582*^9, 
  3.95121085660688*^9}},ExpressionUUID->"d65e8f2b-6500-4348-8918-\
912b67b13cd9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ModuleLoaded", "::", "dependency"}], "=", 
    "\"\<The module `1` requires `2`, which has not been loaded.\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ModuleLoaded", "[", "FunKit", "]"}], "=!=", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"ModuleLoaded", "::", "dependency"}], ",", "\"\<FEDeriK\>\"", 
        ",", "\"\<FunKit\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ModuleLoaded", "[", "FEDeriK", "]"}], "=", "True"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951279357886877*^9, 3.951279421240814*^9}, {
  3.9512794606622543`*^9, 3.951279475842711*^9}, {3.951279581390761*^9, 
  3.9512796956111917`*^9}, {3.951279782883439*^9, 
  3.9512797869913473`*^9}},ExpressionUUID->"0a00f2e0-9e12-4855-8a8a-\
da6773cee6a6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$OrderedObjects", "=", 
   RowBox[{"{", 
    RowBox[{"Propagator", ",", "GammaN", ",", "Rdot"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$indexedObjects", "=", 
   RowBox[{"{", 
    RowBox[{
    "ABasis", ",", "VBasis", ",", "GammaN", ",", "Propagator", ",", "Rdot"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$MaxDerivativeIterations", "=", "500"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$CanonicalOrdering", "=", "\"\<f>af>b\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951210756011141*^9, 3.951210767816422*^9}, {
  3.951210812202783*^9, 3.951210812369783*^9}, {3.9512108663431187`*^9, 
  3.9512108750394697`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"f9a54712-bc7e-4f67-94ba-c436d6c2a287"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$FunKitDirectory", "=", 
   RowBox[{
    RowBox[{"SelectFirst", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
            "$UserBaseDirectory", ",", "\"\<Applications\>\"", ",", 
             "\"\<FunKit\>\""}], "}"}], "]"}], ",", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
            "$BaseDirectory", ",", "\"\<Applications\>\"", ",", 
             "\"\<FunKit\>\""}], "}"}], "]"}], ",", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
            "$InstallationDirectory", ",", "\"\<AddOns\>\"", ",", 
             "\"\<Applications\>\"", ",", "\"\<FunKit\>\""}], "}"}], "]"}], 
          ",", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
            "$InstallationDirectory", ",", "\"\<AddOns\>\"", ",", 
             "\"\<Packages\>\"", ",", "\"\<FunKit\>\""}], "}"}], "]"}], ",", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
            "$InstallationDirectory", ",", "\"\<AddOns\>\"", ",", 
             "\"\<ExtraPackages\>\"", ",", "\"\<FunKit\>\""}], "}"}], "]"}]}],
          "}"}], ",", 
        RowBox[{"Select", "[", 
         RowBox[{"$Path", ",", 
          RowBox[{
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"#", ",", "\"\<FunKit\>\""}], "]"}], "&"}]}], "]"}]}], 
       "]"}], ",", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", "#", "]"}], "&"}]}], "]"}], "<>", 
    "\"\</\>\""}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951226996707944*^9, 3.951227003475544*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"66c68510-764b-433f-bf11-01c5d6a5e9c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["FDOp, FTerm and FEq definitions ", "Section",
 CellChangeTimes->{{3.9509597231601686`*^9, 3.950959732923991*^9}, {
  3.951108540108012*^9, 
  3.9511085438759727`*^9}},ExpressionUUID->"e03db448-7a6c-4e73-9ddc-\
3b1976a84a81"],

Cell[CellGroupData[{

Cell["Basic definitions", "Subsection",
 CellChangeTimes->{{3.950959776616251*^9, 3.950959779850823*^9}, 
   3.9509598524176817`*^9},ExpressionUUID->"35360acd-1ab3-48dc-b387-\
960ef784c1b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", "FTerm", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "FTerm", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTimesPowerPatternaToFTermb", "=", 
   TagBox[
    StyleBox[
     RowBox[{"Power", "[", 
      RowBox[{"a", ",", 
       RowBox[{"FTerm", "[", "b_", "]"}]}], "]"}],
     ShowSpecialCharacters->False,
     ShowStringCharacters->True,
     NumberMarks->True],
    FullForm]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FTimesPowerPatternFTermbtoa", "=", 
    TagBox[
     StyleBox[
      RowBox[{"Power", "[", 
       RowBox[{"a", ",", 
        RowBox[{"FTerm", "[", "b_", "]"}]}], "]"}],
      ShowSpecialCharacters->False,
      ShowStringCharacters->True,
      NumberMarks->True],
     FullForm]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FTerm", "::", "TimesError"}], "=", 
   "\"\<An FTerm cannot be multiplied using Times[__]. To multiply FTerms, \
use term1**term2, also with scalars, a**term. Error in expression\n`1`\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FTerm", "::", "FTermPowerError"}], "=", 
    "\"\<An FTerm cannot be taken to a power of an FTerm.\>\""}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Multiplication", " ", "of", " ", "FTerms"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"FTerm", "/:", 
  RowBox[{"NonCommutativeMultiply", "[", 
   RowBox[{
    RowBox[{"FTerm", "[", "a__", "]"}], ",", 
    RowBox[{"FTerm", "[", "b__", "]"}]}], "]"}], ":=", 
  RowBox[{"FTerm", "[", 
   RowBox[{"a", ",", "b"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTerm", "[", 
   RowBox[{"pre___", ",", 
    RowBox[{"NonCommutativeMultiply", "[", "in___", "]"}], ",", "post___"}], 
   "]"}], ":=", 
  RowBox[{"FTerm", "[", 
   RowBox[{"pre", ",", "in", ",", "post"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FTerm", "[", "]"}], ":=", 
   RowBox[{"FTerm", "[", "1", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Pre", "-", 
    RowBox[{"reduction", " ", "of", " ", "zero", " ", "FTerms"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTerm", "[", 
   RowBox[{"___", ",", "0", ",", "___"}], "]"}], ":=", 
  RowBox[{"FTerm", "[", "0", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTerm", "[", 
   RowBox[{"pre___", ",", "a_", ",", 
    RowBox[{"b", ":", 
     RowBox[{"(", 
      RowBox[{"_Integer", "|", "_Real", "|", "_Rational", "|", "_Complex"}], 
      ")"}]}], ",", "post___"}], "]"}], ":=", 
  RowBox[{"FTerm", "[", 
   RowBox[{"pre", ",", 
    RowBox[{"a", "*", "b"}], ",", "post"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FTerm", "[", 
    RowBox[{
     RowBox[{"a", ":", 
      RowBox[{"(", 
       RowBox[{"_Integer", "|", "_Real", "|", "_Rational", "|", "_Complex"}], 
       ")"}]}], ",", "b_", ",", "post___"}], "]"}], ":=", 
   RowBox[{"FTerm", "[", 
    RowBox[{
     RowBox[{"a", "*", "b"}], ",", "post"}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Reduction", " ", "of", " ", "immediately", " ", "nested", " ", "FTerms"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FTerm", "[", 
    RowBox[{"pre___", ",", 
     RowBox[{"FTerm", "[", "in__", "]"}], ",", "post___"}], "]"}], ":=", 
   RowBox[{"FTerm", "[", 
    RowBox[{"pre", ",", "in", ",", "post"}], "]"}]}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FTerm", "/:", 
    RowBox[{"Power", "[", 
     RowBox[{
      RowBox[{"FTerm", "[", "a___", "]"}], ",", 
      RowBox[{"FTerm", "[", "b___", "]"}]}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"FTerm", "::", "FTermPowerError"}], "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "FTerm", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951108570921122*^9, 3.9511086067410803`*^9}, {
  3.9511206459063587`*^9, 3.951120660081051*^9}, {3.951195864716386*^9, 
  3.951195886154029*^9}, {3.951196961507043*^9, 3.951197010834494*^9}, {
  3.951197041118517*^9, 3.9511971060976057`*^9}, {3.951197479182197*^9, 
  3.951197519394229*^9}, {3.951219979402542*^9, 3.951219993857942*^9}, {
  3.951220337986998*^9, 3.9512203916636333`*^9}, {3.951283991688099*^9, 
  3.951284016560318*^9}},
 CellLabel->
  "In[241]:=",ExpressionUUID->"9610d6bd-1c3a-4143-88dc-cb4244676cae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", "FEq", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "FEq", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FEq", "::", "TimesError"}], "=", 
    "\"\<A FEq cannot be multiplied using Times[__]. To multiply FEqs, use \
eq1**eq2, also with scalars, a**eq. Error in expression\n`1`\>\""}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Removal", " ", "of", " ", "zero", " ", "FTerms"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FEq", "[", 
    RowBox[{"pre___", ",", 
     RowBox[{"FTerm", "[", 
      RowBox[{"___", ",", "0", ",", "___"}], "]"}], ",", "post___"}], "]"}], ":=", 
   RowBox[{"FEq", "[", 
    RowBox[{"pre", ",", "post"}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Sum", " ", "splitting", " ", "of", " ", "FTerms"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FEq", "[", 
    RowBox[{"preEq___", ",", 
     RowBox[{"FTerm", "[", 
      RowBox[{"preTerm___", ",", 
       RowBox[{"Plus", "[", 
        RowBox[{"a_", ",", "b__"}], "]"}], ",", "postTerm___"}], "]"}], ",", 
     "postEq___"}], "]"}], ":=", 
   RowBox[{"FEq", "[", 
    RowBox[{"preEq", ",", 
     RowBox[{"FTerm", "[", 
      RowBox[{"preTerm", ",", "a", ",", "postTerm"}], "]"}], ",", 
     RowBox[{"FTerm", "[", 
      RowBox[{"preTerm", ",", 
       RowBox[{"Plus", "[", "b", "]"}], ",", "postTerm"}], "]"}], ",", 
     "postEq"}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Sums", " ", "of", " ", "FTerms"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FEq", "[", 
   RowBox[{"preEq___", ",", 
    RowBox[{"Plus", "[", 
     RowBox[{
      RowBox[{"FTerm", "[", "a__", "]"}], ",", 
      RowBox[{"FTerm", "[", "b__", "]"}], ",", "c___"}], "]"}], ",", 
    "postEq___"}], "]"}], ":=", 
  RowBox[{"FEq", "[", 
   RowBox[{"preEq", ",", 
    RowBox[{"FTerm", "[", "a", "]"}], ",", 
    RowBox[{"Plus", "[", 
     RowBox[{
      RowBox[{"FTerm", "[", "b", "]"}], ",", "c"}], "]"}], ",", "postEq"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FEq", "/:", 
   RowBox[{"Plus", "[", 
    RowBox[{
     RowBox[{"FEq", "[", "a___", "]"}], ",", 
     RowBox[{"FTerm", "[", "b__", "]"}]}], "]"}], ":=", 
   RowBox[{"FEq", "[", 
    RowBox[{"a", ",", 
     RowBox[{"FTerm", "[", "b", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Sums", " ", "of", " ", "FEqs"}], "*)"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{"FEq", "/:", 
   RowBox[{"Plus", "[", 
    RowBox[{"preEq___", ",", 
     RowBox[{"FEq", "[", "terms1___", "]"}], ",", "midEq___", ",", 
     RowBox[{"FEq", "[", "terms2___", "]"}], ",", "postEq___"}], "]"}], ":=", 
   
   RowBox[{"Plus", "[", 
    RowBox[{"preEq", ",", "midEq", ",", "postEq", ",", 
     RowBox[{"FEq", "[", 
      RowBox[{"terms1", ",", "terms2"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Multiplication", " ", "of", " ", "FEqs"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"FEq", "/:", 
  RowBox[{"Times", "[", 
   RowBox[{"pre___", ",", 
    RowBox[{"FEq", "[", "a__", "]"}], ",", "post___"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"FEq", "::", "TimesError"}], ",", 
      RowBox[{"{", 
       RowBox[{"pre", ",", 
        RowBox[{"FEq", "[", "a", "]"}], ",", "post"}], "}"}]}], "]"}], ";", 
    RowBox[{"Abort", "[", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FEq", "[", 
    RowBox[{"prefeq__", ",", 
     RowBox[{"Times", "[", 
      RowBox[{"pre___", ",", 
       RowBox[{"FTerm", "[", "a__", "]"}], ",", "post___"}], "]"}], ",", 
     "postfeq__"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"FTerm", "::", "TimesError"}], ",", 
       RowBox[{"{", 
        RowBox[{"pre", ",", 
         RowBox[{"FTerm", "[", "a", "]"}], ",", "post"}], "}"}]}], "]"}], ";", 
     RowBox[{"Abort", "[", "]"}]}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"FEq", "/:", 
  RowBox[{"NonCommutativeMultiply", "[", 
   RowBox[{
    RowBox[{"FTerm", "[", "b__", "]"}], ",", 
    RowBox[{"FEq", "[", "c__", "]"}]}], "]"}], ":=", 
  RowBox[{"FEq", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"FTerm", "[", "b", "]"}], "**", "#"}], "&"}], ",", 
     RowBox[{"FEq", "[", "c", "]"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FEq", "/:", 
  RowBox[{"NonCommutativeMultiply", "[", 
   RowBox[{
    RowBox[{"FEq", "[", "a__", "]"}], ",", 
    RowBox[{"FEq", "[", "b__", "]"}]}], "]"}], ":=", 
  RowBox[{"FEq", "@@", 
   RowBox[{"(", 
    RowBox[{"Flatten", "@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"FEq", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", "a", "}"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "**", 
         RowBox[{
          RowBox[{"{", "b", "}"}], "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"{", "a", "}"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"{", "b", "}"}], "]"}]}], "}"}]}], "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"FEq", "/:", 
  RowBox[{"NonCommutativeMultiply", "[", 
   RowBox[{
    RowBox[{"FTerm", "[", "b___", "]"}], ",", 
    RowBox[{"FEq", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"FEq", "[", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FEq", "/:", 
  RowBox[{"NonCommutativeMultiply", "[", 
   RowBox[{
    RowBox[{"FTerm", "[", "]"}], ",", 
    RowBox[{"FEq", "[", "b___", "]"}]}], "]"}], ":=", 
  RowBox[{"FEq", "[", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FEq", "/:", 
  RowBox[{"NonCommutativeMultiply", "[", 
   RowBox[{
    RowBox[{"FTerm", "[", "0", "]"}], ",", 
    RowBox[{"FEq", "[", "b___", "]"}]}], "]"}], ":=", 
  RowBox[{"FEq", "[", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FEq", "/:", 
   RowBox[{"FTerm", "[", 
    RowBox[{"FEq", "[", "a__", "]"}], "]"}], ":=", 
   RowBox[{"FEq", "[", "a", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FEq", "/:", 
   RowBox[{"FTerm", "[", 
    RowBox[{
     RowBox[{"FEq", "[", "a__", "]"}], ",", 
     RowBox[{"FEq", "[", "b__", "]"}]}], "]"}], ":=", 
   RowBox[{"FEq", "@@", 
    RowBox[{"(", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"FEq", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "a", "}"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "**", 
          RowBox[{
           RowBox[{"{", "b", "}"}], "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"{", "a", "}"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"{", "b", "}"}], "]"}]}], "}"}]}], "]"}]}], ")"}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Reduction", " ", "of", " ", "immediately", " ", "nested", " ", "FEqs"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FEq", "[", 
    RowBox[{"pre___", ",", 
     RowBox[{"FEq", "[", "in___", "]"}], ",", "post___"}], "]"}], ":=", 
   RowBox[{"FEq", "[", 
    RowBox[{"pre", ",", "in", ",", "post"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "FEq", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9509578761709423`*^9, 3.950957973036676*^9}, {
   3.9509590689899607`*^9, 3.9509591157318487`*^9}, {3.9509591472919817`*^9, 
   3.950959252858809*^9}, {3.9509592907067623`*^9, 3.9509592957039757`*^9}, {
   3.950959501450481*^9, 3.95095951130514*^9}, {3.950959686410345*^9, 
   3.950959714174095*^9}, 3.950959773470724*^9, {3.951034884384832*^9, 
   3.951034890869*^9}, {3.951035198689001*^9, 3.951035207408928*^9}, {
   3.951035268197209*^9, 3.951035301400906*^9}, {3.951035981870775*^9, 
   3.9510360006370783`*^9}, {3.951036246658142*^9, 3.95103626460588*^9}, {
   3.95103649033849*^9, 3.951036598302443*^9}, {3.951036633594223*^9, 
   3.951036785006905*^9}, {3.9510368169549932`*^9, 3.951036830730741*^9}, {
   3.951037206113153*^9, 3.95103734490982*^9}, {3.951037380987048*^9, 
   3.951037383677424*^9}, {3.951037439125901*^9, 3.951037496838653*^9}, {
   3.95103754050202*^9, 3.9510375690137587`*^9}, {3.9510376206837482`*^9, 
   3.951037625335888*^9}, {3.95103780882169*^9, 3.951037937002328*^9}, {
   3.951045322817977*^9, 3.95104532318824*^9}, {3.9510453867665377`*^9, 
   3.9510456103940287`*^9}, {3.95104564974853*^9, 3.951045666800379*^9}, {
   3.9510457134141083`*^9, 3.951045873397193*^9}, {3.951045915058331*^9, 
   3.9510460013306837`*^9}, {3.95104607626162*^9, 3.951046274552978*^9}, {
   3.951046466112495*^9, 3.951046728989846*^9}, {3.951046767530278*^9, 
   3.951046934066455*^9}, {3.9511072891096373`*^9, 3.951107324549317*^9}, {
   3.951107379842474*^9, 3.951107392161078*^9}, {3.951107584300604*^9, 
   3.95110759264114*^9}, {3.951107680371338*^9, 3.951107740154788*^9}, {
   3.951107781351058*^9, 3.9511077883787947`*^9}, {3.951107886223928*^9, 
   3.951107886588614*^9}, {3.951107926025846*^9, 3.951107950114067*^9}, {
   3.951108556054607*^9, 3.951108598328257*^9}, {3.9511196059065237`*^9, 
   3.951119683559124*^9}, {3.9511198861915407`*^9, 3.951119888700102*^9}, {
   3.951195813278051*^9, 3.95119584540624*^9}, {3.9511975255885773`*^9, 
   3.9511975266179333`*^9}, {3.95121043539817*^9, 3.951210463363813*^9}, 
   3.951285698816757*^9, 3.9512857380318813`*^9, {3.951287820920479*^9, 
   3.951287878783401*^9}, {3.9512879154103193`*^9, 3.951287918549728*^9}},
 CellLabel->
  "In[1067]:=",ExpressionUUID->"d8c7ad92-008a-409f-951b-580a3ca827cd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Checks and assertions", "Subsection",
 CellChangeTimes->{{3.932178009618313*^9, 3.932178022055203*^9}, {
  3.950801118933737*^9, 
  3.950801121691584*^9}},ExpressionUUID->"23b7e69d-dcbb-4fb0-a77e-\
b8638a031ad4"],

Cell[CellGroupData[{

Cell["FTerm and FEq", "Subsubsection",
 CellChangeTimes->{{3.9508642163296537`*^9, 3.950864226113566*^9}, {
  3.950964433513967*^9, 
  3.9509644360831413`*^9}},ExpressionUUID->"d438b387-4f31-41ce-a117-\
795b628d69b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FTermQ", "[", "expr_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Head", "[", "expr", "]"}], "===", "FTerm"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FTerm", "::", "notFTerm"}], "=", 
   "\"\<The term `1` is not an FTerm.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AssertFTerm", "[", "expr_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"Not", "@", 
       RowBox[{"FTermQ", "[", "expr", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{
         RowBox[{"FTerm", "::", "notFTerm"}], ",", "expr"}], "]"}], ";", 
       RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FEqQ", "[", "expr_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Head", "[", "expr", "]"}], "===", "FEq"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FEq", "::", "notFEq"}], "=", 
   "\"\<The term `1` is not an FEq.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AssertFEq", "[", "expr_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"FEqQ", "[", "expr", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"FEq", "::", "notFEq"}], ",", "expr"}], "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950959791226129*^9, 3.950959819925836*^9}, {
  3.950959877202113*^9, 3.950959965968995*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"63fbe29b-4af8-405d-80e3-5cbc9aa8d1d5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Field Space", "Subsubsection",
 CellChangeTimes->{{3.950801271735565*^9, 3.95080128037481*^9}, {
  3.9508933727376747`*^9, 
  3.950893373722165*^9}},ExpressionUUID->"f52392a8-ad40-44db-871d-\
0651868db7ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Check", " ", "if", " ", "a", " ", "given", " ", "field", " ", 
     "definition", " ", "is", " ", 
     RowBox[{"valid", ".", " ", "Can"}], " ", "be", " ", "either", " ", "its",
      " ", "own", " ", "anti"}], "-", 
    RowBox[{"field", " ", "or", " ", "a", " ", "pair", " ", 
     RowBox[{"{", 
      RowBox[{"af", ",", "f"}], "}"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FieldDefQ", "[", "expr_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "expr", "]"}], "===", "List"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "expr", "]"}], "=!=", "2"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<A field definition must be either of form f[x...] or \
{af[x...],f[x...]}. \\\"\>\"", ",", "expr", ",", 
                "\"\<\\\" does not fit.\>\""}], "]"}], ";", 
              RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", 
               RowBox[{"expr", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"Head", "[", 
               RowBox[{"expr", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<A field definition {af[x...],f[x...]} must have different \
field names af and f. \\\"\>\"", ",", "expr", ",", 
                "\"\<\\\" does not fit.\>\""}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Not", "@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"List", "@@", 
                 RowBox[{"(", 
                  RowBox[{"expr", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "===", 
                RowBox[{"List", "@@", 
                 RowBox[{"(", 
                  RowBox[{"expr", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ")"}]}]}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<A field definition {af[x...],f[x...]} must have identical \
indices. \\\"\>\"", ",", "expr", ",", "\"\<\\\" does not fit.\>\""}], "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Not", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"MatchQ", "[", 
                   RowBox[{
                    RowBox[{"expr", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"_Symbol", "[", 
                    RowBox[{"_", ",", 
                    RowBox[{"{", "__Symbol", "}"}]}], "]"}]}], "]"}], "||", 
                  RowBox[{"MatchQ", "[", 
                   RowBox[{
                    RowBox[{"expr", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"_Symbol", "[", "_", "]"}]}], "]"}]}], ")"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<A field definition f[x...] must have indices f[p] or \
f[p,{a,b,...}]. \\\"\>\"", ",", 
                  RowBox[{"expr", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  "\"\<\\\" does not fit.\>\""}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "True", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{"expr", ",", 
               RowBox[{"_Symbol", "[", 
                RowBox[{"_", ",", 
                 RowBox[{"{", "__Symbol", "}"}]}], "]"}]}], "]"}], "||", 
             RowBox[{"MatchQ", "[", 
              RowBox[{"expr", ",", 
               RowBox[{"_Symbol", "[", "_", "]"}]}], "]"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<A field definition f[x...] must have indices f[p] or \
f[p,{a,b,...}]. \\\"\>\"", ",", "expr", ",", "\"\<\\\" does not fit.\>\""}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FieldDef", "::", "invalidFieldDefinition"}], "=", 
     "\"\<The given field definition `1` is not valid.\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AssertFieldDef", "[", "expr_", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "@", 
        RowBox[{"FieldDefQ", "[", "expr", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"FieldDefinition", "::", "invalidFieldDefinition"}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9509723959533377`*^9, 3.950972498533544*^9}, {
  3.9509725391754503`*^9, 3.950972839103818*^9}, {3.95097289590053*^9, 
  3.950973043727556*^9}, {3.9509730775238113`*^9, 3.9509730807717524`*^9}, {
  3.950973155496664*^9, 3.950973196313613*^9}, {3.950973268996133*^9, 
  3.950973292848659*^9}, {3.950973323914188*^9, 3.950973407746553*^9}, {
  3.9509734394970713`*^9, 3.950973519577339*^9}, {3.950973729052182*^9, 
  3.9509737667166567`*^9}, {3.950976938011018*^9, 3.950976940198797*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"d2be4365-2a9f-4170-90b1-81e044dec426"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Check", " ", "if", " ", "a", " ", "given", " ", "field", " ", "space", 
    " ", "definition", " ", "is", " ", "valid"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FieldSpaceDefQ", "[", "fieldSpace_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "fieldSpace", "]"}], "=!=", "Association"}], 
          ",", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<An FSetup must be an association\>\"", "]"}], 
           ";", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Keys", "[", "fieldSpace", "]"}], "===", 
             RowBox[{"{", 
              RowBox[{"\"\<cField\>\"", ",", "\"\<Grassmann\>\""}], "}"}]}], 
            ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<fields must contain the two keys \
{\\\"cField\\\",\\\"Grassmann\\\"}!\>\"", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"ListQ", "[", 
            RowBox[{"fieldSpace", "[", "\"\<cField\>\"", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<fields[\\\"cField\\\"] must be a list!\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"(", 
            RowBox[{"And", "@@", 
             RowBox[{"Map", "[", 
              RowBox[{"FieldDefQ", ",", 
               RowBox[{"fieldSpace", "[", "\"\<cField\>\"", "]"}]}], "]"}]}], 
            ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<fields[\\\"cField\\\"] must contain valid fields!\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"ListQ", "[", 
            RowBox[{"fieldSpace", "[", "\"\<Grassmann\>\"", "]"}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<fields[\\\"Grassmann\\\"] must be a list!\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"(", 
            RowBox[{"And", "@@", 
             RowBox[{"Map", "[", 
              RowBox[{"FieldDefQ", ",", 
               RowBox[{"fieldSpace", "[", "\"\<Grassmann\>\"", "]"}]}], 
              "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<fields[\\\"Grassmann\\\"] must contain valid fields!\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FieldSpaceDefinition", "::", "invalidFieldDefinition"}], "=", 
     "\"\<The given field space definition is invalid.\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AssertFieldSpaceDef", "[", "fields_", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "@", 
        RowBox[{"FieldSpaceDefQ", "[", "fields", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"FieldSpaceDefinition", "::", "invalidFieldDefinition"}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950785803281868*^9, 3.950785830855114*^9}, {
   3.950786297997837*^9, 3.9507864029709253`*^9}, {3.950787129958323*^9, 
   3.9507871301602573`*^9}, {3.950795998774166*^9, 3.950796005485301*^9}, {
   3.9507965324786587`*^9, 3.950796562931445*^9}, {3.950796680245487*^9, 
   3.950796684703451*^9}, 3.950801142187722*^9, {3.9508637092253017`*^9, 
   3.950863710048918*^9}, {3.9508933587966433`*^9, 3.950893362683991*^9}, {
   3.950964560883992*^9, 3.9509647260060463`*^9}, 3.9509709919521027`*^9, {
   3.95097119902899*^9, 3.950971269684161*^9}, {3.950972406057185*^9, 
   3.950972419055738*^9}, {3.9509729891057043`*^9, 3.9509729901532373`*^9}, {
   3.950973052932276*^9, 3.950973069072235*^9}, {3.950973542193096*^9, 
   3.9509735933051243`*^9}, {3.9509736291278887`*^9, 
   3.9509737236713676`*^9}, {3.950973781220873*^9, 3.950973802678894*^9}, {
   3.950973984287372*^9, 3.950974058340818*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"ffdc8015-4beb-4a8a-9712-899076a5bcad"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.9509737011024*^9},
 CellLabel->
  "In[121]:=",ExpressionUUID->"e6fda6fb-9bcb-45a5-b801-7e006569f014"]
}, Closed]],

Cell[CellGroupData[{

Cell["FSetup", "Subsubsection",
 CellChangeTimes->{{3.9508642163296537`*^9, 3.950864226113566*^9}, 
   3.950964437586562*^9, 
   3.9509736149796743`*^9},ExpressionUUID->"432ab124-4161-47f8-a56b-\
8db469a3db21"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FSetup", "::", "notFSetup"}], "=", 
    "\"\<The given setup is not valid!\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FSetupQ", "[", "setup_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Head", "[", "setup", "]"}], "===", "Association"}], 
           ")"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<A valid setup must be an Association!\>\"", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "@", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Keys", "[", "setup", "]"}], ",", "\"\<FieldSpace\>\""}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<A valid setup must have the key \\\"FieldSpace\\\"!\>\"", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "@", 
          RowBox[{"FieldSpaceDefQ", "[", 
           RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AssertFSetup", "[", "setup_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "setup", "]"}], "===", "Association"}], 
          ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<A valid setup must be an Association!\>\"", "]"}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"Message", "[", 
          RowBox[{"FSetup", "::", "notFSetup"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "@", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"Keys", "[", "setup", "]"}], ",", "\"\<FieldSpace\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<A valid setup must have the key \\\"FieldSpace\\\"!\>\"", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Message", "[", 
          RowBox[{"FSetup", "::", "notFSetup"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"AssertFieldSpaceDef", "[", 
       RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950864013876114*^9, 3.950864178121345*^9}, {
  3.950866123517272*^9, 3.9508661552146883`*^9}, {3.95096155740795*^9, 
  3.950961589920692*^9}, {3.9509635332623377`*^9, 3.95096359322543*^9}, {
  3.9509709220279417`*^9, 3.950970986439794*^9}, {3.9509710317799788`*^9, 
  3.950971170043336*^9}, {3.950973871588525*^9, 3.950973901835678*^9}, {
  3.9509739679684*^9, 3.950973970944644*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"11470f5d-e2db-4aaa-9b7e-0a8c11da0687"]
}, Closed]],

Cell[CellGroupData[{

Cell["Existence of a field", "Subsubsection",
 CellChangeTimes->{{3.9508642163296537`*^9, 3.950864226113566*^9}, 
   3.950964437586562*^9, 3.9509736149796743`*^9, {3.951109567275919*^9, 
   3.951109569556551*^9}},ExpressionUUID->"73595dfd-e53e-4d4e-a700-\
40ff68a78e58"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Check", " ", "if", " ", "a", " ", "given", " ", "field", " ", 
     "definition", " ", "is", " ", 
     RowBox[{"valid", ".", " ", "Can"}], " ", "be", " ", "either", " ", "its",
      " ", "own", " ", "anti"}], "-", 
    RowBox[{"field", " ", "or", " ", "a", " ", "pair", " ", 
     RowBox[{"{", 
      RowBox[{"af", ",", "f"}], "}"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FieldQ", "[", 
      RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{"expr", ",", 
               RowBox[{"_Symbol", "[", 
                RowBox[{"_", ",", 
                 RowBox[{"{", "__Symbol", "}"}]}], "]"}]}], "]"}], "||", 
             RowBox[{"MatchQ", "[", 
              RowBox[{"expr", ",", 
               RowBox[{"_Symbol", "[", "_", "]"}]}], "]"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<A field f[x...] must have indices f[p] or f[p,{a,b,...}]. \\\
\"\>\"", ",", "expr", ",", "\"\<\\\" does not fit.\>\""}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"(", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{"Head", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "//", 
                  "Values"}], "//", "Flatten"}]}], "]"}], ",", 
              RowBox[{"Head", "[", "expr", "]"}]}], "]"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<The field \\\"\>\"", ",", "expr", ",", 
             "\"\<\\\" is not contained in the field space.\>\""}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Field", "::", "invalidField"}], "=", 
     "\"\<The given field `1` does not exist.\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AssertField", "[", 
      RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "@", 
        RowBox[{"FieldQ", "[", 
         RowBox[{"setup", ",", "expr"}], "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"FieldDefinition", "::", "invalidField"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9509723959533377`*^9, 3.950972498533544*^9}, {
  3.9509725391754503`*^9, 3.950972839103818*^9}, {3.95097289590053*^9, 
  3.950973043727556*^9}, {3.9509730775238113`*^9, 3.9509730807717524`*^9}, {
  3.950973155496664*^9, 3.950973196313613*^9}, {3.950973268996133*^9, 
  3.950973292848659*^9}, {3.950973323914188*^9, 3.950973407746553*^9}, {
  3.9509734394970713`*^9, 3.950973519577339*^9}, {3.950973729052182*^9, 
  3.9509737667166567`*^9}, {3.9509741552332573`*^9, 3.9509741985720987`*^9}, {
  3.9509742355449142`*^9, 3.9509742565395184`*^9}, {3.9509766019032183`*^9, 
  3.9509766041301928`*^9}, {3.9509766344861717`*^9, 3.950976637210259*^9}, {
  3.9509766769979153`*^9, 3.950976779031054*^9}, {3.9509769256787357`*^9, 
  3.9509769282539797`*^9}, {3.9510498517763968`*^9, 3.951049854349081*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"8025941a-3caa-4a8b-a6f7-d19c65a09782"]
}, Closed]],

Cell[CellGroupData[{

Cell["Derivative List", "Subsubsection",
 CellChangeTimes->{{3.9508642163296537`*^9, 3.950864226113566*^9}, {
  3.950893338644219*^9, 
  3.950893340478217*^9}},ExpressionUUID->"4586692a-ee51-46b9-b58e-\
43bcdb604423"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Check", " ", "a", " ", "derivative", " ", "list", " ", "for", " ", 
    "correct", " ", 
    RowBox[{"formatting", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"DerivativeListQ", "[", 
      RowBox[{"setup_", ",", "derivativeList_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", "derivativeList", "]"}], "===", "List"}], 
            ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<A valid derivativeList must be an List!\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"AllTrue", "[", 
            RowBox[{"derivativeList", ",", 
             RowBox[{
              RowBox[{"FieldQ", "[", 
               RowBox[{"setup", ",", "#"}], "]"}], "&"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<A valid derivativeList must be an List of fields \
f_[p_,{___}] of f_[p_] which have been defined in the setup!\>\"", "]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DeriveEquation", "::", "invalidDerivativeList"}], "=", 
     "\"\<The given derivativeList `1` is not valid.\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AssertDerivativeList", "[", 
      RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "@", 
        RowBox[{"DerivativeListQ", "[", 
         RowBox[{"setup", ",", "expr"}], "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"DeriveEquation", "::", "invalidDerivativeList"}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950864234236211*^9, 3.9508644603567677`*^9}, {
   3.950864514373273*^9, 3.950864523736723*^9}, {3.950865674724793*^9, 
   3.9508656803898973`*^9}, {3.950866001476939*^9, 3.950866011277586*^9}, {
   3.950866277809552*^9, 3.950866291301694*^9}, 3.9508663653146677`*^9, 
   3.95086639713623*^9, {3.95097396076858*^9, 3.950973963799748*^9}, {
   3.9509740743483953`*^9, 3.95097409846065*^9}, {3.9509767888540382`*^9, 
   3.95097688937116*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"d04f551f-63ba-4c59-827e-89539a889eb6"]
}, Closed]],

Cell[CellGroupData[{

Cell["FDOp", "Subsubsection",
 CellChangeTimes->{{3.9508642163296537`*^9, 3.950864226113566*^9}, {
  3.950964433513967*^9, 3.9509644360831413`*^9}, {3.951109340007738*^9, 
  3.9511093407521*^9}},ExpressionUUID->"bb6d67ae-94ea-4de9-ad33-f49796906916"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", "FDOp", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "FDOp", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FDOp", "::", "invalid"}], "=", 
   "\"\<`1` is not a valid FDOp.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FDOp", "::", "invalidArguments"}], "=", 
   "\"\<`1` is not a valid FDOp. FDOp takes a single field with an index as \
argument.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FDOp", "::", "arithmetic"}], "=", 
    "\"\<An FDOp cannot be included as anything but a factor in an FTerm. \
Error in \n  `1`\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"FDOp", "/:", 
  RowBox[{"Times", "[", 
   RowBox[{"a___", ",", 
    RowBox[{"FDOp", "[", "b___", "]"}], ",", "c___"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"FDOp", "::", "arithmetic"}], ",", 
      RowBox[{"StringTake", "[", 
       RowBox[{
        RowBox[{"ToString", "@", 
         RowBox[{"(", 
          RowBox[{"Hold", "@", 
           RowBox[{"Times", "[", 
            RowBox[{"a", ",", 
             RowBox[{"FDOp", "[", "b", "]"}], ",", "c"}], "]"}]}], ")"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"6", ",", 
          RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], "]"}], ";", 
    RowBox[{"Abort", "[", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDOp", "/:", 
   RowBox[{"Plus", "[", 
    RowBox[{"a___", ",", 
     RowBox[{"FDOp", "[", "b___", "]"}], ",", "c___"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"FDOp", "::", "arithmetic"}], ",", 
       RowBox[{"StringTake", "[", 
        RowBox[{
         RowBox[{"ToString", "@", 
          RowBox[{"(", 
           RowBox[{"Hold", "@", 
            RowBox[{"Plus", "[", 
             RowBox[{"a", ",", 
              RowBox[{"FDOp", "[", "b", "]"}], ",", "c"}], "]"}]}], ")"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"6", ",", 
           RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], "]"}], ";", 
     RowBox[{"Abort", "[", "]"}]}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FDOp", "[", 
    RowBox[{"a_", ",", "b__"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"FDOp", "::", "invalidArguments"}], ",", 
       RowBox[{"StringTake", "[", 
        RowBox[{
         RowBox[{"ToString", "@", 
          RowBox[{"(", 
           RowBox[{"Hold", "@", 
            RowBox[{"FDOp", "[", 
             RowBox[{"a", ",", "b"}], "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"6", ",", 
           RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], "]"}], ";", 
     RowBox[{"Abort", "[", "]"}]}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FDOpQ", "[", 
    RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Head", "[", "expr", "]"}], "===", "FDOp"}], ")"}], "&&", 
      RowBox[{"MatchQ", "[", 
       RowBox[{"expr", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"_", "[", 
           RowBox[{"_", ",", 
            RowBox[{"{", "__", "}"}]}], "]"}], "|", 
          RowBox[{"_", "[", "_", "]"}]}], ")"}]}], "]"}], "&&", 
      RowBox[{"FieldQ", "[", 
       RowBox[{"setup", ",", "#"}], "]"}]}], "&"}], "@@", "expr"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AssertFDOp", "[", 
     RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"Not", "@", 
       RowBox[{"FDOpQ", "[", 
        RowBox[{"setup", ",", "expr"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{
         RowBox[{"FDOp", "::", "invalid"}], ",", "expr"}], "]"}], ";", 
       RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "FDOp", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950959791226129*^9, 3.950959819925836*^9}, {
   3.950959877202113*^9, 3.950959965968995*^9}, {3.951109344001295*^9, 
   3.9511093512403717`*^9}, {3.951109385069475*^9, 3.951109490384367*^9}, {
   3.951109575180601*^9, 3.951109623509289*^9}, {3.9512836351836367`*^9, 
   3.951283964372046*^9}, {3.951284035067808*^9, 3.951284092700465*^9}, {
   3.951284638235787*^9, 3.951284775688508*^9}, 3.9512848078377867`*^9, {
   3.951284931040797*^9, 3.951284940471984*^9}, {3.951284975621332*^9, 
   3.951285244742639*^9}, {3.951286114829897*^9, 3.9512862662903748`*^9}, 
   3.9512863198820457`*^9, {3.9512863705738792`*^9, 3.951286468490302*^9}, 
   3.9512866511509457`*^9},
 CellLabel->
  "In[902]:=",ExpressionUUID->"cec32202-2ccb-4a54-a11b-3d74e2fc5239"]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Utilities", "Section",
 CellChangeTimes->{{3.932177970725307*^9, 
  3.9321779720559883`*^9}},ExpressionUUID->"bdee160a-1c91-4de1-b52d-\
86eb572207e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Protect", "[", 
   RowBox[{
   "GammaN", ",", "Propagator", ",", "AnyField", ",", "ABasis", ",", 
    "VBasis"}], "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950894219634593*^9, 3.950894225625526*^9}, {
   3.9508945494140673`*^9, 3.9508945506586037`*^9}, 3.950940101789105*^9, {
   3.95097703546941*^9, 3.95097703915795*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"8b16408f-667b-4fec-b260-6fb6db16586b"],

Cell[CellGroupData[{

Cell["Getting symbols", "Subsubsection",
 CellChangeTimes->{{3.951227382795168*^9, 
  3.9512273921081133`*^9}},ExpressionUUID->"d002c263-ec1e-44d9-8d95-\
a0c4fe2e8e78"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"exclusions", "[", "a_", "]"}], ":=", 
  RowBox[{"And", "@@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "=!=", "List"}], ",", 
     RowBox[{"a", "=!=", "Complex"}], ",", 
     RowBox[{"a", "=!=", "Plus"}], ",", 
     RowBox[{"a", "=!=", "Power"}], ",", 
     RowBox[{"a", "=!=", "Times"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetAllSymbols", "[", "expr_", "]"}], ":=", 
  RowBox[{"DeleteDuplicates", "@", 
   RowBox[{"Cases", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "expr", "}"}], "//.", 
        RowBox[{
         RowBox[{"Times", "[", 
          RowBox[{"a_", ",", "b__"}], "]"}], ":>", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}]}]}], "//.", 
       RowBox[{
        RowBox[{
         RowBox[{"a_Symbol", "[", "b__", "]"}], "/;", 
         RowBox[{"exclusions", "[", "a", "]"}]}], ":>", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", "_Symbol", ",", "\[IndentingNewLine]", 
     "Infinity"}], "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9510242717398663`*^9, 3.951024280343438*^9}, 
   3.951024444887616*^9, {3.951229169059124*^9, 3.9512291793424377`*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"f4704157-c7f9-402c-bf7c-77513ac8ecc7"]
}, Closed]],

Cell[CellGroupData[{

Cell["FunctionalD", "Subsection",
 CellChangeTimes->{{3.932178009618313*^9, 3.932178022055203*^9}, {
  3.950801118933737*^9, 
  3.950801154023693*^9}},ExpressionUUID->"5193f3f7-8901-4525-bbbc-\
d3fa4695bea7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FunctionalD", "::", "malformed"}], "=", 
    "\"\<Cannot take a derivative of `1`. Expression is either malformed or \
this is a bug.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "FunctionalD", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FunctionalD", "[", 
     RowBox[{"expr_", ",", 
      RowBox[{"v", ":", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f_", "[", "_", "]"}], "|", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"f_", "[", "_", "]"}], ",", "_Integer"}], "}"}]}], ")"}], 
        ".."}]}], ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"Internal`InheritedBlock", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "f", ",", "GammaN", ",", "Propagator", ",", "nonConst", ",", "FTerm", 
        ",", "FEq"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nonConst", "=", 
        RowBox[{"Sort", "@", 
         RowBox[{"{", 
          RowBox[{"f", ",", "GammaN", ",", "Propagator", ",", "Power"}], 
          "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Unprotect", "[", 
        RowBox[{
        "GammaN", ",", "Propagator", ",", "FTerm", ",", "FEq", ",", 
         "AnyField"}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Rule", " ", "for", " ", "normal", " ", "functional", " ", 
         "derivatives"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"f", "/:", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"f", "[", "x_", "]"}], ",", 
          RowBox[{"f", "[", "y_", "]"}], ",", 
          RowBox[{"NonConstants", "->", "nonConst"}]}], "]"}], ":=", 
        RowBox[{"\[Gamma]", "[", 
         RowBox[{
          RowBox[{"-", "y"}], ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Ignore", " ", "fields", " ", "without", " ", 
         RowBox[{"indices", ".", " ", "These"}], " ", "are", " ", "usually", 
         " ", "tags"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"f", "/:", 
        RowBox[{"D", "[", 
         RowBox[{"f", ",", 
          RowBox[{"f", "[", "y_", "]"}], ",", 
          RowBox[{"NonConstants", "->", "nonConst"}]}], "]"}], ":=", "0"}], 
       ";", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Delta]", "[", 
           RowBox[{"#", ",", "y"}], "]"}], "&"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Derivative", " ", "rule", " ", "for", " ", "GammaN"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"GammaN", "/:", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"GammaN", "[", 
           RowBox[{
            RowBox[{"{", "a__", "}"}], ",", 
            RowBox[{"{", "b__", "}"}]}], "]"}], ",", 
          RowBox[{"f", "[", "if_", "]"}], ",", 
          RowBox[{"NonConstants", "->", "nonConst"}]}], "]"}], ":=", 
        RowBox[{"GammaN", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"f", ",", "a"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "if"}], ",", "b"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Derivative", " ", "rule", " ", "for", " ", "Propagators"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Propagator", "/:", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"Propagator", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"b_", ",", "a_"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"ib_", ",", "ia_"}], "}"}]}], "]"}], ",", 
          RowBox[{"f", "[", "if_", "]"}], ",", 
          RowBox[{"NonConstants", "->", "nonConst"}]}], "]"}], ":=", 
        RowBox[{"Module", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ic", ",", "id", ",", "ie"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Propagator", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"b", ",", "AnyField"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"ib", ",", "ic"}], "}"}]}], "]"}], 
           RowBox[{"GammaN", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"f", ",", "AnyField", ",", "AnyField"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "if"}], ",", 
               RowBox[{"-", "ic"}], ",", 
               RowBox[{"-", "id"}]}], "}"}]}], "]"}], 
           RowBox[{"Propagator", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"AnyField", ",", "a"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"id", ",", "ie"}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"\[Gamma]", "[", 
            RowBox[{"ia", ",", 
             RowBox[{"-", "ie"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"No", " ", "derivatives", " ", "of", " ", "FTerm"}], ",", 
         " ", "FEq"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"FTerm", "/:", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"FTerm", "[", "a___", "]"}], ",", 
          RowBox[{"f", "[", "y_", "]"}], ",", 
          RowBox[{"NonConstants", "->", "nonConst"}]}], "]"}], ":=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"FunctionalD", "::", "malformed"}], ",", 
            RowBox[{"FTerm", "[", "a", "]"}]}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"FEq", "/:", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"FEq", "[", "a___", "]"}], ",", 
          RowBox[{"f", "[", "y_", "]"}], ",", 
          RowBox[{"NonConstants", "->", "nonConst"}]}], "]"}], ":=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"FunctionalD", "::", "malformed"}], ",", 
            RowBox[{"FEq", "[", "a", "]"}]}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Chain", " ", "rules"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"f", "/:", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"g_", "[", 
           RowBox[{"FTerm", "[", "a___", "]"}], "]"}], ",", 
          RowBox[{"f", "[", "y_", "]"}], ",", 
          RowBox[{"NonConstants", "->", "nonConst"}]}], "]"}], ":=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"FTerm", "[", 
           RowBox[{
            RowBox[{"g", "'"}], "[", 
            RowBox[{"FTerm", "[", "a", "]"}], "]"}], "]"}], "**", 
          RowBox[{"FTerm", "[", 
           RowBox[{
            RowBox[{"FDOp", "[", 
             RowBox[{"f", "[", "y", "]"}], "]"}], ",", "a"}], "]"}]}], 
         ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"f", "/:", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"FTerm", "[", "a___", "]"}], ",", "b_"}], "]"}], ",", 
          RowBox[{"f", "[", "y_", "]"}], ",", 
          RowBox[{"NonConstants", "->", "nonConst"}]}], "]"}], ":=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"FTerm", "[", 
           RowBox[{"b", ",", 
            RowBox[{"Power", "[", 
             RowBox[{
              RowBox[{"FTerm", "[", "a", "]"}], ",", 
              RowBox[{"b", "-", "1"}]}], "]"}]}], "]"}], "**", 
          RowBox[{"FTerm", "[", 
           RowBox[{
            RowBox[{"FDOp", "[", 
             RowBox[{"f", "[", "y", "]"}], "]"}], ",", "a"}], "]"}]}], 
         ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"f", "/:", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{"a_", ",", 
            RowBox[{"FTerm", "[", "b___", "]"}]}], "]"}], ",", 
          RowBox[{"f", "[", "y_", "]"}], ",", 
          RowBox[{"NonConstants", "->", "nonConst"}]}], "]"}], ":=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"FTerm", "[", 
           RowBox[{
            RowBox[{"Log", "[", "a", "]"}], ",", 
            RowBox[{"Power", "[", 
             RowBox[{"a", ",", 
              RowBox[{"FTerm", "[", "b", "]"}]}], "]"}]}], "]"}], "**", 
          RowBox[{"FTerm", "[", 
           RowBox[{
            RowBox[{"FDOp", "[", 
             RowBox[{"f", "[", "y", "]"}], "]"}], ",", "b"}], "]"}]}], 
         ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Protect", "[", 
        RowBox[{
        "GammaN", ",", "Propagator", ",", "FTerm", ",", "FEq", ",", 
         "AnyField"}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"D", "[", 
        RowBox[{"expr", ",", "v", ",", 
         RowBox[{"NonConstants", "->", "nonConst"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FunctionalD", "::", "badArgumentFTerm"}], "=", 
   "\"\<Cannot take derivative of an FTerm. Use DeriveFunctional \
instead.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FunctionalD", "[", 
     RowBox[{
      RowBox[{"FTerm", "[", "expr_", "]"}], ",", 
      RowBox[{"v", ":", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f_", "[", "_", "]"}], "|", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"f_", "[", "_", "]"}], ",", "_Integer"}], "}"}]}], ")"}], 
        ".."}]}], ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"FunctionalD", "::", "badArgumentFTerm"}], "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FunctionalD", "::", "badArgumentFEq"}], "=", 
   "\"\<Cannot take derivative of an FEq. Use DeriveFunctional \
instead.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FunctionalD", "[", 
    RowBox[{
     RowBox[{"FEq", "[", "___", "]"}], ",", 
     RowBox[{"v", ":", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"f_", "[", "_", "]"}], "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"f_", "[", "_", "]"}], ",", "_Integer"}], "}"}]}], ")"}], 
       ".."}]}], ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"FunctionalD", "::", "badArgumentFEq"}], "]"}], ";", 
     RowBox[{"Abort", "[", "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950801155924999*^9, 3.950801156180604*^9}, 
   3.9508745541091022`*^9, {3.950874630546281*^9, 3.9508746344224*^9}, {
   3.9508746716147623`*^9, 3.950874843953817*^9}, {3.950874911320944*^9, 
   3.950874967970771*^9}, {3.9508750098040237`*^9, 3.9508750233744373`*^9}, {
   3.9508750787554817`*^9, 3.950875148206582*^9}, 3.9508752181802464`*^9, {
   3.9508940369998207`*^9, 3.9508941754057407`*^9}, {3.950894207218882*^9, 
   3.950894268707493*^9}, {3.9508943099823914`*^9, 3.950894364887673*^9}, {
   3.950894405287778*^9, 3.9508945587833138`*^9}, {3.9508969076834803`*^9, 
   3.9508969664507713`*^9}, {3.950897004655106*^9, 3.950897015070427*^9}, 
   3.9508971564032593`*^9, {3.950897870040359*^9, 3.950897884551845*^9}, {
   3.950897973224579*^9, 3.9508980022919607`*^9}, {3.9509326427332706`*^9, 
   3.95093266159977*^9}, {3.950939662750992*^9, 3.950939674049011*^9}, {
   3.950939753193946*^9, 3.950939895705489*^9}, {3.95093993866444*^9, 
   3.950939957812808*^9}, {3.9509401218698893`*^9, 3.9509401363101273`*^9}, {
   3.950952533276232*^9, 3.950952545138974*^9}, {3.95095258820336*^9, 
   3.950952722829163*^9}, {3.950952869771017*^9, 3.950953031163056*^9}, {
   3.950977047894329*^9, 3.950977350633822*^9}, {3.951195240203231*^9, 
   3.951195388802322*^9}, {3.951195471889974*^9, 3.951195473766608*^9}, {
   3.9511956520381613`*^9, 3.951195788170877*^9}, {3.9511959410810537`*^9, 
   3.951196141638171*^9}, {3.951196344392086*^9, 3.951196366474864*^9}, {
   3.951196844077084*^9, 3.951196875012323*^9}, {3.951197122093006*^9, 
   3.9511971892386637`*^9}, {3.951197222455007*^9, 3.9511972662623672`*^9}, 
   3.951197330985343*^9, {3.951197540127527*^9, 3.951197713002768*^9}, {
   3.9511977856706*^9, 3.951197818994656*^9}, {3.951197859170909*^9, 
   3.9511978849442472`*^9}, {3.951197917748715*^9, 3.951197953999455*^9}, {
   3.951198041247632*^9, 3.951198053693543*^9}, {3.951198099815494*^9, 
   3.951198115660613*^9}, {3.951198148168233*^9, 3.9511981579505587`*^9}, {
   3.9511981890961323`*^9, 3.95119819493015*^9}, {3.951198226487218*^9, 
   3.9511983610114326`*^9}, {3.951212249172265*^9, 3.9512122738997297`*^9}, {
   3.951212336789455*^9, 3.95121235450749*^9}, {3.9512124129764843`*^9, 
   3.951212432487711*^9}, {3.951212477416629*^9, 3.951212621805851*^9}, {
   3.951212679266748*^9, 3.951212717406486*^9}, {3.9512127594075603`*^9, 
   3.951212800564825*^9}, {3.951212848069742*^9, 3.951212852984906*^9}, {
   3.9512128925965843`*^9, 3.9512128932405643`*^9}, 3.951212942528529*^9, {
   3.951213304723278*^9, 3.9512133814804163`*^9}, {3.9512135401374474`*^9, 
   3.9512135831050463`*^9}, {3.9512136829537783`*^9, 3.95121377398514*^9}, {
   3.951213841275055*^9, 3.9512138820107107`*^9}, {3.951214165220489*^9, 
   3.951214166107987*^9}, {3.951214264868593*^9, 3.951214265319968*^9}, {
   3.951214410771542*^9, 3.951214552289424*^9}, {3.951214666616063*^9, 
   3.951214683032452*^9}, {3.9512147251411657`*^9, 3.9512148731638536`*^9}, 
   3.951214948313456*^9, {3.951215032782189*^9, 3.9512150650325613`*^9}, 
   3.9512151161690197`*^9, {3.9512152756823273`*^9, 3.951215285333046*^9}, 
   3.951215323874226*^9, {3.951215389461582*^9, 3.951215459245329*^9}, {
   3.9512155060238323`*^9, 3.9512155379434958`*^9}, {3.95121557326906*^9, 
   3.951215573427577*^9}, {3.9512156059663343`*^9, 3.95121587158613*^9}, {
   3.951215903365415*^9, 3.951215904513631*^9}, {3.951215980269064*^9, 
   3.9512159890299873`*^9}, {3.9512160291775017`*^9, 3.95121607124547*^9}, {
   3.951216118275013*^9, 3.95121623279858*^9}, {3.951219946242391*^9, 
   3.951219968247802*^9}, {3.951220438913568*^9, 3.9512204416073923`*^9}, {
   3.9512205345107737`*^9, 3.95122053549841*^9}, {3.951231437902248*^9, 
   3.9512314416134233`*^9}, {3.9512866947259703`*^9, 3.951286717389337*^9}, {
   3.951286755884138*^9, 3.951286756498644*^9}},
 CellLabel->
  "In[923]:=",ExpressionUUID->"428f55da-c8db-4d63-89da-51a880a4e13f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Field and index information", "Subsection",
 CellChangeTimes->{{3.932178009618313*^9, 3.932178022055203*^9}, {
  3.95097752282972*^9, 
  3.950977525821363*^9}},ExpressionUUID->"a703f905-419d-403f-a28c-\
a63b6e5d0fbc"],

Cell[CellGroupData[{

Cell["Fields", "Subsubsection",
 CellChangeTimes->{{3.950977858978568*^9, 
  3.9509778685688467`*^9}},ExpressionUUID->"807846d5-0a8e-42e1-8499-\
9436b99fe5c0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetcFields", "[", "setup_", "]"}], ":=", 
   RowBox[{"Map", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "#", "]"}], "===", "List"}], ",", 
        RowBox[{"Head", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
        RowBox[{"Head", "[", "#", "]"}]}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
      "\"\<cField\>\"", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetAnticFields", "[", "setup_", "]"}], ":=", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Map", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "#", "]"}], "===", "List"}], ",", 
           RowBox[{"Head", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", "}"}]}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
         "\"\<cField\>\"", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{
       RowBox[{"#", "=!=", 
        RowBox[{"{", "}"}]}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetGrassmanns", "[", "setup_", "]"}], ":=", 
   RowBox[{"Map", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "#", "]"}], "===", "List"}], ",", 
        RowBox[{"Head", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
        RowBox[{"Head", "[", "#", "]"}]}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
      "\"\<Grassmann\>\"", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetAntiGrassmanns", "[", "setup_", "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Map", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "#", "]"}], "===", "List"}], ",", 
          RowBox[{"Head", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", "}"}]}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
        "\"\<Grassmann\>\"", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{
      RowBox[{"#", "=!=", 
       RowBox[{"{", "}"}]}], "&"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.932178093219666*^9, {3.932220707851465*^9, 3.932220747249592*^9}, {
   3.950800893485785*^9, 3.950800987632131*^9}, {3.9508016274975567`*^9, 
   3.950801660952232*^9}, {3.95086373016462*^9, 3.95086377625705*^9}, {
   3.950977908402094*^9, 3.9509779098545*^9}, {3.95097858078232*^9, 
   3.950978634866104*^9}, {3.950978675954303*^9, 3.9509786993099747`*^9}, 
   3.950978744078698*^9, {3.951022968366856*^9, 3.951023141306739*^9}, {
   3.9510232320318317`*^9, 3.951023236902824*^9}, {3.951023401747789*^9, 
   3.951023405927434*^9}, {3.951023697339532*^9, 3.9510237141319427`*^9}, {
   3.9510240171202173`*^9, 3.951024058934989*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"3518af78-5ff7-49ca-9232-57a8cda2059b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetFieldPairs", "[", "setup_", "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Head", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Head", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Select", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
           "\"\<Grassmann\>\"", "]"}], ",", 
          RowBox[{
           RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
           "\"\<cField\>\"", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "#", "]"}], "===", "List"}], "&"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetSingleFields", "[", "setup_", "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Head", "[", "#", "]"}], "&"}], ",", 
      RowBox[{"Select", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
           "\"\<Grassmann\>\"", "]"}], ",", 
          RowBox[{
           RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
           "\"\<cField\>\"", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "#", "]"}], "=!=", "List"}], "&"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetAllFields", "[", "setup_", "]"}], ":=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Flatten", "@", 
       RowBox[{"GetFieldPairs", "[", "setup", "]"}]}], ",", 
      RowBox[{"GetSingleFields", "[", "setup", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HasPartnerField", "[", 
    RowBox[{"setup_", ",", "field_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Flatten", "@", 
      RowBox[{"GetFieldPairs", "[", "setup", "]"}]}], ",", 
     "\[IndentingNewLine]", "field"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HasPartnerField", "[", 
     RowBox[{"setup_", ",", 
      RowBox[{"field_", "[", "__", "]"}]}], "]"}], ":=", 
    RowBox[{"HasPartnerField", "[", 
     RowBox[{"setup", ",", "field"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IsGrassmann", "[", 
    RowBox[{"setup_", ",", "field_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"GetGrassmanns", "[", "setup", "]"}], ",", "field", ",", 
     "Infinity"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsGrassmann", "[", 
     RowBox[{"setup_", ",", 
      RowBox[{"field_", "[", "__", "]"}]}], "]"}], ":=", 
    RowBox[{"IsGrassmann", "[", 
     RowBox[{"setup", ",", "field"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IsAntiGrassmann", "[", 
    RowBox[{"setup_", ",", "field_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"GetAntiGrassmanns", "[", "setup", "]"}], ",", "field", ",", 
     "Infinity"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsAntiGrassmann", "[", 
     RowBox[{"setup_", ",", 
      RowBox[{"field_", "[", "__", "]"}]}], "]"}], ":=", 
    RowBox[{"IsAntiGrassmann", "[", 
     RowBox[{"setup", ",", "field"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IscField", "[", 
    RowBox[{"setup_", ",", "field_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"GetcFields", "[", "setup", "]"}], ",", "field", ",", 
     "Infinity"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IscField", "[", 
     RowBox[{"setup_", ",", 
      RowBox[{"field_", "[", "__", "]"}]}], "]"}], ":=", 
    RowBox[{"IscField", "[", 
     RowBox[{"setup", ",", "field"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IsAnticField", "[", 
    RowBox[{"setup_", ",", "field_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"GetAnticFields", "[", "setup", "]"}], ",", "field", ",", 
     "Infinity"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IsAnticField", "[", 
    RowBox[{"setup_", ",", 
     RowBox[{"field_", "[", "__", "]"}]}], "]"}], ":=", 
   RowBox[{"IsAnticField", "[", 
    RowBox[{"setup", ",", "field"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951023163939932*^9, 3.951023253706765*^9}, {
  3.9510232893183107`*^9, 3.9510233580953617`*^9}, {3.951023414375457*^9, 
  3.951023635439684*^9}, {3.951023724604463*^9, 3.951023800417603*^9}, {
  3.951024061485753*^9, 3.9510240986479816`*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"51b5119b-7ed2-4d4e-8157-9da88d9e51a3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetPartnerField", "[", 
    RowBox[{"setup_", ",", "field_Symbol"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pairs", ",", "sel"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "@", 
         RowBox[{"HasPartnerField", "[", 
          RowBox[{"setup", ",", "field"}], "]"}]}], ",", 
        RowBox[{"Return", "[", "field", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pairs", "=", 
       RowBox[{"GetFieldPairs", "[", "setup", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"sel", "=", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"pairs", ",", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"#", ",", "field", ",", "Infinity"}], "]"}], "&"}]}], 
         "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sel", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"sel", ",", "field"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "sel", "]"}], ">", "0"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"sel", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<field \>\"", ",", "field", ",", "\"\< not found!\>\""}], 
       "]"}], ";", 
      RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetPartnerField", "[", 
   RowBox[{"setup_", ",", 
    RowBox[{"field_Symbol", "[", "i__", "]"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"GetPartnerField", "[", 
    RowBox[{"setup", ",", "field"}], "]"}], "[", "i", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.932310703182301*^9, {3.9508008732217073`*^9, 3.950800905255765*^9}, 
   3.950874299413641*^9, {3.951023598531598*^9, 3.951023612563867*^9}, {
   3.951023642999547*^9, 3.9510236672477427`*^9}, {3.951023815416168*^9, 
   3.951023941927535*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"f9e7b8dd-479d-4f1c-b30c-43e82a8f1466"]
}, Closed]],

Cell[CellGroupData[{

Cell["Checking field content of expressions", "Subsubsection",
 CellChangeTimes->{{3.9510239782885523`*^9, 
  3.951023985187344*^9}},ExpressionUUID->"d2a5f7e9-fbf3-48fd-896b-\
3c3a13529cd2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExtractFields", "[", 
    RowBox[{"setup_Association", ",", "expr_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "symbols", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"symbols", "=", 
       RowBox[{"GetAllSymbols", "[", "expr", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "@", 
       RowBox[{"Select", "[", 
        RowBox[{"symbols", ",", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"GetAllFields", "[", "setup", "]"}], ",", "#"}], "]"}], 
          "&"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtractFieldsWithIndex", "[", 
    RowBox[{"setup_Association", ",", "expr_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fields", ",", "extracted"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fields", "=", 
       RowBox[{"ExtractFields", "[", 
        RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"extracted", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"expr", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"a_", "[", "b_", "]"}], "/;", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"fields", ",", "a"}], "]"}]}], ":>", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"extracted", ",", 
             RowBox[{"a", "[", "b", "]"}]}], "]"}], ";", "1"}], ")"}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "extracted", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951024006516164*^9, 3.951024008440085*^9}, {
  3.951024116163844*^9, 3.951024187756226*^9}, {3.951024231427863*^9, 
  3.951024239820277*^9}, {3.951024468384468*^9, 3.951024487333744*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"84ac980c-3e5a-487b-a821-389318a8bd26"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ContainsGrassmann", "[", 
   RowBox[{"setup_Association", ",", "expr_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "fields", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fields", "=", 
      RowBox[{"ExtractFields", "[", 
       RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "\[IndentingNewLine]", 
      RowBox[{"AnyTrue", "[", 
       RowBox[{"fields", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"IsGrassmann", "[", 
           RowBox[{"setup", ",", "#"}], "]"}], "||", 
          RowBox[{"IsAntiGrassmann", "[", 
           RowBox[{"setup", ",", "#"}], "]"}]}], "&"}]}], "]"}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GrassmannCount", "[", 
   RowBox[{"setup_Association", ",", "expr_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "fields", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fields", "=", 
      RowBox[{"ExtractFieldsWithIndex", "[", 
       RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"Length", "@", "\[IndentingNewLine]", 
       RowBox[{"Select", "[", 
        RowBox[{"fields", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"IsGrassmann", "[", 
            RowBox[{"setup", ",", 
             RowBox[{"Head", "[", "#", "]"}]}], "]"}], "||", 
           RowBox[{"IsAntiGrassmann", "[", 
            RowBox[{"setup", ",", 
             RowBox[{"Head", "[", "#", "]"}]}], "]"}]}], "&"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950801014829342*^9, 3.950801089487433*^9}, {
   3.9508016734862947`*^9, 3.950801789647143*^9}, {3.950802396390094*^9, 
   3.95080251586098*^9}, {3.9508025705613623`*^9, 3.9508025986163673`*^9}, {
   3.950802685581463*^9, 3.950802850019553*^9}, {3.95080288950806*^9, 
   3.950802891116541*^9}, 3.950977841322421*^9, 3.9510239548515882`*^9, {
   3.951047050359741*^9, 3.951047092694622*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"e0675219-06d7-4260-b88e-aecc77330bb2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Indices", "Subsubsection",
 CellChangeTimes->{{3.950801271735565*^9, 3.95080128037481*^9}, {
  3.950854198551154*^9, 
  3.950854199116568*^9}},ExpressionUUID->"4d34a9f6-835b-4d0e-bded-\
e4ef20d68c82"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Get", " ", "a", " ", "list", " ", "of", " ", "all", " ", "unique", " ", 
     "super"}], "-", 
    RowBox[{
    "indices", " ", "within", " ", "the", " ", "expression", " ", "expr"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GetAllSuperIndices", "[", 
     RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fields", ",", "indices", ",", "i", ",", "j"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fields", "=", 
        RowBox[{"ExtractFieldsWithIndex", "[", 
         RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"indices", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fields", "//.", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"p_", "[", 
            RowBox[{"Times", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "a_"}], "]"}], "]"}], "/;", 
           RowBox[{"exclusions", "[", "p", "]"}]}], ":>", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"indices", ",", "a"}], "]"}], ";", "1"}], ")"}]}]}], "//.",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"p_", "[", "a_", "]"}], "/;", 
          RowBox[{"exclusions", "[", "p", "]"}]}], ":>", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"indices", ",", "a"}], "]"}], ";", "1"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"expr", "//.", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"$indexedObjects", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{
               RowBox[{"{", "f__", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 TagBox[
                  StyleBox[
                   RowBox[{"Times", "[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"a", ":", 
                    RowBox[{"(", 
                    RowBox[{
                    "_Symbol", "|", "_Subscript", "|", "_Superscript"}], 
                    ")"}]}]}], "]"}],
                   ShowSpecialCharacters->False,
                   ShowStringCharacters->True,
                   NumberMarks->True],
                  FullForm], ",", "b___"}], "}"}]}], "]"}], ":>", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"indices", ",", "a"}], "]"}], ";", 
               RowBox[{
                RowBox[{"$indexedObjects", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{
                 RowBox[{"{", "f", "}"}], ",", 
                 RowBox[{"{", "b", "}"}]}], "]"}]}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"$indexedObjects", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{
               RowBox[{"{", "f__", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 TagBox[
                  RowBox[{"a", ":", 
                   RowBox[{"(", 
                    RowBox[{
                    "_Symbol", "|", "_Subscript", "|", "_Superscript"}], 
                    ")"}]}],
                  FullForm], ",", "b___"}], "}"}]}], "]"}], ":>", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"indices", ",", "a"}], "]"}], ";", 
               RowBox[{
                RowBox[{"$indexedObjects", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{
                 RowBox[{"{", "f", "}"}], ",", 
                 RowBox[{"{", "b", "}"}]}], "]"}]}], ")"}]}]}], 
           "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "$indexedObjects", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"expr", "//.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Delta]", "[", 
            RowBox[{
             TagBox[
              StyleBox[
               RowBox[{"Times", "[", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"a", ":", 
                  RowBox[{"(", 
                   RowBox[{
                   "_Symbol", "|", "_Subscript", "|", "_Superscript"}], 
                   ")"}]}]}], "]"}],
               ShowSpecialCharacters->False,
               ShowStringCharacters->True,
               NumberMarks->True],
              FullForm], ",", "b___"}], "]"}], ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"indices", ",", "a"}], "]"}], ";", 
             RowBox[{"\[Delta]", "[", "b", "]"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[Delta]", "[", 
            RowBox[{
             RowBox[{"a", ":", 
              RowBox[{"(", 
               RowBox[{"_Symbol", "|", "_Subscript", "|", "_Superscript"}], 
               ")"}]}], ",", "b___"}], "]"}], ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"indices", ",", "a"}], "]"}], ";", 
             RowBox[{"\[Delta]", "[", "b", "]"}]}], ")"}]}]}], 
         "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"expr", "//.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Gamma]", "[", 
            RowBox[{
             TagBox[
              StyleBox[
               RowBox[{"Times", "[", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"a", ":", 
                  RowBox[{"(", 
                   RowBox[{
                   "_Symbol", "|", "_Subscript", "|", "_Superscript"}], 
                   ")"}]}]}], "]"}],
               ShowSpecialCharacters->False,
               ShowStringCharacters->True,
               NumberMarks->True],
              FullForm], ",", "b___"}], "]"}], ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"indices", ",", "a"}], "]"}], ";", 
             RowBox[{"\[Gamma]", "[", "b", "]"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[Gamma]", "[", 
            RowBox[{
             RowBox[{"a", ":", 
              RowBox[{"(", 
               RowBox[{"_Symbol", "|", "_Subscript", "|", "_Superscript"}], 
               ")"}]}], ",", "b___"}], "]"}], ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"indices", ",", "a"}], "]"}], ";", 
             RowBox[{"\[Gamma]", "[", "b", "]"}]}], ")"}]}]}], 
         "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"indices", "//", "DeleteDuplicates"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951107115870104*^9, 3.951107119664289*^9}, {
   3.951232666728512*^9, 3.9512327307721777`*^9}, {3.951232768256838*^9, 
   3.951232797687828*^9}, {3.951232852977048*^9, 3.951232854904772*^9}, 
   3.951232896832637*^9, {3.951233051337117*^9, 3.9512330784720984`*^9}, {
   3.9512331145693483`*^9, 3.951233116819352*^9}, {3.951233193304516*^9, 
   3.9512332286202087`*^9}, {3.9512332870017033`*^9, 3.951233461017544*^9}},
 CellLabel->
  "In[421]:=",ExpressionUUID->"935d09a0-331b-40fc-a467-f0134b7e4304"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtractObjectsWithIndex", "[", 
    RowBox[{"setup_Association", ",", "expr_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"indices", ",", "flattened", ",", "objects", ",", "dummy"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"indices", "=", 
       RowBox[{"GetAllSuperIndices", "[", 
        RowBox[{"Setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FTermQ", "[", "expr", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"flattened", "=", 
          RowBox[{"List", "@@", "expr"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"objects", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"flattened", "//.", 
          RowBox[{
           RowBox[{
            RowBox[{"a_Symbol", "[", "b__", "]"}], "/;", 
            RowBox[{
             RowBox[{"ContainsAny", "[", 
              RowBox[{
               RowBox[{"Flatten", "@", 
                RowBox[{"{", "b", "}"}]}], ",", 
               RowBox[{"indices", "\[Union]", 
                RowBox[{"(", 
                 RowBox[{"-", "indices"}], ")"}]}]}], "]"}], "&&", 
             RowBox[{"exclusions", "[", "a", "]"}]}]}], ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"objects", ",", 
               RowBox[{"a", "[", "b", "]"}]}], "]"}], ";", "dummy"}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "objects", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FEqQ", "[", "expr", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"flattened", "=", 
          RowBox[{"List", "@@", 
           RowBox[{"(", 
            RowBox[{"Join", "@@", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"List", "@@", "#"}], "&"}], ",", "expr"}], "]"}]}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"objects", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"flattened", "//.", 
          RowBox[{
           RowBox[{
            RowBox[{"a_Symbol", "[", "b__", "]"}], "/;", 
            RowBox[{
             RowBox[{"ContainsAny", "[", 
              RowBox[{
               RowBox[{"{", "b", "}"}], ",", 
               RowBox[{"indices", "\[Union]", 
                RowBox[{"(", 
                 RowBox[{"-", "indices"}], ")"}]}]}], "]"}], "&&", 
             RowBox[{"exclusions", "[", "a", "]"}]}]}], ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"objects", ",", 
               RowBox[{"a", "[", "b", "]"}]}], "]"}], ";", "dummy"}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"flattened", "//.", 
          RowBox[{
           RowBox[{
            RowBox[{"a_Symbol", "[", 
             RowBox[{
              RowBox[{"{", "f__", "}"}], ",", 
              RowBox[{"{", "i__", "}"}]}], "]"}], "/;", 
            RowBox[{
             RowBox[{"ContainsAny", "[", 
              RowBox[{
               RowBox[{"{", "i", "}"}], ",", 
               RowBox[{"indices", "\[Union]", 
                RowBox[{"(", 
                 RowBox[{"-", "indices"}], ")"}]}]}], "]"}], "&&", 
             RowBox[{"exclusions", "[", "a", "]"}]}]}], ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"objects", ",", 
               RowBox[{"a", "[", 
                RowBox[{
                 RowBox[{"{", "f", "}"}], ",", 
                 RowBox[{"{", "i", "}"}]}], "]"}]}], "]"}], ";", "dummy"}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "objects", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Expression \\\"\>\"", ",", "expr", ",", 
        "\"\<\\\" is neither an FTerm nor an FEq!\>\""}], "]"}], ";", 
      RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950854493144973*^9, 3.950854569452779*^9}, {
   3.950854604452739*^9, 3.950854680324503*^9}, {3.950854996656869*^9, 
   3.9508550481848717`*^9}, {3.950859645548572*^9, 3.950859785007856*^9}, {
   3.950860303344551*^9, 3.9508603107335377`*^9}, {3.950861168268649*^9, 
   3.950861274048501*^9}, {3.950861304120777*^9, 3.9508613153605413`*^9}, {
   3.950861367012312*^9, 3.9508614126049147`*^9}, {3.950861453960935*^9, 
   3.9508615591409407`*^9}, {3.950861602551324*^9, 3.9508616765664988`*^9}, {
   3.950873227322419*^9, 3.950873227634747*^9}, {3.9508733445328627`*^9, 
   3.9508733890321093`*^9}, {3.9508734300279284`*^9, 
   3.9508735030787888`*^9}, {3.950873533774803*^9, 3.950873574626863*^9}, {
   3.950873628353125*^9, 3.950873634368539*^9}, {3.9508736653917418`*^9, 
   3.950873725638062*^9}, {3.950977542870824*^9, 3.950977615051394*^9}, 
   3.950977666576852*^9, {3.950977824426978*^9, 3.950977824803349*^9}, {
   3.951048475057866*^9, 3.9510485002012367`*^9}, {3.951048586276622*^9, 
   3.951048595044265*^9}, {3.95104863795863*^9, 3.951048654139003*^9}, {
   3.951048871382616*^9, 3.951049094164*^9}, {3.951049522508106*^9, 
   3.951049543225523*^9}, {3.95104967655072*^9, 3.9510497051863403`*^9}, {
   3.9511067302213497`*^9, 3.951106791491743*^9}, {3.951287544996215*^9, 
   3.951287549952241*^9}, {3.951287602973113*^9, 3.9512876756527433`*^9}, {
   3.951287719050293*^9, 3.951287723077393*^9}},
 CellLabel->
  "In[1044]:=",ExpressionUUID->"f8e80e20-24a8-4ec6-ba4f-132db5be82fc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SuperIndices", "::", "undeterminedSums"}], "=", 
    "\"\<There are indices with count > 2 in the expression\n    `1`\nThis is \
not allowed for valid terms/equation. Problematic indices:\n    `2`\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"hideSubSuper", "[", "expr_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"expr", "//.", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{"a_Symbol", ",", 
            RowBox[{"b_", ":", 
             RowBox[{"(", 
              RowBox[{"_Integer", "|", "_Symbol"}], ")"}]}]}], "]"}], ":>", 
          RowBox[{"Symbol", "[", 
           RowBox[{
            RowBox[{"ToString", "[", "a", "]"}], "<>", "\"\<SUBSCRIPT\>\"", "<>", 
            RowBox[{"ToString", "[", "b", "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Superscript", "[", 
           RowBox[{"a_Symbol", ",", 
            RowBox[{"b_", ":", 
             RowBox[{"(", 
              RowBox[{"_Integer", "|", "_Symbol"}], ")"}]}]}], "]"}], ":>", 
          RowBox[{"Symbol", "[", 
           RowBox[{
            RowBox[{"ToString", "[", "a", "]"}], "<>", "\"\<SUPERSCRIPT\>\"", 
            "<>", 
            RowBox[{"ToString", "[", "b", "]"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Get", " ", "a", " ", "list", " ", "of", " ", "all", " ", "open", " ", 
     "super"}], "-", 
    RowBox[{
    "indices", " ", "within", " ", "the", " ", "expression", " ", "expr"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetOpenSuperIndices", "[", 
     RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"objects", ",", "indices", ",", "count", ",", "pick"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"objects", "=", 
        RowBox[{"ExtractObjectsWithIndex", "[", 
         RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"indices", "=", 
        RowBox[{"GetAllSuperIndices", "[", 
         RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"count", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{
             RowBox[{"objects", "//", "hideSubSuper"}], ",", "#", ",", 
             "Infinity"}], "]"}], "&"}], ",", 
          RowBox[{"indices", "//", "hideSubSuper"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pick", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"count", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "2"}], "]"}], "==", 
             "0"}], ",", "False", ",", "True"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "indices", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"AnyTrue", "[", 
          RowBox[{"count", ",", 
           RowBox[{
            RowBox[{"#", ">", "2"}], "&"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"SuperIndices", "::", "undeterminedSums"}], ",", "expr", 
            ",", 
            RowBox[{"Pick", "[", 
             RowBox[{"indices", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", ">", "2"}], "&"}], "/@", "count"}]}], "]"}]}], 
           "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Pick", "[", 
         RowBox[{"indices", ",", "pick"}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Get", " ", "a", " ", "list", " ", "of", " ", "all", " ", "closed", " ", 
     "super"}], "-", 
    RowBox[{
    "indices", " ", "within", " ", "the", " ", "expression", " ", "expr"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetClosedSuperIndices", "[", 
     RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"objects", ",", "indices", ",", "count", ",", "pick"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"objects", "=", 
        RowBox[{"ExtractObjectsWithIndex", "[", 
         RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"indices", "=", 
        RowBox[{"GetAllSuperIndices", "[", 
         RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"count", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{
             RowBox[{"objects", "//", "hideSubSuper"}], ",", "#", ",", 
             "Infinity"}], "]"}], "&"}], ",", 
          RowBox[{"indices", "//", "hideSubSuper"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"AnyTrue", "[", 
          RowBox[{"count", ",", 
           RowBox[{
            RowBox[{"#", ">", "2"}], "&"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"SuperIndices", "::", "undeterminedSums"}], ",", "expr", 
            ",", 
            RowBox[{"Pick", "[", 
             RowBox[{"indices", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", ">", "2"}], "&"}], "/@", "count"}]}], "]"}]}], 
           "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"pick", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"count", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "2"}], "]"}], "!=", 
             "0"}], ",", "False", ",", "True"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "indices", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Pick", "[", 
         RowBox[{"indices", ",", "pick"}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Get", " ", "a", " ", "list", " ", "of", " ", "all", " ", "open", " ", 
     "super"}], "-", 
    RowBox[{
    "indices", " ", "within", " ", "the", " ", "expression", " ", "expr"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SuperIndicesValid", "[", 
    RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"objects", ",", "indices", ",", "count"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"objects", "=", 
       RowBox[{"ExtractObjectsWithIndex", "[", 
        RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"indices", "=", 
       RowBox[{"GetAllSuperIndices", "[", 
        RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"count", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{
            RowBox[{"objects", "//", "hideSubSuper"}], ",", "#", ",", 
            "Infinity"}], "]"}], "&"}], ",", 
         RowBox[{"indices", "//", "hideSubSuper"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"AnyTrue", "[", 
         RowBox[{"count", ",", 
          RowBox[{
           RowBox[{"#", ">", "2"}], "&"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"SuperIndices", "::", "undeterminedSums"}], ",", "expr", 
           ",", 
           RowBox[{"Pick", "[", 
            RowBox[{"indices", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"#", ">", "2"}], "&"}], "/@", "count"}]}], "]"}]}], 
          "]"}], ";", 
         RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9508542004410467`*^9, 3.9508544749252157`*^9}, {
   3.950861781076435*^9, 3.950861866017157*^9}, {3.950861904572686*^9, 
   3.950862122741899*^9}, 3.950862250128793*^9, {3.9508623533294363`*^9, 
   3.950862473344803*^9}, {3.950862503549046*^9, 3.950862504168859*^9}, {
   3.950862808761071*^9, 3.95086284882382*^9}, {3.9508724621909122`*^9, 
   3.9508725163422728`*^9}, {3.950872679755715*^9, 3.950872742486643*^9}, {
   3.950873274979582*^9, 3.9508733202595463`*^9}, {3.9508736487671967`*^9, 
   3.950873654067449*^9}, {3.9510491583749323`*^9, 3.951049163421998*^9}, {
   3.951049235218823*^9, 3.951049243994762*^9}, {3.951049428748899*^9, 
   3.951049437502572*^9}, {3.951049503039259*^9, 3.951049505389997*^9}, 
   3.9510495609135113`*^9, {3.9510495984105787`*^9, 3.9510496300825567`*^9}, {
   3.9510497431225443`*^9, 3.951049751762602*^9}, 3.951049797343923*^9, 
   3.951057349023424*^9, {3.951106795019677*^9, 3.951106799162589*^9}, {
   3.951106990904499*^9, 3.951107063520145*^9}, {3.951229079559609*^9, 
   3.9512291363161707`*^9}, {3.951229194557047*^9, 3.9512291970249243`*^9}, {
   3.9512309838719883`*^9, 3.9512310891132097`*^9}, {3.95123115620091*^9, 
   3.951231159935547*^9}, {3.951232161292356*^9, 3.9512322491452513`*^9}, {
   3.951232297416614*^9, 3.951232398748467*^9}, {3.951237216865061*^9, 
   3.951237217320691*^9}, {3.9512874864801893`*^9, 3.951287499658772*^9}, {
   3.9512877098305883`*^9, 3.9512877121256933`*^9}},
 CellLabel->
  "In[1045]:=",ExpressionUUID->"9f3b0ea7-2af5-48b1-84b3-46146be887b3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Check", " ", "whether", " ", "all", " ", "indices", " ", "are", " ", 
     "closed", " ", "within", " ", 
     RowBox[{"expr", ".", " ", "\[IndentingNewLine]", "This"}], " ", 
     "disallows", " ", "also", " ", "multiple", " ", "use", " ", "of", " ", 
     "a", " ", "single", " ", "index", " ", "name"}], ",", " ", 
    RowBox[{"!", 
     RowBox[{"anywhere", "!"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"AllIndicesClosed", "[", 
     RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"objects", ",", "indices", ",", "count", ",", "valid"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"objects", "=", 
        RowBox[{"ExtractObjectsWithIndex", "[", 
         RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"indices", "=", 
        RowBox[{"GetAllSuperIndices", "[", 
         RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"count", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{
             RowBox[{"objects", "//", "hideSubSuper"}], ",", "#", ",", 
             "Infinity"}], "]"}], "&"}], ",", 
          RowBox[{"indices", "//", "hideSubSuper"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"valid", "=", 
        RowBox[{"AllTrue", "[", 
         RowBox[{"count", ",", 
          RowBox[{
           RowBox[{"#", "==", "2"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "valid", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.950862410027896*^9, {3.9508628529163237`*^9, 3.9508628920401497`*^9}, 
   3.9510491668196583`*^9, {3.951232402828401*^9, 3.9512324069834948`*^9}},
 CellLabel->
  "In[312]:=",ExpressionUUID->"3edfcfc0-c624-46bc-ab09-a08de412f0d7"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ordering", "Subsection",
 CellChangeTimes->{{3.932178009618313*^9, 3.932178022055203*^9}, {
  3.950801118933737*^9, 3.950801154023693*^9}, {3.9509401502822638`*^9, 
  3.950940151040942*^9}},ExpressionUUID->"1785af53-7c89-486a-9e5f-\
2cc90ee5d4f8"],

Cell[CellGroupData[{

Cell["Setting the canonical ordering", "Subsubsection",
 CellChangeTimes->{{3.950940652516369*^9, 
  3.950940658984301*^9}},ExpressionUUID->"6b5ad42c-f028-4331-8dd5-\
edca6279d9c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$AvailableCanonicalOrderings", "=", 
    RowBox[{"{", 
     RowBox[{
     "\"\<f>af>b\>\"", ",", "\"\<af>f>b\>\"", ",", "\"\<b>f>af\>\"", ",", 
      "\"\<b>af>f\>\""}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CanonicalOrdering", "::", "unknownInteger"}], "=", 
   "\"\<The integer `1` should be between 1 and 4.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CanonicalOrdering", "::", "unknownString"}], "=", 
    RowBox[{"\"\<The expression `1` should be one of \>\"", "<>", 
     RowBox[{"ToString", "[", "$AvailableCanonicalOrderings", "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetCanonicalOrdering", "[", "a_Integer", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Switch", "[", 
        RowBox[{"a", ",", "\[IndentingNewLine]", "1", ",", 
         RowBox[{"$CanonicalOrdering", "=", "\"\<f>af>b\>\""}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "2", ",", 
         RowBox[{"$CanonicalOrdering", "=", "\"\<af>f>b\>\""}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "3", ",", 
         RowBox[{"$CanonicalOrdering", "=", "\"\<b>f>af\>\""}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "4", ",", 
         RowBox[{"$CanonicalOrdering", "=", "\"\<b>af>f\>\""}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "_", ",", 
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"CanonicalOrdering", "::", "unknownInteger"}], ",", "a"}], 
          "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Canonical ordering set to \>\"", ",", "$CanonicalOrdering"}], 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetCanonicalOrdering", "[", "a_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Switch", "[", 
       RowBox[{"a", ",", "\[IndentingNewLine]", "\"\<f>af>b\>\"", ",", 
        RowBox[{"$CanonicalOrdering", "=", "\"\<f>af>b\>\""}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<af>f>b\>\"", ",", 
        RowBox[{"$CanonicalOrdering", "=", "\"\<af>f>b\>\""}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<b>f>af\>\"", ",", 
        RowBox[{"$CanonicalOrdering", "=", "\"\<b>f>af\>\""}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<b>af>f\>\"", ",", 
        RowBox[{"$CanonicalOrdering", "=", "\"\<b>af>f\>\""}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "_", ",", 
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"CanonicalOrdering", "::", "unknownString"}], ",", "a"}], 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Canonical ordering set to \>\"", ",", "$CanonicalOrdering"}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950940153137643*^9, 3.950940313248869*^9}, {
  3.950940364396865*^9, 3.950940626082654*^9}, {3.950947877407638*^9, 
  3.9509478851616173`*^9}, {3.950947925430534*^9, 3.950947963989278*^9}, {
  3.951210780223824*^9, 3.9512107812072353`*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"8223ffc8-f59e-4c33-b04f-02db6763d2e2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Ordering expressions", "Subsubsection",
 CellChangeTimes->{{3.950940652516369*^9, 
  3.950940676916478*^9}},ExpressionUUID->"25f821ed-484b-44c3-bb3d-\
2285af151ba5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Returns", " ", "true", " ", "if", " ", "f1"}], " ", "<", " ", 
     "f2"}], ",", " ", 
    RowBox[{
     RowBox[{"and", " ", "false", " ", "if", " ", "f1"}], " ", ">", " ", 
     "f2"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FieldOrderLess", "[", 
     RowBox[{"setup_", ",", "f1_Symbol", ",", "f2_Symbol"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "kind1", ",", "kind2", ",", "\[IndentingNewLine]", "idxOrder", ",", 
        "\[IndentingNewLine]", "n1", ",", "n2"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kind1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IsGrassmann", "[", 
             RowBox[{"setup", ",", "#"}], "]"}], ",", 
            RowBox[{"IsAntiGrassmann", "[", 
             RowBox[{"setup", ",", "#"}], "]"}], ",", 
            RowBox[{"IscField", "[", 
             RowBox[{"setup", ",", "#"}], "]"}], ",", 
            RowBox[{"IsAnticField", "[", 
             RowBox[{"setup", ",", "#"}], "]"}], ",", 
            RowBox[{"#", "===", "AnyField"}]}], "}"}], "&"}], "[", "f1", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"kind2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IsGrassmann", "[", 
             RowBox[{"setup", ",", "#"}], "]"}], ",", 
            RowBox[{"IsAntiGrassmann", "[", 
             RowBox[{"setup", ",", "#"}], "]"}], ",", 
            RowBox[{"IscField", "[", 
             RowBox[{"setup", ",", "#"}], "]"}], ",", 
            RowBox[{"IsAnticField", "[", 
             RowBox[{"setup", ",", "#"}], "]"}], ",", 
            RowBox[{"#", "===", "AnyField"}]}], "}"}], "&"}], "[", "f2", 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "$CanonicalOrdering", ",", "\[IndentingNewLine]", "\"\<f>af>b\>\"", 
         ",", "\[IndentingNewLine]", 
         RowBox[{"idxOrder", "=", 
          RowBox[{"{", 
           RowBox[{"4", ",", "3", ",", "2", ",", "1", ",", "0"}], "}"}]}], 
         ",", "\[IndentingNewLine]", "\"\<af>f>b\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"idxOrder", "=", 
          RowBox[{"{", 
           RowBox[{"3", ",", "4", ",", "1", ",", "2", ",", "0"}], "}"}]}], 
         ",", "\[IndentingNewLine]", "\"\<b>f>af\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"idxOrder", "=", 
          RowBox[{"{", 
           RowBox[{"2", ",", "1", ",", "4", ",", "3", ",", "0"}], "}"}]}], 
         ",", "\[IndentingNewLine]", "\"\<b>af>f\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"idxOrder", "=", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "0"}], "}"}]}], 
         ",", "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Order failure: order \\\"\>\"", "<>", "$CanonicalOrdering", 
            "<>", "\"\<\\\" unknown.\>\""}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"n1", "=", 
        RowBox[{
         RowBox[{"Pick", "[", 
          RowBox[{"idxOrder", ",", "kind1"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n2", "=", 
        RowBox[{
         RowBox[{"Pick", "[", 
          RowBox[{"idxOrder", ",", "kind2"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"n1", "<", "n2"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9509469386341343`*^9, 3.9509471834252987`*^9}, {
   3.950947223313903*^9, 3.950947224742805*^9}, {3.950947263353957*^9, 
   3.950947275621757*^9}, {3.950947319094739*^9, 3.9509474205587378`*^9}, 
   3.95094746109451*^9, {3.950947500069725*^9, 3.950947678289824*^9}, {
   3.950947722074582*^9, 3.950947766347187*^9}, {3.950947800639678*^9, 
   3.9509478705099792`*^9}, {3.9509479131384983`*^9, 3.950947918497128*^9}, {
   3.950947973835105*^9, 3.950948031631962*^9}, 3.950948064688114*^9, {
   3.951053680094369*^9, 3.951053686753499*^9}, {3.951054284810362*^9, 
   3.9510543614021463`*^9}, {3.951054405821702*^9, 3.951054431637821*^9}, {
   3.9510544720659943`*^9, 3.951054727167162*^9}, {3.951211269076701*^9, 
   3.951211288852489*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"4b678c74-7d06-4764-a1d3-b462e6b01ccf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Returns", " ", "the", " ", "sign", " ", "that", " ", "results", " ", 
    "from", " ", "exchanging", " ", "the", " ", "two", " ", "fields", " ", 
    "f1", " ", "and", " ", "f2"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CommuteSign", "[", 
     RowBox[{"setup_", ",", "f1_", ",", "f2_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"kind1", ",", "kind2"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kind1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"IsGrassmann", "[", 
              RowBox[{"setup", ",", "#"}], "]"}], "||", 
             RowBox[{"IsAntiGrassmann", "[", 
              RowBox[{"setup", ",", "#"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"IscField", "[", 
              RowBox[{"setup", ",", "#"}], "]"}], "||", 
             RowBox[{"IsAnticField", "[", 
              RowBox[{"setup", ",", "#"}], "]"}]}]}], "}"}], "&"}], "[", "f1",
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"kind2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"IsGrassmann", "[", 
              RowBox[{"setup", ",", "#"}], "]"}], "||", 
             RowBox[{"IsAntiGrassmann", "[", 
              RowBox[{"setup", ",", "#"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"IscField", "[", 
              RowBox[{"setup", ",", "#"}], "]"}], "||", 
             RowBox[{"IsAnticField", "[", 
              RowBox[{"setup", ",", "#"}], "]"}]}]}], "}"}], "&"}], "[", "f2",
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"kind1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "&&", 
           RowBox[{"kind2", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9509491238971243`*^9, 3.950949126229731*^9}, {
  3.950949179705824*^9, 3.950949242101665*^9}, {3.9509494626505527`*^9, 
  3.950949470925414*^9}, {3.950951603853833*^9, 3.9509516215042048`*^9}, {
  3.951054737038*^9, 3.951054767618724*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"18065f13-e208-4ab7-83f1-35e867d53bcb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Find", " ", "all", " ", "instances", " ", "of", " ", "$OrderedObjects", 
    " ", "and", " ", "order", " ", "their", " ", "field", " ", "value", " ", 
    "according", " ", "to", " ", "the", " ", "canonical", " ", "scheme"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"OrderObject", "[", 
      RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", "expr"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OrderObject", "[", 
      RowBox[{"setup_", ",", 
       RowBox[{
        RowBox[{"obj_", "[", 
         RowBox[{"fields_List", ",", "indices_List"}], "]"}], "/;", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"$OrderedObjects", ",", "obj"}], "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "i", ",", "j", ",", "curi", ",", "prefactor", ",", "pref", ",", 
         "reverse", ",", "\[IndentingNewLine]", 
         RowBox[{"nfields", "=", "fields"}], ",", 
         RowBox[{"nindices", "=", "indices"}], ",", "\[IndentingNewLine]", 
         "trackedField"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "The", " ", "propagator", " ", "gets", " ", "a", " ", "reverse", " ", 
         "ordering"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"reverse", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"obj", "===", "Propagator"}], ",", "True", ",", "False"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pref", "=", 
         RowBox[{"If", "[", 
          RowBox[{"reverse", ",", "Identity", ",", "Not"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"prefactor", "=", "1"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Always", " ", "compare", " ", "the", " ", "ith", " ", "field", " ",
            "with", " ", "all", " ", "previous", " ", "fields", " ", "and", 
           " ", "put", " ", "it", " ", "in", " ", "the", " ", "right", " ", 
           RowBox[{"place", ".", "\[IndentingNewLine]", "Iterate"}], " ", 
           "until", " ", "one", " ", "reaches", " ", "the", " ", "end", " ", 
           "of", " ", "the", " ", "array"}], ",", " ", 
          RowBox[{"then", " ", "it", " ", "is", " ", 
           RowBox[{"sorted", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "<=", 
           RowBox[{"Length", "[", "nfields", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"curi", "=", "i"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "Check", " ", "if", " ", "we", " ", "should", " ", "switch", " ",
               "curi", " ", "and", " ", "curi"}], "-", "1"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"curi", ">=", "2"}], "&&", 
              RowBox[{"pref", "@", 
               RowBox[{"FieldOrderLess", "[", 
                RowBox[{"setup", ",", 
                 RowBox[{"nfields", "[", 
                  RowBox[{"[", "curi", "]"}], "]"}], ",", 
                 RowBox[{"nfields", "[", 
                  RowBox[{"[", 
                   RowBox[{"curi", "-", "1"}], "]"}], "]"}]}], "]"}]}]}], ",",
              "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"nfields", "[", 
                RowBox[{"[", 
                 RowBox[{"{", 
                  RowBox[{"curi", ",", 
                   RowBox[{"curi", "-", "1"}]}], "}"}], "]"}], "]"}], "=", 
               RowBox[{"nfields", "[", 
                RowBox[{"[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"curi", "-", "1"}], ",", "curi"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"nindices", "[", 
                RowBox[{"[", 
                 RowBox[{"{", 
                  RowBox[{"curi", ",", 
                   RowBox[{"curi", "-", "1"}]}], "}"}], "]"}], "]"}], "=", 
               RowBox[{"nindices", "[", 
                RowBox[{"[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"curi", "-", "1"}], ",", "curi"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"prefactor", "*=", 
               RowBox[{"CommuteSign", "[", 
                RowBox[{"setup", ",", 
                 RowBox[{"nfields", "[", 
                  RowBox[{"[", "curi", "]"}], "]"}], ",", 
                 RowBox[{"nfields", "[", 
                  RowBox[{"[", 
                   RowBox[{"curi", "-", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"curi", "--"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"prefactor", "*", 
          RowBox[{"obj", "[", 
           RowBox[{"nfields", ",", "nindices"}], "]"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OrderFields", "[", 
      RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"OrderObject", "[", 
         RowBox[{"setup", ",", "#"}], "]"}], "&"}], ",", "expr", ",", 
       "Infinity"}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950940680637898*^9, 3.950940703340807*^9}, {
   3.950940753433639*^9, 3.950940770880921*^9}, {3.950940820604183*^9, 
   3.9509408314803343`*^9}, {3.950946867725016*^9, 3.950946867879279*^9}, {
   3.950946910845818*^9, 3.950946916669503*^9}, {3.950948080113351*^9, 
   3.950948364054194*^9}, {3.950948431170244*^9, 3.9509484424895906`*^9}, {
   3.9509487711183453`*^9, 3.9509487713973417`*^9}, {3.950948804373925*^9, 
   3.95094881228995*^9}, {3.950948873358161*^9, 3.950948881330065*^9}, {
   3.950948915158443*^9, 3.950948973463738*^9}, {3.9509490347704144`*^9, 
   3.950949146503368*^9}, {3.950949262758871*^9, 3.9509492803297586`*^9}, {
   3.9509493130620728`*^9, 3.950949346226811*^9}, {3.950949378638241*^9, 
   3.950949437598216*^9}, {3.950949479001645*^9, 3.950949676303194*^9}, {
   3.950949797286953*^9, 3.950949915654313*^9}, {3.95095042176271*^9, 
   3.95095044922293*^9}, {3.950951143743619*^9, 3.950951153673574*^9}, {
   3.9509511839493093`*^9, 3.950951479581605*^9}, {3.950951572049883*^9, 
   3.9509515917025433`*^9}, {3.9509516327864656`*^9, 3.950951696541771*^9}, {
   3.950977443735013*^9, 3.950977444242279*^9}, {3.951054819394979*^9, 
   3.951054841695517*^9}, 3.95121074104852*^9},
 CellLabel->
  "In[116]:=",ExpressionUUID->"4a073111-7191-4734-b32b-1a96840d6461"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["QMeS Compatibility", "Subsection",
 CellChangeTimes->{{3.950951779978003*^9, 
  3.9509517862440367`*^9}},ExpressionUUID->"94391a5f-eb5e-4478-a534-\
7016e4a3f9d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Compatibility", ":", " ", 
    RowBox[{
    "Output", " ", "any", " ", "expression", " ", "in", " ", "a", " ", "Form",
      " ", "which", " ", "looks", " ", "like", " ", "QMeS", " ", "output"}]}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"QMeSNaming", "[", 
      RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", "expr"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"QMeSNaming", "[", 
      RowBox[{"setup_", ",", 
       RowBox[{
        RowBox[{"obj_", "[", 
         RowBox[{"fields_List", ",", "indices_List"}], "]"}], "/;", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"$OrderedObjects", ",", "obj"}], "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "oldCanonicalOrdering", ",", "transf", ",", "prefactor", ",", 
         "\[IndentingNewLine]", "mobj", ",", "mfields", ",", "mindices", ",", 
         "\[IndentingNewLine]", "prefix", ",", "fieldPart", ",", 
         "indexPart"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"QMeS", " ", "follows", " ", "b"}], ">", "af", ">", "f"}], 
         ",", " ", 
         RowBox[{"so", " ", "we", " ", "switch", " ", 
          RowBox[{"temporarily", "!"}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", "$CanonicalOrdering", "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"$CanonicalOrdering", "=", "\"\<b>af>f\>\""}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"transf", "=", 
            RowBox[{"OrderObject", "[", 
             RowBox[{"setup", ",", 
              RowBox[{"obj", "[", 
               RowBox[{"fields", ",", "indices"}], "]"}]}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"prefactor", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"transf", ",", 
            RowBox[{"Times", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "a_"}], "]"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"prefactor", "=", 
            RowBox[{"-", "1"}]}], ";", 
           RowBox[{"transf", "=", 
            RowBox[{"-", "transf"}]}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mobj", "=", 
         RowBox[{"Head", "[", "transf", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mfields", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"List", "@@", "transf"}], ")"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mindices", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"List", "@@", "transf"}], ")"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"prefix", "=", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "obj", ",", "\[IndentingNewLine]", "Propagator", ",", "\"\<G\>\"", 
           ",", "\[IndentingNewLine]", "GammaN", ",", 
           "\"\<\[CapitalGamma]\>\""}], "\[IndentingNewLine]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"fieldPart", "=", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"Map", "[", 
           RowBox[{"ToString", ",", "mfields"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"indexPart", "=", 
         RowBox[{"Flatten", "[", "mindices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"prefactor", "*", 
          RowBox[{
           RowBox[{"Symbol", "[", 
            RowBox[{"prefix", "<>", "fieldPart"}], "]"}], "[", "indexPart", 
           "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"QMeSForm", "[", 
      RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"QMeSNaming", "[", 
          RowBox[{"setup", ",", "#"}], "]"}], "&"}], ",", "expr", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FEq", ":>", "List"}], ",", 
        RowBox[{"FTerm", ":>", "List"}]}], "}"}]}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950950511202754*^9, 3.950950754493911*^9}, {
  3.9509507857536583`*^9, 3.9509511203631363`*^9}, {3.950951490001182*^9, 
  3.950951554042407*^9}, {3.950951710976829*^9, 3.950951737477071*^9}, {
  3.951054861758219*^9, 3.95105491628331*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"ac314d00-9b25-4da1-be23-eabaa3a126f2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Reduce FTerms and FEqs, fix Indices", "Subsection",
 CellChangeTimes->{{3.950867995958111*^9, 3.9508679992839813`*^9}, {
  3.951108367695386*^9, 3.9511083702282677`*^9}, {3.951108500371646*^9, 
  3.95110850408386*^9}},ExpressionUUID->"e5244ec3-f22c-466c-9873-\
92eb903637b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Given", " ", "a", " ", "user"}], "-", 
     RowBox[{
     "defined", " ", "term", " ", "or", " ", "master", " ", "equation"}]}], 
    ",", " ", 
    RowBox[{"give", " ", "all", " ", 
     RowBox[{"(", "closed", ")"}], " ", "indices", " ", "unique", " ", 
     RowBox[{"names", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FixIndices", "[", 
     RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "indices", ",", "newIndices", ",", "replacements", ",", 
        "indexedObjects", ",", "\[IndentingNewLine]", 
        RowBox[{"ret", "=", "expr"}]}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AssertFSetup", "[", "setup", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Indices", " ", "should", " ", "be", " ", "fixed", " ", "on", " ", 
          "a", " ", "per"}], "-", 
         RowBox[{
         "term", " ", "basis", " ", "to", " ", "ensure", " ", "we", " ", "do",
           " ", "not", " ", "mess", " ", "up", " ", "things"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FEqQ", "[", "ret", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Return", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"FixIndices", "[", 
              RowBox[{"setup", ",", "#"}], "]"}], "&"}], "/@", "ret"}], "]"}],
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FTermQ", "[", "ret", "]"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"First", ",", " ", 
           RowBox[{
            RowBox[{
            "take", " ", "care", " ", "of", " ", "nested", " ", "sub"}], "-", 
            "terms"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ret", "=", 
           RowBox[{"FTerm", "@@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"List", "@@", "ret"}], ")"}], "/.", 
              RowBox[{
               RowBox[{"FTerm", "[", "a__", "]"}], ":>", 
               RowBox[{"FixIndices", "[", 
                RowBox[{"setup", ",", 
                 RowBox[{"FTerm", "[", "a", "]"}]}], "]"}]}]}], ")"}]}]}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Now", " ", "check", " ", "if", " ", "everything", " ", "is", " ", 
            "alright"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Not", "@", 
             RowBox[{"SuperIndicesValid", "[", 
              RowBox[{"setup", ",", "ret"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Invalid superindices: \>\"", ",", "ret"}], "]"}], 
             ";", 
             RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"indices", "=", 
           RowBox[{"GetClosedSuperIndices", "[", 
            RowBox[{"setup", ",", "ret"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"newIndices", "=", 
           RowBox[{"Map", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Unique", "[", "\[IndentingNewLine]", 
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", "#", "]"}], ",", 
                 RowBox[{
                  RowBox[{"i", ":", 
                   RowBox[{"DigitCharacter", ".."}]}], ":>", "\"\<\>\""}]}], 
                "]"}], "\[IndentingNewLine]", "]"}], "&"}], ",", 
             "\[IndentingNewLine]", "indices"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"replacements", "=", 
           RowBox[{"Thread", "[", 
            RowBox[{"indices", "->", "newIndices"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"ret", "/.", "replacements"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Expression \\\"\>\"", ",", "expr", ",", 
         "\"\<\\\" is neither a term nor a master equation!\>\""}], "]"}], 
       ";", 
       RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950861714841454*^9, 3.950861755216401*^9}, {
   3.950862487948318*^9, 3.950862798308673*^9}, {3.950862895840537*^9, 
   3.9508630357163677`*^9}, {3.9508724419777927`*^9, 
   3.9508724466302547`*^9}, {3.950872529157947*^9, 3.9508725448503036`*^9}, {
   3.9508725902304573`*^9, 3.950872613199347*^9}, {3.950872648512635*^9, 
   3.950872688616452*^9}, 3.950874347073372*^9, {3.950964034760331*^9, 
   3.950964062155575*^9}, {3.950964146531177*^9, 3.95096414932693*^9}, {
   3.950964196491962*^9, 3.950964291440217*^9}, {3.9510571582595263`*^9, 
   3.9510571726616507`*^9}, {3.95105728303815*^9, 3.951057297698251*^9}, {
   3.951106831163007*^9, 3.951106891415176*^9}, {3.951107069173294*^9, 
   3.951107093464375*^9}, {3.951107127992262*^9, 3.9511071448735332`*^9}, 
   3.951107181155599*^9, {3.9512004831787*^9, 3.951200640317047*^9}, {
   3.9512006715440273`*^9, 3.9512006882442102`*^9}, {3.95120072501525*^9, 
   3.95120073073527*^9}, {3.9512007738520927`*^9, 3.9512007765353394`*^9}, 
   3.951200836520123*^9, {3.951200877343849*^9, 3.951200929974958*^9}, {
   3.95120098569306*^9, 3.951201005326355*^9}, {3.951201043734188*^9, 
   3.951201076755189*^9}, {3.951201114535118*^9, 3.951201142462575*^9}, {
   3.9512873792240334`*^9, 3.951287432812272*^9}, {3.9512876999094963`*^9, 
   3.951287703906385*^9}, 3.9512877776883593`*^9},
 CellLabel->
  "In[1054]:=",ExpressionUUID->"3500ee75-7244-4321-ae5e-82e6897e10d7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FDOp", "::", "cannotProcess"}], "=", 
   "\"\<The FDOp in `1` cannot be processed. Please expand the term \
first\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FDOpCount", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "i", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"expr", "//.", 
       RowBox[{
        RowBox[{
         RowBox[{"Power", "[", 
          RowBox[{
           RowBox[{"FDOp", "[", "a__", "]"}], ",", "n_Integer"}], "]"}], "/;", 
         RowBox[{"n", "<", "0"}]}], ":>", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"FDOp", "::", "cannotProcess"}], ",", "expr"}], "]"}], 
          ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"expr", "//.", 
        RowBox[{
         RowBox[{"Power", "[", 
          RowBox[{
           RowBox[{"FDOp", "[", "a__", "]"}], ",", "n_Integer"}], "]"}], ":>", 
         RowBox[{"NonCommutativeMultiply", "@@", 
          RowBox[{"(", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"FDOp", "[", "a", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ")"}]}]}]}], 
       "//", 
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{
          RowBox[{"{", "#", "}"}], ",", 
          RowBox[{"FDOp", "[", "___", "]"}], ",", "Infinity"}], "]"}], 
        "&"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951282331983509*^9, 3.951282593647258*^9}, {
  3.951282798787737*^9, 3.951282799895976*^9}, {3.951283469783621*^9, 
  3.951283582313293*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"ec93a3ae-c758-4d49-9ec4-9c2ae2983898"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FTerm", "::", "GrassmannCountError"}], "=", 
   "\"\<The factor `1` has multiple Grassmanns in a single factor.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FTerm", "::", "FDOpCountError"}], "=", 
    "\"\<The factor `1` has multiple FDOps in a single factor.\>\""}], ";", 
   RowBox[{
    RowBox[{"FTerm", "::", "GrassmannOpen"}], "=", 
    "\"\<The factor `1` has open Grassmann factors.\>\""}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Simplify", " ", "a", " ", "term", " ", "appearing", " ", "in", " ", "an",
      " ", 
     RowBox[{"equation", ".", " ", "Try"}], " ", "to", " ", "merge", " ", 
     "as", " ", "many", " ", "factors", " ", "as", " ", "possible"}], ",", 
    " ", 
    RowBox[{
    "while", " ", "not", " ", "changing", " ", "the", " ", "Grassmann", " ", 
     "structure", " ", "of", " ", "the", " ", 
     RowBox[{"term", "."}]}]}], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReduceFTerm", "[", 
    RowBox[{"setup_", ",", "term_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"reduced", "=", 
        RowBox[{"List", "@@", "term"}]}], ",", "mergeGrassmanFactors", ",", 
       "i"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AssertFSetup", "[", "setup", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AssertFTerm", "[", "term", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Reduce", " ", "nested", " ", "FTerms", " ", "and", " ", "such", " ", 
        "first"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"reduced", "=", 
       RowBox[{"reduced", "//.", 
        RowBox[{
         RowBox[{"FEq", "[", "a__", "]"}], ":>", 
         RowBox[{"ReduceFEq", "[", 
          RowBox[{"setup", ",", 
           RowBox[{"FEq", "[", "a", "]"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"TODO", ":", " ", 
        RowBox[{
        "find", " ", "a", " ", "way", " ", "to", " ", "not", " ", "reduce", 
         " ", "terms", " ", "twice"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"reduced", "=", 
       RowBox[{"reduced", "//.", 
        RowBox[{
         RowBox[{"FTerm", "[", "a__", "]"}], ":>", 
         RowBox[{"ReduceFTerm", "[", 
          RowBox[{"setup", ",", 
           RowBox[{"FTerm", "[", "a", "]"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"TODO", ":", " ", 
        RowBox[{
         RowBox[{
         "Ensure", " ", "that", " ", "nested", " ", "terms", " ", "are", " ", 
          "Grassmann"}], "-", "neutral"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"reduced", "//.", 
       RowBox[{
        RowBox[{"FTerm", "[", "a__", "]"}], ":>", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"GrassmannCount", "[", 
              RowBox[{"setup", ",", 
               RowBox[{"FTerm", "[", "a", "]"}]}], "]"}], ",", "2"}], "]"}], "=!=",
            "0"}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"FTerm", "::", "GrassmannOpen"}], ",", 
             RowBox[{"FTerm", "[", "a", "]"}]}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Merge", " ", "scalar", " ", "terms", " ", "with", " ", "the", " ", 
         "closest", " ", "Grassman", " ", 
         RowBox[{"term", ".", " ", "We"}], " ", "need", " ", "to", " ", 
         "\"\<vanish\>\"", " ", "nested", " ", "FTerms"}], ",", " ", 
        RowBox[{
        "to", " ", "make", " ", "sure", " ", "we", " ", "do", " ", "not", " ", 
         RowBox[{"overcount", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"i", "<", 
         RowBox[{"Length", "[", "reduced", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"FDOpCount", "[", 
             RowBox[{
              RowBox[{"reduced", "[", 
               RowBox[{"[", 
                RowBox[{"-", "i"}], "]"}], "]"}], "//.", 
              RowBox[{
               RowBox[{"FTerm", "[", "__", "]"}], ":>", "1"}]}], "]"}], ">", 
            "1"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{
              RowBox[{"FTerm", "::", "FDOpCountError"}], ",", 
              RowBox[{"reduced", "[", 
               RowBox[{"[", 
                RowBox[{"-", "i"}], "]"}], "]"}]}], "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"GrassmannCount", "[", 
             RowBox[{"setup", ",", 
              RowBox[{
               RowBox[{"reduced", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "i"}], "]"}], "]"}], "//.", 
               RowBox[{
                RowBox[{"FTerm", "[", "__", "]"}], ":>", "1"}]}]}], "]"}], 
            ">", "1"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{
              RowBox[{"FTerm", "::", "GrassmannCountError"}], ",", 
              RowBox[{"reduced", "[", 
               RowBox[{"[", 
                RowBox[{"-", "i"}], "]"}], "]"}]}], "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"GrassmannCount", "[", 
               RowBox[{"setup", ",", 
                RowBox[{
                 RowBox[{"reduced", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "i"}], "]"}], "]"}], "//.", 
                 RowBox[{
                  RowBox[{"FTerm", "[", "__", "]"}], ":>", "1"}]}]}], "]"}], "==",
               "0"}], "||", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"GrassmannCount", "[", 
               RowBox[{"setup", ",", 
                RowBox[{
                 RowBox[{"reduced", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"-", "i"}], "-", "1"}], "]"}], "]"}], "//.", 
                 RowBox[{
                  RowBox[{"FTerm", "[", "__", "]"}], ":>", "1"}]}]}], "]"}], "==",
               "0"}]}], ")"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"FDOpCount", "[", 
                  RowBox[{
                   RowBox[{"reduced", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "i"}], "]"}], "]"}], "//.", 
                   RowBox[{
                    RowBox[{"FTerm", "[", "__", "]"}], ":>", "1"}]}], "]"}], "==",
                  "0"}], "&&", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"FDOpCount", "[", 
                  RowBox[{
                   RowBox[{"reduced", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"i", "+", "1"}], ")"}]}], "]"}], "]"}], "//.", 
                   RowBox[{
                    RowBox[{"FTerm", "[", "__", "]"}], ":>", "1"}]}], "]"}], "==",
                  "0"}]}], ")"}], ",", "\[IndentingNewLine]", 
              RowBox[{"reduced", "=", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"reduced", "[", 
                  RowBox[{"[", 
                   RowBox[{";;", 
                    RowBox[{
                    RowBox[{"-", "i"}], "-", "2"}]}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"reduced", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "i"}], "-", "1"}], "]"}], "]"}], "*", 
                   RowBox[{"reduced", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "i"}], "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"reduced", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "i"}], "+", "1"}], ";;"}], "]"}], "]"}]}], 
                "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"i", "++"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"i", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FDOpCount", "[", 
          RowBox[{
           RowBox[{"reduced", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "//.", 
           RowBox[{
            RowBox[{"FTerm", "[", "__", "]"}], ":>", "1"}]}], "]"}], ">", 
         "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"FTerm", "::", "FDOpCountError"}], ",", 
           RowBox[{"reduced", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GrassmannCount", "[", 
          RowBox[{"setup", ",", 
           RowBox[{
            RowBox[{"reduced", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "//.", 
            RowBox[{
             RowBox[{"FTerm", "[", "__", "]"}], ":>", "1"}]}]}], "]"}], ">", 
         "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"FTerm", "::", "GrassmannCountError"}], ",", 
           RowBox[{"reduced", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"reduced", "=", 
       RowBox[{"OrderFields", "[", 
        RowBox[{"setup", ",", "reduced"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"FTerm", "@@", "reduced"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950868021337243*^9, 3.950868021665371*^9}, {
   3.95086835724666*^9, 3.9508683710297613`*^9}, 3.9508700517983923`*^9, 
   3.950870106727509*^9, {3.9508701471559877`*^9, 3.9508701622890987`*^9}, 
   3.950872629945331*^9, {3.9509518447947407`*^9, 3.950951851247134*^9}, {
   3.950952161983356*^9, 3.950952217083837*^9}, {3.950953229162822*^9, 
   3.950953297847208*^9}, {3.950953495548379*^9, 3.950953510434524*^9}, 
   3.950953659948514*^9, {3.9509537192506933`*^9, 3.9509537569466476`*^9}, 
   3.95095976117029*^9, {3.950960003047349*^9, 3.950960004176173*^9}, {
   3.9509615265046177`*^9, 3.950961540864068*^9}, {3.950963643675329*^9, 
   3.9509636614251423`*^9}, {3.950963711154449*^9, 3.950963717584083*^9}, {
   3.950963775682248*^9, 3.950963816155239*^9}, {3.950963860300707*^9, 
   3.950963929362384*^9}, {3.951107234846871*^9, 3.951107272579007*^9}, {
   3.951107477640152*^9, 3.951107555487331*^9}, {3.951107981249464*^9, 
   3.951108000501011*^9}, {3.951108345993602*^9, 3.9511083754220457`*^9}, {
   3.951108466123753*^9, 3.951108473001584*^9}, {3.951120018973323*^9, 
   3.951120141322135*^9}, {3.951120175696308*^9, 3.951120258293839*^9}, {
   3.9511993173301573`*^9, 3.951199386830797*^9}, {3.951199702330996*^9, 
   3.951199863935121*^9}, {3.951199941828017*^9, 3.951200206596088*^9}, {
   3.9512007873999853`*^9, 3.951200800152265*^9}, {3.951211180189704*^9, 
   3.9512112247413692`*^9}, {3.951211306550591*^9, 3.951211312108625*^9}, {
   3.9512817944598837`*^9, 3.951281852923716*^9}, {3.951282267880844*^9, 
   3.9512822700840063`*^9}, {3.95128232715619*^9, 3.951282327704615*^9}, {
   3.95128239842417*^9, 3.951282398833179*^9}, {3.95128262267912*^9, 
   3.9512826941777477`*^9}, {3.9512827249420967`*^9, 3.951282770800105*^9}, {
   3.9512828635885363`*^9, 3.951282875043973*^9}, {3.9512829247327137`*^9, 
   3.951283058689929*^9}, {3.951283170556365*^9, 3.951283180253006*^9}, {
   3.951283286916153*^9, 3.95128336262862*^9}, {3.951287326417925*^9, 
   3.9512873368029137`*^9}},
 CellLabel->
  "In[1055]:=",ExpressionUUID->"c85cfa76-e8b5-439f-9ca0-f24e64c44725"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ReduceFEq", "[", 
    RowBox[{"setup_", ",", "equation_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reduced", "=", "equation"}], "}"}], ",", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AssertFSetup", "[", "setup", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AssertFEq", "[", "equation", "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Amend", " ", "the", " ", "index", " ", "structure"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"reduced", "=", 
       RowBox[{"FixIndices", "[", 
        RowBox[{"setup", ",", "reduced"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Make", " ", "sure", " ", "all", " ", "terms", " ", "are", " ", 
        "reduced"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"reduced", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ReduceFTerm", "[", 
          RowBox[{"setup", ",", "#"}], "]"}], "&"}], "/@", "reduced"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "reduced", "]"}], ";"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.95087005673455*^9, 3.9508700859297953`*^9}, {
   3.95087011800534*^9, 3.950870131605879*^9}, {3.950870213341543*^9, 
   3.950870277473693*^9}, {3.950870399615657*^9, 3.950870405389082*^9}, {
   3.950870442661482*^9, 3.950870496553628*^9}, {3.950870560603696*^9, 
   3.95087057682275*^9}, {3.950870622601573*^9, 3.9508706298192472`*^9}, {
   3.950870882690217*^9, 3.950870893085442*^9}, {3.950872136372311*^9, 
   3.9508721384388733`*^9}, {3.95087218393355*^9, 3.950872184825736*^9}, {
   3.950872366461809*^9, 3.950872410282044*^9}, 3.9508726043827133`*^9, {
   3.950872638854124*^9, 3.9508726391619997`*^9}, 3.950874165123219*^9, {
   3.9508742127501917`*^9, 3.950874219718197*^9}, 3.9508742837279673`*^9, {
   3.950875436534375*^9, 3.9508754560376596`*^9}, {3.950953413239159*^9, 
   3.9509534267784367`*^9}, {3.950953462892211*^9, 3.950953463787467*^9}, 
   3.950953644035307*^9, {3.9509639545923243`*^9, 3.95096400898311*^9}, {
   3.951108380757312*^9, 3.951108460175194*^9}, {3.951200372211622*^9, 
   3.951200414587019*^9}, {3.951201152993251*^9, 3.951201155424082*^9}, {
   3.9512111606396103`*^9, 3.951211178344079*^9}, {3.9512113174774103`*^9, 
   3.951211319144833*^9}, {3.951287340601552*^9, 3.951287349949945*^9}, {
   3.9512876915578947`*^9, 3.951287692487217*^9}, {3.9512877897524633`*^9, 
   3.9512877927314177`*^9}, {3.951287940608549*^9, 3.951287983978196*^9}, 
   3.951288027197757*^9},
 CellLabel->
  "In[1121]:=",ExpressionUUID->"52021b7e-bece-436c-b228-076b6c722055"]
}, Closed]],

Cell[CellGroupData[{

Cell["Power expansions", "Subsection",
 CellChangeTimes->{{3.9511983853072557`*^9, 
  3.951198388520007*^9}},ExpressionUUID->"82ef4885-2b2a-47d1-8963-\
133ee7a68a33"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FExpand", "[", 
    RowBox[{"setup_", ",", "expr_", ",", "order_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ret", "=", "expr"}], ",", "n", ",", "i"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ret", "=", 
       RowBox[{"ret", "//.", 
        RowBox[{
         RowBox[{"Power", "[", 
          RowBox[{"a_FTerm", ",", "b_"}], "]"}], ":>", 
         RowBox[{"FEq", "@@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"FTerm", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"SeriesCoefficient", "[", 
               RowBox[{
                RowBox[{"a", "^", "b"}], ",", 
                RowBox[{"{", 
                 RowBox[{"a", ",", "0", ",", "n"}], "}"}]}], "]"}], 
              RowBox[{"NonCommutativeMultiply", "@@", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"FixIndices", "[", 
                  RowBox[{"setup", ",", "a"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "0", ",", "order"}], "}"}]}], "]"}]}]}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ret", "=", 
       RowBox[{"ret", "//.", 
        RowBox[{
         RowBox[{"Power", "[", 
          RowBox[{"a_", ",", "b_FTerm"}], "]"}], ":>", 
         RowBox[{"FEq", "@@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"FTerm", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"SeriesCoefficient", "[", 
               RowBox[{
                RowBox[{"a", "^", "b"}], ",", 
                RowBox[{"{", 
                 RowBox[{"b", ",", "0", ",", "n"}], "}"}]}], "]"}], 
              RowBox[{"NonCommutativeMultiply", "@@", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"FixIndices", "[", 
                  RowBox[{"setup", ",", "b"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "0", ",", "order"}], "}"}]}], "]"}]}]}]}]}], 
      ";", "\[IndentingNewLine]", "ret"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FExpand", "[", 
  RowBox[{"Setup", ",", 
   RowBox[{"FTerm", "[", 
    RowBox[{"Exp", "[", 
     RowBox[{"FTerm", "[", 
      RowBox[{
       RowBox[{"A", "[", "x", "]"}], 
       RowBox[{"A", "[", 
        RowBox[{"-", "x"}], "]"}]}], "]"}], "]"}], "]"}], ",", "2"}], 
  "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951198400665941*^9, 3.951198539982102*^9}, {
   3.95119858122998*^9, 3.951198629997539*^9}, {3.951198840630013*^9, 
   3.951199103563139*^9}, {3.951199144182513*^9, 3.951199153264168*^9}, {
   3.951285293951795*^9, 3.951285618155931*^9}, {3.951285751815961*^9, 
   3.951285790905162*^9}, {3.951286919623252*^9, 3.9512869715228977`*^9}, 
   3.951287309293539*^9},
 CellLabel->"",ExpressionUUID->"c5f93900-11a5-40d3-92c2-259b2094122d"],

Cell[BoxData[
 RowBox[{"FTerm", "[", 
  RowBox[{"FEq", "[", 
   RowBox[{
    RowBox[{"FTerm", "[", "1", "]"}], ",", 
    RowBox[{"FTerm", "[", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"-", "x206"}], "]"}], " ", 
      RowBox[{"A", "[", "x206", "]"}]}], "]"}], ",", 
    RowBox[{"FTerm", "[", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"FTerm", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"-", "x207"}], "]"}], " ", 
         RowBox[{"A", "[", "x207", "]"}]}], ",", 
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"-", "x208"}], "]"}], " ", 
         RowBox[{"A", "[", "x208", "]"}]}]}], "]"}]}], "]"}]}], "]"}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.9512869459959087`*^9, 3.9512869555393476`*^9}},
 CellLabel->
  "Out[943]=",ExpressionUUID->"0b8604f1-da25-4adf-bdad-bd34824e6d4d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DerivativeExpand", "[", 
    RowBox[{"setup_", ",", "expr_", ",", "order_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ret", "=", "expr"}], ",", "n", ",", "i"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "We", " ", "need", " ", "to", " ", "block", " ", "the", " ", "FDOp", 
       " ", "definitions", " ", "to", " ", "use", " ", "SeriesCoefficient", 
       " ", "with", " ", "FDOp"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "FDOp", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ret", "=", 
          RowBox[{"ret", "//.", 
           RowBox[{
            RowBox[{
             RowBox[{"Power", "[", 
              RowBox[{"a_FTerm", ",", "b_"}], "]"}], "/;", 
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"{", "a", "}"}], ",", 
               RowBox[{"FDOp", "[", "__", "]"}], ",", "Infinity"}], "]"}]}], ":>", 
            RowBox[{"FEq", "@@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"FTerm", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"SeriesCoefficient", "[", 
                  RowBox[{
                   RowBox[{"a", "^", "b"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "0", ",", "n"}], "}"}]}], "]"}], "**", 
                 RowBox[{"NonCommutativeMultiply", "@@", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"FixIndices", "[", 
                    RowBox[{"setup", ",", "a"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}], 
                "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "0", ",", "order"}], "}"}]}], "]"}]}]}]}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"ret", "=", 
          RowBox[{"ret", "//.", 
           RowBox[{
            RowBox[{
             RowBox[{"Power", "[", 
              RowBox[{"a_", ",", "b_FTerm"}], "]"}], "/;", 
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"{", "b", "}"}], ",", 
               RowBox[{"FDOp", "[", "__", "]"}], ",", "Infinity"}], "]"}]}], ":>", 
            RowBox[{"FEq", "@@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"FTerm", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"SeriesCoefficient", "[", 
                  RowBox[{
                   RowBox[{"a", "^", "b"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"b", ",", "0", ",", "n"}], "}"}]}], "]"}], "**", 
                 RowBox[{"NonCommutativeMultiply", "@@", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"FixIndices", "[", 
                    RowBox[{"setup", ",", "b"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}], 
                "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "0", ",", "order"}], "}"}]}], "]"}]}]}]}]}],
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "ret"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9512858144958143`*^9, 3.951285815620013*^9}, {
  3.951286835188345*^9, 3.9512868784211693`*^9}, {3.951286911623101*^9, 
  3.951286917760015*^9}, {3.95128697645728*^9, 3.951287305262067*^9}},
 CellLabel->
  "In[986]:=",ExpressionUUID->"c8e3186f-3d3b-492c-8b02-56053c948bd0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ResolveFDOp", "[", 
  RowBox[{"Setup", ",", 
   RowBox[{"FTerm", "[", 
    RowBox[{
     RowBox[{"FDOp", "[", 
      RowBox[{"A", "[", "h", "]"}], "]"}], ",", 
     RowBox[{"GammaN", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"AnyField", ",", "A"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "x"}], ",", "g"}], "}"}]}], "]"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9512865969346733`*^9, 3.95128666406367*^9}, {
  3.9512867678195963`*^9, 3.951286794064334*^9}},
 CellLabel->
  "In[936]:=",ExpressionUUID->"513ad122-b877-49e8-a3ea-d96e8be9b21e"],

Cell[BoxData[
 RowBox[{"FEq", "[", 
  RowBox[{"FTerm", "[", 
   RowBox[{"GammaN", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"A", ",", "A", ",", "AnyField"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"g", ",", 
       RowBox[{"-", "h"}], ",", 
       RowBox[{"-", "x"}]}], "}"}]}], "]"}], "]"}], "]"}]], "Output",
 CellChangeTimes->{{3.951286601978271*^9, 3.951286664430045*^9}, 
   3.951286729208035*^9, {3.951286761016094*^9, 3.951286794810369*^9}},
 CellLabel->
  "Out[936]=",ExpressionUUID->"9ad0818f-edc5-48bc-94af-76e28a530bb3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FEq", "[", 
   RowBox[{"FTerm", "[", 
    RowBox[{"Exp", "[", 
     RowBox[{"FTerm", "[", 
      RowBox[{
       RowBox[{"FDOp", "[", 
        RowBox[{"JA", "[", "x", "]"}], "]"}], ",", 
       RowBox[{"G", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"GA", ",", "GA"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "x"}], ",", 
           RowBox[{"-", "y"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"FDOp", "[", 
        RowBox[{"JA", "[", "y", "]"}], "]"}]}], "]"}], "]"}], "]"}], "]"}], "//", 
  RowBox[{
   RowBox[{"FPrint", "[", 
    RowBox[{"Setup", ",", "#"}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.95128588158747*^9, 3.951285894491994*^9}, {
  3.951285926511264*^9, 3.951285939323969*^9}, {3.951286090875435*^9, 
  3.9512860927070436`*^9}, {3.951286497671545*^9, 3.9512865573876333`*^9}},
 CellLabel->
  "In[897]:=",ExpressionUUID->"281301ac-dffb-4d5e-bbd1-6b3edb5983f7"],

Cell[BoxData[
 GraphicsBox[
  {Thickness[0.006978367062107466], 
   {Thickness[0.0025052337752965803`], 
    FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
      0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
      3}}, {{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGBQBmIQPRMEfoo7qH9SeTkrU8oBxn/gGu84a6MUlBZ36I/o
9mf8IOXAAAINCP6bttxuo2gEX2HXgn2pfuIOB7r3NZk8lnIIeXv544yHYg7t
CuyqZ0qg5l0UdhCpnFRyNkXMoWR5yYZ//XwOZ0BgjajDi9rH2effcMH527w2
WMypZIXzbUsca0/PYXJoA5l3RRzOj1GNkDkXIw3ng/3DKQPng91pLQsxh4fF
QRhkv4qCgx1IXoYTzgf7YwM3nO++5uhyBglBh5XfXlacMVBwOAjyV7KwQzin
WLvxfAWIP1jEHVaA5AMU4eFhDAKbleD8+yB/KyrD+SycXfLJeioOGiB3doo6
/Hz7+oClsirUfCE4H+yvPVxw/ixwBP2wXyukw5d+TwnOh/kPxv+y7+PWdDMJ
aDgwQeJ1pwjcPBgfYo4wnI+SHk5KOqCnDwBT8fTo
      "], {{5.481249999999999, 9.565629999999997}, {5.481249999999999, 
      8.31094}, {3.5687499999999996`, 8.31094}, {3.06719, 8.31094}, {
      2.5656300000000005`, 8.31094}, {3.07969, 10.151600000000002`}, {
      4.214059999999999, 10.329700000000003`}, {4.59688, 
      10.329700000000003`}, {5.121880000000001, 10.329700000000003`}, {
      5.481249999999999, 10.020299999999999`}, {5.481249999999999, 
      9.565629999999997}}}], 
    FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
      1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
      3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
      1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
      3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
      3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxdVGtIFFEUXnUh1EQowkDMXrZZ7e7MubMqoXi2h4gFlkVZZmVqWkIqaS9S
s6CHK2qR2cPEikjDsshIf6iQaYqVLVRWFmQJiRhhDwlXs71zbjvUgeXy3dk9
5zvf983O2ZEZl+qu0+linB9+lq3LmV/xlWF90MCxKqMZvaOCct3HGG5fH2eo
PmXGrDpbX7pOQfOi2unPBzT8KenKKyVQcuEBjiMljDwYX2OZYPR8m4SrO6dE
XPrJcJPfA7suX8Lx0dwPlf0MfzS9LZpol3BqbP3Z1EaGjJeHjIX69lL5BKMz
VMbvd9ZkXAxliEc/Pj5vk1HiPB4BtuYFhKXpwYWTE99FeURruJTvFQuYttNZ
HUD9NgJe4NUFGMF5JgLaYob0ih2wosz3UEiGuH8PmOdYmvXsAOATXsNAex4B
bAj99TBlDLB32jdrz3HRz5PR/JNAfP007Ff+wjN9roZrBqNNk9kMb/CzUPS7
yYjHWsBifo4w0iUMXPqp80IArVwHB8NV/N4i+rkpLpzPec/UsNpPVkiXFYCD
uxePVkQopGeC+L1VPE8BfON/OAlWKqRfpoZV/fZruKtt2a1dJUA+WhT0r9oa
3F0NmHN/hqN7loJ9/HvXAX34Hq8Z+dUAIgcMffl9J4jcaJj6aVidYxL7dwjd
F2hY9c2bYaz99JbfbX/1A/zM92wWvvcCTvKqB9zL+bWAi6/hi0+LVCv62IT/
l0WfbOHfGeHTZsC7pj3X3IqBcmzVsOq7QcOqv3aZct0m5mfKrvwUqD7JlLNG
Jw/n6/fUS6a99gEmzLaOJA9LdIaLPLdK9H4OyZSXQonyWSdTDoMl8r1cxk6u
W5UZ47neJTJWXp3XNJ5mpjlFMioqMQ0HqIRN/+ICE+W+WvD2MpH/7TLqPYsC
k28bid+46G8w0t7OHFvCm+PO9S8hX+79h5czF17I9e9i2PNyw7DZYcT//4/+
AJqz/Ks=
      "], CompressedData["
1:eJxTTMoPSmViYGCQBWIQbaC1UvhCibHD8V07etk+6DmoPmmedzbK2GHGTCCQ
1HM42LY8/JSQscOPt68PWDrrOnifYLedvdUIzpeeF6d5ugDBT46948ZsYeTw
PEv72/RaXQeNt7z7DCSNHFp4/ddPearrwA+kUjmMHP6A1CvrQfQzGDnEhwSp
L8hE8E2MgWAzgq+jKP8l55uew3WhT47n2Ywc/oOAvT6E5jdySADp79R38L84
MeafspFDt9crFhNBA4h7XY0cHicuvGYSb+DwZeetrr+tRg7TJ/BXmc02gJi/
wQjiz0MGDrelaxKNnho5nD7stDbzngHU/caQcHllADFH3tjhz7fSB3MeGjhI
TL3CmeFkDPHvWgOI/cnGkHCoMHCAhe8W8x+HUqwMHCLFt19kqIOqlzWA2NsE
5f/Vh/Ofgvh7EXxwfFTqw/WDw8NM3wE9/gBADs2u
      "]}]}, 
   {Thickness[0.0025052337752965803`], JoinForm[{"Miter", 10.}], 
    JoinedCurveBox[{{{0, 2, 0}}}, {{{7.617189999999998, 
     13.200000000000001`}, {30.224999999999994`, 13.200000000000001`}}},
     CurveClosed->{0}], 
    FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
      1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
      3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
      1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
      3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
      3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxdlHlIFVEUxl8pxSMwcEtIc+bOHWfM0txRFE6ZpJZhL2mVXHJN6RkZWS5U
YqYZmW2aIi5/iKBmUlamJD2kTUszjSRQX4KmPloQE7Xl3bnTG/LCMPzucs65
33dm2DitJmGlSqUKMz7k7VA/GeI6gqFh7ktmTwwCm+KwKfNZDD1kdCDQH1j3
sF/Fw47G7nqVHWfi0eDorXdOLON7HGT/aIlIXcCUv3NQVrL2rM80hvHYmiEv
NwwLhukuPx2GDSTvUwz2VUecX6djKCs3Dj8ezNVFjkctMHgHdGpu1fCwX21b
4Knl4L7v/LP4MCcg28oLEbS4Hq9bESCYmMZVOGJ4fXbsO4HeoxiBD4k3JoAn
GdeN5/nxvCqDAIUBoe2JtQiiIzVCtVqEoJI8y8R2BFs2Nlj1YZHG+yjr4iWC
1ZnSjN5ZWRcQaTwrjuYPEmm9bgpbk/3bFf7k7ND45zMH58y7r7r7ipCs/Zb/
MhJD2IvVgRWDAtjdfK9O1mPY3X8t6nedYNJPylct0HM/MbzSbWtKqRIgnOwz
4038a+7UaKW7wlK8OB5uFOQfGugQoG9w34xbFk/1nJLP58nrSwKdL+Kpfpai
iSU/WIWftz+6sipChKmTD2wWU3lIIffIEGHymMvc7UAeJsg7R6T+tmBoJX5V
ioCH9HtVSxzNqxOhyXKTRVKuwtJ6msKSf1Fyn3WJcFrXFlwernBSonHYcvCW
3OuJCJeJn3oEZqSPmuX4zQg8JN/l8znIVK/kvwZBDPE/VPbfH8FO4oeN7DdG
UFnLPV6aEOTvAMFm1nE2rU1hSecLCp8nPn1wggRS30U5v5WTqX+k/or/9x0h
yF30T38TwtP6DCzMEF3X8PC19i7Tm8nCHuJHK6b9M8DALlKfN6b9eZCR83CQ
NTI/7OnC0Lj9CDiipz1D5ysQdGqzDeU2DNUtUWFJN49l3MrS/wIwtK5AlupT
JMcfY2h983L8wwytr46l97RmqB7J6H++xJlY6rNSTH1yZWH5/+gvrp36gA==

      "], CompressedData["
1:eJxTTMoPSmViYGCQBWIQPRMEXio7GIOAspLD3vyatzO3KjucAQEfRQhfVdkh
PQ0IyhQcqu//uGWcrQTnP3CNd5z1UBHO/w8C+YoOK7+9rDizQcGh28ZzV5qR
osOHResVzkooOqwAiQtA1YcpQvQzKkLsm4Pgg+WfIfhgd2oqOZQf3uY6k1cR
4t5iJYh98lD9e5Qc3NccXc7goeiwB+TuUGWIe7uh5nxUdlC+9iiYgUfJISEk
SH1BpgpEPFHJYYdD06PjO1QcnCc0C6WdUnI4tmtHL9sHFaj7lR1qf1sVnONQ
dVgrpMOXbqfsoKso/yXnm4qDSOWkkrMtyg4snF3yyX0qDh4g+08oO/x8+/qA
pbKKAyx8weIrlB1UQPb/UXZYAzInT9mhhdd//RRWFUh4GaDxPyjB+adB/luj
BNcPNjdTyQE9/gBqacwN
      "]}], 
    FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {
     1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJVIGYCYhbOLvnkdzoOcxYp7/zzXN0Bxpdd/sJDL17D
QWZenObpAG0HI2MgCNZweJ648JrJei04/03xVtHfpzUdvE6w284O1XA4fQYI
dDTh+mF8mPn6WiuFLyxB8EV6vF6xXNHC4DOAwAEE/0WW9rfpsQj+WiEdvvR/
iqj8ewoOG/TyFjPKaDkIV04qORui4KCrKP8lp0wTzq/7bVVwzgPBlwL5b4KG
Q/X9H7eMoxUcju/a0csmoOHwwDXecdZDBYct5j8OpXRpOKwBmf9OwSHwlnRN
4iYNh9kzgcBTEc7/DwL9CD7YfBYlBx2Q/WEaDuGcYu3G9koOvhcnxvxjRvBT
04DgmDqcDwlHdQf+2ID7RuIIvvOEZqG0LkU4/z7IfQsVHDz218pauGtAzHkm
7zC5vTXqco0mnH/+atgb/d1acP4MkLt/ajus/Pay4swGBTgf7P/finC+H8id
yepwPix+UmLvuDFLYKYXGB8AeW32HA==
     "]], 
    FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
      1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
      0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {
      1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 0}, {0, 1, 0}, {0, 
      1, 0}}}, {CompressedData["
1:eJxTTMoPSmViYGDQBmIQffKw09rMd8YOxmCg4ADjO09oFkpbpeAQo+D4MfkM
gn+4bXn4qSQEn9d//ZTUCGMH5WuPghnOKDg0shztN3Q3dgjnFGs3lld08L84
MebfYUOHzPwPrSdLNBw+bwjInrXd0OHvt9IHczZqOHC7qZYyrTJ0eJ6l/W36
Xg2H/bWyFulT0PglCH6E+PaLDHmGDuJTr3BmLNJwMNBaKXwhBWG+Poj/RN/h
gWu846xCRQddEH+JvsOe/Jq3M68qODSA3CeuD3e//y3pmsQiPQw+LDyegCx8
oAfxj72CAwtnl3yynz6cP6W9NeryHgR/i/mPQylSBnA+2J1NBg7paUBgpuAQ
DQrPOQZw82F8mP1nQMAHwZ8+gb/KTNvAgT824L7RdwQfLG+lCOdD9ClCwkcP
al+YIiT8TAwc3NccXc5QoejwJHHhNZN6A4c7mrJr/j9WctB4y7vPwNMIzr8N
9L7RUiOH6vs/bhlrKzokx95xY15hBI9PsD1rjBxmggAngl9+eJvrzL8KcD7M
/d4n2G1nhyL4G/TyFjPqYPJh4QE2V9IYHn7o6RMAA74N9Q==
      "], {{18.1906, 9.67969}, {16.592200000000002`, 9.67969}, {17.3938, 
      11.617199999999997`}, {18.1906, 9.67969}}}], 
    FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJJIGYC4kNty8NPbTJz+A8C+6UcUPj3pRxOHnZam7nO
zGG9kA5f+j9M/pedt7r+skLV/5dx2KiXt5ixxtThjqbsmv/JCnD+ym8vK84Y
KMP5oj1er1i+qDocBNnHZOZwCmTuPXW4+eJTr3BmPNJwOAHli0H5MPcF3pKu
SfyE4JvZ7A2axqgJ54PNF9F0OAMCa8wcXhVvFf2tremwxfzHoZRZCH4JkDpd
h+C/yNL+Np3X1GHGBP4qM291OB/mfhjfxBgE5BzsKiNWmNaaOdTc/3HLOFsK
bj6MD7Mfxoe5L0Y1QubcHLTwBoY/AOgRwxw=
     "]], 
    FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}}}, CompressedData["
1:eJxllAtMTXEcx28y5FFUZB7bOZ1zS5hHD/f8z2p+FxGL8pja5JG4eWyuTS03
oWk0pKfcSmzELvOKJUJhilBe82hhlUUpzSPyKI/z//9P57/lv53dfc79n9//
//t9v78fv9K8YLW9TqezU54I5emlPANDzu1fXSmD8PzNQt0HHnryC+cvxoe3
ZXBaGlrn7eYO1nSn+CmnGH8vqd3zO5vxjV22sHuZMtQHLjfm2blD5a1pZ9am
yhBtUtY7HmzNQRP+RqrxX3FQMzIh0vsbgpxcZVk4mDj2pMujIsb6xqTD1fGM
985p6e07H0EVXtcYx90qDswN4DWedbrCptvMw7ZOeeODcASWuh+1PlfVfEyI
3sfDHdoLQ9fnWRG4WjJjqosE2N67Im2yDUHLpotDO8eJEKP83D+L4Fdb6w0U
pfID9fzTIlzfOlqKbkSQ8EUJVCvCmLZBZZMcZFhr/rTzrqse+s3Ux/aSGXd1
xNbnGxmnLYwRrWbGKfj+GTIE4cBNIkzd8eZOzhIZ8o8KJV13RLo/RIbGyCPP
fc2Mp/iXLjhgZBzmMCzZp06ARJxPnAwz0pOcTfcEeu8Uxp74viWMgyv7Bhx8
K4O3j7JcRI1zsO57GVdeubyvzyQ97CfvZVUfPfhbwk/4BTBesfTVTPsapLEn
1jMPQfO6cR3W1yIMwPXZg+Anrm+BCF+xn2IR3MbxP4lwfsKGAjt/9j2p711J
Y6LvcMajDi/zul9ogEJsnEGixrv9Z18xHRU0xun5ZAlQg/1QbIDB2L9xAkRw
xs9RVYyJXg2MTcTHBsDH5e4WqD9bDFBqTmjLPS5Q/w2RaH6HRFpfi6TpS/xS
zjgV6+WENCbxPRDMr1Ua44KoMclnLuNEnPeYHv8r+fbH9RyB4IzzeMfoswL1
e4dE+zHDHV7ifnsmwRbcD1t4aML3rJZoPyxW+6NY3d/AUT9tl7T+I76bypjo
5ceYzIcBjFdh/ZsNdD7YODhWV+aYL0jUnw85WkcvCVxw//nyGhOfBvfgfF6L
T/aX81SvDwaNiV43GZPzsgxwsuP95qpExkR/e8Zk/yIO5j3OiPjTrrIrp/pP
0riA7Gfslv3UYc0Tic6zFLU+H9X6tnIQ7nbpsc4RwXTcX+s4Om/CkPZ993zp
ZnKfKFnj7nlM6pf8/3z+B4h9d/Y=
     "]], 
    FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJJIGYCYtUnzfPOZtk6rPz2suKMgbIDjD9nkfLOP+7q
DtMn8FeZ/bZ2eFW8VfS3tqbDicNOazPvIfgb9PIWM55B8OtZjvYbHrd2kJoX
p3laAME3s9kbNI0RwX+cuPCayXsNh/rfVgXnTkD1v9Zw2F8ra5H+xNrh/NWw
N/q7NSD25dk4PAWpP6/ucAYE/tg4JIQEqS/gVIPzYe6H8fljA+4bLVdwmAJy
f7eNQ8jbyx9nNMrC3f+mLbfbyFoabn/N/R+3jF9Lwd0nUjmp5OwTBP8/COxH
8ANA5i2UgvsfrD9bCm4+jM/hplrK9AvBh4XvWZA7deQc0MMfAE4/w20=
     "]], 
    FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0,
      1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxllHtIFUEUxn2XlRZE2BOT8t67q9e72TVLDM8OWJKFZdFDKjXNa2opPSDz
UWYPSMQySzOz1D8sKjKotCC1TK7kK/MBmZGYkJTRQ5HS6rYzs3eGamBZfszu
Od+Z78zx2JUcvtvexsbGVnmilMdOefx7Gvca6xEMRpf1GPNEsHLsjr5V9jUi
bDy4uNBSg2D4wP1ZE80qV3HuSI6c1HaDc2jTpJWXryCw4FUnwrBLrXQpgHPO
mg8ORg/Opjhl/ZYZEx2fZQjrOLf9d4MIZiEgv/mtDCXlix7+NKv71TLLR/Yr
OXdiPWWc3S50Ocfn/89NDej2nkzOJ1zC7hQEW/VzJudR889+K+fTlVue+45y
bsFrGoL+rW7VHQtFcJe/xrS4IKiG4wPm2SIQGa5q/RaBsflRTa7TF87t3ZuH
Da8FWO15yK54MoJlgY/DL2YJNL8jonnWCjBStT6x2CLTOgZ0TM8xh8a8Jf46
qv+LDPbOZ9xjXHX0+3YZhhK8xgp/aeD8mFNkUZIMWfj7Qg31Q8M5uqHTa/cT
YLwUr1CAorPTjyxL1DImftmLjA0e7qNJm71o/XsB/LD+Mj3NbwaI3BSuvSYY
IArHF2Q4OhGQ0hYv0f1CGfBxFeVIVF8LZ9J/IYhx5VCIjyXL2r8GxkasY0TP
OP2bEviRHrYptthkIphdulNoTuFM7AjiXIDrm6qn9eRwpnk4E30lnK8GencV
l6r+zdPT/i9HYBBvzHwRq1f7Gal1SrTufjX/VQk8B7NLWwcQVPnsq7C9xZn4
8oBzXcaC5aZnEu2DPkT7pk2i/dHNmfzXxjnR+cc1UzOieZskWl8Dj5+69bpf
axoC3SdF+BwJHCryA2zXIbiL9ZRIoMX5p/B4M7/J7XGNMmPy7gHGpC9fBlGd
3j6MSb5TImPSj2+09FxMAHOxPzM04Ijzz5IZE73ZnAvw+Xcp9xnfnyoNjTcu
wwJsfKSW+uGk+HP6ZERnnwbeYf/cEdzz//40NkGj9h9nUo+eM4nni2BD77z0
6P1qPiOC8U8f61dka9h8o/NJ1bdRZZMO3ta6liyNQJCG+69XR88/BsF7XG+G
QP9P4Pc/GN/3FATzSX3qfE1F4I/vjyzCK0WGby5i8+Yw9usmZ+t8/mt+1f/P
1nn/B9YVqSc=
     "]], 
    FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIZIGZigIIMFwfla4+CGeYoOaDw1yg5lGwV/X06zQUi
vkHJYSYIRLo4CFdOKjn7RMkhQnz7RYZzzg4mxkDwWQVCr3Z2SAgJUl/wUh3O
N7fZGzQtUQvO3+7Q9Oj4Dz2HKd/Y4meouDj0B5eoTO83cHBVLWWaFeHiYFsZ
scL0rQHc/uTYO27MHIZw93G7ARVyIfj+FyfG/BNG8E8fdlqbKWfoUAE05myy
i0O0guPHZB1DuPth/ITDl7VTPRH8NBAQc3HYXytrkX7EwEFvwoIfhnwuDuJT
r3BmbDJw8D7Bbju71dkhHuQ/TX2HEKCz/2c4O0ydwF9l5q0D58P8C+NLzYvT
PH1BzaH+t1XBuRPODt02nrvSPik7gIJhRrCLQ/X9H7eMs5Ug/GgEH+YfdD4s
vgASxaKE
     "]], 
    FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
     1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJHIGYC4jQQKHNzuKMpu+b/YiUHGP/DovUKZ28oObQt
Dz9llOPmcAYE7ig5rOm+ncGQjuBLTL3CmSHk5vDANd5x1kclhze8+wxmvnJ1
cF9zdDlDhzLEvHuuDk8SF14z0VdxyOH8uSD9tquDaI/XK5YQBH+TXt5ixhgE
H6z+PYJvZAwEwepwvo6i/Jecaxpw/lOQen5Nh0v58eznDro6xIcEqS/o1HT4
siEge9Z2qPptmg4mIHMWuzpk5H9oPSmi5RAhvv0iQ5qrg7nN3qBpiVpw88Dy
XxD8P99KH8z5qA3n+5xgt529VQfO3+7Q9Oi4hD6cv8X8x6EULwM4X/VJ87yz
WQYOJVtFf5/+5urwHwTmGzgcqJW1SBdxc7gu9Mnx/DUDB1CwmFi6OfQHl6hM
f2/gsOKFh97/RDeHxff38c35bOCgN2HBD8M8NwdvkP1fDeDxhc4Hm89vCOdH
Kzh+TNYxhMcnjA92TxyCX/fbquDcB1c4/4Sm1aTT/a4O9SDxE1D397k62AO9
O0MbwZ/S3hp1eY4OnJ8KslcNwfe5ODHm32JtiP8yofGjqe1QGbHC9GwwML5B
EfFACxI/xsD0sx8YMMu1IOmA3dXh/NWwN/qztRz+xOQe/ffLxaGB5Wi/4XQt
SLh+wuTD4hPGB6dXHS0HlsWTrBj/ukD8o6Hl8AAYrMZMrnA+2L50VweZeXGa
pwW0HKZ8Y4uf0QJNryaaDhUg93a7OjBzdsknn9OA++95lva36XMRfAOtlcIX
WjRQw4MNjX9MBc5/UwxkeCP44Pw3QxmS3467OuzJr3k7k1UZ6n5Xh+r7P24Z
Vys58Pqvn5Lq4QbhZyvB4xPGh8U3jA9LD+h8WP4HAKM407o=
     "]], 
    FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {
     1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1,
      3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
     0}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJHIGYCYpFPjufT7no6tPD6r5/iquUA478p3ir6+7SW
Q8Lhy9qpKz0d/oPAfi2HMyDQg+C/4d1nMDMIwQdrU0Pw25aHnzK64gHn76+V
tUhf4wE3H8aH2W9+7WiuyQUEP7hEZfp/A4T7NurlLWY08XTIyP/QelIEwX+e
pf1teq0mnL/doenR8QoNON8DZJE6gs8AAg3qDpHi2y8y/PNwSAgJUl/Aqe7w
Oyb36L9THg6NLEf7DaerOSx74aH3fyKCL+/4MflMKxpfFsHXnbDgh2Gau4No
j9crlinqcP6MmUBwUxvOvy1dk2gkauBQ99uq4JyChwPIuTO6DRzm2ehcmVWH
4E/5xhY/4wmCDw62ME+HtapPmue91YeEVwE0vrx1HUDWmhR6Ovx5+/qApbKu
w/19fHOMizwdpkzgrzLj1nVwUy1lmtWA4F/Mj2c/NxGTP2eR8s4/6gg+OLxL
EPyZYGAA528x/3EoZReCD3bnOaj7WxB8IVD6qkXwwfFf4wlJV2cMHIxBoNjT
QXzqFc6MTQYOjxMXXjOx93SYDnKftIFDNufPBenCng7qb4EJr9IAnl5QzCtB
8EHJJnWFO5wPTo9/3CD28ejD+bD4gfHXg8J3rYZDDsi+xe4OUvPiNE8LqDns
vNX1N7XcA86PAKWfYwi+9wl229myng5MnF3yyXlqDmkg4ObpILscmJDi1R1q
QfEdAfXvGzWIf6o9IerS1By8QPpbEXxYeKLzjUDhNBnBB9t/AcEHu79XE86X
AckbaEHcOw0zv8P4APOhytk=
     "]], 
    FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
      1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
      0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {
      1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}}, {{0, 2, 0}, {0, 1, 0}, {0, 
      1, 0}}}, {CompressedData["
1:eJxTTMoPSmViYGDQBWIQveNW199UeV+HNDBQc4Dxz4DAGzUH3QkLfhjyIfgR
4tsvMpzzgfMrIlaYnj3s4/D3W+mDOYLqEP3bfRxEe7xesUxRd6j/bVVw7oS3
QzrI+G0GUPXeDtLz4jRPXzCAyB/wdjAGgccGDntA+tcj+CyLJ1kxzkXwl7/w
0Ps/09vhYNvy8FOXDCDumIIwf8ZMINjo5bDF/MehFC4NiHnLvRw26eUtZpyj
DtE/0QvufrA+O0w+LDzWdN/OYIj3cgi8JV2TWKQGcc9UBB9mPoz/HwSOI/jz
bXSuzHqG4PP4r5+SKuENNx/Gh9lv3/To+IzXXg4yoPD5oOYACkaTi14OElOv
cGY4qcP5OxyACncg+F4n2G1nX0XwX2Rpf5t+V91BHxR/17wcmDm75JP5NCB8
Nm+HF8VbRX9zaznkcP5ckC7tA+dP+cYWPyPEB2L/BnVIeEb6ODCAQAOC77G/
VtYiHTcf5h+weSoIvvm1o7kmHJh8WHjUgtLDDB94eC0FxddFBH8vyJonCD56
+gUA0qpGvQ==
      "], {{56.110899999999994`, 13.287500000000001`}, {54.14379999999999, 
      13.287500000000001`}, {55.1313, 15.8922}, {56.110899999999994`, 
      13.287500000000001`}}}], 
    FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJJIGYCYhNjIJD2cwi8JV2TWKTmAOOnxN5xY65Qd1B9
0jzvLJOfw/QJ/FVm2hoOCo4fk89c9YXz7+7jm2O8CcGXB8nP9XXY4dD06PgO
dTh/i/mPQyle6qjyN9QcerxesZhs9HVIAwM1h5Ktor9PX0Pw99zq+pv6HsGf
a6NzZdY/X4efb18fsFyMm1/zaUNA9ixVB17/9VNSP/hC/LdJBW6fSOWkkrNb
lB1YFk+yYlzr6/Bh0XqFsyuUHX7E5B79t8rXYeW3lxVnFiD4KtceBTP0oPFz
lCHhtdnXAUQZBys7iE+9wpmxC8EHu+cYgg8LX58T7Lazp6o4oIc/AEJNqDM=

     "]], 
    FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {
     1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1,
      3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
     0}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJHIGYC4sWTrBh9TwQ4tPD6r5/iquUA478p3ir6+7SW
g3d1s77PugCH/yCwXwtCz0fw+xf8MHzWhOAHl6hM/5+D4MfmHv23yRnBr4hY
YXpWH2E+jA+zf2tLzYXNjgj+4cvaqZJFCP7nDQHZs4oDHDLyP7SeFEHwn2dp
f5teqwnnb3doenS8QgPO99hfK2uhjuAzgECDuoOrainTrIgAh4SQIPUFnOoO
4h4BfyTsAxwaWY72G05Xc3jDu89gphKCr2k16XS9DIIfAvLvBX84PwHsYH8H
0R6vVyxT1OH8GTOB4KY2nH9buibRSNTAYYNe3mLGK/4OIOfO6DZweLF9PfNz
iQA4/7GI7Mmn3gg+OHxbAhzWqj5pnvdWHxJeE6Hh6a3rcH8f3xzjSQEOf96+
PmCprOvA8XNB+mYgf8oE/iozbl0Ha50rs57NRPCbAz3nNizC5M9ZpLzzjzqC
Dw7vEgR/JhgYwPlbzH8cStmF4IOj9xzU/bMRfHD6moHgV4Lif3qAwxkwMHAw
BoHJAQ7iU69wZmwycOgGBqNJZYDDdJD7pA0c/OXEsnyTAxzU3wIjptIAnl5Q
zBNG8O1B4RbtD+fvudX1N3W9H8Q+Hn04HxY/MP56UPiu1XCYawMMsDB/B6l5
cZqnBdQcvrPFz/ARDYDzwenHBsEHJbP0jAAHJs4u+eQ8NYg9NQEOsstfeOjF
qztEiG+/yNAG9e8bNYh/gP5PAwOo/jkIPiw80flG4HBC8MH2X0Dwwe7v1YTz
ZUDyBloO7iD3LsHM7zA+AC8dzPE=
     "]], 
    FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
      1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
      0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {
      1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}}, {{0, 2, 0}, {0, 1, 0}, {0, 
      1, 0}}}, {CompressedData["
1:eJxTTMoPSmViYGDQBWIQ3b/gh+GzpCCHNDBQc4Dxz4DAGzUH7+pmfZ8oBP/+
Pr45xlYIfn48+zlJ0yCHv99KH8wRVIfo1wtyEO3xesUyRd3h84aA7FnbAx3S
QcZvM4Co3xroID0vTvP0BQOI/OZAB2MQeGzgMAGkfxWCv7Wl5sLmhQh++/Lw
U0YLAh0OtgEZlwwcZoLAXIT5/0FAO9Bhi/mPQylcGhDz1AIdNunlLWacow7R
LxMIdz9Y36cADD4sPDh+LkjfzBToEHhLuiaxSA3iHlkEH2Y+jA92pzmC3xzo
ObfBDcHfeavrb2p8INx8GB9mf3CJyvT/HoEOMqDw+aDmUBGxwvSsdaCDxNQr
nBlO6nD+DoemR8d3IPheJ9htZ19F8F9kaX+bflcdEn92gQ7MnF3yyXwaEH4Y
UL54q+hvbi2HF9vXMz9/gODXrtuWVP8Xav8GdUh4/g90YACBBgTfY3+trEU6
bj7MPzUg854i+P5yYlm+1zH5sPAApwf5IHh4gePLBsEX/uR4Ps0VwUdPvwD+
aExb
      "], {{71.41090000000001, 13.287500000000001`}, {69.4438, 
      13.287500000000001`}, {70.43130000000001, 15.8922}, {71.41090000000001, 
      13.287500000000001`}}}], 
    FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGI7IGYC4pkgkBjsYG6zN2haopYDjN/AcrTfcLqWg6bV
pNP1McEO56+GvdGfreVgo3Nl1rNIBP8MCCgEO5gYA8FmLQd31VKmWSLBDhn5
H1pPXtF2kH79yEwKyP/x9vUBS2cdOP95lva36X/14fxI8e0XGewM4HzvE+y2
s6caOFw/mmvS8D3I4XHiwmsm9w0cPm8IyJ51P8jh9GGntZlyhg77a2Ut0vcE
OUQrOH5M1jGE6F+D4At/cjyfthTBr4hYYXp2Pib/PwjwI/hg+78aOLzYvp75
+ZIgh8X39/HN+Qx1z3IEn/PngvTNp4Icpk/grzJ7beCw4eHLqZueBEHctcXA
YfEkK0bfN0EOW8x/HErxMnCQB1p75m2QQ3LsHTdmCwTf/+LEmH/GCD4k/PTh
fIl5cZqnC3ThfBbOLvnkdzpw/glweOg47LzV9Tf1fZBDC6//+ilPtR0iQOH6
LQgS3rLakPDgDXb4A4qPxdD41UDEP8y8elD8X9eE81PTgOCYBpzPDLKfD8EH
+2+VKpw/Z5Hyzj/qCH4KyL8RKvDwmAEKL20VSHw+DnKovv/jlrG3MiT9HQ2C
0C+VIO5fFQRJZ3eUHB6LyJ58ujjI4cOi9QpnbyjB4wudf0dTds3/xQg+2Pxs
JXh6gPFh6QXGP3xZO1XyEYIPdp9wsMNaIR2+dD1lePoEuydHBc73AEW4ugZq
+p6L4IPTl7ymw4QFPwyfqQU71HwCGazp8J0tfoaPJTS/iGhB8pF/sIO+1krh
CypakPgMD3ao/21VcE5Dy6F23bak+lio/TqI/IrOh8UnACccxJY=
     "]], 
    FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJJIGZigIIvwQ6Bt6RrEovUHGD8lNg7bswV6g6VEStM
zz4Pdpg+gb/KTFvD4Qdb/Ayfiwj+1aO5Jg37EfzvIPmtwQ47HJoeHd+hDudv
Mf9xKMVLHVX+hprDmu7bGQxA/WlgoOag4Pgx+cxFBP/IZe1UyXsI/taWmgub
nwY7/Hz7+oDlYtz8mk8bArJnqTq85d1nMPMe1H+bVOD2iVROKjm7Rdnhxfb1
zM/3BDt8WLRe4ewKZYcnIrInn+4Odlj57WXFmQUIvsq1R8EMPWj8HGVIeB0I
djAGgWBlh88gaw8j+GD3nETwYeHrc4LddvZUFQf08AcAnW+qgQ==
     "]], 
    FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
     1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJHIGZigAKOUIc7mrJr/i9WcoDxPyxar3D2hpLDhAU/
DJ8xhTqcAYE7Sg6LJlkx+jIg+BHi2y8yXAtxeOAa7zjro5LDkcvaqZKHQhzc
1xxdztChDDFvT4jDk8SF10z0VRyaAj3nNuwKcRDt8XrFEoLgb9LLW8wYg+CD
1b9H8I2MgSBYHc7XUZT/knNNA85/ClLPr+mwtaXmwua1IQ7xIUHqCzo1HVxV
S5lmrYCq36bpkAYC80IcMvI/tJ4U0XKoiFhherY+xMHcZm/QtEQtuHlg+S8I
/p9vpQ/mfNSG831OsNvO3qoD5293aHp0XEIfzt9i/uNQipcBnK/6pHne2SwD
h47l4aeMToQ4/AeB+QYOa7pvZzBcD3G4LvTJ8fw1AwcQlfYyxKE/uERl+nsD
BwXHj8ln/oY4LL6/j2/OZwOHJyKyJ58yhzp4g+z/agCPL3Q+2Hx+Qzg/GmSQ
jiE8PmH8NpB7/oTA+aBoMTmK4G94+HLqpikhDvW/rQrOnTCAqAfy7YHenaGN
4E9pb426PEcHzk8FhbMagu9zcWLMv8XaDiIg/zVC40dT24Hj54L0zWXA+AYl
pAdakPhJA6af/bWyFsu1HA4AqfSAEIfzV8Pe6M/WcvCqbtb38QpxaGA52m84
XcvhATBYjN0w+bD4hPHB6VVHyyFATizL1xvqHw0tBxudK7Oe+SL4YPsaQhxk
5sVpnhbQchDzCPgj0Q9NryaaEPdOCnFg5uySTz6nAfff8yztb9PnIvgGWiuF
L7RooIYHGxr/mAqc/6Z4q+hvbwQfnP9mKEPy24YQhz35NW9nsipD3H86xKH6
/o9bxtVKDiHAZPL/A5SfrQSPTxgfFt8wPiw9oPNh+R8AAxi35g==
     "]], 
    FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {
     1, 3, 3}}}, {{{90.5625, 13.190600000000002`}, {90.5625, 
     13.374999999999998`}, {90.38749999999999, 13.374999999999998`}, {
     90.27659999999999, 13.374999999999998`}, {85.69529999999999, 
     13.374999999999998`}, {85.58439999999999, 13.374999999999998`}, {85.4094,
      13.374999999999998`}, {85.4094, 13.190600000000002`}, {85.4094, 
     13.007800000000001`}, {85.58439999999999, 13.007800000000001`}, {
     85.69529999999999, 13.007800000000001`}, {90.27659999999999, 
     13.007800000000001`}, {90.38749999999999, 13.007800000000001`}, {90.5625,
      13.007800000000001`}, {90.5625, 13.190600000000002`}}}], 
    FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}}}, CompressedData["
1:eJx1lA0slVEYx6+PMSuzlViNzOTe670vUlKJ7enDR0XJ7B6KESOkrq0vFVGo
G5kyEtJ8tN3akjt96VtDvspHoabWSuIWbaaSEL3nPfe+Z7N1trPd3957zvM8
/+d/HttIRWC0gUgk0uM24rY+t+0H0q+8/ICgGv+okoKOWVubnwm9UhBj7kNg
WdBtEtsvBdeV3HpDOTHcuH1xF2Wr4X63JZ0IomO49VwKp3ZsLk1rRzAULxsv
LJXC1Tx3Pf8GBCMH7iyaypZAwFKLeH8VguYHtTlGajHcyUjuvHWWsuZetcFQ
EmUv+0P6xQkIIoICJWUmEoHjFKOZLbcp8/GNpBC6r3GmRoFgW9eF0JkobX2H
EZyYck9s93UApQq1rlAiyDBszHU5IiP55CIoOG92zG0rC+e2fDN0LUeQPKYO
2DvJkvpqKY+YPlle9IDygLl1y5emOd9fIVjl8Tjw4jMWTuN4jxDE4nzzWaLn
QwR+zcaeJb9kAmeYbq/O/0JZw+slg6PB11a9rEdgaJJlE7VNBjey38WKOihv
OZ7u7NdHGadRPMz1BxeST3ni+3Dd2o2swHw/ZI7Q27jPNa0NwQu8EhyJnrWU
vTGXUZ4wCr/kl6PVe5CFIrxOIvB9mmK9xocl+XB6W6k0vk42jpCE899Fz58v
m3AZ9KZ8vy/rb7QZ5Qrsl1E5DOwu73VVyATOP5O58/U0I3BE2Htvg7cM0eeH
HC5X2N2fbmJIP35TDrG81yWaoczrNysHtdP+Sr33DKlPpH0Pptp48xGkYX+s
Zkm+DO3vgrH1HTFelMexHiGU+fujEKRgvykp6/otMPZnpYzUHYogFf9fwxAO
RrAH6xvDEH18dPlISX6AoLNHPuK8SwIebHfxoCN9L/z9lpSDDi4rnDWnHIbf
h/Gc79NySOPji4Fxz2tLNdfmu0gi8HLm+sLOhv/zH+wvOyl5T/MQ1GB9Q7Xz
QUR5M/bHmFzgHuy/z3Jord9QFTcjEXgS3xdFme+fSgwOOB6XrwbPF08xmTcW
SOCUm3cjU10o13G23LMJQX8wZ4SPYuJXfyTcr9Ob17NETN5rIj2v/vS1oEZJ
mde/jrJufnbg8+voPNXN13+Y1HNJ
     "]], 
    FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJJIGYC4pkgkBvhEHhLuiaxSM0Bxk+JvePGXKHuIPzJ
8XxaYoTD9An8VWbaGg4TFvwwfOaF4OfHs5+TtETw+0HyehEOOxyaHh3foQ7n
bzH/cSjFSx1V/oaag6tqKdMsiwiHNDBQc9h1q+tvqjeCH5t79N+mcATfX04s
yzc+wuHn29cHLBfj5td82hCQPUvVoX15+CmjCKj/NqnA7ROpnFRydouyQ1Og
59wGswiHD4vWK5xdoexQs25bUr1phMPKby8rzixA8FWuPQpm6EHj5yhDwgvo
f2MQCFZ26PZ6xWJii+CD3eOM4MPC1+cEu+3sqSoO6OEPAOwjpcg=
     "]], 
    FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {
     1, 3, 3}}}, {{{104.26299999999998`, 13.190600000000002`}, {
     104.26299999999998`, 13.374999999999998`}, {104.08799999999997`, 
     13.374999999999998`}, {103.97699999999998`, 13.374999999999998`}, {
     99.39529999999999, 13.374999999999998`}, {99.28439999999999, 
     13.374999999999998`}, {99.1094, 13.374999999999998`}, {99.1094, 
     13.190600000000002`}, {99.1094, 13.007800000000001`}, {99.28439999999999,
      13.007800000000001`}, {99.39529999999999, 13.007800000000001`}, {
     103.97699999999998`, 13.007800000000001`}, {104.08799999999997`, 
     13.007800000000001`}, {104.26299999999998`, 13.007800000000001`}, {
     104.26299999999998`, 13.190600000000002`}}}], 
    FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {
     1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}}}, CompressedData["
1:eJxdlHlIVFEUxs1EEixELKNcm0Wd96ZoMbPNk0JOFoxjUXJfuaGmOWW50MKY
lTNYtGm5hQtqhQXVDFFogmilaYuVZGobGWlqaomZUm7d+97MXOzA/ePHu8s5
3/nOc49KDImZbWFhMQsvFV6WeHVdL6x3U3BQVC56MLGXBY/lc245BXHQGepY
2VJKOW187cGXNyhr5yr1OQ2UB5Lvzx9n5OCEotd99uNA2ZK9eypADon2GXXP
fCkX/ax4stWH8oCqykXHcDBNwk8O+qS47EExB3J31xF1Gws5AWfVPSIOvNfX
hOQ9ZIXzrhx0R5a1rVrGQq+UJMBBwRUc7xjIGtT4eU8hiInFYe0Jdvj5skkE
mmFDcMJfDwj8cszhTg+Cpuqq89YGKbxa8uHP8UeUK39Nth65SdnnzKaI7lIE
C3NbbeL8Pcxsus/E5LnYb57gaLVznvwugonR1M4ilQzaX45t/1qDoPGx/+34
jQyEV2+xtXyMYBup/yoDDndwRvUI0om+TZSD3y/WRNqzZlYSHmZBzxeA4AUJ
tRxcdf2qqjzK26LsQn2jKfN6KRHoJV0ZJXLGzDmZOvRmQmbmiD0fN8/ukIGG
PBiCBD80ymAEy9G3kzKv5x7KfD5hCLqIXzplsAtXXxyO79sR4lFqwwj9VCPo
Jf5IYOE0luv1KZN+LGhx+i65lPm8iyjXuxmS4sqMerZQdjgX9N0qhXIT0deF
hVBsP2UxEvxbxwB2Q1j1FQRaq4aLyw8zwv1aBIraNOc1jV6gJHppEJwg38c8
Z7IPZb7eCikEY7v24/d69zGj+Rukgm9rKfP+b6fcibsV2IdgxUocl6Ww7JPY
+uRvBE4lYV7Ph6Swl/jmh7FftnS/gfRrvwQ6iH/eGvW8KRb0ajD60VIMETi9
ewYEQ+V6t+YCkbleE9taMpkLsinz9kzD+h29lNJ8TSTMXzIC54pexVJXMSjI
gQu4n/x8ieFc/gH7jCyjXj2UXcj+acqryXxGSiA9Fw9sJhLmN08izKeGMj9f
hyib/LKI6BEsmemfM2IzF5L5fioS9EtFgm5SWq+J+fqaKVfidqnmcBCfOKR7
miKGHeQ+R07QL0oK/////gGTpz/2
     "]], 
    FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGI7IGYC4v8g4B7jYG6zN2haopYDjN/AcrTfcLqWQ43I
OveHTjEO56+GvdGfreWwXa71daADgr9GJirFmj3GwcQYCDZrOcTv8uRh+h3t
kJH/ofXkFW2H80q3f9b9inb48fb1AUtnHTj/eZb2t+l/9eH8SPHtFxnsDOB8
7xPstrOnGjhcP/c9+PHdaIfHiQuvmdw3cNhTMlmC5Vi0w+nDTmsz5QwdOhwT
nl5YFO0QreD4MVnHEKJ/EoK/Ye775ce6EfwJb2vsTdsw+WB/8yP4YPu/GjiI
3wQ6AKh/8f19fHM+Q93Ti+DzMGm3i22Mdpg+gb/K7LWBg3/v9Dyh09EO+2tl
LdK3GDgsn31EYcOlaIct5j8OpXgZOPgkCURYXol2SI6948ZsgeD7X5wY888Y
wYeEnz6cLzEvTvN0gS6cz8LZJZ/8TgfOPwEODx2H579Xfrx0Ndqhhdd//ZSn
2g4qwODIugMNb1ltSHh8jnb4A4qPxVoOX/5eqXjJh4h/mHn1oPi/rgnnp6YB
wTENOJ8ZZD8fgg/23ypVOH/OIuWdf9QR/BSQfyNU4OExAxRe2ioOLt05z3+f
jHaovv/jlrG3skP5SzVDjjXRDjNB4KWSw4qPl3yTJkQ7nAGBO0oOf4De8+2K
dviwaL3C2RtK8PhC59/RlF3zfzGCDzY/WwmeHmB8WHqB8XuA0dd8AsEHu+9n
tMNaIR2+dD1lePoEuydHBc73AEW4ugZq+p6L4IPTl7ymQ0SK9X1/3hiHmk8b
ArJnaTq4P6wSWScfA4lvES0HgeYDpxaaxjjoa60UvqCi5fAUFJ+2MQ71v60K
zmloOUxxBjrIOQZivw4iv6LzYfEJACah1w0=
     "]], 
    FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYC4j8rP17y5Yp1MLfZGzQtUcsBxm/h9V8/5am2
gzhLGJ8uU6yDjqL8l5xtug5bTpTtm/8oxiEl9o4b8wx9hxkzgeBkjMPnDQHZ
s9oNHEyMgWB2jEO0guPHZB1DB5funOe/JyL464syJr7tQfDZ18hEpXTHOJw+
7LQ2Uw7B9784MeafMIK/US9vMSMPgp8Msp/D0GHr579XKoDm9weXqEx/b+Bg
2umY8PRGjMODCPHtFw/oO7xffszb/GWMgy7I/dd04HyYf2H8p4kLr5mcV3UQ
Wef+sGpNjINI5aSSs0uUHc4r3f5ZNynGAeTNmS+VHKY4Az0EtP+Opuya/5uV
4O5hAIENCL7ytUfBDHMQfP7YgPtG7Upw/1ff/3HLOFsJHj4wPji8ZyH4+08t
dN22OcahEsS3VnYAuk5k3fYYh3BOsXbjeGWHjD0lkyX+xDjUfAJFgCo8/rY7
ND06XqHhgB6/AAZ92OU=
     "]], 
    FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
      1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
      3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
      1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
      3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
      3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxdlHtMjWEcx8NxC8uyYRmhyyk557zv45xOLukbQiUnZeSWR5eFTDGXGHG0
uZ2ITUIplzVsyB+NMWQlck25NGJuWRiz5LpKnue8z3rGs71799mz93f5fn+/
d1hCWkxyZxcXlwj28Pedo2Hnm6MoSnwasgoNJnh3s+dOtFHQmTH6IztMaKqN
SugbTWEacarfgwbJbxcdfWL2VDq4gXOIguqfsW+LbeJ+oYLi/OtDz02nmDPg
Qo1LpoJHGR981WkU3y4+29lWqaDueHqw6xSKUfx0UWHdEUrfgcKuq8xRrSpS
G1tONQVSYMubmwccKnj4fD+Kso2Dg1J0pIMTFzyf3GWq5JzYVd55NoK7/PiJ
eLMJvpy4EWn1pwheF3fSsoCgyMP0wnsERd4et/WBqUSrP4BiY8uY9PsZBAf5
MVCkn3bUL95McJgHMFHUuX8Nrd4q4qki/3aCZbxeIjnEEn8p3Cy5F294PMWJ
91ON7XaCOUljX9rCKBwRH3XmGaIepldvW8m+5CDSoZ8zXyDB78yll1cxfSOr
ugfnWwhuRjLFoiVXrbla5BEr2RlvFoXC/ZtEcO02M3y20HOe+D5O3CcRMDfq
jscJ/dIkO/VbK/lWxYQzS3YT5C13z7rG4g8qjPe/c4SA21nH8tcP2rCIFBPN
30jhVynB6FJWYQiFG++viiB3omNZo1WyM16g5DSGty2i/xsEZbwhs2SmzsrF
TH9bzd75fypEv0aKxqUBP/KuEDS3sYlj/rbzUyLq08t6+bWvj/DfIfz3osjm
fqwgYG7WRg2nKLX+Kk+aS8Cid7MPo2j9sfpVQajk5nPRqYf0kp3+1qjwqmeO
+Yn8aWrH/Gzi8zVQ1fxi9ejZ+t1zVdEpYFv/p0Mo5g0NbUr8pCCRjceuAcKP
MgUpez9vCOkj5sWuaPPZlWpvf7FvnSmquD+FJnz3m59T3omi4JjXxdYUEx6y
dY1jbHYunOTBzoKN//Imo7bfOtG/q1HzvweFrudOz8SzBq0+NxFfb9Dm24PC
Mu5KzP7XI/FgOBPAV3I2NzhIslP/cIrqx7M+mVoM+P9/9BeSkvu+
      "], CompressedData["
1:eJxTTMoPSmViYGCQBWIQbX3fv3e6XYLD8V07etk+6Dn0H/qqEWOd4DBjJhBI
6jmUTJZgCTNKcPjx9vUBS2ddh6WzjyhsUEPw1Q051sjIIfixuzx5mMQTHJ5n
aX+bXqvr4Jjw9IKScIJDC6//+ilPdR1AxvEJJjj8AalX1nPI3gO0QSDBIT4k
SH1BJoJvYgwEmxF8HUX5Lznf9Bz2z5fSvwvk/wcBe32H3SAHCiU4JID0d+o7
9E7PE2oWSXDo9nrFYiJo4JAsEGG5RSLB4XHiwmsm8QYOt3/WZe1RSHCYPoG/
ymy2AcT9QP8cbFsefuqQgUOBLdf1xToJDqcPO63NvGcAcb9xgoPqk+Z5Z18Z
OEx17s55DuT/+Vb6YM5DAwd707hdnhZQ/641gNhvk+CQHHvHjbnCwAEWvlvM
fxxKsTJwsNxyomyfPVS9rIGDAdD6KAco/68+nP8UxN+L4IPjo1Ifrh8cHmb6
DujxBwBucsQq
      "]}], 
    JoinedCurveBox[{{{0, 2, 0}}}, {{{118.17899999999997`, 
     13.200000000000001`}, {140.614, 13.200000000000001`}}},
     CurveClosed->{0}], 
    FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
      1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
      3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
      1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
      3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
      3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxdlAtMTmEYx5OGpuXSdWPq+/q+zhkq0Sep+FNREUnS4n27SBczl7QJuS/m
NrdyC8ttrVGqJSTTJLflEoVlRmTp8k2tVumC9/3O2Xe2nu3s7Lf3Pf/3eZ7/
8x5V3MawtaYmJibB7OHvgbyOdyHzKfK6m9OqY9S4nZJ0Uu9PUc2jXI1AC9Mp
BxdQLLxVlWti72TkbwHR8y5sHsJFTjCLsHQpDpC5wwmFl37nPvWjaIy98sHD
TYMxkV4lz+dQTMr9Fej6SAPrgoUN2z0ozp1n4aVFbVqzs7tIofN5GHbmiha+
OloWZE1R4tn7OD7YGeFM/lIPQaHrhmvDfAQj9+lbK7wqFQ6tn5Ae+07APx6M
Z3K9BgH+pZ2Dtb3se23j/st6AdeznzgW9hFEh4cJOeailP8gwbTJeVZvNaKU
1zAKm6PBLWYeInICmIAZxfdIu7s1ECW9UVQ630/EXJ6vhcKNb9Wf/1gqnM4L
VlPsMas67u4pwt7ti2aEO0Xw85G+2XUCbvB8mB9Lak6u/ntNMPbPcF6OgMh4
769LWX9fVs7PT74soGuQdWyBwj3Lf9zIXqywQS+MIvNgRtT7cgFN/czwFXI/
W+TvI+T1AQHMDeuClVTq33jRyAY/VAo/K7t3bESoiEy/I+ubllMkb2zPeJEq
Ip9vWELRtG5K99mdouSvD0Ux9+uiiE+vWYZaihBeX6WIE/r0uTpbhQ16Vgr7
M+wfJ9dfwfrJCxqrMOvOIk9zijd1EW1uD0SpXlOK4eaHHdYUiAiJGxvpNUAw
fQaL03J+3cSYbwxbLmkniOH+B8n+6wkWcT9sRBDmpmkrwcWrTvcHmgQw9ZSk
ZgIXlUPX+lKF7bNqzZP2KbyX+/vRGbcmRsV798jnWzkb58cwX/Faya8ugl39
sze9DtQiqTz1tH0jQduWOzb9o7VwYeOxt45gGfejWAPdoXkxPysIFvP8dBpp
PosI1iawOCDft5tEun81aoTem5TRmkew42tv/YxsNfh1tWWcyPcnKHzEJ6gs
YfoQLlZJ97uAYGtlacB5X5Xk/11Zv8FRyq9K1l/lKM13PYHVtlOpr6wdMZI3
oFPh3VnMYDtqZEP/Z1Hkj59qmeiqwtD/0X99Ogg1
      "], CompressedData["
1:eJxTTMoPSmViYGCQBWIQfUeFrXGqcpyDMQgoKzm0vA7cIScb53AGBHwUHfx7
p+cJccc5pKcBQZmCw4a575cf+xwL5285UbZv/iMEX+H2z7qsK7EOK7+9rDiz
QcHhhZohx5ozsQ4fFq1XOCuh6NADNK75BFR9mKKDzX2gDcdiIfbNQfDB8s8Q
/JkgoKnk8GTp7CMKQP1g9xYrOdwFOfAUVP8eJYeGqc7dOedjHfbk17ydGars
oNMudvPc9ViHB67xjrM+KjvIRKVY338e65AQEqS+IFMF4v5PsQ47HJoeHd+h
4uD+sEpk3f9Yh2O7dvSyfVCBuJ8nzqH2t1XBOQ5Vhwlva+xN+eIcdBXlv+R8
U3F4ckHp9k+xOAcWzi755D4ViP3ycQ4/374+YKms4gALX481R5czrFB2uHHu
e/Bj1TiHNUI6fOl5yg7HgdZLqcdBwssAjf9BCc4/DfLfGiW4fnB4ZCo5oMcf
AGZr1BI=
      "]}], 
    FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {
     1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJVIGYCYp8kgQhLl3iHOYuUd/55ru4A48suf+GhF6/h
0DM9T6hZIN7ByBgIgjUc7E3jdnn+iYPzZaJSrO/fj3PwOsFuOztUw6H8pZoh
x5k4uH4YH2Z+7C5PHqbbCL5pp2PCU4Z4DD4DCBxA8F9kaX+bHovgrxXS4Uv/
p4jKv6fgELBDrvX1yzgH4cpJJWdDFBxK982X0r+K4JdkTHxbcx7BB/tvR5xD
9f0ft4yjFRxWfLzkm7QizuGBa7zjrIcKDu4Pq0TWbY9zWAMy/52Cwwugd9bs
iXOYPRMIPBXh/P8g0I/gg81nUXJ4u/yYt/nGOIdwTrF2Y3slhy9/r1S8XIbg
rwEF4HwEn4dJu11sYpwDf2zAfSNxBN95QrNQWpcinH8f5L6FCg5z3gMtWB/n
kJoGBM/kHfaUTJZguYbgP/298uOlvwi+QPOBUwtV4x1WfntZcWaDApwP9v9v
RTjf7+LEmH/J6nA+LH6OKGwoytDETC8wPgD4iPbX
     "]], 
    FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
      1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
      0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {
      1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 0}, {0, 1, 0}, {0, 
      1, 0}}}, {CompressedData["
1:eJxTTMoPSmViYGDQBmIQvdB12+e/AQkOxmCg4ADjO09oFkpbpeBw+2dd1h4f
BD/Z+r5/rz2Cz319cYGtXYKD8rVHwQxnFByy95RMlrBJcAjnFGs3lld02H8K
aCJ3gkNm/ofWkyUaDvOl9O+qcCU4/P1W+mDORg2H2UcUNhRxJDg8z9L+Nn2v
hsNXjZj+Q6xofEYEH8T9ypDgID71CmfGIg2HUD7dTXP/x8PNj93lycO0ON7h
gWu846xCRQh/drzDnvyatzOvKjg8qBJZ594ZD3f/CzVDjjUlmHxYeJxXAoZA
UzzEP/YKDlcqXqoZTkDwQd5lmYfgLwCF3xoE/8kFoAHH4h3S04DATMFB964K
W+NZhPkwPsz+GTOBYCeC/3b5MW/zjfEO/LEB942+I/hgeStFOP8MCPgoOgTs
kGt9vRFqX5iiw5tAoMDmeAf3NUeXM1QoOkx4W2NvCnTPHU3ZNf8fKzkYcKyR
iZJJgPOBscl1XT3Bofr+j1vG2ooQ/2og4hNsD5APcuZMTgS//PA215l/FeB8
mPtvnPse/FgWKf0IRFhukcDkw8IDEk4J8PBDT58AtAQctw==
      "], {{128.79100000000003`, 9.67969}, {127.192, 9.67969}, {
      127.99399999999999`, 11.617199999999997`}, {128.79100000000003`, 
      9.67969}}}], 
    FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJJIGYC4uXHvM07VyY4/AeB/VIOKPz7Ug4LXbd9/rsi
wWG9kA5f+j9MPr/uprnvJ0PV/5dxWDr7iMKGpgSHO5qya/4nK8D5K7+9rDhj
oAzni/Z4vWL5ouqQbH3fvxeo/9Rhp7WZ99Th5otPvcKZ8UjDYQGULwblw9wX
eEu6JvETgm9mszdoGqMmnA82X0TT4QwIAPW/Kt4q+ltb0+GC0u2fdcsQ/OuL
C2y5FiP45p2OCU9LEhxmTOCvMvNWh/Nh7ofxTYxBQM6BUbtd7OaiBIea+z9u
GWdLwc2H8WH2w/gw98WoRsicm4MW3sDwBwCZ88WJ
     "]], 
    FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}}}, CompressedData["
1:eJxllH8slVEYx6+uX/3CMIl73fd63xutrJSSVeuxpmYm1g9TqPNGrLRuawp1
VxMWyShrhZloKkur9YeWJEONQpSUVl2RYZGfkYw6533fe8/Ss50/Pu95z3me
832+56gPancekstkMhM89uAxDw83T8syhQMPMhKrGbh07ZhtsjsP17OtT69/
xcGzQqdVnzF3hS551NrJQY6jaYjVch4aSQxQ9lCrxo9OUG55FzKwylkDWTU/
3cPdJA7TANmOc6U8NtOW0O9C+fXkru4SZ5w/F4ePBqZLR94EOvFgOv+iKtJK
A7dfBHinL5XmpzjAq5d5OvKgG30QHJvHAWeedHXrEuk8SGI7Hjr9Dvjm8Szs
jdqoD1rMw1oS3Wqw9nhYMLSQh/jacr/cTLX4HTPb3rVLFq6GSPx7ppyH7WXP
b8v6GNi84P3N4yY85JP8DQwUDOGKppFYTyID9aeqCp3GKHun+6Keb/9z6UR/
QiOojSzsn0D5nu1Kq5hZqZ5eBEPF95mmNFdRnyEEZLvcDlbUYwTB1OD3ah+W
A6GfowiiIj5tk2+g/I0vavfSUjb0xwzLk9FnqE8DERX+i+bpKU+dPVIZ94qy
sL4GwVOtbjC3hzVy+ib/iuhiykLdOSyYrLjg0IHZJiJYvyaeBdx986TnlIX+
1VMWfFUvnS+dhbeBB21CG6R8JSyU5NcxD5qR6IdmyZ8fEBzWDqc22Gvg8qBu
y7ovlL324wN1UbYoU+yL6kZG/xo4msStORzNif3oNPSDhTSMLXj/M/pfH9fe
ZSG2Mi7HEec/SfxT4Apa2+Tql+8Q3CH9taEs6qM28h8S5xhjPrvEK3FN9ozo
91HKRX7lYzPjlJ/gdKazlMPIBbPkQU/8XcRAxtHe6VIziUdUor+xf6szqs57
yVVArnf1bwT2ZH2dUvTvJAK3Ua4/z18p6vsDgariRtWhHQrpnlAW/P+VcgwR
vANBCmOhadytEPvRhiCV8Lg0/1nKxykhhsj6RZq3dzGyjugZQDkzNCPIZNgF
skk/P0r/e6mgFj8nWe2UCda0Uv7Hr49djCzoXaic42cFkOOeaJPqS3E29sPA
wn2bpCz41UbSM1IJc9/Pv0VHS+8=
     "]], 
    FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJJIGYC4vlS+ndVqhIdVn57WXHGQNkBxp+zSHnnH3d1
hysVL9UMfRIdXhVvFf2trenwPfjx0tkeCP7vlR8v+boh+MxhfLqbXBMdpObF
aZ4WQPDNbPYGTWNE8B8nLrxm8l7D4cY5oImuUP2vNRwu+yYJRHgmOpy/GvZG
f7eGg/V9/97pUYkOT0Hqz6s7KN/+WZeVk+iQEBKkvoBTDc6HuR/G548NuG+0
XMFh4tsae9O4RIeQt5c/zmiUhbv/TVtut5G1NNz+mvs/bhm/loK7T6RyUsnZ
Jwj+fxDYj+AHgMxbKAX3P1h/thTcfBgfKJsk4IPgw8L37Bkg0JFzQA9/AMX/
ub8=
     "]]}},
  AspectRatio->Automatic,
  BaselinePosition->Scaled[0.27023990214544485`],
  ImageSize->{143.3039302615193, 19.61281195516812},
  PlotRange->{{0., 143.3}, {0., 19.610000000000003`}}]], "Output",
 CellChangeTimes->{
  3.951285883505773*^9, {3.951285930362904*^9, 3.95128596883426*^9}, {
   3.951286081597411*^9, 3.951286094023354*^9}, 3.951286272649108*^9, {
   3.951286481651016*^9, 3.95128655805203*^9}},
 CellLabel->
  "Out[897]=",ExpressionUUID->"838c1182-5e2f-4bc2-9df1-2f48f924020a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DerivativeExpand", "[", 
  RowBox[{"Setup", ",", 
   RowBox[{"FTerm", "[", 
    RowBox[{"Exp", "[", 
     RowBox[{"FTerm", "[", 
      RowBox[{"FDOp", "[", 
       RowBox[{
        RowBox[{"A", "[", "x", "]"}], ",", 
        RowBox[{"FDOp", "[", 
         RowBox[{"A", "[", 
          RowBox[{"-", "x"}], "]"}], "]"}]}], "]"}], "]"}], "]"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.951285827015435*^9, 3.951285875811627*^9}},
 CellLabel->
  "In[605]:=",ExpressionUUID->"4295c899-7890-4d08-8905-98f26dddfa74"],

Cell[BoxData[
 RowBox[{"DerivativeExpand", "[", 
  RowBox[{
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"MasterEquation\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"A", "[", "x", "]"}], " ", 
          RowBox[{"A", "[", "y", "]"}], " ", 
          RowBox[{"VBasis", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"A", ",", "A"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "x"}], ",", 
              RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"cb", "[", "x", "]"}]}], " ", 
           RowBox[{"VBasis", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"cb", ",", "c"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "x"}], ",", 
               RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], ",", 
          RowBox[{"c", "[", "y", "]"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"\<\"FieldSpace\"\>", "\[Rule]", 
      RowBox[{"\[LeftAssociation]", 
       RowBox[{
        RowBox[{"\<\"cField\"\>", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"A", "[", 
            RowBox[{"p", ",", 
             RowBox[{"{", 
              RowBox[{"v", ",", "c"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Phi]", "[", "p", "]"}], ",", 
             RowBox[{"\[Phi]x", "[", "p", "]"}]}], "}"}]}], "}"}]}], ",", 
        RowBox[{"\<\"Grassmann\"\>", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"cb", "[", 
             RowBox[{"p", ",", 
              RowBox[{"{", "c", "}"}]}], "]"}], ",", 
            RowBox[{"c", "[", 
             RowBox[{"p", ",", 
              RowBox[{"{", "c", "}"}]}], "]"}]}], "}"}], "}"}]}]}], 
       "\[RightAssociation]"}]}]}], "\[RightAssociation]"}], ",", 
   RowBox[{"FTerm", "[", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"FTerm", "[", 
      RowBox[{"FDOp", "[", 
       RowBox[{
        RowBox[{"A", "[", "x", "]"}], ",", 
        RowBox[{"FDOp", "[", 
         RowBox[{"A", "[", 
          RowBox[{"-", "x"}], "]"}], "]"}]}], "]"}], "]"}]], "]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{3.951285876328587*^9},
 CellLabel->
  "Out[605]=",ExpressionUUID->"e0c0781e-2cfd-4aa3-bfbc-782460af2124"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"ReduceFTerm", "[", 
   RowBox[{"Setup", ",", 
    RowBox[{"FTerm", "[", 
     RowBox[{
      RowBox[{"cb", "[", "x", "]"}], ",", 
      RowBox[{"FDOp", "[", 
       RowBox[{"A", "[", "c", "]"}], "]"}], ",", 
      RowBox[{"cb", "[", "x", "]"}], ",", 
      RowBox[{"A", "[", "c", "]"}], ",", 
      RowBox[{"FDOp", "[", 
       RowBox[{"A", "[", "b", "]"}], "]"}], ",", 
      RowBox[{"cb", "[", "x", "]"}], ",", 
      RowBox[{"cb", "[", "x", "]"}], ",", 
      RowBox[{"A", "[", "b", "]"}]}], "]"}]}], "]"}]}]], "Input",ExpressionUUI\
D->"47687bc9-4adb-47ae-af03-f85ea04c7388"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Algorithm", "Section",
 CellChangeTimes->{{3.932177970725307*^9, 3.9321779720559883`*^9}, {
  3.9508509057472887`*^9, 
  3.950850909097567*^9}},ExpressionUUID->"be19843a-e765-47f1-9747-\
2d6834a73a9e"],

Cell[CellGroupData[{

Cell["Resolve a single FDOp", "Subsection",
 CellChangeTimes->{{3.9512328702638407`*^9, 
  3.951232879465557*^9}},ExpressionUUID->"e3f3669e-621b-4b13-b56e-\
3deed41d0aba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Resolve", " ", "a", " ", "single", " ", "occurence", " ", "of", " ", 
    "FDOp"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ResolveFDOp", "[", 
      RowBox[{"setup_", ",", "feq_FEq"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Return", "[", 
         RowBox[{"FEq", "@@", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ResolveFDOp", "[", 
              RowBox[{"setup", ",", "#"}], "]"}], "&"}], ",", 
            RowBox[{"List", "@@", "feq"}]}], "]"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ResolveFDOp", "[", 
     RowBox[{"setup_", ",", "term_FTerm"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rTerm", "=", 
         RowBox[{"ReduceFTerm", "[", 
          RowBox[{"setup", ",", "term"}], "]"}]}], ",", "\[IndentingNewLine]",
         "FDOpPos", ",", "\[IndentingNewLine]", "termsNoFDOp", ",", "dF", ",",
         "\[IndentingNewLine]", "dTerms", ",", "nPre", ",", "nPost"}], "}"}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "If", " ", "no", " ", "derivatives", " ", "are", " ", "present"}], 
        ",", " ", 
        RowBox[{"do", " ", "nothing"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{"rTerm", ",", "FDOp", ",", "Infinity"}], "]"}], ",", 
         RowBox[{"Return", "[", "rTerm", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"FDOpPos", "=", 
        RowBox[{
         RowBox[{"Length", "[", "rTerm", "]"}], "-", 
         RowBox[{
          RowBox[{"FirstPosition", "[", 
           RowBox[{
            RowBox[{"Reverse", "@", 
             RowBox[{"(", 
              RowBox[{"List", "@@", "rTerm"}], ")"}]}], ",", 
            RowBox[{"FDOp", "[", "_", "]"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"termsNoFDOp", "=", 
        RowBox[{
         RowBox[{"rTerm", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", 
            RowBox[{"FDOpPos", "-", "1"}]}], "]"}], "]"}], "**", 
         RowBox[{"rTerm", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"FDOpPos", "+", "1"}], ";;"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "If", " ", "the", " ", "derivative", " ", "operator", " ", "is", " ",
           "trailing"}], ",", " ", 
         RowBox[{"simply", " ", "remove", " ", "it"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FDOpPos", ">=", 
          RowBox[{"Length", "[", "rTerm", "]"}]}], ",", 
         RowBox[{"Return", "[", "termsNoFDOp", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dF", "=", 
        RowBox[{"rTerm", "[", 
         RowBox[{"[", 
          RowBox[{"FDOpPos", ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Perform", " ", "the", " ", "product", " ", "rule"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"nPre", "=", 
        RowBox[{"FDOpPos", "-", "1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nPost", "=", 
        RowBox[{
         RowBox[{"Length", "[", "rTerm", "]"}], "-", "FDOpPos"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dTerms", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"termsNoFDOp", "[", 
            RowBox[{"[", 
             RowBox[{";;", 
              RowBox[{"nPre", "+", "idx", "-", "1"}]}], "]"}], "]"}], "**", 
           RowBox[{"FTerm", "[", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"idx", "+", "1"}]], 
             RowBox[{"FunctionalD", "[", 
              RowBox[{
               RowBox[{"termsNoFDOp", "[", 
                RowBox[{"[", 
                 RowBox[{"nPre", "+", "idx"}], "]"}], "]"}], ",", "dF"}], 
              "]"}]}], "]"}], "**", 
           RowBox[{"termsNoFDOp", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"nPre", "+", "idx", "+", "1"}], ";;"}], "]"}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"idx", ",", "1", ",", "nPost"}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"ReduceFEq", "[", 
         RowBox[{"setup", ",", 
          RowBox[{"FEq", "@@", "dTerms"}]}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9511105533495092`*^9, 3.9511105648525476`*^9}, {
   3.951119455805057*^9, 3.9511195617211657`*^9}, {3.951119676282247*^9, 
   3.951119712474145*^9}, {3.951119753961474*^9, 3.951119965018001*^9}, {
   3.951120276792581*^9, 3.9511205887782927`*^9}, {3.951120670947592*^9, 
   3.951120778348651*^9}, {3.951120826438107*^9, 3.951120906614008*^9}, {
   3.951120939999701*^9, 3.951120956314575*^9}, {3.951121009242169*^9, 
   3.951121081510736*^9}, {3.951121127768268*^9, 3.951121329433323*^9}, {
   3.951121359899194*^9, 3.951121425034974*^9}, {3.9511224825381813`*^9, 
   3.951122501258943*^9}, {3.951123573189911*^9, 3.951123598725543*^9}, {
   3.951123637357983*^9, 3.9511238544580727`*^9}, {3.951123926802017*^9, 
   3.9511240059898977`*^9}, {3.9511240423102016`*^9, 3.951124131010861*^9}, {
   3.9511241648535767`*^9, 3.951124227324479*^9}, {3.951199174459216*^9, 
   3.951199180926196*^9}, {3.951200228052285*^9, 3.951200273018259*^9}, {
   3.951200422144641*^9, 3.951200425300118*^9}, 3.95120094844139*^9, {
   3.9512011642699833`*^9, 3.951201182694016*^9}, 3.951201274960949*^9, {
   3.9512015178111143`*^9, 3.951201562510607*^9}, {3.9512095086440887`*^9, 
   3.951209512939533*^9}, {3.951209684117496*^9, 3.951209732155652*^9}, {
   3.95120994522215*^9, 3.951209973936924*^9}, {3.9512110641082573`*^9, 
   3.95121111673773*^9}, 3.951211153997551*^9, {3.951211324253121*^9, 
   3.951211350271022*^9}, {3.951211627960374*^9, 3.951211709649838*^9}},
 CellLabel->
  "In[313]:=",ExpressionUUID->"ac348a0a-7a6e-409c-9a98-56e5170bdbb5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ResolveDerivatives", "::", "argument"}], "=", 
    "\"\<The given argument is neither an FTerm nor a FEq.\nThe argument was \
`1`\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Iteratively", " ", "resolve", " ", "all", " ", "derivative", " ", 
    "operators", " ", "in", " ", "an", " ", "FTerm", " ", "or", " ", "FEq"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ResolveDerivatives", "[", 
    RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ret", "=", "expr"}], ",", 
       RowBox[{"i", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AssertFSetup", "[", "setup", "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{"ret", ",", 
          RowBox[{"FDOp", "[", "__", "]"}], ",", "Infinity"}], "]"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"ReduceFEq", "[", 
          RowBox[{"setup", ",", "ret"}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FTermQ", "[", "ret", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"ret", ",", 
              RowBox[{"FDOp", "[", "__", "]"}], ",", "Infinity"}], "]"}], "&&", 
            RowBox[{"i", "<", "$MaxDerivativeIterations"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ret", "=", 
             RowBox[{"ResolveFDOp", "[", 
              RowBox[{"setup", ",", "ret"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "ret", "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FEqQ", "[", "ret", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Return", "[", 
          RowBox[{"FEq", "@@", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ResolveDerivatives", "[", 
               RowBox[{"setup", ",", "#"}], "]"}], "&"}], ",", 
             RowBox[{"List", "@@", "ret"}]}], "]"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"ResolveDerivatives", "::", "argument"}], ",", "ret"}], "]"}],
       ";", 
      RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951109126796526*^9, 3.951109162803561*^9}, {
   3.951109195696103*^9, 3.9511092753420467`*^9}, {3.951109641851746*^9, 
   3.951109708704658*^9}, {3.951109745518846*^9, 3.951109820791531*^9}, {
   3.951119472303504*^9, 3.951119473407467*^9}, {3.951201291788858*^9, 
   3.9512015119676657`*^9}, {3.951201569206512*^9, 3.951201586086426*^9}, {
   3.951206148564587*^9, 3.951206211857237*^9}, {3.9512062440841913`*^9, 
   3.951206321742989*^9}, {3.951206368639289*^9, 3.951206475591106*^9}, 
   3.951207767500757*^9, 3.9512094609041777`*^9, {3.9512095311450663`*^9, 
   3.951209577983329*^9}, {3.951209618249853*^9, 3.951209633863234*^9}, {
   3.9512097690861053`*^9, 3.9512099352835913`*^9}, {3.951209996511508*^9, 
   3.9512100677197866`*^9}, {3.9512102840601892`*^9, 3.951210369806964*^9}, 
   3.95121047975072*^9, {3.951210516428762*^9, 3.951210536552635*^9}, {
   3.951211721416297*^9, 3.9512117303764887`*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"b0835c23-2d69-40a7-9251-be3d8571a3bb"]
}, Closed]],

Cell[CellGroupData[{

Cell["Take several functional derivatives", "Subsection",
 CellChangeTimes->{{3.9508680530500927`*^9, 
  3.950868063045309*^9}},ExpressionUUID->"a8f64e7a-d885-45c2-99d7-\
7e2e4dc385f7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Protect", "[", 
   RowBox[{"OutputLevel", ",", "SuperIndexForm"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "TakeDerivatives", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"OutputLevel", "->", "SuperIndexForm"}], "}"}]}], ";"}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.951227336083239*^9, 3.951227337862597*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"bba04405-f573-40fc-9a19-18ca7de811ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Perform", " ", "multiple", " ", "functional", " ", "derivatives", " ", 
    "on", " ", "a", " ", "master", " ", 
    RowBox[{"equation", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TakeDerivatives", "[", 
     RowBox[{"setup_", ",", "expr_", ",", "derivativeList_", ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "result", ",", "\[IndentingNewLine]", "externalIndexNames", ",", 
        "outputReplacements", ",", "\[IndentingNewLine]", 
        "derivativeListSIDX"}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AssertFSetup", "[", "setup", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AssertFEq", "[", "expr", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AssertDerivativeList", "[", 
        RowBox[{"setup", ",", "derivativeList"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"While", " ", "doing", " ", "the", " ", "derivatives"}], ",",
          " ", 
         RowBox[{
          RowBox[{"we", " ", "want", " ", "to", " ", "use", " ", "super"}], 
          "-", 
          RowBox[{"indices", ".", " ", "Afterwards"}]}], ",", " ", 
         RowBox[{
         "we", " ", "can", " ", "replace", " ", "these", " ", "again", " ", 
          "with", " ", "the", " ", "given", " ", "indices"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"externalIndexNames", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<eI\>\"", "]"}], "&"}], ",", 
          "derivativeList"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"outputReplacements", "=", 
        RowBox[{"Thread", "[", 
         RowBox[{"externalIndexNames", "->", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"FieldIndices", "@@", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Head", "[", "#", "]"}], ",", 
                RowBox[{"List", "@@", "#"}]}], "]"}]}], "&"}], ",", 
            "derivativeList"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"derivativeListSIDX", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", 
            RowBox[{"derivativeList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
           RowBox[{"externalIndexNames", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "derivativeList", "]"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "We", " ", "take", " ", "them", " ", "in", " ", "reverse", " ", 
         RowBox[{"order", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"derivativeListSIDX", "=", 
        RowBox[{"Reverse", "[", "derivativeListSIDX", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"First", ",", " ", 
         RowBox[{
         "fix", " ", "the", " ", "indices", " ", "in", " ", "the", " ", 
          "input", " ", "equation"}], ",", " ", 
         RowBox[{
          RowBox[{"i", ".", "e", ".", " ", "make"}], " ", "everything", " ", 
          "have", " ", "unique", " ", "names"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"FixIndices", "[", 
         RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Perform", " ", "all", " ", "the", " ", "derivatives"}], ",",
          " ", 
         RowBox[{"one", " ", "after", " ", "the", " ", "other"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"result", "=", 
          RowBox[{"ResolveDerivatives", "[", 
           RowBox[{"setup", ",", 
            RowBox[{
             RowBox[{"FTerm", "[", 
              RowBox[{"FDOp", "[", 
               RowBox[{"derivativeListSIDX", "[", 
                RowBox[{"[", "pass", "]"}], "]"}], "]"}], "]"}], "**", 
             "result"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"pass", ",", "1", ",", 
           RowBox[{"Length", "[", "derivativeList", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"OptionValue", "[", "OutputLevel", "]"}], "===", 
          "SuperIndexForm"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Return", "[", " ", 
           RowBox[{"{", 
            RowBox[{"result", ",", "outputReplacements"}], "}"}], "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"result", "//.", "outputReplacements"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.95086807399784*^9, 3.950868101837797*^9}, {
   3.950868135961317*^9, 3.950868153423587*^9}, {3.950868228217888*^9, 
   3.950868269490148*^9}, {3.95086841046174*^9, 3.950868424387451*^9}, {
   3.950873786052535*^9, 3.950873787662897*^9}, {3.950874377585595*^9, 
   3.950874378821952*^9}, {3.950875285850876*^9, 3.950875301335219*^9}, {
   3.950875343786489*^9, 3.9508753492991743`*^9}, {3.9508754834989862`*^9, 
   3.950875487444517*^9}, {3.9508932689591846`*^9, 3.950893303250742*^9}, {
   3.950893467838776*^9, 3.950893530412135*^9}, {3.950951875092435*^9, 
   3.950951917051467*^9}, {3.950951969983094*^9, 3.950951982885131*^9}, {
   3.950953049415739*^9, 3.9509530566618147`*^9}, {3.9509576893692417`*^9, 
   3.950957693641984*^9}, {3.950957869930423*^9, 3.9509578703743134`*^9}, {
   3.951205890224668*^9, 3.951205922452134*^9}, {3.9512059655680513`*^9, 
   3.951205987956233*^9}, {3.9512060250926027`*^9, 3.951206037771141*^9}, {
   3.9512060757270203`*^9, 3.9512061056706333`*^9}, {3.951210129116617*^9, 
   3.951210160246964*^9}, {3.951210230711794*^9, 3.951210261583102*^9}, {
   3.951210487269314*^9, 3.9512104881636333`*^9}, 3.951210648908422*^9, {
   3.951210922739853*^9, 3.951210952732194*^9}, {3.9512110036490707`*^9, 
   3.9512110540158043`*^9}, {3.951211364096175*^9, 3.951211371087821*^9}, {
   3.9512114169092283`*^9, 3.951211492808696*^9}, {3.951211535712715*^9, 
   3.951211602095957*^9}, {3.951211800213296*^9, 3.951211815568632*^9}, {
   3.9512134241932383`*^9, 3.951213498323842*^9}, {3.9512273400034513`*^9, 
   3.9512273627572317`*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"fcb7ecd2-adb3-4b5a-a94f-8080924ea319"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing", "Title",
 CellChangeTimes->{{3.9508681098093233`*^9, 
  3.950868110913395*^9}},ExpressionUUID->"7a24c792-7a48-4e73-8b88-\
7b56966e439b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<FunKit`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.951280802995201*^9, 3.951280805886263*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"45787101-b7c2-46b3-828f-0dde391998ab"],

Cell[CellGroupData[{

Cell[BoxData["\<\"\\!\\(\\*\\nStyleBox[\\\"Loading\\\",\\nFontSize->10,\\\
nFontWeight->\\\"Plain\\\",\\nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\\
nStyleBox[\\\" \
\\\",\\nFontSize->10,\\nFontWeight->\\\"Plain\\\",\\nFontSlant->\\\"Italic\\\"\
]\\)\\!\\(\\*\\nStyleBox[\\\"modules\\\",\\nFontSize->10,\\nFontWeight->\\\"\
Plain\\\",\\nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"...\\\",\\\
nFontSize->10,\\nFontWeight->\\\"Plain\\\",\\nFontSlant->\\\"Italic\\\"]\\)\"\
\>"], "Print",
 CellChangeTimes->{3.9512808080301123`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"d971df05-ab22-4dad-b400-2235bb68c427"],

Cell[BoxData["\<\"\\!\\(\\*\\nStyleBox[\\\"...\\\",\\nFontSize->10,\\\
nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"TensorBases\\\",\\\
nFontSize->10,\\nFontWeight->\\\"Bold\\\",\\nFontSlant->\\\"Italic\\\"]\\)\\!\
\\(\\*\\nStyleBox[\\\" \
\\\",\\nFontSize->10,\\nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\
loaded\\\",\\nFontSize->10,\\nFontWeight->\\\"Plain\\\",\\nFontSlant->\\\"\
Italic\\\"]\\)\"\>"], "Print",
 CellChangeTimes->{3.951280809561195*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"0e1f556e-dfdb-403b-a863-9050fab992ec"],

Cell[BoxData["\<\"\\!\\(\\*\\nStyleBox[\\\"...\\\",\\nFontSize->10,\\\
nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"FEDeriK\\\",\\\
nFontSize->10,\\nFontWeight->\\\"Bold\\\",\\nFontSlant->\\\"Italic\\\"]\\)\\!\
\\(\\*\\nStyleBox[\\\" \
\\\",\\nFontSize->10,\\nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\
loaded\\\",\\nFontSize->10,\\nFontWeight->\\\"Plain\\\",\\nFontSlant->\\\"\
Italic\\\"]\\)\"\>"], "Print",
 CellChangeTimes->{3.951280809582314*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"1161a992-b3e3-411e-80d4-04c9871d412b"],

Cell[BoxData["\<\"\\!\\(\\*\\nStyleBox[\\\"...\\\",\\nFontSize->10,\\\
nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"DiANE\\\",\\nFontSize->\
10,\\nFontWeight->\\\"Bold\\\",\\nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\\
nStyleBox[\\\" \\\",\\nFontSize->10,\\nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\
\\nStyleBox[\\\"loaded\\\",\\nFontSize->10,\\nFontWeight->\\\"Plain\\\",\\\
nFontSlant->\\\"Italic\\\"]\\)\"\>"], "Print",
 CellChangeTimes->{3.9512808099412527`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"8fb9ad9f-322c-494c-aa64-a9339300c467"],

Cell[BoxData["\<\"Welcome to  \
\\!\\(\\*\\nStyleBox[\\\"\:2588\:2580\\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\
\\*\\nStyleBox[\\\" \
\\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\\\"\:2590\:2584\:2588\
\\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\\\" \
\\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\\\"\:2588\:259a\:258c\
\\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\\\" \
\\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\\\"\:2590\
\[FilledLeftTriangle]\\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\
\\\" \\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\\\"\:2588\\\",\\\
nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\\\" \
\\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\\\"\:2580\:2588\:2580\
\\\",\\nFontColor->GrayLevel[0]]\\)\\n\\!\\(\\*\\nStyleBox[\\\"Author\\\",\\\
nFontWeight->\\\"Bold\\\"]\\): Franz Richard \
Sattler\\n\\!\\(\\*\\nStyleBox[\\\"Version\\\",\\nFontWeight->\\\"Bold\\\"]\\)\
: 1.0\\n\\!\\(\\*\\nStyleBox[\\\"Year\\\",\\nFontWeight->\\\"Bold\\\"]\\): \
2025\\nFor more information, call \
\\!\\(\\*\\nStyleBox[\\\"FunKitInfo\\\",\\nFontColor->RGBColor[1, 0.5, \
0]]\\)[].\"\>"], "Print",
 CellChangeTimes->{3.9512808099422073`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"88fcb640-8fb8-40a0-a68d-8f42f4107f90"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fields", "=", " ", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<cField\>\"", "\[Rule]", " ", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"p", ",", 
          RowBox[{"{", 
           RowBox[{"v", ",", " ", "c"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Phi]", "[", "p", "]"}], ",", 
          RowBox[{"\[Phi]x", "[", "p", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Grassmann\>\"", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cb", "[", 
          RowBox[{"p", ",", 
           RowBox[{"{", "c", "}"}]}], "]"}], ",", 
         RowBox[{"c", "[", 
          RowBox[{"p", ",", 
           RowBox[{"{", "c", "}"}]}], "]"}]}], "}"}], "\[IndentingNewLine]", 
       "}"}]}]}], "\[IndentingNewLine]", "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"masterEquation", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"A", "[", "x", "]"}], 
        RowBox[{"VBasis", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", "A"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "x"}], ",", 
            RowBox[{"-", "y"}]}], "}"}]}], "]"}], 
        RowBox[{"A", "[", "y", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"cb", "[", "x", "]"}]}], 
         RowBox[{"VBasis", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"cb", ",", "c"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "x"}], ",", 
             RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], ",", 
        RowBox[{"c", "[", "y", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Setup", "=", 
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<MasterEquation\>\"", "->", "masterEquation"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<FieldSpace\>\"", "->", "fields"}]}], "\[IndentingNewLine]",
      "|>"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TakeDerivatives", "[", 
    RowBox[{"Setup", ",", "\[IndentingNewLine]", 
     RowBox[{"FEq", "[", "\[IndentingNewLine]", 
      RowBox[{"FTerm", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Propagator", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"AnyField", ",", "AnyField"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}]}], "]"}], 
        RowBox[{"Rdot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"AnyField", ",", "AnyField"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
       "]"}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"A", "[", 
       RowBox[{"p", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}]}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], "//", 
  RowBox[{
   RowBox[{"FPrint", "[", 
    RowBox[{"Setup", ",", "#"}], "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.9507856762700357`*^9, 3.9507858002547617`*^9}, {
  3.9509731139899683`*^9, 3.950973140087144*^9}, {3.9512274397433567`*^9, 
  3.951227441558628*^9}, {3.951227486267386*^9, 3.951227497450511*^9}, {
  3.951227632078931*^9, 3.951227677663128*^9}, {3.951228330842969*^9, 
  3.951228340299478*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"2632f66f-a425-44c8-b21c-333bdd8417c4"],

Cell[BoxData[
 GraphicsBox[
  {Thickness[0.007887679444707366], 
   FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1,
     3, 3}}}, {{{9.29219, 8.2875}, {9.29219, 8.526560000000002}, {
    9.065629999999997, 8.526560000000002}, {8.898439999999999, 
    8.526560000000002}, {2.3859399999999997`, 8.526560000000002}, {
    2.2187499999999996`, 8.526560000000002}, {1.99219, 8.526560000000002}, {
    1.99219, 8.2875}, {1.99219, 8.04844}, {2.2187499999999996`, 8.04844}, {
    2.3859399999999997`, 8.04844}, {8.898439999999999, 8.04844}, {
    9.065629999999997, 8.04844}, {9.29219, 8.04844}, {9.29219, 8.2875}}}], 
   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0,
     1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
    0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 
    1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIlIGYC4mgFx4/JMoYOMybwV5l1qzqcAQMDh/8gcF/L
ITP/Q+vJKaoYfBbOLvlkPS0IzacG53vsr5W1OK4O588EgZvqDhLz4jRPf9CE
85nB+hD8NgV21TNXJOD8vohuf0YBcbh5X/Z93Jo+TQxuH4wPcw8638QYBEQh
+tXVHKru/7hl7C3qMGeR8s4/7hpwvtzyFx56/xF8nxPstrOvasL5x3ft6GX7
oA3nP4gQ335xgQ7cfBgfZn98SJD6gpfacD7MPBi//rdVwbkTmg4an1ReztIU
h/OD317+OOOhBJw/AxQOlppw/o+3rw9YMmvBzYOFr8TUK5wZj7QQfFA4F+jC
+cVbRX+fjjOA80HOZVhn4OB3cWLMv8caDhpvefcZ3DSAxz96egAAjjnr7A==

    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
     0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1,
      3, 3}}, {{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {CompressedData["
1:eJxTTMoPSmViYGBwAGIQPSG4RGX6enOH67y3xVLNOB1g/DkzgUCSy+GOdE2i
0VQE/0CtrEV6CRqfBcGXmHqFM4PJ3OF57ePs82u4HDbq5S1m/GPm0CBey5rp
xuOg+qR53tkoMweQ8pkvFRwMtFYKXwgxczAGAWdFh4Nty8NPBZk5/AeBeEWQ
MxkYDBB8h6ZHx2dwI/hPEhdeM/lv6sAfG3DfyFzR4RBI/ydTh7VCOnzpfFDz
hIwdvuz7uDV9Gr/DbZB/tho59Ed0+zN+4HL48630wZxEI4czIODD5ZAce8eN
WcII7p/F9/fxzWE2clD/pPJyFieXw/QJ/FVmrw0dtnttsJjzkxPOP9i9r8nk
MQecD/bPZg6I+94bQtz7n93h84aA7FnsRnA+t5tqKZMUgp+eBgRqRg59IPcZ
cMDdC+OD48feGM4v2Sr6+3SeMVx/7W+rgnMVCL4JyB3NCD7Yvwsx+bD4h/Fh
/m1kOdpv2G4MDw9wONUg+MtfeOj9DzR24HHk85qhCVWvbgyPfxjf/4nnJVNh
HjhfA2w+LyQ8zI0d7Esca0/f4XU4fdhpbWYc1D3b+B3qQf55YewQoxohcy5G
2OELSL24GZwPTm9OZhB/fuaG80uWl2z4x8/tECG+/SKDnBncvZEg/j5TOB8c
P/MRfHB6bMHkw+IXxj8A5d8Q+uR4vs0UHp6fQO5bjuCD0/8eBB+c7jnNHGQ2
is1nUuCApGdpM3h8xig4fkyeg+AvAaW/YHM4H5Q80srM4eZB7EfwwemhD8GH
5Wd0Piy+AR2Fz5Q=
     "], {{22.060899999999997`, 5.10313}, {20.0766, 5.10313}, {
     21.726599999999998`, 7.72344}, {22.060899999999997`, 5.10313}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0,
      1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{0, 2, 
     0}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGBQAGIQvUUvbzHjHyuHB67xjrMEJRxg/PsgvqGEg/pb3n0G
P60cWhXYVc+USDg8SVx4zeQ+gj9lAn+V2WkEPyX2jhvzCSuHvohuf8YACYfl
Lzz0/h+0ckhPAwI2CQefixNj/k22cmAAAQcxhx6vVywmilYOZ8BA1EH9SfO8
s7cs4XyQtrQ2BP/UYae1mXaWDiKVk0rOpog5LL6/j2+OsKVD0NvLH2c4ijuo
gvVbQPiJEnD+l30ft6Z/k4Tz37TldhvNlnI4ATLvnBWc/x8E3iP4sPBA58vv
WrAvVU8azk8F+0/WYYv5j0Mpu6wc1gjp8KXfk4fI77GE871PsNvOfmoB588E
AU8Lh15weMnC+f0gfoEUnH8W5P0ccQj/J8w/Ig5/vpU+mHPREs4PF99+kWGd
FZwPc1/l/R+3jLvFHdDjGwBBP+jn
     "], {{26.5484, 6.831250000000001}, {24.867199999999997`, 
     6.831250000000001}, {24.9328, 7.632809999999998}, {25.4828, 7.77656}, {
     25.728099999999998`, 7.77656}, {26.499999999999996`, 7.77656}, {
     26.542199999999994`, 7.00469}, {26.5484, 6.831250000000001}}}], 
   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0,
     1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 
    3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
    0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJpIGYC4qdZ2t+m19o6mBiDgKgDjB/y9vLHGYpiDj1e
r1hMAhF88alXODMu2WDwq+7/uGWcjeB/2fdxa7qZOJx/W1N2zf/DinD+TBDQ
VILz1wrp8KX7KcHtg/Fh7kHn78mveTvzqJKDzwl229mtNg4zQObtVHJ4DpLv
tYbLw/gw/RxuqqVMuxB89be8+wwsbTD4MPfB+DD3w/gw/8H4MP/D+LDwgdkH
48Pcg86HhT/MP2DzvBHxAZMHAFCds8s=
    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 
    3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 
    1, 0}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJZIGYCYnnHj8lnSh0cTIxBQNQBxg95e/njDEUxB9bF
k6wYQxH8CPHtFxnYMPkPXOMdZxUi+G/acruNrMXh/G4bz11pRkpw/lohHb70
PiWH3zG5R/8xIfgJsXfcmG/Yw/lgdxXbOzhPaBZKO6XocFXok+P5a3Zwfm9w
icr0+Zh8sHeCFR0+bAjInnUcwY9RAHpQxx7O5/FfPyW1w97hw6L1CmdXIPgw
98P4MP/B+DD/qz5pnnf2lR2cX/vbquDcCkw+LHxtKiNWmP61c6i6/+OWsbeo
w/5aWYv0Ens4f4v5j0MppxD8/yDA7wDnVwC1n/VG8NHjDwAq07tn
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGDQBmIQrfqked7ZJCeHdgV21TMiUg4wvkjlpJKzT6Qcjmta
TTod7+RwBgRyZByCS1Sm/zdwclD/pPJy1klZB90JC34Yijk5yO9asC+1T85h
yje2+BlfHCH6U+Qdsjl/LkjfjODLO35MPlOL4BdvFf19OszRYXuwVcT/djmI
PTaODmuFdPjS5WQdvE+w2862dXR44BrvOCtQzuFx4sJrJvaODulpQKCm4LD8
hYfe/0hHB2GwexUcHJoeHZ9R7ehQfnib68yzig76IPetc3SYCQKaSg4b9fIW
M95B8MHmv0Xwwf4TgPpXRsnBGASUnRz4YwPuGx1XdFjTfTuDgd0JYt8WRQfx
qVc4M5icHPbm17ydmYrg39GUXfPfGMGHuc/82tFcE6D590H+Wajg8ATkH3UE
P1J8+0UGOwR/Mig8fZwcqu//uGV8G8F3ntAslGalCOeDzf+i6JBw+LJ2qqYT
JPz6lCDhf9sRzgfHTwqCD3bPBweHld9eVpz5oADnQ+JXBs73WHN0OcMPMUh8
uTk6mIDCZbOIQ0XECtOzqxF8cDieRPDB8f3XEaL/hojD/lpZi3QdJwcGEHAQ
c2BZPMmK0RWa3ljE4ekPbM5PBB+WPgHIcB5/
     "], CompressedData["
1:eJxTTMoPSmViYGAQBmIQrTthwQ9DMSeHdgV21TMiUg4wvvyuBftS8yQczoCA
iJPDWiEdvvR54g5vePcZzPzl6KDxSeXlrJViDrz+66ekvnB0eOAa7zjro6jD
cU2rSafPOzoogPT3iTr8jsk9+m8Vgv84ceE1E3tMPtieNZJw/pu23G6j2VJw
virYPhkH9SfN885mOTr8B4H5cg6fNwRkz1qP4O+81fU39TqCn54GBO+gfHk5
h/rfVgXnGJwg5kfLwv0Ltj9HBs6fPhMIIqUd0MMHAA89k40=
     "]}], 
   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0,
      1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
     0}}}, {CompressedData["
1:eJxTTMoPSmViYGAwBmIQ7XWC3Xb2UxeHGNUImXN7eB1g/LVCOnzp8wQcIsS3
X2Q4hsmHqYfxZTaKzWdS4HYo2Sr6+/Q2F4c5M4FAkssh8fBl7dSFCL5D06Pj
M6ox+RqfVF7O4uSF82Hmw/hg++tEUfnzJBxUnzTPOyvl4vBl38et6WZSDpEg
9+xzhvMTQPZnOqPKyzk73HeNd5xlKAnng+XFxOH8kLeXP85QFHPI4fy5IN3Y
2UFh14J9qX2iDgqOH5PP+CL4ElOvcGZkocnXOjs8AJsvBueD5fnEUeUvijuk
pwFBnrNDNMi/MRIODCAQ4ewgUjmp5GyLBFz9Q5D6QEmHMyCwBcHfqJe3mHEP
gs+6eJIV41cEX2/Cgh+Gei4OxiAgLAHng/1bJgrng6JjZqWIw++Y3KP/Pjk7
BIH8nyjisMBG58qsdc4OO4OtIv67izjsvNX1NzXdGRI/McIO3qD0wusM8Yea
kEP78vBTRn+cIO70EYDzwf5q4IPzm8RrWTPZOB1MQO5KdnawK3GsPR3DDnHH
SgQf7L8vCP6KFx56/xVdHLZ7bbCY85PTgcd//ZRUCxeHFpB5bTwOQp8cz6fZ
ItIXJDxdHPoiuv0ZN7BD3NWC4K/pvp3B0I/gw9I/mP8BwYelRwDiu0tY
     "], {{40.3609, 4.1234399999999996`}, {40.3609, 3.3499999999999996`}, {
     39.70779999999999, 3.14375}, {39.38909999999999, 3.14375}, {
     38.974999999999994`, 3.14375}, {38.623400000000004`, 3.42188}, {
     38.623400000000004`, 3.8046899999999995`}, {38.623400000000004`, 
     4.32969}, {39.1172, 4.871880000000001}, {40.3609, 4.912500000000001}, {
     40.3609, 4.1234399999999996`}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1,
      3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 
     3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGAQA2IQDQYa7g7Bby9/nPFQyAHGTwOBZ2IOa7pvZzDsd3M4
AwI8Ug5vePcZzHRC8Je98ND7/9EVzre4djTX5ICrg/yuBftS10k4lGwV/X16
navDm7bcbiNpBH+tkA5fOp8ihC/m6vDANd5x1kMFOL/6/o9bxtEKDm3Lw08Z
xSD4B2plLdJToPrtEHyw/W/k4Pz/YMDusFEvbzFjC4LvplrKNGuFq4OJMRB8
5nbo8XrFYnLQ1UH9k8rLWSc5HUJKVKb//+DqYFfiWHs6hh0SDmZucP4JTatJ
p7cj+LDwsgXx5/A6oIcnAKIslqg=
     "], CompressedData["
1:eJxTTMoPSmViYGCQAmIQLfLJ8XzaWTcH9U8qL2e9FHKA8eV3LdiXqofgf933
cWv6NX4HN9VSplkr3By+gPk8DhURK0zPNrs5bPfaYDHnJ6fDRr28xYwhbg5p
IKDG6SAx9QpnhhGCn3j4snYqI4LvCjLvhqtDjGqEzLk9XA6R4tsvMuxzddgK
Ms+S1+Fifjz7uY2uDr0R3f6MBXxwPgMINCD413lvi6Vu44fzH7jGO84SFIPz
z4DAGgQ/CmyfmEOP1ysWk4OuDn0g8wPEHUq2iv4+fc/VIRokXyPhsMBG58os
PjeHHcFWEf/VJR2mfGOLn2GD4M8EgUIEPwHkv5luDlX3f9wy1pZwUHD8mHxm
LTS8zMQd1nTfzmDY7+bwpi232yhaDB6+YP/biDqgxwcA9GGvkA==
     "]}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
     3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJzIGYCYvGpVzgzdnk5+Jxgt529VcUBnR9SojL9/w4v
hzQQeKbiYGIMBKsx+alQPo//+impCxDyIp8cz6fN9XLYoPqked5ZqPmzvBzM
bPYGTTuo4nAGBFK8HO67xjvOUlR2WNN9O4PB3MvhAYjfqOjwHwTkofyNCg4J
hy9rpzJ6OcSoRsics5GHqD/v6bA92CriP7u0Q3nECtOzpz0dGEAgQdah/rdV
wbkTnhD3tSk4zLfRuTKrz9Oh/PA215lrlSDm53s6hHOKtRvfV3bYqJe3mNHG
0+Hn29cHLJVVHfbXylqkn/GA88H+E0DwL+bHs59b6e4ACgbjZEU4/7am7Jr/
hxXgfLA/exQcpnxji5+xBcHv8XrFYrITwQf75zgm/8Oi9QpnZyg4LAC5/xyU
/wLKf+fucAdkX7KSg6tqKdOsAA+I/ycoOyx74aH3fyeCD/M/jH9DuibRaK2n
w5d9H7emb5OH89+05XYb/ZaC82eCwE9xh/e8+wxmLvJ08FhzdDnDDzFIfMz0
dDjYva/JhFkMEl41ng5nQe7nEYb439MTEs72XHB+wBPPS6aT2eF8sH/PsEHS
jZ8nJF19ZnV4A7IvCsEHu6MQwd95q+tvaj3UfZKcDubXjuaaTPB0eFH7OPv8
Gx4HlsWTrBi3ejpU3/9xy3i1kEO4+PaLDPs8HUQqJ5WcPSLiIO/4MfnMUU8H
hV0L9qWuE4Okz1OeDm0K7KpnrohD/KfoBQ8fWPpVufYomGGOMsT8pV6Q9PRX
GZ5/wOljMWZ+AgCLvYDY
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{
     0, 2, 0}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGBQAGIQ/R8Elvs4nNi1o5ctQM0BxmcAgQQ1B5bFk6wYl/o4
1P62KjjXoeZwVNNq0unpCP6Ub2zxM3oQfPGpVzgzunwcXhVvFf2drebA479+
SmqHj4Noj9crlhA1h4qIFaZnk30c5ixS3vnnuIrDBr28xYw8PhB6j4rDjJlA
8NMbzi8HqT+N4IPdM9fb4e+30gdzBFUd0tOAoA4or/qked5ZVYfjIPfFe8Pd
A+OD5XvV4fzZIPvZNRxyOH8uSO/2gfOXvvDQ+78QwYeFBzo/DQwQfJl5cZqn
L2g6RIhvv8hQ5uNgbrM3aFqjNsR9z7zhfLD96Qg+2D+s3g4vsrS/Tb+rCef/
evv6gOVjdTjf6wS77eyrqg4mxkBQDFVvq+Jg3/To+IzPCD5YfakPnA9zX+At
6ZrET6oO6PENACKx65Q=
     "], {{56.771899999999995`, 12.2234}, {54.7563, 12.2234}, {54.8281, 
     13.3391}, {55.504699999999985`, 13.529699999999998`}, {
     55.800000000000004`, 13.529699999999998`}, {56.731300000000005`, 
     13.529699999999998`}, {56.76249999999999, 12.4063}, {56.771899999999995`,
      12.2234}}}], 
   FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1,
      3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
     0}, {0, 1, 0}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}, {1, 3, 3}, {0, 1, 0}}}, {CompressedData["
1:eJxTTMoPSmViYGCQAmIQ/R8Elvs5pKeBAJMDjM8AAg0sDqpPmuedTULw3/Lu
M5gZ5edgYgwEnxF8/yeel0yFOeD83ohuf8YAeQj/kK/Dl30ft6Z/k4Pz1T+p
vJz1UhZiH7sfnG9+7WiuiQBU/wYEH6xOXgbO3xFsFfE/XdRhb62sRfobX4cY
1QiZc3PEHKZ8Y4ufsccX4l4HcYcvGwKyZ7Uj+BD7EPySraK/T0/zcdAA2a8p
AuefPQMEPAJw/pJbyx8bOnM4gITP/IHyDzM6iHxyPJ9W6wvnJxy+rJ26E8HP
4fy5IP21L0RfD7MDy+JJVoy8fg4t4rWsmcdY4XyYevT4AAAdWrpE
     "], CompressedData["
1:eJxTTMoPSmViYGAQB2IQzbJ4khUjr5/DGRDw4XKA8dNAQI0Tlf+Mw0He8WPy
mb++DjIbxeYzLWB36PF6xWLy0Nch4InnJVNhVgfxqVc4Mzb5QszrYXaQAPGb
EHz7pkfHZwQj+CpPmued1ULov7uPb46xkK9DX0S3P2MBu0PJVtHfp7/5OLyo
fZx9/g2nw4yZQPDRx0Hjk8rLWZy8cL5w5aSSsywCcP5aIR2+9HuCDqog83/5
QOzTEYabD9bvKQK332PN0eUMFaIOLqqlTLMifB3etOV2G0WLOUz5xhY/owfB
9znBbjt7L4KfCgqXd74ObiD9M0Th4dULcv8HYQf08AUAX+WeQQ==
     "]}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1,
     3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 
    3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
    1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 
    3}, {1, 3, 3}}}, CompressedData["
1:eJx11H0slVEYAPAr1q0/aIuLS3jvuHJdRT5LaY9K3CLvKeO2yCIfkbRVIlcM
sbpapS8fZcoaTT7GZKl8zKzymam7pjUSQ9iipkzUPe9773u2rLOdP3475z3P
Oc95ziuKSDwYpcvj8XTUPVjdV6m7LDXL0f8hgphodVNRoLULboYimNZvdios
Ii7L99QJKCAOtDSOC1ASd+OmQLAujB5y5ougUvkxlpdI3JCteFvvQ+wrPreq
aJTmvmfGPxEz4+9W+mWiYqbwEcXZ90lHOS+WgrULpTH1gzQod8iaoiNW2sp7
NrJ7hnio2eCeiz1a4cfzk8ndTsTJQ78GXSqtOJ/XODShY7nOHIECu8sMlPu+
6rnqI5jKSVA6HxGC+dSIu9k3Gqim0uaoamMIw/PrabhE8cXdtwRsfnOImfX2
E3uoOhJcPwRC1XoHg5iLJpxblc2Zru1WnFNx/FQR6OELWgqEhZmp1m3WYvDB
+fGjwUFk9eOkaiN7P8k0jB17oHK9JoEvRhZvxlpo6HsfPO343J7Nsy7inFb9
NCI9jLgQtzQEZiVHJV20HefO9l1VJyxtOdduPlWm80IMWUh2P+MCAv/XfK9i
N2IebsM2nDMWPU/3Vtiw+c0klnrmd6VnE0801uiO5xEz8a4iGMXnqbGB2s+T
t+uuI5iIk87ftRCz81u18aWcJ840CBbjpSA3aeznNf3fIRqPa2w4590X3UDG
mfqvUY/j+I5S7jxMHl0ksAbXXxKCA/03QpcjJfBs8MpSVIy6XuZq6XhPTT5l
CPxa0iy2vrKHGrx/O7J+irzCrYdPzLy/3zRnZr6cOA/X3+FA2ITv292WM7Od
mxTnNlw/u4Xs+ro0DPuEexdtMWL3n0TM7K+KmFnnOw178XuTC9h8CLX1bgoU
fl8iBHZzNpNFl43Z+nbW3DcI4A9uHsTJOP524p+rwwv8vRAYpeSf7Tm+0u0D
0ijhTgShYvmGXoUAcstDOp33aOJJTNj1fREY4vl6pmy+ghDk4vdkZA7i0ayS
nggEQTMDswVtlux54xAUM/dAsd/HI7BWjRzihVJsPdwh/4fEcH6vsJBY+7/8
19r/6V+rfzzx
    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
     0}}}, {CompressedData["
1:eJxTTMoPSmViYGAwBmIQ/XlDQPas+0EOXifYbWdfVXWA8X1A/K1qDhURK0zP
nsfkw9TD+CycXfLJeqoO7cvDTxmdCHI4AwJvVBxq121Lqt+L4L/h3WcwcxUm
v+G3VcG5FapwPsx8GL+F13/9FFVNOB/iHi2H+/v45hhXBTmY2+wNmtaoDXGP
N4IPtl8RTf53oIP88hceev+14Pw/30ofzPmoCec3sBztNyzXdGgO9JzbwBbk
sF71SfM8XU2H2Nyj/zYJI/gR4tsvMigh+DEgee0gBzmQ+fUIPlj+LYL/JHHh
NRN/LYf/IKAc5JCR/6H15BQtSLhIBDnUg8NDC1U9v7aDMQi4I/jqQGPPeiH4
/nJiWb7pCP5jEdmTT5uDHI7v2tHLVqAF55uCwkNRE87/+fb1AcvFGg7e1c36
PmlBDo0g/0/XcJB+/chMyiXIYYv5j0MpXRoO2laTTtcrBDlkgtwrogFJL58D
HWbMBIJKdYcJC34YPnsVCPFHjxqcn5oGBGwI/pxFyjv/LFdxSAeJywU5vMjS
/jbdVsUBZMxMRwQfFGxn0xB8ecePyWdqgxwMtFYKX3ii4hBcojL9f0cQxLx2
VYfrR3NNGroR6QtMzwhyCLglXZMYpAIJv/UI/uJJVoy+WxB8WPqXmHqFMyMJ
wYelRwDk23f2
     "], {{74.06089999999999, 11.3234}, {74.06089999999999, 
     10.549999999999999`}, {73.4078, 10.343800000000002`}, {73.08909999999999,
      10.343800000000002`}, {72.675, 10.343800000000002`}, {72.32339999999999,
      10.6219}, {72.32339999999999, 11.0047}, {72.32339999999999, 11.5297}, {
     72.8172, 12.0719}, {74.06089999999999, 12.112499999999997`}, {
     74.06089999999999, 11.3234}}}], 
   FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1,
      3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
     0}, {0, 1, 0}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}, {1, 3, 3}, {0, 1, 0}}}, {CompressedData["
1:eJxTTMoPSmViYGCQAmIQfQYEGEIc0sBAxQHGB9NvVBwe7OObY3wvGM4/clk7
VfJWsENCSJD6Ak5VOP/vt9IHcy4i+Bn5H1pPluhD+H3BDnMWKe/8447gm9rs
DZp2UA9i7gYE/8X29czPtwQ76GqtFL6wBMGf0t4adfmOLpz/IEJ8+8UGLYc1
3bczGBYHO5y/GvZGX1rbQcIj4I9EN9S9OdoO7qqlTLMKEHwwbYDgty8PP2X0
I8jBHGT/Q00438gYCC6rw/kvsrS/Tb+r6gASNtYOhvBtVRyuH801achG8GvX
bUuq70TwmwM95zYsCnY4sWtHL9sGFYcAObEs383BDqcOO63NtFOF82Hq0eMD
ANr5xkg=
     "], CompressedData["
1:eJxTTMoPSmViYGAQB2IQHSAnluW7OdiBAQQS1BxgfF1F+S85Ygh+ahoQsKk5
xOQe/bdpdbBDZv6H1pNbVB1EPjmeT5sb7PD3W+mDOYKqDhHi2y8ytAU7nNi1
o5dtg4pDJIifh+C/4d1nMDMMwX+wj2+OsRNCv43OlVnPTIMdGn5bFZxboerQ
vjz8lJFGsMOcRco7/7irOcwEAdVgh6eJC6+Z8Kuj8s8j+Bv08hYz7tFwuA8y
XyvY4dfb1wcskzXh5v8B2fdRE25/Pci+Di2Hgnj2c5KRwQ41nzYEZP/ScpDw
CPgjUYzgfwZSs7oRfHC4LQl22O7Q9Oj4DC14eOlrrRS+cETTAT18AdhPnKw=

     "]}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1,
     3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 
    3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
    1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 
    3}, {1, 3, 3}}}, CompressedData["
1:eJx11HtIU1EYAPBrr0FQgu2l+bjDXXPOWjqTFIXPwtKwWnXPzcqyLNfDrCAj
w1n2Jv2jN+oqMSJStBo9yWol9iJ1JuWC+kMLy5kKNUwMe+3cu50DSQfuHz/O
4zvnO9+5mpztS3PHMgzj5/kEzzfG8ynTTD/ViwXYaPY0Jws+G3GbooF770p/
5c6n3pEtcwSmUgf3fYwPmk1diZtOAP/Vps5YmQYKM2tmtU6lPrAk/UKJGxHL
3Slt5pOIzBf7S6nF/v2j/XC7ZaDyMks8v/7pFWYTC86n+XElRxGUJaU3mHNG
u3+SfWallbq+7P0m5u1o1w71FrbMpC7sHH5nrAsj3u21LvFU874XCCzYzUGQ
qbrbzjQg6DuSXxa7KhBcd6+P7TmPgG2otudeU0IUHr8WwWFWxrWcUUj5NVKL
6w3zxOL8Ch6uBkRP3rhXRfy4zH4grimMuAjHL9KAKVS5ZWEdDz8G+h4nhHMQ
gPPznYdoTdjgVuc06X44BJ/WXXTGHdeB7UPv2RtbEbR1CP2G+1HA4GajXlB0
0JAxUSDGZWKOEiCoao2u2RRJ/LJpztXNoRHEthnbLvk94KT9TBMg44Us+dws
ajFOl5a4ZCRxh6NGK+XXQD08IbsiI4b69iHLq5sJ1GK8RAG68Xmua6H42p2c
fckCuLboh8pDOGl8vi++nti187ZiJE8PXPfBqlbz/631usfrLvvk88Yc2i/W
f5anH8c36Ml5xHo16qAD11+4AIvaT2b9Xq+DI1eWv4yVC2Bx20x5id58DiFI
e1QcMvt5FFjw/jsQWX8et2uM9Ra1+P5qqcXx46nF+17Bw3R83/ERxOJ2TrPE
jbh+5gZK69t46ErNTrHGyKX9hyNicX8rqcV7q0YwD7+3TIWUj2e+elfDAH5f
DgSRbm2v9ZhSqu9OJM0DBbTg1k2diuO7qJ+81ucGfkEg33OqoHXDaJ+oHo75
7HEWlxnssCiAL9CW//nqjadTSesPIpiCx49TS/nyE+Aofk/yqYDTbvUXgB94
/a2iMVQ6r0qAc/hdpLPSfLUA4c6Py5gsVqqHOQL5PyRFv7F+TqX2/S//te9/
+he9fTGC
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 
    3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGINIGYC4jMgkBDucGLXjl62ADUHGP9RhPj2iw1qDg/2
8c0xjkLwNzx8OXVTBIJfEM9+TjIUwW8K9JzbEBTuMKW9NepyjZpDSInK9P8B
4Q6iPV6vWELUHEQ+OZ5P8w13OHXYaW3mP1UHE2MgsA932KCXt5hxj4pD2/Lw
U0Y8CL6rainTrDdhcD5Y/f4wBwYQaFCF8y9cDXujf1sdzk9PAwI1LYcX29cz
P38S5vDj7esDlszaEP9whcP5nD8XpG/mQ/AVHD8mn9FE8D9tCMieZR3uMGMm
EOzUcvjBFj/DRzfcISP/Q+vJKVoOAXJiWb7a4Q4NLEf7Dc0RfLD9bAh+cuwd
N+YZmpDwMAl3SAXJu2lC5J0RfC2rSafrAxB8sH+iwx2Og+JnAoK/xfzHoRQu
LTjffX+trAW7toMmSL9FuIO5zd6gaY3akPDjQPDB/jsYhsqfGAaJrz2acH4j
yD/X1eH8v99KH8y5qOowYcEPw2fHwhxeZGl/m26r4iDhEfBHgj0czl/TfTuD
wR/Bh6Un2eUvPPTkEekLlt4AVPQIbg==
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
     0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}}, {{
     1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGAQA2IQPRMEeiMcGlmO9hteV3eA8WeA6JuaDvnx7OckIyMc
zoBAjrbDhAU/DJ9JIfhvePcZzPwUDudvbam5sPlmuMPzLO1v0/dqOYSUqEz/
fyHcQaTH6xVLCYKfkf+h9WSJPoTfEu4wZ5Hyzj/uCL6pzd6gaQf1HGJzj/7b
tBzBr4hYYXp2dbiDrtZK4QtLEPwp7a1Rl+/owvlpYKDi8GlDQPas3Qi+jc6V
Wc/Ohjv8evv6gGWyqsODfXxzjG+FO+xwaHp0/IaKw5HL2qmSQP+8ALnfVgXi
L5EIOL9m3bak+lAEHxZeG1SfNM87q+qAHp4AA56r4Q==
     "], CompressedData["
1:eJxTTMoPSmViYGCQAmIQvWiSFaNvQoTDhathb/RvqzvA+C+ytL9Nr0XwN+nl
LWaMUXOw0bky65kvlD9H1eHa0VyTBusIBwOtlcIXnqg4fNoQkD1LOcLhxK4d
vWwbVBxUnzTPOyuE4HtVN+v7/AqH88HmPQ138DnBbjtbVNXBVbWUadaNcIfM
/A+tJ7eoOjQFes5tuBTuIDH1CmcGkxqcn5oGBGwIvmiP1yuWEAT/ceLCayb5
mnD+lPbWqMt7EHx9kHuPaDo82Mc3x/hWuAMLZ5d8Mp+WQ0iJyvT/L6DyS7Qc
Xmxfz/ycIcKhBuSxX1oOj0VkTz4VR/BBzkgzQvDB/nOLcNgCCp8aLQctq0mn
6wMiHMxt9gZNY9RyyI9nPycZGQFx7xRNePiCw48FwYfFBwDKJK4R
     "]}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}}}, {CompressedData["
1:eJxTTMoPSmViYGBQBWIQ/eXvlYqXaVEOKbF33JhnqDrA+LW/rQrOcWg6mHc6
JjzViHI4vmtHL9sGbYfjZfvmSx2PhPOvVrxUM4xA8Oe+X37M2zzSIQ0ElmnA
+WY2e4OmMSL4W8x/HEo5pe4wxbk757l1pIPvxYkx/5zVHR5WiaxzD0Tws/aU
TJbIQfCLMya+rSmPdJi9SHnnH3YNOP8YyP4CBH+96pPmebqaDtrtYjfPxSP4
N859D34ciuCDvKNfGungf0u6JvGTlsMckPvWRzpMaW+Nuiyj7VAO9B7HEQQf
LM8eBeerG3KskTGKcpCeF6d5ukATzv/19vUBy8NqcP4GvbzFjDaqDndU2Bqn
Kkc5CMQG3DcqV3YwMQYC6SgH4cpJJWenKDnY3PfvnS4W5VB9/8ct49fKDhtA
AfY70qGF13/9lFZVhycXlG7/3Ibgg7QbeyP4+fHs5yTvRjg4T2gWSpNSgvPf
tOV2G82WgfMfuMY7ztoo6dDt9YrF5C+UbygCCY/USDh/xkwgkIyC82HpA8wP
VHJATz8AuwEDjA==
     "], {{104.233, 8.932809999999998}, {104.233, 8.04844}, {103.456, 
     5.371880000000001}, {101.617, 5.371880000000001}, {100.49399999999999`, 
     5.371880000000001}, {100.30299999999998`, 6.2562500000000005`}, {
     100.30299999999998`, 6.757809999999998}, {100.30299999999998`, 
     7.282809999999998}, {100.63799999999999`, 8.514059999999999}, {
     100.81599999999999`, 8.956249999999999}, {100.972, 9.31406}, {
     101.65299999999999`, 10.521900000000002`}, {102.89499999999998`, 
     10.521900000000002`}, {103.983, 10.521900000000002`}, {104.233, 
     9.57813}, {104.233, 8.932809999999998}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0,
     1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 
    1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIzIGYCYnVDjjUyv6Ic5Hct2JfaJ+QA4+8Mtor4/1zI
Qf+uClvj1ygH9zVHlzP8EHI4r3T7Z90nBH99UcbEt28QfBWgdBaMf0PIwWXb
579XXkQ5RKtGyJyLEXKwue/fO/1elMOXfR+3pl8TcGh5HbhD7miUQ2oaEKjx
OuwpmSzBsgzBF7957nvwbAS/fN98Kf2pUQ7qn1RezuLkg/MfuMY7zhIUgPPP
gMAaAQf5VqAF06Ic0kH62QQdrlS8VDOcAVVfKAjx316o/9dJOTRMde7OeY/g
8zBpt4v9RPDXyESlWP/H5IPd4ykN579py+022i3tUJ8F9NEPBB8kff89gr8d
GDwVBxH8KUDrn1+Oclj57WXFGQUFhxtA7z++GuWwVkiHLz0OwQf7pww3X/na
o2CGMwoOz3+v/HjpbJSDcOWkkrNfFODhDeNvmPt++bHNCD44fDZEOfDHBtw3
aldw2HKibN/8VVD758k7tDsmPL0wC+HegB1yra8zEXyw/gQ0/0Vi8v+DgDyC
DwtPmH4YH5x+MhB8WHzC+E+Wzj6iUAFNr+zCEP+VQtObjZBDz/Q8oeYCmH2C
cD4sfcD4LeK1rJltvBD3dEY52Jc41p6O4XYQWef+sGoJgh+/y5OH6TaCD8sv
YPN0EPkHlp8A37SR5w==
    "]], FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 
     0}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}}}, {{{116.36999999999999`, 11.8719}, {116.36999999999999`, 
     11.262499999999998`}, {116.06099999999998`, 9.50625}, {
     113.65799999999997`, 9.50625}, {112.30799999999998`, 9.50625}, {
     113.09699999999998`, 12.6484}, {113.20499999999998`, 
     13.090600000000002`}, {113.25200000000001`, 13.1141}, {113.719, 
     13.1141}, {114.57799999999997`, 13.1141}, {115.60599999999998`, 
     13.1141}, {116.36999999999999`, 12.803099999999999`}, {
     116.36999999999999`, 11.8719}}, CompressedData["
1:eJx11HtIU1EYAPClkUmWom5utrlNnTL1H5slWtYnZUss5gub7l4bos7yRQ/C
JKLS1FhGEWY+KBVDivlAXOiQ9SDNRCVEgtJIiVDREk1C07B77t29BzY6MMZv
Z+fxfd85R55VnJzjxOPxTlMf9P204a2sK4uEOrqJgLXU0mTN+SmC1b8TJfOZ
JESoqOblC5vPlsdPZWDn9V96IEzF7hm6bH2STELwSuB8/XsRuDmFVgqSSOhN
idZuGUQgubWQ1HuYhNdG680IZwFcrzlqLJCSkItaEB+O7M+0xLth0+PXCc6d
F/Lu/1gkYAQ1E3aFzEUxMuHDmQ5nXQjt6plS798Es78UCRMP5WqtUbPtngRa
Ubx/CChH41OlnHPQehXY9P5nsY2H4i253XLwKHs13DxKwBZqxf5wp7bIs6yL
gEdo/T5/aFxqG0xwJ6HdM2yPITMAzL+oDaST0NgS0LepVnAOk0tXC9KCOavo
poRyKl1+EhLmLpr5GwshUBWr//6hm+A8FbjjRs03HWc6fxPYJyNvx+pHHZ1N
Th13LsG+utKVmB8dAm0ovnHs6VLvDvUM9juqvL7uhIP1qcnBTa7YBpS/QSUM
2JntTxhyiWmoUTLnx82WryglU79WHWQotOKxfiGg7u2PdXAX1cvDBwIn16+d
a9TBqnXZbHgoAFTeDgN2J/ohDVvvoY3qSXQ0e35Y0+dDxQdUrsh0bBeTOCNb
Z9d/FpvOzxUdlH5d+6xK4ENYpeDTWCX2MWPB7MaMXf8SNjX7wa9beD76PO0m
OL8cbo574YVN50vs6MWKQuO+vQLObLxaanoNH7vQk1rAFZueZ1Ln4BOmgTbe
GvZ03JnY+vM+/zV7/+aCwneapmzzHRAy8VH1XmrplI1W+TPx5GPHoPPag62g
hovf2O6vSM6Zvl8aGWf2Pn7RVNcWWQgoQfnc5cfcF7PtfRgRM/sx2c5XnS/z
/+cE916xpusRKuJMvzeDfOa9+kgw8YZ7M/V0JTnT8amx2feTXn5RCPbv6z8a
31wU
     "]}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
     3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGINIGYC4vKXaoYcIXEOJ3bt6GULUHOA8R9FiG+/2KDm
4GPe6Zjgi+BPce7Oee6N4G+Xa30d6IHgs4Tx6W5yjXOY0t4adbkGqD9JIMLS
Jc5BtMfrFUuImkNt1p6SyQ5xDqcOO63N/KfqcNe/d3qeUZzDBr28xYx7VBwa
pgIt+B8L5+u0i908dx/BB6vfFOvAAAINqnD+hathb/Rvq8P56WlAoKbl8GTp
7CMKN2Idfrx9fcCSWRvin78IfsAOoAcY4+D8Ba7bPv+VQfD5Iyy3nNCLc5gx
Ewh2ajn0TM8TalaIc8jI/9B6coqWgwcPk3a7XJxDA8vRfkNzBB9sPxuCnxx7
x415hqbDlQpgAGvEOaSC5N00IfJmCP7+Uwtdtzkj+GDaL87hOCh+JiD4W8x/
HErh0oLz3ffXylqwa0P0a8c5mNvsDZrWqO2wYe775cd+x8L5YP9tQeO3xELi
a48mnN8I8s91dTj/77fSB3MuqjqoGnKskdkV6/AiS/vbdFsVhz8rP17y/YXg
i4MSgFMcnA9LT7LLX3joySPSFyy9AQCTSw6i
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{
     0, 2, 0}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGBQAGIQ7bLt898rDvEOJ3bt6GULUHOA8RlAIEHNYc775ce8
7eMdan9bFZzrUHNIEIiw3GKB4Pv3Ts8TMkbwXbpznv82jHd4VbxV9He2moOE
/l0VNiBftMfrFUuImoNs6+vAHXLxDnMWKe/8c1zFocMx4emFT3EOG/TyFjPu
UXGYMRMIXiL4S2cfUdhwCcEXvXnue/DuOIe/30ofzBFUdSh/qWbIsQYor/qk
ed5ZVYcXIO6cOLh7YHywfK86nD8bZD+7hsN5pds/64zi4fynv1d+vGSL4MPC
A52fBgYIvsy8OM3TFzQddNrFbp5Tj3cwt9kbNK1R2+E/CNyPg/PB4bcAwQeH
b36cw4ss7W/T72rC+b/evj5g+Vgdzvc6wW47+6qqQyrI2mVQ9bYqDjb3gTHw
DMEHqwfaD+PD3Bd4S7om8ZOqA3p8AwCUz/Dd
     "], {{124.47199999999998`, 12.2234}, {122.45599999999997`, 12.2234}, {
     122.52799999999998`, 13.3391}, {123.20499999999998`, 
     13.529699999999998`}, {123.49999999999999`, 13.529699999999998`}, {
     124.43099999999998`, 13.529699999999998`}, {124.46299999999997`, 
     12.4063}, {124.47199999999998`, 12.2234}}}]},
  AspectRatio->Automatic,
  BaselinePosition->Scaled[0.3169380676693431],
  ImageSize->{126.77974595267746`, 16.723028642590286`},
  PlotRange->{{0., 126.78}, {0., 16.72}}]], "Output",
 CellChangeTimes->{{3.951227480607923*^9, 3.951227498508594*^9}, 
   3.951227590723441*^9, {3.951227661082717*^9, 3.9512276785464973`*^9}, 
   3.951228233968712*^9, {3.951228327360218*^9, 3.951228340718918*^9}, 
   3.9512283821936007`*^9, 3.9512284290396833`*^9, 3.951228862779323*^9, 
   3.951229355860683*^9, 3.951231936508786*^9, 3.951233653649911*^9, 
   3.95128087556818*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"f12dfa59-86fa-4ecf-82c5-db0abc9b8293"]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->"FEDeriK.m",
WindowSize->{1200, 750},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.9 Inherited,
FrontEndVersion->"14.1 for Linux x86 (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"dfc92765-bf29-47cf-bd50-cf1f31dcd525"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 530, 10, 28, "Input",ExpressionUUID->"33cd48af-4550-42b3-9c95-127f2f1ee635"],
Cell[CellGroupData[{
Cell[1109, 34, 259, 4, 59, "Section",ExpressionUUID->"d65e8f2b-6500-4348-8918-912b67b13cd9"],
Cell[1371, 40, 1164, 30, 181, "Input",ExpressionUUID->"0a00f2e0-9e12-4855-8a8a-da6773cee6a6",
 InitializationCell->True],
Cell[2538, 72, 827, 21, 101, "Input",ExpressionUUID->"f9a54712-bc7e-4f67-94ba-c436d6c2a287",
 InitializationCell->True],
Cell[3368, 95, 1862, 48, 144, "Input",ExpressionUUID->"66c68510-764b-433f-bf11-01c5d6a5e9c2",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[5267, 148, 230, 4, 59, "Section",ExpressionUUID->"e03db448-7a6c-4e73-9ddc-3b1976a84a81"],
Cell[CellGroupData[{
Cell[5522, 156, 190, 3, 47, "Subsection",ExpressionUUID->"35360acd-1ab3-48dc-b387-960ef784c1b9"],
Cell[5715, 161, 4731, 130, 560, "Input",ExpressionUUID->"9610d6bd-1c3a-4143-88dc-cb4244676cae",
 InitializationCell->True],
Cell[10449, 293, 10231, 260, 806, "Input",ExpressionUUID->"d8c7ad92-008a-409f-951b-580a3ca827cd",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[20717, 558, 218, 4, 47, "Subsection",ExpressionUUID->"23b7e69d-dcbb-4fb0-a77e-b8638a031ad4"],
Cell[CellGroupData[{
Cell[20960, 566, 217, 4, 39, "Subsubsection",ExpressionUUID->"d438b387-4f31-41ce-a117-795b628d69b9"],
Cell[21180, 572, 1698, 50, 183, "Input",ExpressionUUID->"63fbe29b-4af8-405d-80e3-5cbc9aa8d1d5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[22915, 627, 212, 4, 32, "Subsubsection",ExpressionUUID->"f52392a8-ad40-44db-871d-0651868db7ca"],
Cell[23130, 633, 7271, 167, 779, "Input",ExpressionUUID->"d2be4365-2a9f-4170-90b1-81e044dec426",
 InitializationCell->True],
Cell[30404, 802, 5708, 132, 672, "Input",ExpressionUUID->"ffdc8015-4beb-4a8a-9712-899076a5bcad",
 InitializationCell->True],
Cell[36115, 936, 149, 3, 26, "Input",ExpressionUUID->"e6fda6fb-9bcb-45a5-b801-7e006569f014"]
}, Closed]],
Cell[CellGroupData[{
Cell[36301, 944, 210, 4, 32, "Subsubsection",ExpressionUUID->"432ab124-4161-47f8-a56b-8db469a3db21"],
Cell[36514, 950, 4130, 102, 635, "Input",ExpressionUUID->"11470f5d-e2db-4aaa-9b7e-0a8c11da0687",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[40681, 1057, 270, 4, 32, "Subsubsection",ExpressionUUID->"73595dfd-e53e-4d4e-a700-40ff68a78e58"],
Cell[40954, 1063, 4286, 99, 389, "Input",ExpressionUUID->"8025941a-3caa-4a8b-a6f7-d19c65a09782",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[45277, 1167, 217, 4, 32, "Subsubsection",ExpressionUUID->"4586692a-ee51-46b9-b58e-43bcdb604423"],
Cell[45497, 1173, 3210, 77, 406, "Input",ExpressionUUID->"d04f551f-63ba-4c59-827e-89539a889eb6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[48744, 1255, 250, 3, 32, "Subsubsection",ExpressionUUID->"bb6d67ae-94ea-4de9-ad33-f49796906916"],
Cell[48997, 1260, 5053, 141, 360, "Input",ExpressionUUID->"cec32202-2ccb-4a54-a11b-3d74e2fc5239",
 InitializationCell->True]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[54111, 1408, 156, 3, 59, "Section",ExpressionUUID->"bdee160a-1c91-4de1-b52d-86eb572207e3"],
Cell[54270, 1413, 468, 10, 42, "Input",ExpressionUUID->"8b16408f-667b-4fec-b260-6fb6db16586b",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[54763, 1427, 168, 3, 39, "Subsubsection",ExpressionUUID->"d002c263-ec1e-44d9-8d95-a0c4fe2e8e78"],
Cell[54934, 1432, 1396, 36, 124, "Input",ExpressionUUID->"f4704157-c7f9-402c-bf7c-77513ac8ecc7",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[56367, 1473, 208, 4, 33, "Subsection",ExpressionUUID->"5193f3f7-8901-4525-bbbc-d3fa4695bea7"],
Cell[56578, 1479, 15188, 350, 922, "Input",ExpressionUUID->"428f55da-c8db-4d63-89da-51a880a4e13f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[71803, 1834, 223, 4, 33, "Subsection",ExpressionUUID->"a703f905-419d-403f-a28c-a63b6e5d0fbc"],
Cell[CellGroupData[{
Cell[72051, 1842, 159, 3, 39, "Subsubsection",ExpressionUUID->"807846d5-0a8e-42e1-8499-9436b99fe5c0"],
Cell[72213, 1847, 3735, 96, 376, "Input",ExpressionUUID->"3518af78-5ff7-49ca-9232-57a8cda2059b",
 InitializationCell->True],
Cell[75951, 1945, 5577, 155, 672, "Input",ExpressionUUID->"51b5119b-7ed2-4d4e-8157-9da88d9e51a3",
 InitializationCell->True],
Cell[81531, 2102, 2343, 58, 267, "Input",ExpressionUUID->"f9e7b8dd-479d-4f1c-b30c-43e82a8f1466",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[83911, 2165, 190, 3, 32, "Subsubsection",ExpressionUUID->"d2a5f7e9-fbf3-48fd-896b-3c3a13529cd2"],
Cell[84104, 2170, 2125, 54, 229, "Input",ExpressionUUID->"84ac980c-3e5a-487b-a821-389318a8bd26",
 InitializationCell->True],
Cell[86232, 2226, 2296, 54, 273, "Input",ExpressionUUID->"e0675219-06d7-4260-b88e-aecc77330bb2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[88565, 2285, 206, 4, 32, "Subsubsection",ExpressionUUID->"4d34a9f6-835b-4d0e-bded-e4ef20d68c82"],
Cell[88774, 2291, 8147, 206, 585, "Input",ExpressionUUID->"935d09a0-331b-40fc-a467-f0134b7e4304",
 InitializationCell->True],
Cell[96924, 2499, 6090, 134, 538, "Input",ExpressionUUID->"f8e80e20-24a8-4ec6-ba4f-132db5be82fc",
 InitializationCell->True],
Cell[103017, 2635, 10826, 272, 1018, "Input",ExpressionUUID->"9f3b0ea7-2af5-48b1-84b3-46146be887b3",
 InitializationCell->True],
Cell[113846, 2909, 2104, 53, 225, "Input",ExpressionUUID->"3edfcfc0-c624-46bc-ab09-a08de412f0d7",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[115999, 2968, 253, 4, 47, "Subsection",ExpressionUUID->"1785af53-7c89-486a-9e5f-2cc90ee5d4f8"],
Cell[CellGroupData[{
Cell[116277, 2976, 181, 3, 39, "Subsubsection",ExpressionUUID->"6b5ad42c-f028-4331-8dd5-edca6279d9c9"],
Cell[116461, 2981, 3693, 79, 693, "Input",ExpressionUUID->"8223ffc8-f59e-4c33-b04f-02db6763d2e2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[120191, 3065, 171, 3, 32, "Subsubsection",ExpressionUUID->"25f821ed-484b-44c3-bb3d-2285af151ba5"],
Cell[120365, 3070, 4843, 109, 565, "Input",ExpressionUUID->"4b678c74-7d06-4764-a1d3-b462e6b01ccf",
 InitializationCell->True],
Cell[125211, 3181, 2618, 65, 204, "Input",ExpressionUUID->"18065f13-e208-4ab7-83f1-35e867d53bcb",
 InitializationCell->True],
Cell[127832, 3248, 7194, 158, 584, "Input",ExpressionUUID->"4a073111-7191-4734-b32b-1a96840d6461",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[135075, 3412, 168, 3, 47, "Subsection",ExpressionUUID->"94391a5f-eb5e-4478-a534-7016e4a3f9d1"],
Cell[135246, 3417, 5023, 125, 588, "Input",ExpressionUUID->"ac314d00-9b25-4da1-be23-eabaa3a126f2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[140306, 3547, 281, 4, 33, "Subsection",ExpressionUUID->"e5244ec3-f22c-466c-9873-92eb903637b0"],
Cell[140590, 3553, 6289, 139, 701, "Input",ExpressionUUID->"3500ee75-7244-4321-ae5e-82e6897e10d7",
 InitializationCell->True],
Cell[146882, 3694, 1916, 53, 125, "Input",ExpressionUUID->"ec93a3ae-c758-4d49-9ec4-9c2ae2983898",
 InitializationCell->True],
Cell[148801, 3749, 13046, 303, 958, "Input",ExpressionUUID->"c85cfa76-e8b5-439f-9ca0-f24e64c44725",
 InitializationCell->True],
Cell[161850, 4054, 2867, 55, 342, "Input",ExpressionUUID->"52021b7e-bece-436c-b228-076b6c722055",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[164754, 4114, 166, 3, 33, "Subsection",ExpressionUUID->"82ef4885-2b2a-47d1-8963-133ee7a68a33"],
Cell[CellGroupData[{
Cell[164945, 4121, 3351, 82, 271, "Input",ExpressionUUID->"c5f93900-11a5-40d3-92c2-259b2094122d",
 InitializationCell->True],
Cell[168299, 4205, 877, 26, 56, "Output",ExpressionUUID->"0b8604f1-da25-4adf-bdad-bd34824e6d4d"]
}, Open  ]],
Cell[169191, 4234, 3902, 89, 311, "Input",ExpressionUUID->"c8e3186f-3d3b-492c-8b02-56053c948bd0",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[173118, 4327, 628, 18, 28, "Input",ExpressionUUID->"513ad122-b877-49e8-a3ea-d96e8be9b21e"],
Cell[173749, 4347, 548, 14, 32, "Output",ExpressionUUID->"9ad0818f-edc5-48bc-94af-76e28a530bb3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[174334, 4366, 976, 26, 28, "Input",ExpressionUUID->"281301ac-dffb-4d5e-bbd1-6b3edb5983f7"],
Cell[175313, 4394, 37523, 634, 32, "Output",ExpressionUUID->"838c1182-5e2f-4bc2-9df1-2f48f924020a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[212873, 5033, 543, 15, 28, "Input",ExpressionUUID->"4295c899-7890-4d08-8905-98f26dddfa74"],
Cell[213419, 5050, 2539, 72, 92, "Output",ExpressionUUID->"e0c0781e-2cfd-4aa3-bfbc-782460af2124"]
}, Open  ]],
Cell[215973, 5125, 660, 16, 66, "Input",ExpressionUUID->"47687bc9-4adb-47ae-af03-f85ea04c7388"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[216682, 5147, 207, 4, 59, "Section",ExpressionUUID->"be19843a-e765-47f1-9747-2d6834a73a9e"],
Cell[CellGroupData[{
Cell[216914, 5155, 171, 3, 47, "Subsection",ExpressionUUID->"e3f3669e-621b-4b13-b56e-3deed41d0aba"],
Cell[217088, 5160, 6805, 156, 693, "Input",ExpressionUUID->"ac348a0a-7a6e-409c-9a98-56e5170bdbb5",
 InitializationCell->True],
Cell[223896, 5318, 3904, 88, 448, "Input",ExpressionUUID->"b0835c23-2d69-40a7-9251-be3d8571a3bb",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[227837, 5411, 185, 3, 33, "Subsection",ExpressionUUID->"a8f64e7a-d885-45c2-99d7-7e2e4dc385f7"],
Cell[228025, 5416, 498, 14, 63, "Input",ExpressionUUID->"bba04405-f573-40fc-9a19-18ca7de811ab",
 InitializationCell->True],
Cell[228526, 5432, 7107, 152, 706, "Input",ExpressionUUID->"fcb7ecd2-adb3-4b5a-a94f-8080924ea319",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[235682, 5590, 152, 3, 86, "Title",ExpressionUUID->"7a24c792-7a48-4e73-8b88-7b56966e439b"],
Cell[CellGroupData[{
Cell[235859, 5597, 214, 3, 28, "Input",ExpressionUUID->"45787101-b7c2-46b3-828f-0dde391998ab"],
Cell[CellGroupData[{
Cell[236098, 5604, 642, 11, 20, "Print",ExpressionUUID->"d971df05-ab22-4dad-b400-2235bb68c427"],
Cell[236743, 5617, 582, 10, 20, "Print",ExpressionUUID->"0e1f556e-dfdb-403b-a863-9050fab992ec"],
Cell[237328, 5629, 578, 10, 20, "Print",ExpressionUUID->"1161a992-b3e3-411e-80d4-04c9871d412b"],
Cell[237909, 5641, 576, 9, 20, "Print",ExpressionUUID->"8fb9ad9f-322c-494c-aa64-a9339300c467"],
Cell[238488, 5652, 1347, 22, 89, "Print",ExpressionUUID->"88fcb640-8fb8-40a0-a68d-8f42f4107f90"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[239884, 5680, 3982, 107, 597, "Input",ExpressionUUID->"2632f66f-a425-44c8-b21c-333bdd8417c4"],
Cell[243869, 5789, 25895, 428, 31, "Output",ExpressionUUID->"f12dfa59-86fa-4ecf-82c5-db0abc9b8293"]
}, Open  ]]
}, Open  ]]
}
]
*)

