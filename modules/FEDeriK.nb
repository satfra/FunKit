(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    315221,       7384]
NotebookOptionsPosition[    302139,       7144]
NotebookOutlinePosition[    302593,       7162]
CellTagsIndexPosition[    302550,       7159]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"AutoGeneratedPackage", "->", "\"\<FEDeriK.m\>\""}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.933907062001917*^9, 3.933907088477437*^9}, 
   3.9356618434708548`*^9, 3.935744927606638*^9, {3.935833716539812*^9, 
   3.93583371672362*^9}, {3.9507222866535883`*^9, 3.95072228934137*^9}, {
   3.950850838405504*^9, 3.950850842475651*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"33cd48af-4550-42b3-9c95-127f2f1ee635"],

Cell[CellGroupData[{

Cell["Global variables", "Section",
 CellChangeTimes->{{3.9509597231601686`*^9, 3.950959732923991*^9}, {
  3.951108540108012*^9, 3.9511085438759727`*^9}, {3.951210853720582*^9, 
  3.95121085660688*^9}},ExpressionUUID->"d65e8f2b-6500-4348-8918-\
912b67b13cd9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ModuleLoaded", "::", "dependency"}], "=", 
    "\"\<The module `1` requires `2`, which has not been loaded.\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ModuleLoaded", "[", "FunKit", "]"}], "=!=", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"ModuleLoaded", "::", "dependency"}], ",", "\"\<FEDeriK\>\"", 
        ",", "\"\<FunKit\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ModuleLoaded", "[", "FEDeriK", "]"}], "=", "True"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951279357886877*^9, 3.951279421240814*^9}, {
  3.9512794606622543`*^9, 3.951279475842711*^9}, {3.951279581390761*^9, 
  3.9512796956111917`*^9}, {3.951279782883439*^9, 3.9512797869913473`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"0a00f2e0-9e12-4855-8a8a-da6773cee6a6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$OrderedObjects", "=", 
   RowBox[{"{", 
    RowBox[{"Propagator", ",", "GammaN", ",", "Rdot"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$indexedObjects", "=", 
   RowBox[{"{", 
    RowBox[{
    "ABasis", ",", "VBasis", ",", "GammaN", ",", "Propagator", ",", "Rdot", 
     ",", "\[Delta]", ",", "\[Gamma]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$userIndexedObjects", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$MaxDerivativeIterations", "=", "500"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$CanonicalOrdering", "=", "\"\<f>af>b\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951210756011141*^9, 3.951210767816422*^9}, {
  3.951210812202783*^9, 3.951210812369783*^9}, {3.9512108663431187`*^9, 
  3.9512108750394697`*^9}, {3.951288819743936*^9, 3.9512888255679903`*^9}, {
  3.951292005911707*^9, 
  3.951292009096613*^9}},ExpressionUUID->"f9a54712-bc7e-4f67-94ba-\
c436d6c2a287"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddIndexedObject", "[", "name_Symbol", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AppendTo", "[", 
      RowBox[{"$userIndexedObjects", ",", "name"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"$userIndexedObjects", "=", 
      RowBox[{"DeleteDuplicates", "[", "$userIndexedObjects", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"$indexedObjects", ",", "name"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"$indexedObjects", "=", 
      RowBox[{"DeleteDuplicates", "[", "$indexedObjects", "]"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9512888041247883`*^9, 3.951288852682535*^9}, {
  3.951292978856127*^9, 
  3.9512929928318167`*^9}},ExpressionUUID->"9f23e5c2-affb-4cab-9de6-\
acd7510a1543"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$FunKitDirectory", "=", 
   RowBox[{
    RowBox[{"SelectFirst", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
            "$UserBaseDirectory", ",", "\"\<Applications\>\"", ",", 
             "\"\<FunKit\>\""}], "}"}], "]"}], ",", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
            "$BaseDirectory", ",", "\"\<Applications\>\"", ",", 
             "\"\<FunKit\>\""}], "}"}], "]"}], ",", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
            "$InstallationDirectory", ",", "\"\<AddOns\>\"", ",", 
             "\"\<Applications\>\"", ",", "\"\<FunKit\>\""}], "}"}], "]"}], 
          ",", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
            "$InstallationDirectory", ",", "\"\<AddOns\>\"", ",", 
             "\"\<Packages\>\"", ",", "\"\<FunKit\>\""}], "}"}], "]"}], ",", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
            "$InstallationDirectory", ",", "\"\<AddOns\>\"", ",", 
             "\"\<ExtraPackages\>\"", ",", "\"\<FunKit\>\""}], "}"}], "]"}]}],
          "}"}], ",", 
        RowBox[{"Select", "[", 
         RowBox[{"$Path", ",", 
          RowBox[{
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"#", ",", "\"\<FunKit\>\""}], "]"}], "&"}]}], "]"}]}], 
       "]"}], ",", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", "#", "]"}], "&"}]}], "]"}], "<>", 
    "\"\</\>\""}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951226996707944*^9, 3.951227003475544*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"66c68510-764b-433f-bf11-01c5d6a5e9c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["FDOp, FTerm and FEq definitions ", "Section",
 CellChangeTimes->{{3.9509597231601686`*^9, 3.950959732923991*^9}, {
  3.951108540108012*^9, 
  3.9511085438759727`*^9}},ExpressionUUID->"e03db448-7a6c-4e73-9ddc-\
3b1976a84a81"],

Cell[CellGroupData[{

Cell["Basic definitions", "Subsection",
 CellChangeTimes->{{3.950959776616251*^9, 3.950959779850823*^9}, 
   3.9509598524176817`*^9},ExpressionUUID->"35360acd-1ab3-48dc-b387-\
960ef784c1b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", "FTerm", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "FTerm", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTimesPowerPatternaToFTermb", "=", 
   TagBox[
    StyleBox[
     RowBox[{"Power", "[", 
      RowBox[{"a", ",", 
       RowBox[{"FTerm", "[", "b_", "]"}]}], "]"}],
     ShowSpecialCharacters->False,
     ShowStringCharacters->True,
     NumberMarks->True],
    FullForm]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FTimesPowerPatternFTermbtoa", "=", 
    TagBox[
     StyleBox[
      RowBox[{"Power", "[", 
       RowBox[{"a", ",", 
        RowBox[{"FTerm", "[", "b_", "]"}]}], "]"}],
      ShowSpecialCharacters->False,
      ShowStringCharacters->True,
      NumberMarks->True],
     FullForm]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FTerm", "::", "TimesError"}], "=", 
   "\"\<An FTerm cannot be multiplied using Times[__]. To multiply FTerms, \
use term1**term2, also with scalars, a**term. Error in expression\n`1`\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FTerm", "::", "FTermPowerError"}], "=", 
    "\"\<An FTerm cannot be taken to a power of an FTerm.\>\""}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Multiplication", " ", "of", " ", "FTerms"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"FTerm", "/:", 
  RowBox[{"NonCommutativeMultiply", "[", 
   RowBox[{
    RowBox[{"FTerm", "[", "a__", "]"}], ",", 
    RowBox[{"FTerm", "[", "b__", "]"}]}], "]"}], ":=", 
  RowBox[{"FTerm", "[", 
   RowBox[{"a", ",", "b"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTerm", "[", 
   RowBox[{"pre___", ",", 
    RowBox[{"NonCommutativeMultiply", "[", "in___", "]"}], ",", "post___"}], 
   "]"}], ":=", 
  RowBox[{"FTerm", "[", 
   RowBox[{"pre", ",", "in", ",", "post"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FTerm", "[", "]"}], ":=", 
   RowBox[{"FTerm", "[", "1", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Pre", "-", 
    RowBox[{"reduction", " ", "of", " ", "zero", " ", "FTerms"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTerm", "[", 
   RowBox[{"___", ",", "0", ",", "___"}], "]"}], ":=", 
  RowBox[{"FTerm", "[", "0", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTerm", "[", 
   RowBox[{"pre___", ",", "a_", ",", 
    RowBox[{"b", ":", 
     RowBox[{"(", 
      RowBox[{"_Integer", "|", "_Real", "|", "_Rational", "|", "_Complex"}], 
      ")"}]}], ",", "post___"}], "]"}], ":=", 
  RowBox[{"FTerm", "[", 
   RowBox[{"pre", ",", 
    RowBox[{"a", "*", "b"}], ",", "post"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FTerm", "[", 
    RowBox[{
     RowBox[{"a", ":", 
      RowBox[{"(", 
       RowBox[{"_Integer", "|", "_Real", "|", "_Rational", "|", "_Complex"}], 
       ")"}]}], ",", "b_", ",", "post___"}], "]"}], ":=", 
   RowBox[{"FTerm", "[", 
    RowBox[{
     RowBox[{"a", "*", "b"}], ",", "post"}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Reduction", " ", "of", " ", "immediately", " ", "nested", " ", "FTerms"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FTerm", "[", 
    RowBox[{"pre___", ",", 
     RowBox[{"FTerm", "[", "in__", "]"}], ",", "post___"}], "]"}], ":=", 
   RowBox[{"FTerm", "[", 
    RowBox[{"pre", ",", "in", ",", "post"}], "]"}]}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FTerm", "/:", 
    RowBox[{"Power", "[", 
     RowBox[{
      RowBox[{"FTerm", "[", "a___", "]"}], ",", 
      RowBox[{"FTerm", "[", "b___", "]"}]}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"FTerm", "::", "FTermPowerError"}], "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "FTerm", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951108570921122*^9, 3.9511086067410803`*^9}, {
  3.9511206459063587`*^9, 3.951120660081051*^9}, {3.951195864716386*^9, 
  3.951195886154029*^9}, {3.951196961507043*^9, 3.951197010834494*^9}, {
  3.951197041118517*^9, 3.9511971060976057`*^9}, {3.951197479182197*^9, 
  3.951197519394229*^9}, {3.951219979402542*^9, 3.951219993857942*^9}, {
  3.951220337986998*^9, 3.9512203916636333`*^9}, {3.951283991688099*^9, 
  3.951284016560318*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"9610d6bd-1c3a-4143-88dc-cb4244676cae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", "FEq", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "FEq", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FEq", "::", "TimesError"}], "=", 
    "\"\<A FEq cannot be multiplied using Times[__]. To multiply FEqs, use \
eq1**eq2, also with scalars, a**eq. Error in expression\n`1`\>\""}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Removal", " ", "of", " ", "zero", " ", "FTerms"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FEq", "[", 
    RowBox[{"pre___", ",", 
     RowBox[{"FTerm", "[", 
      RowBox[{"___", ",", "0", ",", "___"}], "]"}], ",", "post___"}], "]"}], ":=", 
   RowBox[{"FEq", "[", 
    RowBox[{"pre", ",", "post"}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Sum", " ", "splitting", " ", "of", " ", "FTerms"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FEq", "[", 
    RowBox[{"preEq___", ",", 
     RowBox[{"FTerm", "[", 
      RowBox[{"preTerm___", ",", 
       RowBox[{"Plus", "[", 
        RowBox[{"a_", ",", "b__"}], "]"}], ",", "postTerm___"}], "]"}], ",", 
     "postEq___"}], "]"}], ":=", 
   RowBox[{"FEq", "[", 
    RowBox[{"preEq", ",", 
     RowBox[{"FTerm", "[", 
      RowBox[{"preTerm", ",", "a", ",", "postTerm"}], "]"}], ",", 
     RowBox[{"FTerm", "[", 
      RowBox[{"preTerm", ",", 
       RowBox[{"Plus", "[", "b", "]"}], ",", "postTerm"}], "]"}], ",", 
     "postEq"}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Sums", " ", "of", " ", "FTerms"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FEq", "[", 
   RowBox[{"preEq___", ",", 
    RowBox[{"Plus", "[", 
     RowBox[{
      RowBox[{"FTerm", "[", "a__", "]"}], ",", 
      RowBox[{"FTerm", "[", "b__", "]"}], ",", "c___"}], "]"}], ",", 
    "postEq___"}], "]"}], ":=", 
  RowBox[{"FEq", "[", 
   RowBox[{"preEq", ",", 
    RowBox[{"FTerm", "[", "a", "]"}], ",", 
    RowBox[{"Plus", "[", 
     RowBox[{
      RowBox[{"FTerm", "[", "b", "]"}], ",", "c"}], "]"}], ",", "postEq"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FEq", "/:", 
   RowBox[{"Plus", "[", 
    RowBox[{
     RowBox[{"FEq", "[", "a___", "]"}], ",", 
     RowBox[{"FTerm", "[", "b__", "]"}]}], "]"}], ":=", 
   RowBox[{"FEq", "[", 
    RowBox[{"a", ",", 
     RowBox[{"FTerm", "[", "b", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Sums", " ", "of", " ", "FEqs"}], "*)"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{"FEq", "/:", 
   RowBox[{"Plus", "[", 
    RowBox[{"preEq___", ",", 
     RowBox[{"FEq", "[", "terms1___", "]"}], ",", "midEq___", ",", 
     RowBox[{"FEq", "[", "terms2___", "]"}], ",", "postEq___"}], "]"}], ":=", 
   
   RowBox[{"Plus", "[", 
    RowBox[{"preEq", ",", "midEq", ",", "postEq", ",", 
     RowBox[{"FEq", "[", 
      RowBox[{"terms1", ",", "terms2"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Multiplication", " ", "of", " ", "FEqs"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"FEq", "/:", 
  RowBox[{"Times", "[", 
   RowBox[{"pre___", ",", 
    RowBox[{"FEq", "[", "a__", "]"}], ",", "post___"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"FEq", "::", "TimesError"}], ",", 
      RowBox[{"{", 
       RowBox[{"pre", ",", 
        RowBox[{"FEq", "[", "a", "]"}], ",", "post"}], "}"}]}], "]"}], ";", 
    RowBox[{"Abort", "[", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FEq", "[", 
    RowBox[{"prefeq__", ",", 
     RowBox[{"Times", "[", 
      RowBox[{"pre___", ",", 
       RowBox[{"FTerm", "[", "a__", "]"}], ",", "post___"}], "]"}], ",", 
     "postfeq__"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"FTerm", "::", "TimesError"}], ",", 
       RowBox[{"{", 
        RowBox[{"pre", ",", 
         RowBox[{"FTerm", "[", "a", "]"}], ",", "post"}], "}"}]}], "]"}], ";", 
     RowBox[{"Abort", "[", "]"}]}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"FEq", "/:", 
  RowBox[{"NonCommutativeMultiply", "[", 
   RowBox[{
    RowBox[{"FTerm", "[", "b__", "]"}], ",", 
    RowBox[{"FEq", "[", "c__", "]"}]}], "]"}], ":=", 
  RowBox[{"FEq", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"FTerm", "[", "b", "]"}], "**", "#"}], "&"}], ",", 
     RowBox[{"FEq", "[", "c", "]"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FEq", "/:", 
  RowBox[{"NonCommutativeMultiply", "[", 
   RowBox[{
    RowBox[{"FEq", "[", "a__", "]"}], ",", 
    RowBox[{"FEq", "[", "b__", "]"}]}], "]"}], ":=", 
  RowBox[{"FEq", "@@", 
   RowBox[{"(", 
    RowBox[{"Flatten", "@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"FEq", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", "a", "}"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "**", 
         RowBox[{
          RowBox[{"{", "b", "}"}], "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"{", "a", "}"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"{", "b", "}"}], "]"}]}], "}"}]}], "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"FEq", "/:", 
  RowBox[{"NonCommutativeMultiply", "[", 
   RowBox[{
    RowBox[{"FTerm", "[", "b___", "]"}], ",", 
    RowBox[{"FEq", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"FEq", "[", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FEq", "/:", 
  RowBox[{"NonCommutativeMultiply", "[", 
   RowBox[{
    RowBox[{"FTerm", "[", "]"}], ",", 
    RowBox[{"FEq", "[", "b___", "]"}]}], "]"}], ":=", 
  RowBox[{"FEq", "[", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FEq", "/:", 
  RowBox[{"NonCommutativeMultiply", "[", 
   RowBox[{
    RowBox[{"FTerm", "[", "0", "]"}], ",", 
    RowBox[{"FEq", "[", "b___", "]"}]}], "]"}], ":=", 
  RowBox[{"FEq", "[", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FEq", "/:", 
   RowBox[{"FTerm", "[", 
    RowBox[{"FEq", "[", "a__", "]"}], "]"}], ":=", 
   RowBox[{"FEq", "[", "a", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FEq", "/:", 
   RowBox[{"FTerm", "[", 
    RowBox[{
     RowBox[{"FEq", "[", "a__", "]"}], ",", 
     RowBox[{"FEq", "[", "b__", "]"}]}], "]"}], ":=", 
   RowBox[{"FEq", "@@", 
    RowBox[{"(", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"FEq", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "a", "}"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "**", 
          RowBox[{
           RowBox[{"{", "b", "}"}], "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"{", "a", "}"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"{", "b", "}"}], "]"}]}], "}"}]}], "]"}]}], ")"}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Reduction", " ", "of", " ", "immediately", " ", "nested", " ", "FEqs"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FEq", "[", 
    RowBox[{"pre___", ",", 
     RowBox[{"FEq", "[", "in___", "]"}], ",", "post___"}], "]"}], ":=", 
   RowBox[{"FEq", "[", 
    RowBox[{"pre", ",", "in", ",", "post"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "FEq", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9509578761709423`*^9, 3.950957973036676*^9}, {
   3.9509590689899607`*^9, 3.9509591157318487`*^9}, {3.9509591472919817`*^9, 
   3.950959252858809*^9}, {3.9509592907067623`*^9, 3.9509592957039757`*^9}, {
   3.950959501450481*^9, 3.95095951130514*^9}, {3.950959686410345*^9, 
   3.950959714174095*^9}, 3.950959773470724*^9, {3.951034884384832*^9, 
   3.951034890869*^9}, {3.951035198689001*^9, 3.951035207408928*^9}, {
   3.951035268197209*^9, 3.951035301400906*^9}, {3.951035981870775*^9, 
   3.9510360006370783`*^9}, {3.951036246658142*^9, 3.95103626460588*^9}, {
   3.95103649033849*^9, 3.951036598302443*^9}, {3.951036633594223*^9, 
   3.951036785006905*^9}, {3.9510368169549932`*^9, 3.951036830730741*^9}, {
   3.951037206113153*^9, 3.95103734490982*^9}, {3.951037380987048*^9, 
   3.951037383677424*^9}, {3.951037439125901*^9, 3.951037496838653*^9}, {
   3.95103754050202*^9, 3.9510375690137587`*^9}, {3.9510376206837482`*^9, 
   3.951037625335888*^9}, {3.95103780882169*^9, 3.951037937002328*^9}, {
   3.951045322817977*^9, 3.95104532318824*^9}, {3.9510453867665377`*^9, 
   3.9510456103940287`*^9}, {3.95104564974853*^9, 3.951045666800379*^9}, {
   3.9510457134141083`*^9, 3.951045873397193*^9}, {3.951045915058331*^9, 
   3.9510460013306837`*^9}, {3.95104607626162*^9, 3.951046274552978*^9}, {
   3.951046466112495*^9, 3.951046728989846*^9}, {3.951046767530278*^9, 
   3.951046934066455*^9}, {3.9511072891096373`*^9, 3.951107324549317*^9}, {
   3.951107379842474*^9, 3.951107392161078*^9}, {3.951107584300604*^9, 
   3.95110759264114*^9}, {3.951107680371338*^9, 3.951107740154788*^9}, {
   3.951107781351058*^9, 3.9511077883787947`*^9}, {3.951107886223928*^9, 
   3.951107886588614*^9}, {3.951107926025846*^9, 3.951107950114067*^9}, {
   3.951108556054607*^9, 3.951108598328257*^9}, {3.9511196059065237`*^9, 
   3.951119683559124*^9}, {3.9511198861915407`*^9, 3.951119888700102*^9}, {
   3.951195813278051*^9, 3.95119584540624*^9}, {3.9511975255885773`*^9, 
   3.9511975266179333`*^9}, {3.95121043539817*^9, 3.951210463363813*^9}, 
   3.951285698816757*^9, 3.9512857380318813`*^9, {3.951287820920479*^9, 
   3.951287878783401*^9}, {3.9512879154103193`*^9, 3.951287918549728*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"d8c7ad92-008a-409f-951b-580a3ca827cd"]
}, Closed]],

Cell[CellGroupData[{

Cell["Checks and assertions", "Subsection",
 CellChangeTimes->{{3.932178009618313*^9, 3.932178022055203*^9}, {
  3.950801118933737*^9, 
  3.950801121691584*^9}},ExpressionUUID->"23b7e69d-dcbb-4fb0-a77e-\
b8638a031ad4"],

Cell[CellGroupData[{

Cell["FTerm and FEq", "Subsubsection",
 CellChangeTimes->{{3.9508642163296537`*^9, 3.950864226113566*^9}, {
  3.950964433513967*^9, 
  3.9509644360831413`*^9}},ExpressionUUID->"d438b387-4f31-41ce-a117-\
795b628d69b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FTermQ", "[", "expr_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Head", "[", "expr", "]"}], "===", "FTerm"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FTerm", "::", "notFTerm"}], "=", 
   "\"\<The term `1` is not an FTerm.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AssertFTerm", "[", "expr_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"Not", "@", 
       RowBox[{"FTermQ", "[", "expr", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{
         RowBox[{"FTerm", "::", "notFTerm"}], ",", "expr"}], "]"}], ";", 
       RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FEqQ", "[", "expr_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Head", "[", "expr", "]"}], "===", "FEq"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FEq", "::", "notFEq"}], "=", 
   "\"\<The term `1` is not an FEq.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AssertFEq", "[", "expr_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"FEqQ", "[", "expr", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"FEq", "::", "notFEq"}], ",", "expr"}], "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950959791226129*^9, 3.950959819925836*^9}, {
  3.950959877202113*^9, 3.950959965968995*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"63fbe29b-4af8-405d-80e3-5cbc9aa8d1d5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Field Space", "Subsubsection",
 CellChangeTimes->{{3.950801271735565*^9, 3.95080128037481*^9}, {
  3.9508933727376747`*^9, 
  3.950893373722165*^9}},ExpressionUUID->"f52392a8-ad40-44db-871d-\
0651868db7ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Check", " ", "if", " ", "a", " ", "given", " ", "field", " ", 
     "definition", " ", "is", " ", 
     RowBox[{"valid", ".", " ", "Can"}], " ", "be", " ", "either", " ", "its",
      " ", "own", " ", "anti"}], "-", 
    RowBox[{"field", " ", "or", " ", "a", " ", "pair", " ", 
     RowBox[{"{", 
      RowBox[{"af", ",", "f"}], "}"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FieldDefQ", "[", "expr_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "expr", "]"}], "===", "List"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "expr", "]"}], "=!=", "2"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<A field definition must be either of form f[x...] or \
{af[x...],f[x...]}. \\\"\>\"", ",", "expr", ",", 
                "\"\<\\\" does not fit.\>\""}], "]"}], ";", 
              RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", 
               RowBox[{"expr", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"Head", "[", 
               RowBox[{"expr", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<A field definition {af[x...],f[x...]} must have different \
field names af and f. \\\"\>\"", ",", "expr", ",", 
                "\"\<\\\" does not fit.\>\""}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Not", "@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"List", "@@", 
                 RowBox[{"(", 
                  RowBox[{"expr", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "===", 
                RowBox[{"List", "@@", 
                 RowBox[{"(", 
                  RowBox[{"expr", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ")"}]}]}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<A field definition {af[x...],f[x...]} must have identical \
indices. \\\"\>\"", ",", "expr", ",", "\"\<\\\" does not fit.\>\""}], "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Not", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"MatchQ", "[", 
                   RowBox[{
                    RowBox[{"expr", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"_Symbol", "[", 
                    RowBox[{"_", ",", 
                    RowBox[{"{", "__Symbol", "}"}]}], "]"}]}], "]"}], "||", 
                  RowBox[{"MatchQ", "[", 
                   RowBox[{
                    RowBox[{"expr", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"_Symbol", "[", "_", "]"}]}], "]"}]}], ")"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<A field definition f[x...] must have indices f[p] or \
f[p,{a,b,...}]. \\\"\>\"", ",", 
                  RowBox[{"expr", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  "\"\<\\\" does not fit.\>\""}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "True", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{"expr", ",", 
               RowBox[{"_Symbol", "[", 
                RowBox[{"_", ",", 
                 RowBox[{"{", "__Symbol", "}"}]}], "]"}]}], "]"}], "||", 
             RowBox[{"MatchQ", "[", 
              RowBox[{"expr", ",", 
               RowBox[{"_Symbol", "[", "_", "]"}]}], "]"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<A field definition f[x...] must have indices f[p] or \
f[p,{a,b,...}]. \\\"\>\"", ",", "expr", ",", "\"\<\\\" does not fit.\>\""}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FieldDef", "::", "invalidFieldDefinition"}], "=", 
     "\"\<The given field definition `1` is not valid.\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AssertFieldDef", "[", "expr_", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "@", 
        RowBox[{"FieldDefQ", "[", "expr", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"FieldDefinition", "::", "invalidFieldDefinition"}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9509723959533377`*^9, 3.950972498533544*^9}, {
  3.9509725391754503`*^9, 3.950972839103818*^9}, {3.95097289590053*^9, 
  3.950973043727556*^9}, {3.9509730775238113`*^9, 3.9509730807717524`*^9}, {
  3.950973155496664*^9, 3.950973196313613*^9}, {3.950973268996133*^9, 
  3.950973292848659*^9}, {3.950973323914188*^9, 3.950973407746553*^9}, {
  3.9509734394970713`*^9, 3.950973519577339*^9}, {3.950973729052182*^9, 
  3.9509737667166567`*^9}, {3.950976938011018*^9, 3.950976940198797*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"d2be4365-2a9f-4170-90b1-81e044dec426"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Check", " ", "if", " ", "a", " ", "given", " ", "field", " ", "space", 
    " ", "definition", " ", "is", " ", "valid"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FieldSpaceDefQ", "[", "fieldSpace_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "fieldSpace", "]"}], "=!=", "Association"}], 
          ",", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<An FSetup must be an association\>\"", "]"}], 
           ";", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Keys", "[", "fieldSpace", "]"}], "===", 
             RowBox[{"{", 
              RowBox[{"\"\<cField\>\"", ",", "\"\<Grassmann\>\""}], "}"}]}], 
            ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<fields must contain the two keys \
{\\\"cField\\\",\\\"Grassmann\\\"}!\>\"", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"ListQ", "[", 
            RowBox[{"fieldSpace", "[", "\"\<cField\>\"", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<fields[\\\"cField\\\"] must be a list!\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"(", 
            RowBox[{"And", "@@", 
             RowBox[{"Map", "[", 
              RowBox[{"FieldDefQ", ",", 
               RowBox[{"fieldSpace", "[", "\"\<cField\>\"", "]"}]}], "]"}]}], 
            ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<fields[\\\"cField\\\"] must contain valid fields!\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"ListQ", "[", 
            RowBox[{"fieldSpace", "[", "\"\<Grassmann\>\"", "]"}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<fields[\\\"Grassmann\\\"] must be a list!\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"(", 
            RowBox[{"And", "@@", 
             RowBox[{"Map", "[", 
              RowBox[{"FieldDefQ", ",", 
               RowBox[{"fieldSpace", "[", "\"\<Grassmann\>\"", "]"}]}], 
              "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<fields[\\\"Grassmann\\\"] must contain valid fields!\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FieldSpaceDefinition", "::", "invalidFieldDefinition"}], "=", 
     "\"\<The given field space definition is invalid.\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AssertFieldSpaceDef", "[", "fields_", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "@", 
        RowBox[{"FieldSpaceDefQ", "[", "fields", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"FieldSpaceDefinition", "::", "invalidFieldDefinition"}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950785803281868*^9, 3.950785830855114*^9}, {
   3.950786297997837*^9, 3.9507864029709253`*^9}, {3.950787129958323*^9, 
   3.9507871301602573`*^9}, {3.950795998774166*^9, 3.950796005485301*^9}, {
   3.9507965324786587`*^9, 3.950796562931445*^9}, {3.950796680245487*^9, 
   3.950796684703451*^9}, 3.950801142187722*^9, {3.9508637092253017`*^9, 
   3.950863710048918*^9}, {3.9508933587966433`*^9, 3.950893362683991*^9}, {
   3.950964560883992*^9, 3.9509647260060463`*^9}, 3.9509709919521027`*^9, {
   3.95097119902899*^9, 3.950971269684161*^9}, {3.950972406057185*^9, 
   3.950972419055738*^9}, {3.9509729891057043`*^9, 3.9509729901532373`*^9}, {
   3.950973052932276*^9, 3.950973069072235*^9}, {3.950973542193096*^9, 
   3.9509735933051243`*^9}, {3.9509736291278887`*^9, 
   3.9509737236713676`*^9}, {3.950973781220873*^9, 3.950973802678894*^9}, {
   3.950973984287372*^9, 3.950974058340818*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"ffdc8015-4beb-4a8a-9712-899076a5bcad"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.9509737011024*^9},
 CellLabel->"In[57]:=",ExpressionUUID->"e6fda6fb-9bcb-45a5-b801-7e006569f014"]
}, Closed]],

Cell[CellGroupData[{

Cell["FSetup", "Subsubsection",
 CellChangeTimes->{{3.9508642163296537`*^9, 3.950864226113566*^9}, 
   3.950964437586562*^9, 
   3.9509736149796743`*^9},ExpressionUUID->"432ab124-4161-47f8-a56b-\
8db469a3db21"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FSetup", "::", "notFSetup"}], "=", 
    "\"\<The given setup is not valid!\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FSetupQ", "[", "setup_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Head", "[", "setup", "]"}], "===", "Association"}], 
           ")"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<A valid setup must be an Association!\>\"", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "@", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Keys", "[", "setup", "]"}], ",", "\"\<FieldSpace\>\""}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<A valid setup must have the key \\\"FieldSpace\\\"!\>\"", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "@", 
          RowBox[{"FieldSpaceDefQ", "[", 
           RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AssertFSetup", "[", "setup_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "setup", "]"}], "===", "Association"}], 
          ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<A valid setup must be an Association!\>\"", "]"}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"Message", "[", 
          RowBox[{"FSetup", "::", "notFSetup"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "@", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"Keys", "[", "setup", "]"}], ",", "\"\<FieldSpace\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<A valid setup must have the key \\\"FieldSpace\\\"!\>\"", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Message", "[", 
          RowBox[{"FSetup", "::", "notFSetup"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"AssertFieldSpaceDef", "[", 
       RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950864013876114*^9, 3.950864178121345*^9}, {
  3.950866123517272*^9, 3.9508661552146883`*^9}, {3.95096155740795*^9, 
  3.950961589920692*^9}, {3.9509635332623377`*^9, 3.95096359322543*^9}, {
  3.9509709220279417`*^9, 3.950970986439794*^9}, {3.9509710317799788`*^9, 
  3.950971170043336*^9}, {3.950973871588525*^9, 3.950973901835678*^9}, {
  3.9509739679684*^9, 3.950973970944644*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"11470f5d-e2db-4aaa-9b7e-0a8c11da0687"]
}, Closed]],

Cell[CellGroupData[{

Cell["Existence of a field", "Subsubsection",
 CellChangeTimes->{{3.9508642163296537`*^9, 3.950864226113566*^9}, 
   3.950964437586562*^9, 3.9509736149796743`*^9, {3.951109567275919*^9, 
   3.951109569556551*^9}},ExpressionUUID->"73595dfd-e53e-4d4e-a700-\
40ff68a78e58"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Check", " ", "if", " ", "a", " ", "given", " ", "field", " ", 
     "definition", " ", "is", " ", 
     RowBox[{"valid", ".", " ", "Can"}], " ", "be", " ", "either", " ", "its",
      " ", "own", " ", "anti"}], "-", 
    RowBox[{"field", " ", "or", " ", "a", " ", "pair", " ", 
     RowBox[{"{", 
      RowBox[{"af", ",", "f"}], "}"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FieldQ", "[", 
      RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{"expr", ",", 
               RowBox[{"_Symbol", "[", 
                RowBox[{"_", ",", 
                 RowBox[{"{", "__Symbol", "}"}]}], "]"}]}], "]"}], "||", 
             RowBox[{"MatchQ", "[", 
              RowBox[{"expr", ",", 
               RowBox[{"_Symbol", "[", "_", "]"}]}], "]"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<A field f[x...] must have indices f[p] or f[p,{a,b,...}]. \\\
\"\>\"", ",", "expr", ",", "\"\<\\\" does not fit.\>\""}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"(", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{"Head", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "//", 
                  "Values"}], "//", "Flatten"}]}], "]"}], ",", 
              RowBox[{"Head", "[", "expr", "]"}]}], "]"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<The field \\\"\>\"", ",", "expr", ",", 
             "\"\<\\\" is not contained in the field space.\>\""}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Field", "::", "invalidField"}], "=", 
     "\"\<The given field `1` does not exist.\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AssertField", "[", 
      RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "@", 
        RowBox[{"FieldQ", "[", 
         RowBox[{"setup", ",", "expr"}], "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"FieldDefinition", "::", "invalidField"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9509723959533377`*^9, 3.950972498533544*^9}, {
  3.9509725391754503`*^9, 3.950972839103818*^9}, {3.95097289590053*^9, 
  3.950973043727556*^9}, {3.9509730775238113`*^9, 3.9509730807717524`*^9}, {
  3.950973155496664*^9, 3.950973196313613*^9}, {3.950973268996133*^9, 
  3.950973292848659*^9}, {3.950973323914188*^9, 3.950973407746553*^9}, {
  3.9509734394970713`*^9, 3.950973519577339*^9}, {3.950973729052182*^9, 
  3.9509737667166567`*^9}, {3.9509741552332573`*^9, 3.9509741985720987`*^9}, {
  3.9509742355449142`*^9, 3.9509742565395184`*^9}, {3.9509766019032183`*^9, 
  3.9509766041301928`*^9}, {3.9509766344861717`*^9, 3.950976637210259*^9}, {
  3.9509766769979153`*^9, 3.950976779031054*^9}, {3.9509769256787357`*^9, 
  3.9509769282539797`*^9}, {3.9510498517763968`*^9, 3.951049854349081*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"8025941a-3caa-4a8b-a6f7-d19c65a09782"]
}, Closed]],

Cell[CellGroupData[{

Cell["Derivative List", "Subsubsection",
 CellChangeTimes->{{3.9508642163296537`*^9, 3.950864226113566*^9}, {
  3.950893338644219*^9, 
  3.950893340478217*^9}},ExpressionUUID->"4586692a-ee51-46b9-b58e-\
43bcdb604423"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Check", " ", "a", " ", "derivative", " ", "list", " ", "for", " ", 
    "correct", " ", 
    RowBox[{"formatting", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"DerivativeListQ", "[", 
      RowBox[{"setup_", ",", "derivativeList_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", "derivativeList", "]"}], "===", "List"}], 
            ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<A valid derivativeList must be an List!\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"AllTrue", "[", 
            RowBox[{"derivativeList", ",", 
             RowBox[{
              RowBox[{"FieldQ", "[", 
               RowBox[{"setup", ",", "#"}], "]"}], "&"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<A valid derivativeList must be an List of fields \
f_[p_,{___}] of f_[p_] which have been defined in the setup!\>\"", "]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DeriveEquation", "::", "invalidDerivativeList"}], "=", 
     "\"\<The given derivativeList `1` is not valid.\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AssertDerivativeList", "[", 
      RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "@", 
        RowBox[{"DerivativeListQ", "[", 
         RowBox[{"setup", ",", "expr"}], "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"DeriveEquation", "::", "invalidDerivativeList"}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950864234236211*^9, 3.9508644603567677`*^9}, {
   3.950864514373273*^9, 3.950864523736723*^9}, {3.950865674724793*^9, 
   3.9508656803898973`*^9}, {3.950866001476939*^9, 3.950866011277586*^9}, {
   3.950866277809552*^9, 3.950866291301694*^9}, 3.9508663653146677`*^9, 
   3.95086639713623*^9, {3.95097396076858*^9, 3.950973963799748*^9}, {
   3.9509740743483953`*^9, 3.95097409846065*^9}, {3.9509767888540382`*^9, 
   3.95097688937116*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"d04f551f-63ba-4c59-827e-89539a889eb6"]
}, Closed]],

Cell[CellGroupData[{

Cell["FDOp", "Subsubsection",
 CellChangeTimes->{{3.9508642163296537`*^9, 3.950864226113566*^9}, {
  3.950964433513967*^9, 3.9509644360831413`*^9}, {3.951109340007738*^9, 
  3.9511093407521*^9}},ExpressionUUID->"bb6d67ae-94ea-4de9-ad33-f49796906916"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", "FDOp", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "FDOp", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FDOp", "::", "invalid"}], "=", 
   "\"\<`1` is not a valid FDOp.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FDOp", "::", "invalidArguments"}], "=", 
   "\"\<`1` is not a valid FDOp. FDOp takes a single field with an index as \
argument.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FDOp", "::", "arithmetic"}], "=", 
    "\"\<An FDOp cannot be included as anything but a factor in an FTerm. \
Error in \n  `1`\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"FDOp", "/:", 
  RowBox[{"Times", "[", 
   RowBox[{"a___", ",", 
    RowBox[{"FDOp", "[", "b___", "]"}], ",", "c___"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"FDOp", "::", "arithmetic"}], ",", 
      RowBox[{"StringTake", "[", 
       RowBox[{
        RowBox[{"ToString", "@", 
         RowBox[{"(", 
          RowBox[{"Hold", "@", 
           RowBox[{"Times", "[", 
            RowBox[{"a", ",", 
             RowBox[{"FDOp", "[", "b", "]"}], ",", "c"}], "]"}]}], ")"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"6", ",", 
          RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], "]"}], ";", 
    RowBox[{"Abort", "[", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDOp", "/:", 
   RowBox[{"Plus", "[", 
    RowBox[{"a___", ",", 
     RowBox[{"FDOp", "[", "b___", "]"}], ",", "c___"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"FDOp", "::", "arithmetic"}], ",", 
       RowBox[{"StringTake", "[", 
        RowBox[{
         RowBox[{"ToString", "@", 
          RowBox[{"(", 
           RowBox[{"Hold", "@", 
            RowBox[{"Plus", "[", 
             RowBox[{"a", ",", 
              RowBox[{"FDOp", "[", "b", "]"}], ",", "c"}], "]"}]}], ")"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"6", ",", 
           RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], "]"}], ";", 
     RowBox[{"Abort", "[", "]"}]}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FDOp", "[", 
    RowBox[{"a_", ",", "b__"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"FDOp", "::", "invalidArguments"}], ",", 
       RowBox[{"StringTake", "[", 
        RowBox[{
         RowBox[{"ToString", "@", 
          RowBox[{"(", 
           RowBox[{"Hold", "@", 
            RowBox[{"FDOp", "[", 
             RowBox[{"a", ",", "b"}], "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"6", ",", 
           RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], "]"}], ";", 
     RowBox[{"Abort", "[", "]"}]}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FDOpQ", "[", 
    RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Head", "[", "expr", "]"}], "===", "FDOp"}], ")"}], "&&", 
      RowBox[{"MatchQ", "[", 
       RowBox[{"expr", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"_", "[", 
           RowBox[{"_", ",", 
            RowBox[{"{", "__", "}"}]}], "]"}], "|", 
          RowBox[{"_", "[", "_", "]"}]}], ")"}]}], "]"}], "&&", 
      RowBox[{"FieldQ", "[", 
       RowBox[{"setup", ",", "#"}], "]"}]}], "&"}], "@@", "expr"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AssertFDOp", "[", 
     RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"Not", "@", 
       RowBox[{"FDOpQ", "[", 
        RowBox[{"setup", ",", "expr"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{
         RowBox[{"FDOp", "::", "invalid"}], ",", "expr"}], "]"}], ";", 
       RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "FDOp", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950959791226129*^9, 3.950959819925836*^9}, {
   3.950959877202113*^9, 3.950959965968995*^9}, {3.951109344001295*^9, 
   3.9511093512403717`*^9}, {3.951109385069475*^9, 3.951109490384367*^9}, {
   3.951109575180601*^9, 3.951109623509289*^9}, {3.9512836351836367`*^9, 
   3.951283964372046*^9}, {3.951284035067808*^9, 3.951284092700465*^9}, {
   3.951284638235787*^9, 3.951284775688508*^9}, 3.9512848078377867`*^9, {
   3.951284931040797*^9, 3.951284940471984*^9}, {3.951284975621332*^9, 
   3.951285244742639*^9}, {3.951286114829897*^9, 3.9512862662903748`*^9}, 
   3.9512863198820457`*^9, {3.9512863705738792`*^9, 3.951286468490302*^9}, 
   3.9512866511509457`*^9},
 CellLabel->"In[67]:=",ExpressionUUID->"cec32202-2ccb-4a54-a11b-3d74e2fc5239"]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Utilities", "Section",
 CellChangeTimes->{{3.932177970725307*^9, 
  3.9321779720559883`*^9}},ExpressionUUID->"bdee160a-1c91-4de1-b52d-\
86eb572207e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Protect", "[", 
   RowBox[{
   "GammaN", ",", "Propagator", ",", "AnyField", ",", "ABasis", ",", "VBasis",
     ",", "FieldIndices"}], "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950894219634593*^9, 3.950894225625526*^9}, {
   3.9508945494140673`*^9, 3.9508945506586037`*^9}, 3.950940101789105*^9, {
   3.95097703546941*^9, 3.95097703915795*^9}, {3.9512927803798428`*^9, 
   3.9512927818951397`*^9}},ExpressionUUID->"8b16408f-667b-4fec-b260-\
6fb6db16586b"],

Cell[CellGroupData[{

Cell["Getting symbols", "Subsubsection",
 CellChangeTimes->{{3.951227382795168*^9, 
  3.9512273921081133`*^9}},ExpressionUUID->"d002c263-ec1e-44d9-8d95-\
a0c4fe2e8e78"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"exclusions", "[", "a_", "]"}], ":=", 
  RowBox[{"And", "@@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "=!=", "List"}], ",", 
     RowBox[{"a", "=!=", "Complex"}], ",", 
     RowBox[{"a", "=!=", "Plus"}], ",", 
     RowBox[{"a", "=!=", "Power"}], ",", 
     RowBox[{"a", "=!=", "Times"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetAllSymbols", "[", "expr_", "]"}], ":=", 
  RowBox[{"DeleteDuplicates", "@", 
   RowBox[{"Cases", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "expr", "}"}], "//.", 
        RowBox[{
         RowBox[{"Times", "[", 
          RowBox[{"a_", ",", "b__"}], "]"}], ":>", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}]}]}], "//.", 
       RowBox[{
        RowBox[{
         RowBox[{"a_Symbol", "[", "b__", "]"}], "/;", 
         RowBox[{"exclusions", "[", "a", "]"}]}], ":>", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", "_Symbol", ",", "\[IndentingNewLine]", 
     "Infinity"}], "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9510242717398663`*^9, 3.951024280343438*^9}, 
   3.951024444887616*^9, {3.951229169059124*^9, 3.9512291793424377`*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"f4704157-c7f9-402c-bf7c-77513ac8ecc7"]
}, Closed]],

Cell[CellGroupData[{

Cell["FunctionalD", "Subsection",
 CellChangeTimes->{{3.932178009618313*^9, 3.932178022055203*^9}, {
  3.950801118933737*^9, 
  3.950801154023693*^9}},ExpressionUUID->"5193f3f7-8901-4525-bbbc-\
d3fa4695bea7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FunctionalD", "::", "malformed"}], "=", 
    "\"\<Cannot take a derivative of `1`. Expression is either malformed or \
this is a bug.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "FunctionalD", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FunctionalD", "[", 
     RowBox[{"expr_", ",", 
      RowBox[{"v", ":", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f_", "[", "_", "]"}], "|", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"f_", "[", "_", "]"}], ",", "_Integer"}], "}"}]}], ")"}], 
        ".."}]}], ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"Internal`InheritedBlock", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "f", ",", "GammaN", ",", "Propagator", ",", "nonConst", ",", "FTerm", 
        ",", "FEq"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nonConst", "=", 
        RowBox[{"Sort", "@", 
         RowBox[{"{", 
          RowBox[{"f", ",", "GammaN", ",", "Propagator", ",", "Power"}], 
          "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Unprotect", "[", 
        RowBox[{
        "GammaN", ",", "Propagator", ",", "FTerm", ",", "FEq", ",", 
         "AnyField"}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Rule", " ", "for", " ", "normal", " ", "functional", " ", 
         "derivatives"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"f", "/:", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"f", "[", "x_", "]"}], ",", 
          RowBox[{"f", "[", "y_", "]"}], ",", 
          RowBox[{"NonConstants", "->", "nonConst"}]}], "]"}], ":=", 
        RowBox[{"\[Gamma]", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"f", ",", "f"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "y"}], ",", "x"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Ignore", " ", "fields", " ", "without", " ", 
         RowBox[{"indices", ".", " ", "These"}], " ", "are", " ", "usually", 
         " ", "tags"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"f", "/:", 
        RowBox[{"D", "[", 
         RowBox[{"f", ",", 
          RowBox[{"f", "[", "y_", "]"}], ",", 
          RowBox[{"NonConstants", "->", "nonConst"}]}], "]"}], ":=", "0"}], 
       ";", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Delta]", "[", 
           RowBox[{"#", ",", "y"}], "]"}], "&"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Derivative", " ", "rule", " ", "for", " ", "GammaN"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"GammaN", "/:", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"GammaN", "[", 
           RowBox[{
            RowBox[{"{", "a__", "}"}], ",", 
            RowBox[{"{", "b__", "}"}]}], "]"}], ",", 
          RowBox[{"f", "[", "if_", "]"}], ",", 
          RowBox[{"NonConstants", "->", "nonConst"}]}], "]"}], ":=", 
        RowBox[{"GammaN", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"f", ",", "a"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "if"}], ",", "b"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Derivative", " ", "rule", " ", "for", " ", "Propagators"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Propagator", "/:", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"Propagator", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"b_", ",", "a_"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"ib_", ",", "ia_"}], "}"}]}], "]"}], ",", 
          RowBox[{"f", "[", "if_", "]"}], ",", 
          RowBox[{"NonConstants", "->", "nonConst"}]}], "]"}], ":=", 
        RowBox[{"Module", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ic", ",", "id", ",", "ie"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Propagator", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"b", ",", "AnyField"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"ib", ",", "ic"}], "}"}]}], "]"}], 
           RowBox[{"GammaN", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"f", ",", "AnyField", ",", "AnyField"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "if"}], ",", 
               RowBox[{"-", "ic"}], ",", 
               RowBox[{"-", "id"}]}], "}"}]}], "]"}], 
           RowBox[{"Propagator", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"AnyField", ",", "a"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"id", ",", "ie"}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"\[Gamma]", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"a", ",", "a"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"ia", ",", 
               RowBox[{"-", "ie"}]}], "}"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"No", " ", "derivatives", " ", "of", " ", "FTerm"}], ",", 
         " ", "FEq"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"FTerm", "/:", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"FTerm", "[", "a___", "]"}], ",", 
          RowBox[{"f", "[", "y_", "]"}], ",", 
          RowBox[{"NonConstants", "->", "nonConst"}]}], "]"}], ":=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"FunctionalD", "::", "malformed"}], ",", 
            RowBox[{"FTerm", "[", "a", "]"}]}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"FEq", "/:", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"FEq", "[", "a___", "]"}], ",", 
          RowBox[{"f", "[", "y_", "]"}], ",", 
          RowBox[{"NonConstants", "->", "nonConst"}]}], "]"}], ":=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"FunctionalD", "::", "malformed"}], ",", 
            RowBox[{"FEq", "[", "a", "]"}]}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Chain", " ", "rules"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"f", "/:", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"g_", "[", 
           RowBox[{"FTerm", "[", "a___", "]"}], "]"}], ",", 
          RowBox[{"f", "[", "y_", "]"}], ",", 
          RowBox[{"NonConstants", "->", "nonConst"}]}], "]"}], ":=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"FTerm", "[", 
           RowBox[{
            RowBox[{"g", "'"}], "[", 
            RowBox[{"FTerm", "[", "a", "]"}], "]"}], "]"}], "**", 
          RowBox[{"FTerm", "[", 
           RowBox[{
            RowBox[{"FDOp", "[", 
             RowBox[{"f", "[", "y", "]"}], "]"}], ",", "a"}], "]"}]}], 
         ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"f", "/:", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"FTerm", "[", "a___", "]"}], ",", "b_"}], "]"}], ",", 
          RowBox[{"f", "[", "y_", "]"}], ",", 
          RowBox[{"NonConstants", "->", "nonConst"}]}], "]"}], ":=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"FTerm", "[", 
           RowBox[{"b", ",", 
            RowBox[{"Power", "[", 
             RowBox[{
              RowBox[{"FTerm", "[", "a", "]"}], ",", 
              RowBox[{"b", "-", "1"}]}], "]"}]}], "]"}], "**", 
          RowBox[{"FTerm", "[", 
           RowBox[{
            RowBox[{"FDOp", "[", 
             RowBox[{"f", "[", "y", "]"}], "]"}], ",", "a"}], "]"}]}], 
         ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"f", "/:", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{"a_", ",", 
            RowBox[{"FTerm", "[", "b___", "]"}]}], "]"}], ",", 
          RowBox[{"f", "[", "y_", "]"}], ",", 
          RowBox[{"NonConstants", "->", "nonConst"}]}], "]"}], ":=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"FTerm", "[", 
           RowBox[{
            RowBox[{"Log", "[", "a", "]"}], ",", 
            RowBox[{"Power", "[", 
             RowBox[{"a", ",", 
              RowBox[{"FTerm", "[", "b", "]"}]}], "]"}]}], "]"}], "**", 
          RowBox[{"FTerm", "[", 
           RowBox[{
            RowBox[{"FDOp", "[", 
             RowBox[{"f", "[", "y", "]"}], "]"}], ",", "b"}], "]"}]}], 
         ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Protect", "[", 
        RowBox[{
        "GammaN", ",", "Propagator", ",", "FTerm", ",", "FEq", ",", 
         "AnyField"}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"D", "[", 
        RowBox[{"expr", ",", "v", ",", 
         RowBox[{"NonConstants", "->", "nonConst"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FunctionalD", "::", "badArgumentFTerm"}], "=", 
   "\"\<Cannot take derivative of an FTerm. Use DeriveFunctional \
instead.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FunctionalD", "[", 
     RowBox[{
      RowBox[{"FTerm", "[", "expr_", "]"}], ",", 
      RowBox[{"v", ":", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f_", "[", "_", "]"}], "|", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"f_", "[", "_", "]"}], ",", "_Integer"}], "}"}]}], ")"}], 
        ".."}]}], ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"FunctionalD", "::", "badArgumentFTerm"}], "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FunctionalD", "::", "badArgumentFEq"}], "=", 
   "\"\<Cannot take derivative of an FEq. Use DeriveFunctional \
instead.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FunctionalD", "[", 
    RowBox[{
     RowBox[{"FEq", "[", "___", "]"}], ",", 
     RowBox[{"v", ":", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"f_", "[", "_", "]"}], "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"f_", "[", "_", "]"}], ",", "_Integer"}], "}"}]}], ")"}], 
       ".."}]}], ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"FunctionalD", "::", "badArgumentFEq"}], "]"}], ";", 
     RowBox[{"Abort", "[", "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950801155924999*^9, 3.950801156180604*^9}, 
   3.9508745541091022`*^9, {3.950874630546281*^9, 3.9508746344224*^9}, {
   3.9508746716147623`*^9, 3.950874843953817*^9}, {3.950874911320944*^9, 
   3.950874967970771*^9}, {3.9508750098040237`*^9, 3.9508750233744373`*^9}, {
   3.9508750787554817`*^9, 3.950875148206582*^9}, 3.9508752181802464`*^9, {
   3.9508940369998207`*^9, 3.9508941754057407`*^9}, {3.950894207218882*^9, 
   3.950894268707493*^9}, {3.9508943099823914`*^9, 3.950894364887673*^9}, {
   3.950894405287778*^9, 3.9508945587833138`*^9}, {3.9508969076834803`*^9, 
   3.9508969664507713`*^9}, {3.950897004655106*^9, 3.950897015070427*^9}, 
   3.9508971564032593`*^9, {3.950897870040359*^9, 3.950897884551845*^9}, {
   3.950897973224579*^9, 3.9508980022919607`*^9}, {3.9509326427332706`*^9, 
   3.95093266159977*^9}, {3.950939662750992*^9, 3.950939674049011*^9}, {
   3.950939753193946*^9, 3.950939895705489*^9}, {3.95093993866444*^9, 
   3.950939957812808*^9}, {3.9509401218698893`*^9, 3.9509401363101273`*^9}, {
   3.950952533276232*^9, 3.950952545138974*^9}, {3.95095258820336*^9, 
   3.950952722829163*^9}, {3.950952869771017*^9, 3.950953031163056*^9}, {
   3.950977047894329*^9, 3.950977350633822*^9}, {3.951195240203231*^9, 
   3.951195388802322*^9}, {3.951195471889974*^9, 3.951195473766608*^9}, {
   3.9511956520381613`*^9, 3.951195788170877*^9}, {3.9511959410810537`*^9, 
   3.951196141638171*^9}, {3.951196344392086*^9, 3.951196366474864*^9}, {
   3.951196844077084*^9, 3.951196875012323*^9}, {3.951197122093006*^9, 
   3.9511971892386637`*^9}, {3.951197222455007*^9, 3.9511972662623672`*^9}, 
   3.951197330985343*^9, {3.951197540127527*^9, 3.951197713002768*^9}, {
   3.9511977856706*^9, 3.951197818994656*^9}, {3.951197859170909*^9, 
   3.9511978849442472`*^9}, {3.951197917748715*^9, 3.951197953999455*^9}, {
   3.951198041247632*^9, 3.951198053693543*^9}, {3.951198099815494*^9, 
   3.951198115660613*^9}, {3.951198148168233*^9, 3.9511981579505587`*^9}, {
   3.9511981890961323`*^9, 3.95119819493015*^9}, {3.951198226487218*^9, 
   3.9511983610114326`*^9}, {3.951212249172265*^9, 3.9512122738997297`*^9}, {
   3.951212336789455*^9, 3.95121235450749*^9}, {3.9512124129764843`*^9, 
   3.951212432487711*^9}, {3.951212477416629*^9, 3.951212621805851*^9}, {
   3.951212679266748*^9, 3.951212717406486*^9}, {3.9512127594075603`*^9, 
   3.951212800564825*^9}, {3.951212848069742*^9, 3.951212852984906*^9}, {
   3.9512128925965843`*^9, 3.9512128932405643`*^9}, 3.951212942528529*^9, {
   3.951213304723278*^9, 3.9512133814804163`*^9}, {3.9512135401374474`*^9, 
   3.9512135831050463`*^9}, {3.9512136829537783`*^9, 3.95121377398514*^9}, {
   3.951213841275055*^9, 3.9512138820107107`*^9}, {3.951214165220489*^9, 
   3.951214166107987*^9}, {3.951214264868593*^9, 3.951214265319968*^9}, {
   3.951214410771542*^9, 3.951214552289424*^9}, {3.951214666616063*^9, 
   3.951214683032452*^9}, {3.9512147251411657`*^9, 3.9512148731638536`*^9}, 
   3.951214948313456*^9, {3.951215032782189*^9, 3.9512150650325613`*^9}, 
   3.9512151161690197`*^9, {3.9512152756823273`*^9, 3.951215285333046*^9}, 
   3.951215323874226*^9, {3.951215389461582*^9, 3.951215459245329*^9}, {
   3.9512155060238323`*^9, 3.9512155379434958`*^9}, {3.95121557326906*^9, 
   3.951215573427577*^9}, {3.9512156059663343`*^9, 3.95121587158613*^9}, {
   3.951215903365415*^9, 3.951215904513631*^9}, {3.951215980269064*^9, 
   3.9512159890299873`*^9}, {3.9512160291775017`*^9, 3.95121607124547*^9}, {
   3.951216118275013*^9, 3.95121623279858*^9}, {3.951219946242391*^9, 
   3.951219968247802*^9}, {3.951220438913568*^9, 3.9512204416073923`*^9}, {
   3.9512205345107737`*^9, 3.95122053549841*^9}, {3.951231437902248*^9, 
   3.9512314416134233`*^9}, {3.9512866947259703`*^9, 3.951286717389337*^9}, {
   3.951286755884138*^9, 3.951286756498644*^9}, {3.95129203442869*^9, 
   3.951292045360529*^9}, {3.951292102401136*^9, 3.951292133419026*^9}, {
   3.951292166228506*^9, 
   3.951292188249078*^9}},ExpressionUUID->"428f55da-c8db-4d63-89da-\
51a880a4e13f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Field and index information", "Subsection",
 CellChangeTimes->{{3.932178009618313*^9, 3.932178022055203*^9}, {
  3.95097752282972*^9, 
  3.950977525821363*^9}},ExpressionUUID->"a703f905-419d-403f-a28c-\
a63b6e5d0fbc"],

Cell[CellGroupData[{

Cell["Fields", "Subsubsection",
 CellChangeTimes->{{3.950977858978568*^9, 
  3.9509778685688467`*^9}},ExpressionUUID->"807846d5-0a8e-42e1-8499-\
9436b99fe5c0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetcFields", "[", "setup_", "]"}], ":=", 
   RowBox[{"Map", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "#", "]"}], "===", "List"}], ",", 
        RowBox[{"Head", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
        RowBox[{"Head", "[", "#", "]"}]}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
      "\"\<cField\>\"", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetAnticFields", "[", "setup_", "]"}], ":=", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Map", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "#", "]"}], "===", "List"}], ",", 
           RowBox[{"Head", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", "}"}]}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
         "\"\<cField\>\"", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{
       RowBox[{"#", "=!=", 
        RowBox[{"{", "}"}]}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetGrassmanns", "[", "setup_", "]"}], ":=", 
   RowBox[{"Map", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "#", "]"}], "===", "List"}], ",", 
        RowBox[{"Head", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
        RowBox[{"Head", "[", "#", "]"}]}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
      "\"\<Grassmann\>\"", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetAntiGrassmanns", "[", "setup_", "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Map", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "#", "]"}], "===", "List"}], ",", 
          RowBox[{"Head", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", "}"}]}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
        "\"\<Grassmann\>\"", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{
      RowBox[{"#", "=!=", 
       RowBox[{"{", "}"}]}], "&"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.932178093219666*^9, {3.932220707851465*^9, 3.932220747249592*^9}, {
   3.950800893485785*^9, 3.950800987632131*^9}, {3.9508016274975567`*^9, 
   3.950801660952232*^9}, {3.95086373016462*^9, 3.95086377625705*^9}, {
   3.950977908402094*^9, 3.9509779098545*^9}, {3.95097858078232*^9, 
   3.950978634866104*^9}, {3.950978675954303*^9, 3.9509786993099747`*^9}, 
   3.950978744078698*^9, {3.951022968366856*^9, 3.951023141306739*^9}, {
   3.9510232320318317`*^9, 3.951023236902824*^9}, {3.951023401747789*^9, 
   3.951023405927434*^9}, {3.951023697339532*^9, 3.9510237141319427`*^9}, {
   3.9510240171202173`*^9, 3.951024058934989*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"3518af78-5ff7-49ca-9232-57a8cda2059b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetFieldPairs", "[", "setup_", "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Head", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Head", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Select", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
           "\"\<Grassmann\>\"", "]"}], ",", 
          RowBox[{
           RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
           "\"\<cField\>\"", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "#", "]"}], "===", "List"}], "&"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetSingleFields", "[", "setup_", "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Head", "[", "#", "]"}], "&"}], ",", 
      RowBox[{"Select", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
           "\"\<Grassmann\>\"", "]"}], ",", 
          RowBox[{
           RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
           "\"\<cField\>\"", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "#", "]"}], "=!=", "List"}], "&"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetAllFields", "[", "setup_", "]"}], ":=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Flatten", "@", 
       RowBox[{"GetFieldPairs", "[", "setup", "]"}]}], ",", 
      RowBox[{"GetSingleFields", "[", "setup", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HasPartnerField", "[", 
    RowBox[{"setup_", ",", "field_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Flatten", "@", 
      RowBox[{"GetFieldPairs", "[", "setup", "]"}]}], ",", 
     "\[IndentingNewLine]", "field"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HasPartnerField", "[", 
     RowBox[{"setup_", ",", 
      RowBox[{"field_", "[", "__", "]"}]}], "]"}], ":=", 
    RowBox[{"HasPartnerField", "[", 
     RowBox[{"setup", ",", "field"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IsGrassmann", "[", 
    RowBox[{"setup_", ",", "field_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"GetGrassmanns", "[", "setup", "]"}], ",", "field", ",", 
     "Infinity"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsGrassmann", "[", 
     RowBox[{"setup_", ",", 
      RowBox[{"field_", "[", "__", "]"}]}], "]"}], ":=", 
    RowBox[{"IsGrassmann", "[", 
     RowBox[{"setup", ",", "field"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IsAntiGrassmann", "[", 
    RowBox[{"setup_", ",", "field_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"GetAntiGrassmanns", "[", "setup", "]"}], ",", "field", ",", 
     "Infinity"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsAntiGrassmann", "[", 
     RowBox[{"setup_", ",", 
      RowBox[{"field_", "[", "__", "]"}]}], "]"}], ":=", 
    RowBox[{"IsAntiGrassmann", "[", 
     RowBox[{"setup", ",", "field"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IscField", "[", 
    RowBox[{"setup_", ",", "field_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"GetcFields", "[", "setup", "]"}], ",", "field", ",", 
     "Infinity"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IscField", "[", 
     RowBox[{"setup_", ",", 
      RowBox[{"field_", "[", "__", "]"}]}], "]"}], ":=", 
    RowBox[{"IscField", "[", 
     RowBox[{"setup", ",", "field"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IsAnticField", "[", 
    RowBox[{"setup_", ",", "field_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"GetAnticFields", "[", "setup", "]"}], ",", "field", ",", 
     "Infinity"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IsAnticField", "[", 
    RowBox[{"setup_", ",", 
     RowBox[{"field_", "[", "__", "]"}]}], "]"}], ":=", 
   RowBox[{"IsAnticField", "[", 
    RowBox[{"setup", ",", "field"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951023163939932*^9, 3.951023253706765*^9}, {
  3.9510232893183107`*^9, 3.9510233580953617`*^9}, {3.951023414375457*^9, 
  3.951023635439684*^9}, {3.951023724604463*^9, 3.951023800417603*^9}, {
  3.951024061485753*^9, 3.9510240986479816`*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"51b5119b-7ed2-4d4e-8157-9da88d9e51a3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetPartnerField", "[", 
    RowBox[{"setup_", ",", "field_Symbol"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pairs", ",", "sel"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "@", 
         RowBox[{"HasPartnerField", "[", 
          RowBox[{"setup", ",", "field"}], "]"}]}], ",", 
        RowBox[{"Return", "[", "field", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pairs", "=", 
       RowBox[{"GetFieldPairs", "[", "setup", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"sel", "=", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"pairs", ",", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"#", ",", "field", ",", "Infinity"}], "]"}], "&"}]}], 
         "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sel", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"sel", ",", "field"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "sel", "]"}], ">", "0"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"sel", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<field \>\"", ",", "field", ",", "\"\< not found!\>\""}], 
       "]"}], ";", 
      RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetPartnerField", "[", 
   RowBox[{"setup_", ",", 
    RowBox[{"field_Symbol", "[", "i__", "]"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"GetPartnerField", "[", 
    RowBox[{"setup", ",", "field"}], "]"}], "[", "i", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.932310703182301*^9, {3.9508008732217073`*^9, 3.950800905255765*^9}, 
   3.950874299413641*^9, {3.951023598531598*^9, 3.951023612563867*^9}, {
   3.951023642999547*^9, 3.9510236672477427`*^9}, {3.951023815416168*^9, 
   3.951023941927535*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"f9e7b8dd-479d-4f1c-b30c-43e82a8f1466"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Checking field content of expressions", "Subsubsection",
 CellChangeTimes->{{3.9510239782885523`*^9, 
  3.951023985187344*^9}},ExpressionUUID->"d2a5f7e9-fbf3-48fd-896b-\
3c3a13529cd2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExtractFields", "[", 
    RowBox[{"setup_Association", ",", "expr_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "symbols", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"symbols", "=", 
       RowBox[{"GetAllSymbols", "[", "expr", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "@", 
       RowBox[{"Select", "[", 
        RowBox[{"symbols", ",", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"GetAllFields", "[", "setup", "]"}], ",", "#"}], "]"}], 
          "&"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtractFieldsWithIndex", "[", 
    RowBox[{"setup_Association", ",", "expr_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fields", ",", "extracted"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fields", "=", 
       RowBox[{"ExtractFields", "[", 
        RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"extracted", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"expr", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"a_", "[", "b_", "]"}], "/;", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"fields", ",", "a"}], "]"}]}], ":>", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"extracted", ",", 
             RowBox[{"a", "[", "b", "]"}]}], "]"}], ";", "1"}], ")"}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "extracted", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951024006516164*^9, 3.951024008440085*^9}, {
  3.951024116163844*^9, 3.951024187756226*^9}, {3.951024231427863*^9, 
  3.951024239820277*^9}, {3.951024468384468*^9, 3.951024487333744*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"84ac980c-3e5a-487b-a821-389318a8bd26"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ContainsGrassmann", "[", 
   RowBox[{"setup_Association", ",", "expr_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "fields", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fields", "=", 
      RowBox[{"ExtractFields", "[", 
       RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "\[IndentingNewLine]", 
      RowBox[{"AnyTrue", "[", 
       RowBox[{"fields", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"IsGrassmann", "[", 
           RowBox[{"setup", ",", "#"}], "]"}], "||", 
          RowBox[{"IsAntiGrassmann", "[", 
           RowBox[{"setup", ",", "#"}], "]"}]}], "&"}]}], "]"}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GrassmannCount", "[", 
   RowBox[{"setup_Association", ",", "expr_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "fields", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fields", "=", 
      RowBox[{"ExtractFieldsWithIndex", "[", 
       RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"Length", "@", "\[IndentingNewLine]", 
       RowBox[{"Select", "[", 
        RowBox[{"fields", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"IsGrassmann", "[", 
            RowBox[{"setup", ",", 
             RowBox[{"Head", "[", "#", "]"}]}], "]"}], "||", 
           RowBox[{"IsAntiGrassmann", "[", 
            RowBox[{"setup", ",", 
             RowBox[{"Head", "[", "#", "]"}]}], "]"}]}], "&"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950801014829342*^9, 3.950801089487433*^9}, {
   3.9508016734862947`*^9, 3.950801789647143*^9}, {3.950802396390094*^9, 
   3.95080251586098*^9}, {3.9508025705613623`*^9, 3.9508025986163673`*^9}, {
   3.950802685581463*^9, 3.950802850019553*^9}, {3.95080288950806*^9, 
   3.950802891116541*^9}, 3.950977841322421*^9, 3.9510239548515882`*^9, {
   3.951047050359741*^9, 3.951047092694622*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"e0675219-06d7-4260-b88e-aecc77330bb2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Indices", "Subsubsection",
 CellChangeTimes->{{3.950801271735565*^9, 3.95080128037481*^9}, {
  3.950854198551154*^9, 
  3.950854199116568*^9}},ExpressionUUID->"4d34a9f6-835b-4d0e-bded-\
e4ef20d68c82"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Get", " ", "a", " ", "list", " ", "of", " ", "all", " ", "unique", " ", 
     "super"}], "-", 
    RowBox[{
    "indices", " ", "within", " ", "the", " ", "expression", " ", "expr"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GetAllSuperIndices", "[", 
     RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fields", ",", "indices", ",", "i", ",", "j"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fields", "=", 
        RowBox[{"ExtractFieldsWithIndex", "[", 
         RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"indices", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fields", "//.", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"p_", "[", 
            RowBox[{"Times", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "a_"}], "]"}], "]"}], "/;", 
           RowBox[{"exclusions", "[", "p", "]"}]}], ":>", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"indices", ",", "a"}], "]"}], ";", "1"}], ")"}]}]}], "//.",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"p_", "[", "a_", "]"}], "/;", 
          RowBox[{"exclusions", "[", "p", "]"}]}], ":>", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"indices", ",", "a"}], "]"}], ";", "1"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"expr", "//.", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"$indexedObjects", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{
               RowBox[{"{", "f__", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 TagBox[
                  StyleBox[
                   RowBox[{"Times", "[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"a", ":", 
                    RowBox[{"(", 
                    RowBox[{
                    "_Symbol", "|", "_Subscript", "|", "_Superscript"}], 
                    ")"}]}]}], "]"}],
                   ShowSpecialCharacters->False,
                   ShowStringCharacters->True,
                   NumberMarks->True],
                  FullForm], ",", "b___"}], "}"}]}], "]"}], ":>", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"indices", ",", "a"}], "]"}], ";", 
               RowBox[{
                RowBox[{"$indexedObjects", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{
                 RowBox[{"{", "f", "}"}], ",", 
                 RowBox[{"{", "b", "}"}]}], "]"}]}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"$indexedObjects", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{
               RowBox[{"{", "f__", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 TagBox[
                  RowBox[{"a", ":", 
                   RowBox[{"(", 
                    RowBox[{
                    "_Symbol", "|", "_Subscript", "|", "_Superscript"}], 
                    ")"}]}],
                  FullForm], ",", "b___"}], "}"}]}], "]"}], ":>", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"indices", ",", "a"}], "]"}], ";", 
               RowBox[{
                RowBox[{"$indexedObjects", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{
                 RowBox[{"{", "f", "}"}], ",", 
                 RowBox[{"{", "b", "}"}]}], "]"}]}], ")"}]}]}], 
           "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "$indexedObjects", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"expr", "//.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Delta]", "[", 
            RowBox[{
             TagBox[
              StyleBox[
               RowBox[{"Times", "[", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"a", ":", 
                  RowBox[{"(", 
                   RowBox[{
                   "_Symbol", "|", "_Subscript", "|", "_Superscript"}], 
                   ")"}]}]}], "]"}],
               ShowSpecialCharacters->False,
               ShowStringCharacters->True,
               NumberMarks->True],
              FullForm], ",", "b___"}], "]"}], ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"indices", ",", "a"}], "]"}], ";", 
             RowBox[{"\[Delta]", "[", "b", "]"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[Delta]", "[", 
            RowBox[{
             RowBox[{"a", ":", 
              RowBox[{"(", 
               RowBox[{"_Symbol", "|", "_Subscript", "|", "_Superscript"}], 
               ")"}]}], ",", "b___"}], "]"}], ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"indices", ",", "a"}], "]"}], ";", 
             RowBox[{"\[Delta]", "[", "b", "]"}]}], ")"}]}]}], 
         "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"expr", "//.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Gamma]", "[", 
            RowBox[{
             TagBox[
              StyleBox[
               RowBox[{"Times", "[", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"a", ":", 
                  RowBox[{"(", 
                   RowBox[{
                   "_Symbol", "|", "_Subscript", "|", "_Superscript"}], 
                   ")"}]}]}], "]"}],
               ShowSpecialCharacters->False,
               ShowStringCharacters->True,
               NumberMarks->True],
              FullForm], ",", "b___"}], "]"}], ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"indices", ",", "a"}], "]"}], ";", 
             RowBox[{"\[Gamma]", "[", "b", "]"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[Gamma]", "[", 
            RowBox[{
             RowBox[{"a", ":", 
              RowBox[{"(", 
               RowBox[{"_Symbol", "|", "_Subscript", "|", "_Superscript"}], 
               ")"}]}], ",", "b___"}], "]"}], ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"indices", ",", "a"}], "]"}], ";", 
             RowBox[{"\[Gamma]", "[", "b", "]"}]}], ")"}]}]}], 
         "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"indices", "//", "DeleteDuplicates"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951107115870104*^9, 3.951107119664289*^9}, {
   3.951232666728512*^9, 3.9512327307721777`*^9}, {3.951232768256838*^9, 
   3.951232797687828*^9}, {3.951232852977048*^9, 3.951232854904772*^9}, 
   3.951232896832637*^9, {3.951233051337117*^9, 3.9512330784720984`*^9}, {
   3.9512331145693483`*^9, 3.951233116819352*^9}, {3.951233193304516*^9, 
   3.9512332286202087`*^9}, {3.9512332870017033`*^9, 3.951233461017544*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"935d09a0-331b-40fc-a467-f0134b7e4304"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtractObjectsWithIndex", "[", 
    RowBox[{"setup_Association", ",", "expr_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"indices", ",", "flattened", ",", "objects", ",", "dummy"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"indices", "=", 
       RowBox[{"GetAllSuperIndices", "[", 
        RowBox[{"Setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FTermQ", "[", "expr", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"flattened", "=", 
          RowBox[{"List", "@@", "expr"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"objects", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"flattened", "//.", 
          RowBox[{
           RowBox[{
            RowBox[{"a_Symbol", "[", "b__", "]"}], "/;", 
            RowBox[{
             RowBox[{"ContainsAny", "[", 
              RowBox[{
               RowBox[{"Flatten", "@", 
                RowBox[{"{", "b", "}"}]}], ",", 
               RowBox[{"indices", "\[Union]", 
                RowBox[{"(", 
                 RowBox[{"-", "indices"}], ")"}]}]}], "]"}], "&&", 
             RowBox[{"exclusions", "[", "a", "]"}]}]}], ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"objects", ",", 
               RowBox[{"a", "[", "b", "]"}]}], "]"}], ";", "dummy"}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "objects", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FEqQ", "[", "expr", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"flattened", "=", 
          RowBox[{"List", "@@", 
           RowBox[{"(", 
            RowBox[{"Join", "@@", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"List", "@@", "#"}], "&"}], ",", "expr"}], "]"}]}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"objects", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"flattened", "//.", 
          RowBox[{
           RowBox[{
            RowBox[{"a_Symbol", "[", "b__", "]"}], "/;", 
            RowBox[{
             RowBox[{"ContainsAny", "[", 
              RowBox[{
               RowBox[{"{", "b", "}"}], ",", 
               RowBox[{"indices", "\[Union]", 
                RowBox[{"(", 
                 RowBox[{"-", "indices"}], ")"}]}]}], "]"}], "&&", 
             RowBox[{"exclusions", "[", "a", "]"}]}]}], ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"objects", ",", 
               RowBox[{"a", "[", "b", "]"}]}], "]"}], ";", "dummy"}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"flattened", "//.", 
          RowBox[{
           RowBox[{
            RowBox[{"a_Symbol", "[", 
             RowBox[{
              RowBox[{"{", "f__", "}"}], ",", 
              RowBox[{"{", "i__", "}"}]}], "]"}], "/;", 
            RowBox[{
             RowBox[{"ContainsAny", "[", 
              RowBox[{
               RowBox[{"{", "i", "}"}], ",", 
               RowBox[{"indices", "\[Union]", 
                RowBox[{"(", 
                 RowBox[{"-", "indices"}], ")"}]}]}], "]"}], "&&", 
             RowBox[{"exclusions", "[", "a", "]"}]}]}], ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"objects", ",", 
               RowBox[{"a", "[", 
                RowBox[{
                 RowBox[{"{", "f", "}"}], ",", 
                 RowBox[{"{", "i", "}"}]}], "]"}]}], "]"}], ";", "dummy"}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "objects", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Expression \\\"\>\"", ",", "expr", ",", 
        "\"\<\\\" is neither an FTerm nor an FEq!\>\""}], "]"}], ";", 
      RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950854493144973*^9, 3.950854569452779*^9}, {
   3.950854604452739*^9, 3.950854680324503*^9}, {3.950854996656869*^9, 
   3.9508550481848717`*^9}, {3.950859645548572*^9, 3.950859785007856*^9}, {
   3.950860303344551*^9, 3.9508603107335377`*^9}, {3.950861168268649*^9, 
   3.950861274048501*^9}, {3.950861304120777*^9, 3.9508613153605413`*^9}, {
   3.950861367012312*^9, 3.9508614126049147`*^9}, {3.950861453960935*^9, 
   3.9508615591409407`*^9}, {3.950861602551324*^9, 3.9508616765664988`*^9}, {
   3.950873227322419*^9, 3.950873227634747*^9}, {3.9508733445328627`*^9, 
   3.9508733890321093`*^9}, {3.9508734300279284`*^9, 
   3.9508735030787888`*^9}, {3.950873533774803*^9, 3.950873574626863*^9}, {
   3.950873628353125*^9, 3.950873634368539*^9}, {3.9508736653917418`*^9, 
   3.950873725638062*^9}, {3.950977542870824*^9, 3.950977615051394*^9}, 
   3.950977666576852*^9, {3.950977824426978*^9, 3.950977824803349*^9}, {
   3.951048475057866*^9, 3.9510485002012367`*^9}, {3.951048586276622*^9, 
   3.951048595044265*^9}, {3.95104863795863*^9, 3.951048654139003*^9}, {
   3.951048871382616*^9, 3.951049094164*^9}, {3.951049522508106*^9, 
   3.951049543225523*^9}, {3.95104967655072*^9, 3.9510497051863403`*^9}, {
   3.9511067302213497`*^9, 3.951106791491743*^9}, {3.951287544996215*^9, 
   3.951287549952241*^9}, {3.951287602973113*^9, 3.9512876756527433`*^9}, {
   3.951287719050293*^9, 3.951287723077393*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"f8e80e20-24a8-4ec6-ba4f-132db5be82fc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SuperIndices", "::", "undeterminedSums"}], "=", 
    "\"\<There are indices with count > 2 in the expression\n    `1`\nThis is \
not allowed for valid terms/equation. Problematic indices:\n    `2`\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"hideSubSuper", "[", "expr_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"expr", "//.", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{"a_Symbol", ",", 
            RowBox[{"b_", ":", 
             RowBox[{"(", 
              RowBox[{"_Integer", "|", "_Symbol"}], ")"}]}]}], "]"}], ":>", 
          RowBox[{"Symbol", "[", 
           RowBox[{
            RowBox[{"ToString", "[", "a", "]"}], "<>", "\"\<SUBSCRIPT\>\"", "<>", 
            RowBox[{"ToString", "[", "b", "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Superscript", "[", 
           RowBox[{"a_Symbol", ",", 
            RowBox[{"b_", ":", 
             RowBox[{"(", 
              RowBox[{"_Integer", "|", "_Symbol"}], ")"}]}]}], "]"}], ":>", 
          RowBox[{"Symbol", "[", 
           RowBox[{
            RowBox[{"ToString", "[", "a", "]"}], "<>", "\"\<SUPERSCRIPT\>\"", 
            "<>", 
            RowBox[{"ToString", "[", "b", "]"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Get", " ", "a", " ", "list", " ", "of", " ", "all", " ", "open", " ", 
     "super"}], "-", 
    RowBox[{
    "indices", " ", "within", " ", "the", " ", "expression", " ", "expr"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetOpenSuperIndices", "[", 
     RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"objects", ",", "indices", ",", "count", ",", "pick"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"objects", "=", 
        RowBox[{"ExtractObjectsWithIndex", "[", 
         RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"indices", "=", 
        RowBox[{"GetAllSuperIndices", "[", 
         RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"count", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{
             RowBox[{"objects", "//", "hideSubSuper"}], ",", "#", ",", 
             "Infinity"}], "]"}], "&"}], ",", 
          RowBox[{"indices", "//", "hideSubSuper"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pick", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"count", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "2"}], "]"}], "==", 
             "0"}], ",", "False", ",", "True"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "indices", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"AnyTrue", "[", 
          RowBox[{"count", ",", 
           RowBox[{
            RowBox[{"#", ">", "2"}], "&"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"SuperIndices", "::", "undeterminedSums"}], ",", "expr", 
            ",", 
            RowBox[{"Pick", "[", 
             RowBox[{"indices", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", ">", "2"}], "&"}], "/@", "count"}]}], "]"}]}], 
           "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Pick", "[", 
         RowBox[{"indices", ",", "pick"}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Get", " ", "a", " ", "list", " ", "of", " ", "all", " ", "closed", " ", 
     "super"}], "-", 
    RowBox[{
    "indices", " ", "within", " ", "the", " ", "expression", " ", "expr"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetClosedSuperIndices", "[", 
     RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"objects", ",", "indices", ",", "count", ",", "pick"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"objects", "=", 
        RowBox[{"ExtractObjectsWithIndex", "[", 
         RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"indices", "=", 
        RowBox[{"GetAllSuperIndices", "[", 
         RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"count", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{
             RowBox[{"objects", "//", "hideSubSuper"}], ",", "#", ",", 
             "Infinity"}], "]"}], "&"}], ",", 
          RowBox[{"indices", "//", "hideSubSuper"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"AnyTrue", "[", 
          RowBox[{"count", ",", 
           RowBox[{
            RowBox[{"#", ">", "2"}], "&"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"SuperIndices", "::", "undeterminedSums"}], ",", "expr", 
            ",", 
            RowBox[{"Pick", "[", 
             RowBox[{"indices", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", ">", "2"}], "&"}], "/@", "count"}]}], "]"}]}], 
           "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"pick", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"count", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "2"}], "]"}], "!=", 
             "0"}], ",", "False", ",", "True"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "indices", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Pick", "[", 
         RowBox[{"indices", ",", "pick"}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Get", " ", "a", " ", "list", " ", "of", " ", "all", " ", "open", " ", 
     "super"}], "-", 
    RowBox[{
    "indices", " ", "within", " ", "the", " ", "expression", " ", "expr"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SuperIndicesValid", "[", 
    RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"objects", ",", "indices", ",", "count"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"objects", "=", 
       RowBox[{"ExtractObjectsWithIndex", "[", 
        RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"indices", "=", 
       RowBox[{"GetAllSuperIndices", "[", 
        RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"count", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{
            RowBox[{"objects", "//", "hideSubSuper"}], ",", "#", ",", 
            "Infinity"}], "]"}], "&"}], ",", 
         RowBox[{"indices", "//", "hideSubSuper"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"AnyTrue", "[", 
         RowBox[{"count", ",", 
          RowBox[{
           RowBox[{"#", ">", "2"}], "&"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"SuperIndices", "::", "undeterminedSums"}], ",", "expr", 
           ",", 
           RowBox[{"Pick", "[", 
            RowBox[{"indices", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"#", ">", "2"}], "&"}], "/@", "count"}]}], "]"}]}], 
          "]"}], ";", 
         RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9508542004410467`*^9, 3.9508544749252157`*^9}, {
   3.950861781076435*^9, 3.950861866017157*^9}, {3.950861904572686*^9, 
   3.950862122741899*^9}, 3.950862250128793*^9, {3.9508623533294363`*^9, 
   3.950862473344803*^9}, {3.950862503549046*^9, 3.950862504168859*^9}, {
   3.950862808761071*^9, 3.95086284882382*^9}, {3.9508724621909122`*^9, 
   3.9508725163422728`*^9}, {3.950872679755715*^9, 3.950872742486643*^9}, {
   3.950873274979582*^9, 3.9508733202595463`*^9}, {3.9508736487671967`*^9, 
   3.950873654067449*^9}, {3.9510491583749323`*^9, 3.951049163421998*^9}, {
   3.951049235218823*^9, 3.951049243994762*^9}, {3.951049428748899*^9, 
   3.951049437502572*^9}, {3.951049503039259*^9, 3.951049505389997*^9}, 
   3.9510495609135113`*^9, {3.9510495984105787`*^9, 3.9510496300825567`*^9}, {
   3.9510497431225443`*^9, 3.951049751762602*^9}, 3.951049797343923*^9, 
   3.951057349023424*^9, {3.951106795019677*^9, 3.951106799162589*^9}, {
   3.951106990904499*^9, 3.951107063520145*^9}, {3.951229079559609*^9, 
   3.9512291363161707`*^9}, {3.951229194557047*^9, 3.9512291970249243`*^9}, {
   3.9512309838719883`*^9, 3.9512310891132097`*^9}, {3.95123115620091*^9, 
   3.951231159935547*^9}, {3.951232161292356*^9, 3.9512322491452513`*^9}, {
   3.951232297416614*^9, 3.951232398748467*^9}, {3.951237216865061*^9, 
   3.951237217320691*^9}, {3.9512874864801893`*^9, 3.951287499658772*^9}, {
   3.9512877098305883`*^9, 3.9512877121256933`*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"9f3b0ea7-2af5-48b1-84b3-46146be887b3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Check", " ", "whether", " ", "all", " ", "indices", " ", "are", " ", 
     "closed", " ", "within", " ", 
     RowBox[{"expr", ".", " ", "\[IndentingNewLine]", "This"}], " ", 
     "disallows", " ", "also", " ", "multiple", " ", "use", " ", "of", " ", 
     "a", " ", "single", " ", "index", " ", "name"}], ",", " ", 
    RowBox[{"!", 
     RowBox[{"anywhere", "!"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"AllIndicesClosed", "[", 
     RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"objects", ",", "indices", ",", "count", ",", "valid"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"objects", "=", 
        RowBox[{"ExtractObjectsWithIndex", "[", 
         RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"indices", "=", 
        RowBox[{"GetAllSuperIndices", "[", 
         RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"count", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{
             RowBox[{"objects", "//", "hideSubSuper"}], ",", "#", ",", 
             "Infinity"}], "]"}], "&"}], ",", 
          RowBox[{"indices", "//", "hideSubSuper"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"valid", "=", 
        RowBox[{"AllTrue", "[", 
         RowBox[{"count", ",", 
          RowBox[{
           RowBox[{"#", "==", "2"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "valid", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.950862410027896*^9, {3.9508628529163237`*^9, 3.9508628920401497`*^9}, 
   3.9510491668196583`*^9, {3.951232402828401*^9, 3.9512324069834948`*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"3edfcfc0-c624-46bc-ab09-a08de412f0d7"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ordering", "Subsection",
 CellChangeTimes->{{3.932178009618313*^9, 3.932178022055203*^9}, {
  3.950801118933737*^9, 3.950801154023693*^9}, {3.9509401502822638`*^9, 
  3.950940151040942*^9}},ExpressionUUID->"1785af53-7c89-486a-9e5f-\
2cc90ee5d4f8"],

Cell[CellGroupData[{

Cell["Setting the canonical ordering", "Subsubsection",
 CellChangeTimes->{{3.950940652516369*^9, 
  3.950940658984301*^9}},ExpressionUUID->"6b5ad42c-f028-4331-8dd5-\
edca6279d9c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$AvailableCanonicalOrderings", "=", 
    RowBox[{"{", 
     RowBox[{
     "\"\<f>af>b\>\"", ",", "\"\<af>f>b\>\"", ",", "\"\<b>f>af\>\"", ",", 
      "\"\<b>af>f\>\""}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CanonicalOrdering", "::", "unknownInteger"}], "=", 
   "\"\<The integer `1` should be between 1 and 4.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CanonicalOrdering", "::", "unknownString"}], "=", 
    RowBox[{"\"\<The expression `1` should be one of \>\"", "<>", 
     RowBox[{"ToString", "[", "$AvailableCanonicalOrderings", "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetCanonicalOrdering", "[", "a_Integer", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Switch", "[", 
        RowBox[{"a", ",", "\[IndentingNewLine]", "1", ",", 
         RowBox[{"$CanonicalOrdering", "=", "\"\<f>af>b\>\""}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "2", ",", 
         RowBox[{"$CanonicalOrdering", "=", "\"\<af>f>b\>\""}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "3", ",", 
         RowBox[{"$CanonicalOrdering", "=", "\"\<b>f>af\>\""}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "4", ",", 
         RowBox[{"$CanonicalOrdering", "=", "\"\<b>af>f\>\""}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "_", ",", 
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"CanonicalOrdering", "::", "unknownInteger"}], ",", "a"}], 
          "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Canonical ordering set to \>\"", ",", "$CanonicalOrdering"}], 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetCanonicalOrdering", "[", "a_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Switch", "[", 
       RowBox[{"a", ",", "\[IndentingNewLine]", "\"\<f>af>b\>\"", ",", 
        RowBox[{"$CanonicalOrdering", "=", "\"\<f>af>b\>\""}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<af>f>b\>\"", ",", 
        RowBox[{"$CanonicalOrdering", "=", "\"\<af>f>b\>\""}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<b>f>af\>\"", ",", 
        RowBox[{"$CanonicalOrdering", "=", "\"\<b>f>af\>\""}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<b>af>f\>\"", ",", 
        RowBox[{"$CanonicalOrdering", "=", "\"\<b>af>f\>\""}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "_", ",", 
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"CanonicalOrdering", "::", "unknownString"}], ",", "a"}], 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Canonical ordering set to \>\"", ",", "$CanonicalOrdering"}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950940153137643*^9, 3.950940313248869*^9}, {
  3.950940364396865*^9, 3.950940626082654*^9}, {3.950947877407638*^9, 
  3.9509478851616173`*^9}, {3.950947925430534*^9, 3.950947963989278*^9}, {
  3.951210780223824*^9, 3.9512107812072353`*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"8223ffc8-f59e-4c33-b04f-02db6763d2e2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Ordering expressions", "Subsubsection",
 CellChangeTimes->{{3.950940652516369*^9, 
  3.950940676916478*^9}},ExpressionUUID->"25f821ed-484b-44c3-bb3d-\
2285af151ba5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Returns", " ", "true", " ", "if", " ", "f1"}], " ", "<", " ", 
     "f2"}], ",", " ", 
    RowBox[{
     RowBox[{"and", " ", "false", " ", "if", " ", "f1"}], " ", ">", " ", 
     "f2"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FieldOrderLess", "[", 
     RowBox[{"setup_", ",", "f1_Symbol", ",", "f2_Symbol"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "kind1", ",", "kind2", ",", "\[IndentingNewLine]", "idxOrder", ",", 
        "\[IndentingNewLine]", "n1", ",", "n2"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kind1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IsGrassmann", "[", 
             RowBox[{"setup", ",", "#"}], "]"}], ",", 
            RowBox[{"IsAntiGrassmann", "[", 
             RowBox[{"setup", ",", "#"}], "]"}], ",", 
            RowBox[{"IscField", "[", 
             RowBox[{"setup", ",", "#"}], "]"}], ",", 
            RowBox[{"IsAnticField", "[", 
             RowBox[{"setup", ",", "#"}], "]"}], ",", 
            RowBox[{"#", "===", "AnyField"}]}], "}"}], "&"}], "[", "f1", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"kind2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IsGrassmann", "[", 
             RowBox[{"setup", ",", "#"}], "]"}], ",", 
            RowBox[{"IsAntiGrassmann", "[", 
             RowBox[{"setup", ",", "#"}], "]"}], ",", 
            RowBox[{"IscField", "[", 
             RowBox[{"setup", ",", "#"}], "]"}], ",", 
            RowBox[{"IsAnticField", "[", 
             RowBox[{"setup", ",", "#"}], "]"}], ",", 
            RowBox[{"#", "===", "AnyField"}]}], "}"}], "&"}], "[", "f2", 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "$CanonicalOrdering", ",", "\[IndentingNewLine]", "\"\<f>af>b\>\"", 
         ",", "\[IndentingNewLine]", 
         RowBox[{"idxOrder", "=", 
          RowBox[{"{", 
           RowBox[{"4", ",", "3", ",", "2", ",", "1", ",", "0"}], "}"}]}], 
         ",", "\[IndentingNewLine]", "\"\<af>f>b\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"idxOrder", "=", 
          RowBox[{"{", 
           RowBox[{"3", ",", "4", ",", "1", ",", "2", ",", "0"}], "}"}]}], 
         ",", "\[IndentingNewLine]", "\"\<b>f>af\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"idxOrder", "=", 
          RowBox[{"{", 
           RowBox[{"2", ",", "1", ",", "4", ",", "3", ",", "0"}], "}"}]}], 
         ",", "\[IndentingNewLine]", "\"\<b>af>f\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"idxOrder", "=", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "0"}], "}"}]}], 
         ",", "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Order failure: order \\\"\>\"", "<>", "$CanonicalOrdering", 
            "<>", "\"\<\\\" unknown.\>\""}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"n1", "=", 
        RowBox[{
         RowBox[{"Pick", "[", 
          RowBox[{"idxOrder", ",", "kind1"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n2", "=", 
        RowBox[{
         RowBox[{"Pick", "[", 
          RowBox[{"idxOrder", ",", "kind2"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"n1", "<", "n2"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9509469386341343`*^9, 3.9509471834252987`*^9}, {
   3.950947223313903*^9, 3.950947224742805*^9}, {3.950947263353957*^9, 
   3.950947275621757*^9}, {3.950947319094739*^9, 3.9509474205587378`*^9}, 
   3.95094746109451*^9, {3.950947500069725*^9, 3.950947678289824*^9}, {
   3.950947722074582*^9, 3.950947766347187*^9}, {3.950947800639678*^9, 
   3.9509478705099792`*^9}, {3.9509479131384983`*^9, 3.950947918497128*^9}, {
   3.950947973835105*^9, 3.950948031631962*^9}, 3.950948064688114*^9, {
   3.951053680094369*^9, 3.951053686753499*^9}, {3.951054284810362*^9, 
   3.9510543614021463`*^9}, {3.951054405821702*^9, 3.951054431637821*^9}, {
   3.9510544720659943`*^9, 3.951054727167162*^9}, {3.951211269076701*^9, 
   3.951211288852489*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"4b678c74-7d06-4764-a1d3-b462e6b01ccf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Returns", " ", "the", " ", "sign", " ", "that", " ", "results", " ", 
    "from", " ", "exchanging", " ", "the", " ", "two", " ", "fields", " ", 
    "f1", " ", "and", " ", "f2"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CommuteSign", "[", 
     RowBox[{"setup_", ",", "f1_", ",", "f2_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"kind1", ",", "kind2"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kind1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"IsGrassmann", "[", 
              RowBox[{"setup", ",", "#"}], "]"}], "||", 
             RowBox[{"IsAntiGrassmann", "[", 
              RowBox[{"setup", ",", "#"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"IscField", "[", 
              RowBox[{"setup", ",", "#"}], "]"}], "||", 
             RowBox[{"IsAnticField", "[", 
              RowBox[{"setup", ",", "#"}], "]"}]}]}], "}"}], "&"}], "[", "f1",
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"kind2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"IsGrassmann", "[", 
              RowBox[{"setup", ",", "#"}], "]"}], "||", 
             RowBox[{"IsAntiGrassmann", "[", 
              RowBox[{"setup", ",", "#"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"IscField", "[", 
              RowBox[{"setup", ",", "#"}], "]"}], "||", 
             RowBox[{"IsAnticField", "[", 
              RowBox[{"setup", ",", "#"}], "]"}]}]}], "}"}], "&"}], "[", "f2",
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"kind1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "&&", 
           RowBox[{"kind2", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9509491238971243`*^9, 3.950949126229731*^9}, {
  3.950949179705824*^9, 3.950949242101665*^9}, {3.9509494626505527`*^9, 
  3.950949470925414*^9}, {3.950951603853833*^9, 3.9509516215042048`*^9}, {
  3.951054737038*^9, 3.951054767618724*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"18065f13-e208-4ab7-83f1-35e867d53bcb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Find", " ", "all", " ", "instances", " ", "of", " ", "$OrderedObjects", 
    " ", "and", " ", "order", " ", "their", " ", "field", " ", "value", " ", 
    "according", " ", "to", " ", "the", " ", "canonical", " ", "scheme"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"OrderObject", "[", 
      RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", "expr"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OrderObject", "[", 
      RowBox[{"setup_", ",", 
       RowBox[{
        RowBox[{"obj_", "[", 
         RowBox[{"fields_List", ",", "indices_List"}], "]"}], "/;", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"$OrderedObjects", ",", "obj"}], "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "i", ",", "j", ",", "curi", ",", "prefactor", ",", "pref", ",", 
         "reverse", ",", "\[IndentingNewLine]", 
         RowBox[{"nfields", "=", "fields"}], ",", 
         RowBox[{"nindices", "=", "indices"}], ",", "\[IndentingNewLine]", 
         "trackedField"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "The", " ", "propagator", " ", "gets", " ", "a", " ", "reverse", " ", 
         "ordering"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"reverse", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"obj", "===", "Propagator"}], ",", "True", ",", "False"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pref", "=", 
         RowBox[{"If", "[", 
          RowBox[{"reverse", ",", "Identity", ",", "Not"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"prefactor", "=", "1"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Always", " ", "compare", " ", "the", " ", "ith", " ", "field", " ",
            "with", " ", "all", " ", "previous", " ", "fields", " ", "and", 
           " ", "put", " ", "it", " ", "in", " ", "the", " ", "right", " ", 
           RowBox[{"place", ".", "\[IndentingNewLine]", "Iterate"}], " ", 
           "until", " ", "one", " ", "reaches", " ", "the", " ", "end", " ", 
           "of", " ", "the", " ", "array"}], ",", " ", 
          RowBox[{"then", " ", "it", " ", "is", " ", 
           RowBox[{"sorted", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "<=", 
           RowBox[{"Length", "[", "nfields", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"curi", "=", "i"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "Check", " ", "if", " ", "we", " ", "should", " ", "switch", " ",
               "curi", " ", "and", " ", "curi"}], "-", "1"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"curi", ">=", "2"}], "&&", 
              RowBox[{"pref", "@", 
               RowBox[{"FieldOrderLess", "[", 
                RowBox[{"setup", ",", 
                 RowBox[{"nfields", "[", 
                  RowBox[{"[", "curi", "]"}], "]"}], ",", 
                 RowBox[{"nfields", "[", 
                  RowBox[{"[", 
                   RowBox[{"curi", "-", "1"}], "]"}], "]"}]}], "]"}]}]}], ",",
              "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"nfields", "[", 
                RowBox[{"[", 
                 RowBox[{"{", 
                  RowBox[{"curi", ",", 
                   RowBox[{"curi", "-", "1"}]}], "}"}], "]"}], "]"}], "=", 
               RowBox[{"nfields", "[", 
                RowBox[{"[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"curi", "-", "1"}], ",", "curi"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"nindices", "[", 
                RowBox[{"[", 
                 RowBox[{"{", 
                  RowBox[{"curi", ",", 
                   RowBox[{"curi", "-", "1"}]}], "}"}], "]"}], "]"}], "=", 
               RowBox[{"nindices", "[", 
                RowBox[{"[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"curi", "-", "1"}], ",", "curi"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"prefactor", "*=", 
               RowBox[{"CommuteSign", "[", 
                RowBox[{"setup", ",", 
                 RowBox[{"nfields", "[", 
                  RowBox[{"[", "curi", "]"}], "]"}], ",", 
                 RowBox[{"nfields", "[", 
                  RowBox[{"[", 
                   RowBox[{"curi", "-", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"curi", "--"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"prefactor", "*", 
          RowBox[{"obj", "[", 
           RowBox[{"nfields", ",", "nindices"}], "]"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OrderFields", "[", 
      RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"OrderObject", "[", 
         RowBox[{"setup", ",", "#"}], "]"}], "&"}], ",", "expr", ",", 
       "Infinity"}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950940680637898*^9, 3.950940703340807*^9}, {
   3.950940753433639*^9, 3.950940770880921*^9}, {3.950940820604183*^9, 
   3.9509408314803343`*^9}, {3.950946867725016*^9, 3.950946867879279*^9}, {
   3.950946910845818*^9, 3.950946916669503*^9}, {3.950948080113351*^9, 
   3.950948364054194*^9}, {3.950948431170244*^9, 3.9509484424895906`*^9}, {
   3.9509487711183453`*^9, 3.9509487713973417`*^9}, {3.950948804373925*^9, 
   3.95094881228995*^9}, {3.950948873358161*^9, 3.950948881330065*^9}, {
   3.950948915158443*^9, 3.950948973463738*^9}, {3.9509490347704144`*^9, 
   3.950949146503368*^9}, {3.950949262758871*^9, 3.9509492803297586`*^9}, {
   3.9509493130620728`*^9, 3.950949346226811*^9}, {3.950949378638241*^9, 
   3.950949437598216*^9}, {3.950949479001645*^9, 3.950949676303194*^9}, {
   3.950949797286953*^9, 3.950949915654313*^9}, {3.95095042176271*^9, 
   3.95095044922293*^9}, {3.950951143743619*^9, 3.950951153673574*^9}, {
   3.9509511839493093`*^9, 3.950951479581605*^9}, {3.950951572049883*^9, 
   3.9509515917025433`*^9}, {3.9509516327864656`*^9, 3.950951696541771*^9}, {
   3.950977443735013*^9, 3.950977444242279*^9}, {3.951054819394979*^9, 
   3.951054841695517*^9}, 3.95121074104852*^9},
 CellLabel->
  "In[126]:=",ExpressionUUID->"4a073111-7191-4734-b32b-1a96840d6461"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["QMeS Compatibility", "Subsection",
 CellChangeTimes->{{3.950951779978003*^9, 
  3.9509517862440367`*^9}},ExpressionUUID->"94391a5f-eb5e-4478-a534-\
7016e4a3f9d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Compatibility", ":", " ", 
    RowBox[{
    "Output", " ", "any", " ", "expression", " ", "in", " ", "a", " ", "Form",
      " ", "which", " ", "looks", " ", "like", " ", "QMeS", " ", "output"}]}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"QMeSNaming", "[", 
      RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", "expr"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"QMeSNaming", "[", 
      RowBox[{"setup_", ",", 
       RowBox[{
        RowBox[{"obj_", "[", 
         RowBox[{"fields_List", ",", "indices_List"}], "]"}], "/;", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"$OrderedObjects", ",", "obj"}], "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "oldCanonicalOrdering", ",", "transf", ",", "prefactor", ",", 
         "\[IndentingNewLine]", "mobj", ",", "mfields", ",", "mindices", ",", 
         "\[IndentingNewLine]", "prefix", ",", "fieldPart", ",", 
         "indexPart"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"QMeS", " ", "follows", " ", "b"}], ">", "af", ">", "f"}], 
         ",", " ", 
         RowBox[{"so", " ", "we", " ", "switch", " ", 
          RowBox[{"temporarily", "!"}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", "$CanonicalOrdering", "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"$CanonicalOrdering", "=", "\"\<b>af>f\>\""}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"transf", "=", 
            RowBox[{"OrderObject", "[", 
             RowBox[{"setup", ",", 
              RowBox[{"obj", "[", 
               RowBox[{"fields", ",", "indices"}], "]"}]}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"prefactor", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"transf", ",", 
            RowBox[{"Times", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "a_"}], "]"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"prefactor", "=", 
            RowBox[{"-", "1"}]}], ";", 
           RowBox[{"transf", "=", 
            RowBox[{"-", "transf"}]}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mobj", "=", 
         RowBox[{"Head", "[", "transf", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mfields", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"List", "@@", "transf"}], ")"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mindices", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"List", "@@", "transf"}], ")"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"prefix", "=", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "obj", ",", "\[IndentingNewLine]", "Propagator", ",", "\"\<G\>\"", 
           ",", "\[IndentingNewLine]", "GammaN", ",", 
           "\"\<\[CapitalGamma]\>\""}], "\[IndentingNewLine]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"fieldPart", "=", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"Map", "[", 
           RowBox[{"ToString", ",", "mfields"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"indexPart", "=", 
         RowBox[{"Flatten", "[", "mindices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"prefactor", "*", 
          RowBox[{
           RowBox[{"Symbol", "[", 
            RowBox[{"prefix", "<>", "fieldPart"}], "]"}], "[", "indexPart", 
           "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"QMeSForm", "[", 
      RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"QMeSNaming", "[", 
          RowBox[{"setup", ",", "#"}], "]"}], "&"}], ",", "expr", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FEq", ":>", "List"}], ",", 
        RowBox[{"FTerm", ":>", "List"}]}], "}"}]}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950950511202754*^9, 3.950950754493911*^9}, {
  3.9509507857536583`*^9, 3.9509511203631363`*^9}, {3.950951490001182*^9, 
  3.950951554042407*^9}, {3.950951710976829*^9, 3.950951737477071*^9}, {
  3.951054861758219*^9, 3.95105491628331*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"ac314d00-9b25-4da1-be23-eabaa3a126f2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Reduce metric factors", "Subsection",
 CellChangeTimes->{{3.950867995958111*^9, 3.9508679992839813`*^9}, {
  3.951108367695386*^9, 3.9511083702282677`*^9}, {3.951108500371646*^9, 
  3.95110850408386*^9}, {3.951293082804921*^9, 
  3.951293105795587*^9}},ExpressionUUID->"ff235384-733f-4abf-8f02-\
504f4ee478e5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"GammaN", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"A", ",", "A"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", "z"}], "}"}]}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.951294180487898*^9, 3.951294180834478*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"b7565136-1813-4aac-8c91-9bf6bcafcf8b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"A", ",", "A"}], "}"}]], "Output",
 CellChangeTimes->{3.9512941812633877`*^9},
 CellLabel->"Out[60]=",ExpressionUUID->"3a9e13f0-4685-4ac4-8f49-f04440f744c6"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ReduceIndices", "[", 
    RowBox[{"setup_", ",", "term_FTerm"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "closedSIndices", ",", "\[IndentingNewLine]", "cases", ",", "i", ",", 
       "allObj", ",", "\[IndentingNewLine]", "subCase", ",", "subObj", ",", 
       "subIndices", ",", "\[IndentingNewLine]", "subsubObj", ",", 
       "\[IndentingNewLine]", "originalCases", ",", 
       RowBox[{"result", "=", "term"}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"TODO", ":", " ", 
       RowBox[{
       "TAKE", " ", "CARE", " ", "OF", " ", "NESTED", " ", "ENTRIES"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"closedSIndices", "=", 
       RowBox[{"GetClosedSuperIndices", "[", 
        RowBox[{"setup", ",", "term"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"cases", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{"term", ",", 
         RowBox[{"\[Gamma]", "[", "__", "]"}], ",", "Infinity"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"originalCases", "=", "cases"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cases", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "}"}], "&"}], ",", 
         RowBox[{"cases", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cases", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "}"}], "&"}], ",", 
         RowBox[{"cases", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "The", " ", "following", " ", "code", " ", "expands", " ", "the", " ", 
         RowBox[{"\[Gamma]", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"f1", ",", "f2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i1", ",", "i2"}], "}"}]}], "]"}], " ", "into", " ", 
         RowBox[{"\[Gamma]", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"f1", ",", 
               RowBox[{"p", "[", "f1", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"f2", ",", 
               RowBox[{"p", "[", "f2", "]"}]}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i1", ",", 
               RowBox[{"p", "[", "i1", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i2", ",", 
               RowBox[{"p", "[", "i2", "]"}]}], "}"}]}], "}"}]}], "]"}]}], 
        ",", " ", 
        RowBox[{"where", " ", "the", " ", 
         RowBox[{"p", "[", "...", "]"}], " ", "are", " ", "the", " ", 
         "\"\<partners\>\""}], ",", " ", 
        RowBox[{
         RowBox[{"i", ".", "e", ".", " ", "the"}], " ", "matching", " ", 
         "indices", " ", "somewhere", " ", 
         RowBox[{"else", ".", " ", "If"}], " ", "no", " ", "partner", " ", 
         "exists"}], ",", " ", 
        RowBox[{
         RowBox[{"p", "[", "...", "]"}], "=", 
         RowBox[{
         "0.", " ", "This", " ", "effectively", " ", "marks", " ", "open", 
          " ", 
          RowBox[{"indices", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"allObj", "=", 
       RowBox[{"ExtractObjectsWithIndex", "[", 
        RowBox[{"setup", ",", "term"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"subIndices", "=", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"cases", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2", ",", "All"}], "]"}], "]"}], "]"}], "//.", 
           RowBox[{
            RowBox[{"Times", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "a_Symbol"}], "]"}], ":>", "a"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"subObj", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"allObj", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Or", "@@", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"subIndices", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "Infinity"}], "]"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "1", ",", 
                   RowBox[{"Length", "[", "subIndices", "]"}]}], "}"}]}], 
                "]"}]}], ")"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"subsubObj", "=", 
             RowBox[{"Select", "[", 
              RowBox[{"subObj", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Head", "[", "#", "]"}], "=!=", "\[Gamma]"}], "&&", 
                 
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"subIndices", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "Infinity"}], 
                  "]"}]}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{
                RowBox[{"Length", "[", "subsubObj", "]"}], "<=", "1"}], "]"}],
               ",", 
              RowBox[{"Abort", "[", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"No", " ", "partner", " ", "exists"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Not", "@", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"closedSIndices", ",", 
                 RowBox[{"subIndices", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{
                 RowBox[{"cases", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1", ",", "j"}], "]"}], "]"}], ",", 
                 "0"}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{
                 RowBox[{"cases", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2", ",", "j"}], "]"}], "]"}], ",", 
                 "0"}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"Continue", "[", "]"}]}]}], "\[IndentingNewLine]", 
             "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Get", " ", "the", " ", "partner", " ", "position"}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"fIdx", "=", 
             RowBox[{
              RowBox[{"FirstPosition", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"subsubObj", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2"}], "]"}], "]"}], "//.", 
                 RowBox[{
                  RowBox[{"Times", "[", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "a_Symbol"}], "]"}], ":>", 
                  "a"}]}], ",", 
                RowBox[{"subIndices", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{
              RowBox[{"cases", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1", ",", "j"}], "]"}], "]"}], ",", 
              RowBox[{"subsubObj", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1", ",", "fIdx"}], "]"}], "]"}]}], "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{
              RowBox[{"cases", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2", ",", "j"}], "]"}], "]"}], ",", 
              RowBox[{"-", 
               RowBox[{"cases", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2", ",", "j", ",", "1"}], "]"}], 
                "]"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "subIndices", "]"}]}], "}"}]}], "]"}], 
         ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "cases", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Now", ",", " ", 
        RowBox[{
        "we", " ", "use", " ", "this", " ", "information", " ", "to", " ", 
         "reduce", " ", "what", " ", "we", " ", "can"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"subCase", "=", 
          RowBox[{"cases", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Let", "'"}], "s", " ", "start", " ", "with", " ", "the", 
           " ", "possible", " ", "zero", " ", 
           RowBox[{"entries", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"FreeQ", "[", 
             RowBox[{
              RowBox[{"subCase", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "AnyField"}], 
             "]"}], "&&", "\[IndentingNewLine]", 
            RowBox[{"FreeQ", "[", 
             RowBox[{
              RowBox[{"subCase", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "0"}], "]"}], "&&",
             "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"subCase", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], "=!=", 
             RowBox[{"GetPartnerField", "[", 
              RowBox[{"setup", ",", 
               RowBox[{"subCase", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}]}]}],
            ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"result", "=", 
             RowBox[{"result", "//.", 
              RowBox[{
               RowBox[{"originalCases", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ":>", "0"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Continue", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"FreeQ", "[", 
             RowBox[{
              RowBox[{"subCase", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "AnyField"}], 
             "]"}], "&&", "\[IndentingNewLine]", 
            RowBox[{"FreeQ", "[", 
             RowBox[{
              RowBox[{"subCase", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "0"}], "]"}], "&&",
             "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"subCase", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}], "=!=", 
             RowBox[{"GetPartnerField", "[", 
              RowBox[{"setup", ",", 
               RowBox[{"subCase", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}]}], "]"}]}]}],
            ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"result", "=", 
             RowBox[{"result", "//.", 
              RowBox[{
               RowBox[{"originalCases", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ":>", "0"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Continue", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"FreeQ", "[", 
             RowBox[{
              RowBox[{"subCase", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "All", ",", "1"}], "]"}], "]"}], ",", 
              "AnyField"}], "]"}], "&&", "\[IndentingNewLine]", 
            RowBox[{"FreeQ", "[", 
             RowBox[{
              RowBox[{"subCase", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "All", ",", "1"}], "]"}], "]"}], ",", "0"}],
              "]"}], "&&", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"subCase", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], "=!=", 
             RowBox[{"GetPartnerField", "[", 
              RowBox[{"setup", ",", 
               RowBox[{"subCase", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}]}], "]"}]}]}],
            ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"result", "=", 
             RowBox[{"result", "//.", 
              RowBox[{
               RowBox[{"originalCases", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ":>", "0"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Continue", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Count", "[", 
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"subCase", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "AnyField"}], 
               "]"}], "+", 
              RowBox[{"Count", "[", 
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"subCase", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "0"}], "]"}]}], 
             ")"}], "===", "4"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<yet\>\"", ",", 
             RowBox[{"subCase", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"subCase", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "===", "1"}], "&&", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"subCase", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}], "===", "1"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<nope\>\"", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Continue", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"repl", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Then", " ", "check", " ", "the", " ", "left", " ", "index"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"cases", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}], "]"}], "===", 
            "2"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"cases", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1", ",", "1", ",", "1"}], "]"}], "]"}], "===", 
              RowBox[{"GetPartnerField", "[", 
               RowBox[{"setup", ",", 
                RowBox[{"cases", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1", ",", "1", ",", "2"}], "]"}], "]"}]}],
                "]"}]}], ",", "\[IndentingNewLine]", "j"}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Then", " ", "the", " ", "right", " ", "one"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"cases", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], "===", 
            "2"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"cases", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1", ",", "2", ",", "1"}], "]"}], "]"}], "===", 
              RowBox[{"GetPartnerField", "[", 
               RowBox[{"setup", ",", 
                RowBox[{"cases", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}]}],
                "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<bye at \>\"", ",", 
               RowBox[{"cases", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ","}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "cases", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "cases", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "result", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReduceIndices", "[", 
    RowBox[{"setup_", ",", "eq_FEq"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ReduceIndices", "[", 
         RowBox[{"setup", ",", "#"}], "]"}], "&"}], ",", "eq"}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.951293099908997*^9, 3.951293103339663*^9}, {
   3.9512931806568193`*^9, 3.95129334745252*^9}, {3.9512934171427307`*^9, 
   3.951293510836471*^9}, {3.951293611801972*^9, 3.951293853237314*^9}, {
   3.951293887468422*^9, 3.951293953965994*^9}, {3.95129399396294*^9, 
   3.951294064842847*^9}, {3.951294101264472*^9, 3.951294287644477*^9}, {
   3.9512943548446093`*^9, 3.951294485308804*^9}, {3.9512945332808113`*^9, 
   3.951294597128996*^9}, {3.95129464639744*^9, 3.951294826041237*^9}, {
   3.951294859626028*^9, 3.951295010576996*^9}, {3.9512950436412888`*^9, 
   3.951295043878949*^9}, {3.951295108137199*^9, 3.951295229401376*^9}, 
   3.9512952650295897`*^9, {3.951295300094865*^9, 3.9512953458849573`*^9}, {
   3.951295378778844*^9, 3.951295466391921*^9}, {3.951295519247057*^9, 
   3.951295569301572*^9}, {3.9512956225456753`*^9, 3.951295710369485*^9}, {
   3.951298137125782*^9, 3.9512981671816883`*^9}, {3.951298198962242*^9, 
   3.951298452885186*^9}, {3.9512985557204123`*^9, 3.951298600800028*^9}, {
   3.9512986439543962`*^9, 3.951298741726343*^9}, {3.9512987775746183`*^9, 
   3.951298854581284*^9}, {3.9512988859108257`*^9, 3.951298897562704*^9}, {
   3.951298969478414*^9, 3.95129907517942*^9}, {3.9512991204834948`*^9, 
   3.9512991542387047`*^9}, {3.951299214315*^9, 3.951299221834786*^9}, {
   3.951299254335927*^9, 3.951299254666767*^9}, {3.9512992847403584`*^9, 
   3.9512992858584137`*^9}, {3.9512994136106977`*^9, 3.951299630254718*^9}, {
   3.951299660818803*^9, 3.951299886891375*^9}, {3.9512999393065987`*^9, 
   3.951300257575531*^9}, {3.951300311539563*^9, 3.951300330416025*^9}, {
   3.9513003793076687`*^9, 3.951300483945078*^9}, 3.9513007734119043`*^9},
 CellLabel->
  "In[338]:=",ExpressionUUID->"4b71f7d2-f04e-43f5-b54d-39e57cffabf7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Is", " ", "an", " ", "index", " ", 
    RowBox[{"down", "?"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"isNeg", "[", "i_", "]"}], ":=", 
     RowBox[{"MatchQ", "[", 
      RowBox[{"i", ",", 
       RowBox[{"Times", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "a_Symbol"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"makePosIdx", "[", "i_", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"isNeg", "[", "i", "]"}], ",", 
       RowBox[{"-", "i"}], ",", "i"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"AntiGrassmann", "-", 
      RowBox[{"Grassmann", " ", "gives", " ", "1"}]}], ",", " ", 
     RowBox[{"otherwise", " ", "-", "1"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GrassOrder", "[", 
      RowBox[{"setup_", ",", "f1_", ",", "f2_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sign", "=", 
         RowBox[{"CommuteSign", "[", 
          RowBox[{"setup", ",", "f1", ",", "f2"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"sign", "===", "1"}], ",", 
          RowBox[{"Return", "[", "1", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"IsGrassmann", "[", 
           RowBox[{"setup", ",", "f1"}], "]"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"-", "1"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "1", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Return", " ", 
      SubscriptBox["\[Gamma]", "ab"]}], " ", "=", " ", 
     RowBox[{
      SuperscriptBox["\[Gamma]", "ab"], " ", "=", " ", 
      RowBox[{
       RowBox[{"(", GridBox[{
          {"0", 
           RowBox[{"-", "1"}]},
          {"1", "0"}
         }], ")"}], " ", "and", " ", "ordering", " ", 
       RowBox[{"(", 
        RowBox[{"\[Psi]", ",", " ", 
         OverscriptBox["\[Psi]", "_"]}], ")"}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"metric", "[", 
      RowBox[{"setup_", ",", "a_", ",", "b_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f1", "=", 
          RowBox[{"a", "//.", 
           RowBox[{
            RowBox[{"Times", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "c_Symbol"}], "]"}], ":>", "c"}]}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"f2", "=", 
          RowBox[{"b", "//.", 
           RowBox[{
            RowBox[{"Times", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "c_Symbol"}], "]"}], ":>", "c"}]}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"lower", "=", 
          RowBox[{"Map", "[", 
           RowBox[{"isNeg", ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "f2p", ",", "sign"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f2p", "=", 
         RowBox[{"GetPartnerField", "[", 
          RowBox[{"setup", ",", "f2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sign", "=", 
         RowBox[{"CommuteSign", "[", 
          RowBox[{"setup", ",", "f1", ",", "f2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Does", " ", "not", " ", "fit", " ", "the", " ", "partner", " ", 
           "field"}], " ", "->", "0"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"f1", "=!=", "f2p"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Return", "[", "0", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Grassmann", " ", "without", " ", "partner"}], " ", "->", 
          "0"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"f1", "===", "f2"}], "&&", 
           RowBox[{"sign", "=!=", "1"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Return", "[", "0", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          SubscriptBox[
           SuperscriptBox["\[Gamma]", "a"], "b"], " ", "=", " ", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "ab"], 
           SubscriptBox[
            SuperscriptBox["\[Delta]", "a"], "b"]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"lower", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "&&", 
           RowBox[{"lower", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"Return", "[", "sign", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Gamma]", "a"], "b"], " ", "=", " ", 
          SuperscriptBox[
           SubscriptBox["\[Delta]", "a"], "b"]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"lower", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "&&", 
           RowBox[{"Not", "[", 
            RowBox[{"lower", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"Return", "[", "1", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Otherwise", ",", " ", 
          RowBox[{
           SuperscriptBox["\[Gamma]", "ab"], " ", "or", " ", 
           SubscriptBox["\[Gamma]", "ab"]}]}], "*)"}], "\[IndentingNewLine]", 
        
        RowBox[{"Return", "[", 
         RowBox[{"GrassOrder", "[", 
          RowBox[{"setup", ",", "f1", ",", "f2"}], "]"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.951303744159573*^9, 3.9513037989744387`*^9}, {
  3.951303843582143*^9, 3.951303870050048*^9}, {3.9513039622742357`*^9, 
  3.951304155282446*^9}, {3.951304199642703*^9, 3.951304285719481*^9}, {
  3.951304663115595*^9, 3.951304692218692*^9}},
 CellLabel->
  "In[490]:=",ExpressionUUID->"b7774a84-ac87-42fd-842d-b4b0fef4ae7a"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"MakeIdxRule", "[", 
    RowBox[{"setup_", ",", "i1_", ",", "i2_", ",", "f1_", ",", "f2_"}], "]"}],
    ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"coeff", ",", "sig"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"coeff", "=", 
       RowBox[{"FCoeff", "[", 
        RowBox[{"setup", ",", "f1", ",", "f2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sig", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"isNeg", "[", "i1", "]"}], ",", 
         RowBox[{"isNeg", "[", "i2", "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{"sig", ","}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9513026532932*^9, 3.9513030235896072`*^9}, {
  3.951303066473933*^9, 3.951303190727026*^9}, {3.951303246934038*^9, 
  3.9513034161740923`*^9}, {3.9513034858386374`*^9, 3.951303564826015*^9}, {
  3.951303615612461*^9, 
  3.9513037319676437`*^9}},ExpressionUUID->"c9003c35-4657-4bce-afe4-\
e0f49513a564"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FEq", "[", 
  RowBox[{
   RowBox[{"FTerm", "[", "2", "]"}], "**", 
   RowBox[{"FTerm", "[", 
    RowBox[{"a", ",", "b"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.951304352810367*^9, 3.9513043859692373`*^9}},
 CellLabel->
  "In[473]:=",ExpressionUUID->"20ecc2f0-10c5-4d34-85b0-76fc7ccdb97b"],

Cell[BoxData[
 RowBox[{"FEq", "[", 
  RowBox[{"FTerm", "[", 
   RowBox[{
    RowBox[{"2", " ", "a"}], ",", "b"}], "]"}], "]"}]], "Output",
 CellChangeTimes->{{3.9513043567855*^9, 3.951304386293581*^9}},
 CellLabel->
  "Out[473]=",ExpressionUUID->"7bcc71a3-8fd0-4a3f-9044-3da1b16e4767"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ReduceIndices", "[", 
      RowBox[{"setup_", ",", "term_FTerm"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "closedSIndices", ",", "\[IndentingNewLine]", "cases", ",", "i", ",", 
         "allObj", ",", "\[IndentingNewLine]", "subCase", ",", "subObj", ",", 
         "subIndices", ",", "\[IndentingNewLine]", "subsubObj", ",", "closed",
          ",", "\[IndentingNewLine]", "idx1Rule", ",", "idx2Rule", ",", "f1", 
         ",", "f2", ",", "bothDown", ",", "\[IndentingNewLine]", 
         "originalCases", ",", 
         RowBox[{"result", "=", "term"}]}], "\[IndentingNewLine]", "}"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"closedSIndices", "=", 
         RowBox[{"GetClosedSuperIndices", "[", 
          RowBox[{"setup", ",", "term"}], "]"}]}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"cases", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{"term", ",", 
           RowBox[{"\[Gamma]", "[", "__", "]"}], ",", "Infinity"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"cases", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"cases", ",", 
           RowBox[{
            RowBox[{"FreeQ", "[", 
             RowBox[{"#", ",", "AnyField", ",", "Infinity"}], "]"}], "&"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"closed", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"closedSIndices", ",", 
              RowBox[{"#", "//.", 
               RowBox[{
                RowBox[{"Times", "[", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "a_Symbol"}], "]"}], ":>", 
                "a"}]}]}], "]"}], "&"}], ",", 
           RowBox[{"cases", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"cases", "=", 
         RowBox[{"Pick", "[", 
          RowBox[{"cases", ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "||", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "&"}], ",", "closed"}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"closed", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"closedSIndices", ",", 
              RowBox[{"#", "//.", 
               RowBox[{
                RowBox[{"Times", "[", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "a_Symbol"}], "]"}], ":>", 
                "a"}]}]}], "]"}], "&"}], ",", 
           RowBox[{"cases", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "closed", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"result", "=", 
            RowBox[{"result", "//.", 
             RowBox[{
              RowBox[{"cases", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ":>", "1"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"bothDown", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"isNeg", "[", 
                RowBox[{"cases", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2", ",", "1"}], "]"}], "]"}], "]"}], "&&", 
               RowBox[{"isNeg", "[", 
                RowBox[{"cases", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2", ",", "2"}], "]"}], "]"}], "]"}]}], 
              ",", 
              RowBox[{"-", "1"}], ",", "2"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"idx1Rule", "=", 
            RowBox[{
             RowBox[{"makePosIdx", "[", 
              RowBox[{"cases", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2", ",", "1"}], "]"}], "]"}], "]"}], "->", 
             
             RowBox[{"bothDown", "*", 
              RowBox[{"makePosIdx", "[", 
               RowBox[{"cases", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2", ",", "2"}], "]"}], "]"}], "]"}]}]}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"idx2Rule", "=", 
            RowBox[{
             RowBox[{"makePosIdx", "[", 
              RowBox[{"cases", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2", ",", "2"}], "]"}], "]"}], "]"}], "->", 
             
             RowBox[{"bothDown", "*", 
              RowBox[{"makePosIdx", "[", 
               RowBox[{"cases", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2", ",", "1"}], "]"}], "]"}], "]"}]}]}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"idx1Rule", ",", "idx2Rule"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"f1", "=", 
            RowBox[{"cases", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"f2", "=", 
            RowBox[{"cases", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"result", "=", 
            RowBox[{
             RowBox[{"FTerm", "[", 
              RowBox[{"metric", "[", 
               RowBox[{"setup", ",", "f1", ",", "f2"}], "]"}], "]"}], "**", 
             RowBox[{"(", 
              RowBox[{"result", "//.", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"closed", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "idx1Rule", 
                 ",", "idx2Rule"}], "]"}]}], ")"}]}]}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "cases", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "cases", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "result", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ReduceIndices", "[", 
      RowBox[{"setup_", ",", "eq_FEq"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ReduceIndices", "[", 
           RowBox[{"setup", ",", "#"}], "]"}], "&"}], ",", "eq"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReduceIndices", "[", 
     RowBox[{"Setup", ",", "\[IndentingNewLine]", 
      RowBox[{"FEq", "[", 
       RowBox[{"FTerm", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Gamma]", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"cb", ",", "c"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "aa"}], ",", 
             RowBox[{"-", "bb"}]}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"\[Gamma]", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"c", ",", "cb"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "x"}], ",", 
              RowBox[{"-", "y"}]}], "}"}]}], "]"}], 
          RowBox[{"GammaN", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"cb", ",", "AnyField"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", "z"}], "}"}]}], "]"}], 
          RowBox[{"\[Gamma]", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"AnyField", ",", "A"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "z"}], ",", 
              RowBox[{"-", "g"}]}], "}"}]}], "]"}]}], ",", "b", ",", "c"}], 
        "\[IndentingNewLine]", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], "//", 
    RowBox[{
     RowBox[{"FPrint", "[", 
      RowBox[{"Setup", ",", "#"}], "]"}], "&"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReduceIndices", "[", 
     RowBox[{"Setup", ",", "\[IndentingNewLine]", 
      RowBox[{"FEq", "[", 
       RowBox[{"FTerm", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Gamma]", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"AnyField", ",", "AnyField"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "aa"}], ",", 
             RowBox[{"-", "bb"}]}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"\[Gamma]", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"cb", ",", "c"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "x"}], ",", 
              RowBox[{"-", "y"}]}], "}"}]}], "]"}], 
          RowBox[{"GammaN", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"cb", ",", "AnyField"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", "z"}], "}"}]}], "]"}], 
          RowBox[{"\[Gamma]", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"AnyField", ",", "A"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "z"}], ",", 
              RowBox[{"-", "g"}]}], "}"}]}], "]"}]}], ",", "b", ",", "c"}], 
        "\[IndentingNewLine]", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.951300785349235*^9, 3.9513009564539337`*^9}, {
  3.951301035377817*^9, 3.9513011665740213`*^9}, {3.951301225543013*^9, 
  3.951301236678216*^9}, {3.951301282098599*^9, 3.951301346441934*^9}, {
  3.9513014157148848`*^9, 3.951301622525878*^9}, {3.951304318827338*^9, 
  3.95130433289494*^9}, {3.951304377102706*^9, 3.9513044134229794`*^9}, {
  3.951304453206748*^9, 3.951304456090837*^9}, {3.95130449455897*^9, 
  3.9513045456587973`*^9}, {3.951304582937003*^9, 3.9513046552791443`*^9}, {
  3.951304700567832*^9, 3.951304762946992*^9}},
 CellLabel->
  "In[502]:=",ExpressionUUID->"43985720-cee5-4d43-b10f-0ff857cd9f45"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"False", ",", "True"}], "}"}], "}"}]], "Print",
 CellChangeTimes->{{3.951300871421281*^9, 3.951300919135776*^9}, {
   3.951301127497387*^9, 3.951301167029838*^9}, 3.951301237080329*^9, 
   3.95130128581881*^9, 3.9513013470021544`*^9, {3.9513014287506742`*^9, 
   3.951301460301876*^9}, 3.951304547137569*^9, {3.9513045969629498`*^9, 
   3.951304621354989*^9}, {3.9513047263336906`*^9, 3.951304764623678*^9}},
 CellLabel->
  "During evaluation of \
In[502]:=",ExpressionUUID->"52894274-6c25-446c-a400-455bcaaaff9d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"x", "\[Rule]", 
    RowBox[{"-", "y"}]}], "\[InvisibleSpace]", 
   RowBox[{"y", "\[Rule]", 
    RowBox[{"-", "x"}]}]}],
  SequenceForm[$CellContext`x -> -$CellContext`y, $CellContext`y -> \
-$CellContext`x],
  Editable->False]], "Print",
 CellChangeTimes->{{3.951300871421281*^9, 3.951300919135776*^9}, {
   3.951301127497387*^9, 3.951301167029838*^9}, 3.951301237080329*^9, 
   3.95130128581881*^9, 3.9513013470021544`*^9, {3.9513014287506742`*^9, 
   3.951301460301876*^9}, 3.951304547137569*^9, {3.9513045969629498`*^9, 
   3.951304621354989*^9}, {3.9513047263336906`*^9, 3.951304764624435*^9}},
 CellLabel->
  "During evaluation of \
In[502]:=",ExpressionUUID->"4e1591df-aba9-49a1-a4b2-991798ccfaa4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\[Gamma]", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"c", ",", "cb"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "x"}], ",", 
      RowBox[{"-", "y"}]}], "}"}]}], "]"}], "}"}]], "Print",
 CellChangeTimes->{{3.951300871421281*^9, 3.951300919135776*^9}, {
   3.951301127497387*^9, 3.951301167029838*^9}, 3.951301237080329*^9, 
   3.95130128581881*^9, 3.9513013470021544`*^9, {3.9513014287506742`*^9, 
   3.951301460301876*^9}, 3.951304547137569*^9, {3.9513045969629498`*^9, 
   3.951304621354989*^9}, {3.9513047263336906`*^9, 3.951304764625263*^9}},
 CellLabel->
  "During evaluation of \
In[502]:=",ExpressionUUID->"48c514ec-81cb-4f07-a252-5918c0327fbd"]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[
  {Thickness[0.009702144173862424], 
   FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1,
     3, 3}}}, {{{9.29219, 8.2875}, {9.29219, 8.526560000000002}, {
    9.065629999999997, 8.526560000000002}, {8.898439999999999, 
    8.526560000000002}, {2.3859399999999997`, 8.526560000000002}, {
    2.2187499999999996`, 8.526560000000002}, {1.99219, 8.526560000000002}, {
    1.99219, 8.2875}, {1.99219, 8.04844}, {2.2187499999999996`, 8.04844}, {
    2.3859399999999997`, 8.04844}, {8.898439999999999, 8.04844}, {
    9.065629999999997, 8.04844}, {9.29219, 8.04844}, {9.29219, 8.2875}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
     3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJzIGYC4uTYO27MKwwcfE6w287equKAzr8tXZNotNTA
IQ0Enqk4zASBTgR/BpSfCuX7X5wY868YIR8hvv0iQ56BwwbVJ83zzkLNzzBw
MLPZGzTtIFT/T32H+67xjrMUlR3Ep17hzHDSd3gA4jcqQs3Vg/A3Kji8KN4q
+jtbzyFGNULmnI08RP0iXYftwVYR/9mlIe6equvAAAIJsg4JIUHqCzp1Iea0
KTg8ADlogY5D+eFtrjPXKkHE1XQcwjnF2o3vKzvoK8p/yQnTdvj59vUBS2VV
iHtnaML5cxYp7/yzXA3OB/uLV9XBGASSFeH825qya/4fVoDzz4BAj4LDDoem
R8ctEPwZE/irzLwRfAmQf5ow+R8WrVc4O0PB4RHY/VD+CyhfQc3hDsi+ZCWH
ht9WBedWqEP8P0HZgZmzSz7ZTxPOh/kfxj9/NeyNvrSuw5d9H7emb5OH89+0
5XYb/ZaC88Hx/lPcQWJenObpDzoOHmuOLmf4IebwBhQfp3UcDnbvazJhFnNI
AIVXhI7DWZD7eYQd1oP836vt8B8E7Lng/IAnnpdMJ7PD+WD/nmGDqJuv7WAC
Cs/PrA4yIPsuIPhgZTo6cL4vKL0l60DcJ8np4L6/VtZiuY7Di9rH2eff8DjU
fNoQkG2l61B9/8ct49VCDicOO63NjNN1EKmcVHL2iIjD8yztb9NrdR0Udi3Y
l7pOzOHorh29bBN0HdoU2FXPXBGHpLfXevDwgaVflWuPghnmKDvYV0asMK01
gKSnv8rw/ANOH4sx8xMA91N+hQ==
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 
    3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGINIGYC4pkg8NLYIT0NCJbxO8D4rQrsqmdMBByeJC68
ZnIewdd4y7vP4CSCr/qked7ZXQh+4Zru2xkbjB3OgICOgMMW8x+HUlYZO1zn
vS2Wuo3fYaNe3mLGOcYOMhvF5jMl8DmYGANBsrHD130ft6aHcTo0shztN5xu
BOfX/7YqOCeB4BuD1Rs6pILcm8YD56t/Unk566UQnM8AAg3iDtxuqqVMvwwd
ZoH8ZSkJ8U+/EZzf7fWKxWQhgv88S/vbdF5jON9Aa6XwhRBY+Eg4ODQ9Oj5D
2tghWjVC5lyMhMPi+/v45ggbO4S8vfxxxkJxOB9svwOCf7B7X5NJshgkPKyg
8gdEHZaA5IsRfF7/9VNSVyD44PC5bAyhg8Xg/J3BVhH/3cXh/CCQ/Y6SDvwg
/R7GDl9A4WUmBQm/DiM4H+y/XENU/loDSHytEYPzg0HmPRSC81/UPs4+v4bX
YfkLD73/jYYOdiWOtadj2B0Oti0PP9VkBOdLTL3CmbHIGM6HpacDIP8/5nNA
T28APegGSQ==
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
     0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}}, {{
     1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGAQA2IQbQwCzRYOwW8vf5zxUMgBxk8DgWdiDj1er1hMNpo7
nAEBHikHHv/1U1J3mMH5jSxH+w3FEfwl9/fxzdls6iC/a8G+1HUSDjLz4jRP
TzB1eNOW220kjeCvFdLhS+dThPATTBweuMY7znqoAOdX3/9xyzhawcGh6dHx
Ga8R/I16eYsZ/5hA9Nsh+GD738jB+f/BgN1h2gT+KjNrUzj/QK2sRXqLqYMJ
yJ+fuR18TrDbzt5q6qD+SeXlrJOcDnekaxKNRM0c7Eoca0/HsDswgMACBP9Q
2/LwU4vM4XxYeNmC+HN4HdDDEwAHj5Vn
     "], CompressedData["
1:eJxTTMoPSmViYGCQAmIQHSG+/SLDOXMH9U8qL2e9FHKA8eV3LdiXqofgf933
cWv6NX6HA7WyFukt5g5fwHweB9UnzfPOWpk7bPfaYDHnJ6fDtAn8VWa3zRzS
QECN0yEl9o4b8wwE/8vOW11/TRF8sHlPTB1iVCNkzu3hcniSuPCayXpTh60g
8yx5HW4IfXI8P83UoTei25+xgA/OZwCBBgT/Ou9tsdRt/HD+A9d4x1mCYnD+
GRBYg+BHge0Tc/A5wW47e6upQx/I/ABxB5l5cZqnP5g6RIPkayQcCtZ0384I
MHPYEWwV8V9d0iFGwfFj8hoEH+wPMXM4/yvIf6nmDlX3f9wy1pZwKNkq+vt0
HzS8zMQderxesZhsNHd405bbbRQtBg9fsP9tRB3Q4wMAIYqxrQ==
     "]}], 
   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0,
      1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
     0}}}, {CompressedData["
1:eJxTTMoPSmViYGAwBmIQra+1UviCi42D/K4F+1L7pBxg/DVCOnzp96QdYhQc
PybzYPJnzAQBKTg/RjVC5lwMgq/+SeXlLE9JB5l5cZqnL1jD+WDzp2DyYfph
fJj5MP72YKuI/+3ycP7Kby8rzjxQcFhyfx/fHGZrh/eL1iuc7VB0SIi948Yc
YQXnnzjstDaTD8EHGxtpCTG/EsEHy1cowPl782vezlRVcLglXZNoVGrpIFI5
qeTsEaj9SxD8Hq9XLCYXEXywfe8Q+lH4pQj+6TNAsEbBYfkLD73/Dy3h/klP
A4JjUPf9VHCo/21VcO6HpQN/bMB9I3VFB58T7LazXa3gfLB7QhD8P99KH8w5
aIWqXtQaYu4yBTj/TVtut1G1PJwfAQr/O3IOTxIXXjM5b+XQG9Htz3hBDm7+
ge59TSaH5RxugMLjKdS/KnIO/0Gg3tLBfc3R5QwzZB36gktUpstbQtQ3y8D5
4Ph+KQXn7wDF53EJiP8PQuU1JRzU3/LuM7C0gvM53FRLmXYh+GB/sFk7VN3/
cctYW9IhBRTfGtYOJsZAICzlcKBtefgpI2uHNgV21TNXJCD+S7V22Amyz13C
YfoE/iqz2Qg+OP4WIviw9I/Oh+UPAGHnUzk=
     "], {{27.084400000000002`, 6.949999999999999}, {27.084400000000002`, 
     6.32656}, {26.4688, 6.231249999999999}, {26.27809999999999, 
     6.231249999999999}, {25.9547, 6.231249999999999}, {25.650000000000002`, 
     6.42969}, {25.650000000000002`, 6.728129999999999}, {25.650000000000002`,
      7.062499999999997}, {25.9719, 7.499999999999999}, {27.084400000000002`, 
     7.53594}, {27.084400000000002`, 6.949999999999999}}}], 
   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0,
      1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
     0}}}, {CompressedData["
1:eJxTTMoPSmViYGAwBmIQnRJ7x435h72D/K4F+1L7pBxg/DVCOnzp96QdeoNL
VKbvx+TPmAkCUnB+jGqEzLkYBF/9k8rLWZ6SDr4XJ8b8a0bwweZ7YPJh+mF8
mPkw/vZgq4j/7fJw/spvLyvOPFBwuC70yfH8NjuH94vWK5ztUHSYMoG/yowb
wf/zrfTBnIO2cP4ZEOCxhZhfieCD5SsU4Py9+TVvZ6oqOPD4r5+SqmHrIFI5
qeTsEXmHBJD9EQj+/lpZi/QWBB9s30KEfhR+KYJ/GmTPGgWHG9I1iUZTbeH+
gbgL6r6fCg4b9PIWM66xdeCPDbhvpK7oUPvbquDcDwQfHB4cdnC+vtZK4Qsl
CH49SP0JO4f0NCBYpgDnv2nL7TaqlofzI0Dhf0fOQXzqFc6MJjuH3ohuf8YL
cnDzD3TvazI5LAcJjxlQ/6rIOZgYg4Ctg/uao8sZZsg6HGhbHn7qkg1EfbMM
nA+O75dScP4OUHwel4D4v9QWIq8p4RCj4Pgx+Q2Cb1MZscI01w7OB4fLTjuH
qvs/bhlrSzpMBcX3bTuIO4SlHL7svNX196mdQ5sCu+qZKxKQ8JKwd9gJss9d
wuHEYae1mX4I/l5Q/IUg+LD0j86H5Q8AEz5kjA==
     "], {{30.7844, 6.949999999999999}, {30.7844, 6.32656}, {
     30.168799999999994`, 6.231249999999999}, {29.978099999999998`, 
     6.231249999999999}, {29.654700000000005`, 6.231249999999999}, {
     29.349999999999994`, 6.42969}, {29.349999999999994`, 
     6.728129999999999}, {29.349999999999994`, 7.062499999999997}, {
     29.671899999999994`, 7.499999999999999}, {30.7844, 7.53594}, {30.7844, 
     6.949999999999999}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
     3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJtIGYCYtUnzfPOKjk5yGwUm8+0gM8BxjcxBgF+B1fV
UqZZEk4O6WlAsIzf4Q3vPoOZQgj+/lpZi3QeBD/h8GXtVE6o/mJ+h/bl4aeM
WJwcfJ94XjIV5newb3p0fMZmRweQ8jQ1ToeZIOCI4D9JXHjNRB/B/w8C3x3g
fLB5ZxwcGEDAgRvOr77/45YxtwCcD3Z+saCDO8j9Dxwg7rksAvGPgKPDGTAQ
cxD+5Hg+zdbR4cu+j1vTp0k48Pivn5Ja4OiwI9gq4r+6pIP5taO5JjMQfLB/
lyD42Zw/F6RfdoS4U17SQd7xY/KZt44OrQrsqmdMJBw26uUtZjzi6FAFdp+E
Q/FW0d+ntzk6KOxasC+VTxzOB8tni8H5a4V0+NLrRB16vF6xmFx0dIhRjZA5
ZyPqMN9G58qsewg+ODwfI/ifNwRkzxJ3guiPQ/D7Irr9GQPE4fygt5c/znCE
+ucKNDx4pCDhPx3BB8crG4IPjq9KB4j/l4vC+fdd4x1nGQrC+eDwDOOB+H+P
g4NdiWPt6Rh2h5vSNYlGuo5wvv6EBT8MzyH4sPQHiR9eB/T0CQApfR2B
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
     0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}}, {{
     1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}}}, {CompressedData["
1:eJxTTMoPSmViYGAQA2IQfSk/nv0co4vDeiEdvvQ4KQcYX/2TystZnrIOTxIX
XjNZ7+zw9z8Q7Jd38D7BbjvbFcFnWTzJilEWwU88fFk79aOTg0jlpJKzKfIO
FRErTM+ednL4su/j1vQwOTifPzbgvtFzJQfVJ83zzgY5OezJr3k78yiCvxbk
Hj8lB17/9VNSOxB8sHv6nRzeL1qvcNYCwe+08dyVtkgRzjcxBgFRB/umR8dn
rEbw09OA4JiTgwbIfyvFHHhA5j+Aym8Wdfi8ISB7FrszxL3fRBwO1MpapNsg
+CVbRX+fXobgw8KrTYFd9UyIuAN6eAIAQ6ScQA==
     "], CompressedData["
1:eJxTTMoPSmViYGAQAWIQ3eP1isVkp7PDeiEdvvQ4KQcY32PN0eUMN0QdEg5f
1k71dHaYCQI7RR1cVUuZZlkg+OlpQCCH4AeXqEz//8MJov+HqIP41CucGbec
HL7s+7g13UzcoXir6O/T55wc+iK6/Rk3IPhRqhEy5/Yg+Pdd4x1nGUrA+SKV
k0rOqsg6zLfRuTLrGdS8MDmHKd/Y4meIODvEgPT/kXMIAdnvgOCD3ZWJJt8B
5cfIObzh3Wcwc5azgzvIvTtkHX7H5B79t8nZQf2TystZJ2Xg4QFWP0faAT28
ANKoivY=
     "]}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1,
      3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 
     3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}}}, {CompressedData["
1:eJxTTMoPSmViYGAQA2IQfSk/nv0co5vDeiEdvvQ4KQcYX/2TystZnrIOTxIX
XjNZ7+rw9z8Q7Jd38DrBbjvbFcFnWTzJilEWwU88fFk79aOLg0jlpJKzKfIO
FRErTM+ednH4su/j1vQwOTifPzbgvtFzJQfVJ83zzga5OOzJr3k78yiCvxbk
Hj8lB17/9VNSOxB8sHv6XRzeL1qvcNYCwe+08dyVtkgRzjcxBgFRB4emR8dn
rEbw00DgmIuDBsh/K8UceEDmP4DKbxZ1+LQhIHsWuyvEvd9EHA7Uylqk2yD4
JVtFf59ehuDDwqtNgV31TIi4A3p4AgBgzJxq
     "], CompressedData["
1:eJxTTMoPSmViYGAQAWIQ3eP1isVkp6vDeiEdvvQ4KQcY32PN0eUMN0QdEg5f
1k71dHWYCQI7RR1cVUuZZlkg+GkgIIfgh5SoTP//wwWi/4eog8TUK5wZt1wc
vuz7uDXdTNyhZKvo79PnXBz6Irr9GTcg+FGqETLn9iD4913jHWcZSsD5IpWT
Ss6qyDrMs9G5MusZ1LwwOYcp39jiZ4i4OsSA9P+Rg9jvgOCD3ZWJJt8B5cfI
Obzh3Wcwc5argzvIvTtkHX7F5B79t8nVQf2TystZJ2Xg4QFWP0faAT28AO7o
iyE=
     "]}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
     3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJzIGYC4vrfVgXnHng6+Jxgt529VcUBnb/jVtff1Pue
Dmkg8EzFYcZMILiI4E+H8lOh/JKtor9PH0PIV0SsMD172NNhg+qT5nlnoeYf
8HQws9kbNO2gioMxCHR7Otx3jXecpajsIPTJ8XxarKfDAxC/URFijhuUv1HB
4bim1aTT6p4OMaoRMuds5B2EQeq/ejhsD7aK+M8u7XB/H98c408eDgwgkCDr
8CRx4TWT9x4Q97UpOLAunmTFuNXDofzwNteZa5Ug5k/zcAjnFGs3vq/sID71
CmdGkofDz7evD1gqqzqAnf3JHc4H+88Mwbe4djTX5IIbxB/JinD+bU3ZNf8P
K8D5Z0CgR8HhT0zu0X+3EPxPGwKyZ91H8EVA/nmLyf+waL3C2RlQ93+F8l9A
+aLuDndA9iUrOazpvp3BUO4O8f8EZQce//VTUh8g+DD/w/j2TY+Oz7js4fBl
38et6dvk4fw3bbndRr+l4HxQNM/8Ke4QXKIy/f8JDwePNUeXM/wQg8THfg+H
g937mkyYxSDhtcjD4SzI/TzCDuYg/xd4OPwHAXsuOD/giecl08nscD7Yv2fY
IHSJh4MJKDw/s0Lsa0DwweZMR/DlHT8mn1kKdZ8kp8M8G50rs7Z5OLyofZx9
/g2PQzbnzwXptz0cqu//uGW8Wshhf62sRfoTDweRykklZ4+IOLQtDz9l9MbD
QWHXgn2p68Qc6kDp84OHQ5sCu+qZK+IQ/7l7wsMHln5Vrj0KZpij7JADMv+0
JyQ9/VWG5x9w+liMmZ8Ao3CU4A==
    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
     0}}}, {CompressedData["
1:eJxTTMoPSmViYGAwBmIQvUEvbzHjGW+HtUI6fOn3BBxQ+POEHPbXylqkr8HB
B6qH8WU2is1nUuB3uCNdk2g019thzkwgkORzOK5pNel0O4K//IWH3v9ETL5I
5aSSsy0CcD7MfBR+nTicvx7sHimHHq9XLCaM3g5f9n3cmm4mA3HPEi84H2y/
vxeqPIuXwwPXeMdZhtJwPlheTBLOD357+eMMRQmHC/nx7OckvRwUdi3Yl9on
7tC+PPyUkQmCX//bquBcAJp8ipfDfbD5EnC+PEieTxLOB9t/UdLhDAiEeDnE
qEbInIuRckhPAwI7L2h4SKGqD5R2MDEGgtkIvsTUK5wZixD8HM6fC9JvI/hT
vrHFzxDxhugTloLzwf4tE4fzQdExs1LMIeHwZe3Um14OQSD/J4o5sCyeZMU4
1cthZ7BVxH93MQcFx4/JZ3xh7hWFpJcvng4gZ6epiTi8591nMPORJ8RfPkJw
PgMIOAjC+S3itayZbLwOM0D2eno52Jc41p6O4Xb4DwL9CL44yH+3EHwe//VT
Ujm8HbZ6bbCY85PXoWSr6O/Tct4OB7v3NZk4CzhURKwwPauMSF+Q8PR26I/o
9mfcwA0Jh2wEX+ST4/m0UgQflv7B/A/cDuj5AwBuSEoC
     "], {{54.1609, 4.6234399999999996`}, {54.1609, 3.8499999999999996`}, {
     53.5078, 3.6437499999999994`}, {53.18909999999999, 
     3.6437499999999994`}, {52.775000000000006`, 3.6437499999999994`}, {
     52.42340000000001, 3.92188}, {52.42340000000001, 4.30469}, {
     52.42340000000001, 4.82969}, {52.91720000000001, 5.371880000000001}, {
     54.1609, 5.412500000000001}, {54.1609, 4.6234399999999996`}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0,
      1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1,
      3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
     3}}, {{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {CompressedData["
1:eJxTTMoPSmViYGBwAGIQPeUbW/yMJ34O13lvi6Wa8TrA+HNmAoEkn8OOW11/
U68j+Gu6b2cwHEfj9yP4EeLbLzL0+Tk8r32cfX4Nn4PKk+Z5Z7v8HA5072sy
URZwuLuPb46xlZ8DSPnMl4oOTxIXXjMx93MwBgFnJQfdCQt+GJr5OfwHgXgl
hzMgoILgv+HdZzBTCMHfWytrkc7j58AfG3DfyByqn83PYa2QDl86H5Q/zceh
8v6PW8anBR32gPyT7uPQG9Htz/iBz8HnBLvtbFsfiD0+fA61v60Kzkn4wP0z
10bnyiw+Hwf1TyovZ3HyOUhMvcKZweTjsNVrg8Wcn7xwPth/j3ngfBOQfzbz
QNzH4gNx739uB1fVUqZZAgj+hfx49nOSCD6Ykoe6z4AH1b1APjh+1iD4rcvD
TxkdQejv8XrFYnISwU9NA4JzCD7Yv3cx+bD4h/Fh/uX1Xz8l9QIiPMD+Oo3g
Kzh+TD6z1ceBx5HPa4YmnwMPSP0CH3j8w/gQ8wTgfJHKSSVnWwQg4bHCx0F+
14J9qe8EHLbo5S1m3OPj8Lott9votiDEP4y+DjGqETLnYkQdXEDqJfzgfHB6
0/ODuOszP5xfsrxkwz9+foeKiBWmZ6UR6bMcxH/tC+fvB8XPHQT/KSg9nsfk
w+L3CZS/H8o3v3Y01+SCLzw8we57gOCD0/8rBH8GyFxBPweZjWLzmRR4HN6C
0rOUHzw+/8TkHv0XheCD0982BB9szHE/uHkQ+xH8dlB6uILgw/IzOh8W3wCN
0dzv
     "], {{60.1609, 5.60313}, {58.176599999999986`, 5.60313}, {
     59.826599999999985`, 8.223440000000002}, {60.1609, 5.60313}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}}, {{0, 2, 0}, {
     1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}}}, {CompressedData["
1:eJxTTMoPSmViYGAwAmIQnR/Pfk4yMsBBdteCfanv5B3e8O4zmBkV4PBh0XqF
sxoKcL77mqPLGSwQ/JXfXlaccUDwb2vKrvnfrOAg/fqRmVRIgEN6GhAsU3Do
9nrFYuKL4HP8XJC+2Q3Br123LaneNsDhgWu846xGBQdjELAOcKi+/+OWsbaC
w5ru2xkM5gEO/0EgXsEhQnz7RQYtKP++gsOGhy+nbhJA8FWfNM87u8sfzldw
/Jh8JtTfYcZMIKiUg/Mh/pGG82eB5G9KQPzT5e9gAnaIOIR/CcEXn3qFM+MX
gg+m+AMg/MviDhURK0zPSgc4rBXS4Uuvk3DY2lJzYbNogEOMaoTMuT9iEP9K
QuXviTvsvNX1N1U4wOHLvo9b08PE4Oa9acvtNooWddC0mnS6nifAoS+i259x
gwjEHz/9IeH1UdghFRSO1/wh6qWFHY6CNGxH8Gt/WxWcW4DgP0lceM2kHsG/
IV2TaFTq77Aj2Criv7qww1wbnSuz0vwdGEDAQdhhB8h95f4Q900TdngLCo8q
f4h/ZETgfJCzZkYi+OtA/pMThZun8Unl5SxPUUj4RCP4OZzABOGM4O8B2afv
DwmfeSJwPiR8heH8hyD/Bwo5mF87mmtSgeCDw2chgt+/4IfhM6YAON9fTizL
Vz3A4WD3viaTZmFIejUIcPAApYcdog7o+QEAN8JRZw==
     "], CompressedData["
1:eJxTTMoPSmViYGAQB2IQvXiSFaOvSYDDA9d4x1kT5Rwei8iefKoc4JCeBgRt
Ug42OldmPVMMcFgvpMOXLofg3wepF5RycFUtZZolE+DQH9Htz7hB0kH1SfO8
s3wBDvK7FuxLXSfhsONW19/U7/4OMaoRMuf+iDucAYErCL4LSP8OBP/DhoDs
WdP9HdQ/qbyc1SkB54PND5CC88HqY6QderxesZis9HcIeXv544yDsg4hJSrT
/x/wdzAwBoLPcg53pGsSje76O6wFuV9PwUHB8WPyGcYAh+r7P24ZVys4bHj4
cuomAQRf+JPj+TRdBL9m3bakelNo+BjKw/kw82H8FgV21TNX5CDmAcOzFxwe
cg7o4QsAV+6bTA==
     "]}], 
   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0,
     1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
    0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 
    1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIlIGYC4tp125Lqc4McZkzgrzLrVnWYCQKRQQ7/QeC+
lkNwicr0/zcCMPgsnF3yyXpaDu3Lw08ZvUDw/eXEsnzlA+F8sHmKgQ4S8+I0
T3/QhPOZQfJ8CH6bArvqmSsScH5fRLc/o4A43Lwv+z5uTZ8mBrcPxoe5B51v
YgwCohD9rwMcqu7/uGXsLeqw81bX31T9QDjfu7pZ38cNwc+PZz8nmYjg76+V
tUhfguA3B3rObdgVCDcfxofZ/3lDQPasxQg+zDwY/+rRXJOG+EAHjU8qL2dp
isP5wW8vf5zxUALOnwEKB0tNOP/H29cHLJm14ObBwpfj54L0zU0IvrbVpNP1
VxD8w5e1UyXtguB8G50rs54FBjn4XZwY8++xhsOGhy+nbopBxD96egAAaWDq
6A==
    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
     0}}}, {CompressedData["
1:eJxTTMoPSmViYGAwBmIQ3eP1isXkZpiD1wl229lXVR1gfB8Qf6uag9Anx/Np
JzH5MPUwPgtnl3yynqqDguPH5DMHwxzOgMAbFQcJj4A/EtsR/Lbl4aeMlmDy
G35bFZxboQrnw8yH8Vt4/ddPUdWE8yHu0XKojFhherY4zMHcZm/QtEZtiHtc
EXyw/dJo8l9DHeSXv/DQ+68F5//5VvpgzkdNOL+B5Wi/Ybmmg8zrR2ZSDGEO
61WfNM/T1XT4wRY/w4cXwf+0ISB7ljSC/w0krxrmIAcyvx7BB8u/RfCfJC68
ZuKv5TATBGTDHDLyP7SenKLlkAYCQmEO9eDw0EJVz68NCTcHBP9AraxFuguC
/2L7eubnCQh+7bptSfW1YQ7Hd+3oZSvQgvNNQeGhqAnn/3z7+oDlYg2HJyKy
J5/Ghzk0gvw/XcNha0vNhc22YQ5bzH8cSunScDhyWTtVUirMIRPkXhENSHp5
G+owA+SPSnUHLatJp+ufhELc2aMG56eC/MWG4M9ZpLzzz3IVBwYQkAhzeJGl
/W26rYqDiTEQWCP4YP8lIPg7b3X9TS0PczDQWil84YmKwxvefQYzm8Ig5rWr
OhTEs5+TbEWkL3B4TgpzCLglXZMYpAIRX4Hg2+hcmfVsLYIPS/8SU69wZiQh
+LD0CAAEIWiT
     "], {{89.9609, 11.3234}, {89.9609, 10.549999999999999`}, {89.3078, 
     10.343800000000002`}, {88.98910000000001, 10.343800000000002`}, {
     88.57499999999999, 10.343800000000002`}, {88.2234, 10.6219}, {88.2234, 
     11.0047}, {88.2234, 11.5297}, {88.71719999999999, 12.0719}, {89.9609, 
     12.112499999999997`}, {89.9609, 11.3234}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
     3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGINIGYC4pkgkBvscP4MEPBwOcD4BctLNvw7z+Wwpvt2
BkM6gl+zbltSfSqCb6NzZdazRAQ/QE4syzc+2OE/COznclBw/Jh8JjbYwb7E
sfa0DJfDg318c4yjgh2axGtZM49xODCAgE+wQ4xqhMy5PcwOwSUq0/9LIPjC
nxzPp/0MgvPB5p4OcjgDBmxwfjRIXkYAzjcxBoLNIg5bW2oubP4Y5HAWpDxH
DOIf8WA4//rRXJMGaQT/De8+g5lmCP6BWlmLdI9gh1mgcLkp6nDksnaqpFWw
Q19Etz/jBFEHmdePzKQsgh3aFNhVz1wRgfPB9hcj+F/2fdyaPk0YEh6OwQ4g
aePPQhD5AAT/B1v8DJ9YBB8cPhnBDulpQNAmDOe/acvtNqoWgfNbQfaXiDl8
B+l3DXbQ+KTyclamOCT8RBH8tyD/nQtC5c8LgpjzQBjObweZJyIA5/s/8bxk
KszhEJt79N+my0EOS24tf2x4mNHhsYjsyafCwXB+RcQK07PRCD4sPamD7PPk
dEBPbwCTyRVZ
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
     0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}}, {{
     1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGAQA2IQnQYCs0Ic2hXYVc+ICDjA+DNBQFLEwUbnyqxnqSEO
DCDgIO4Qm3v03yZ1BH/nra6/qf+D4fzmQM+5Dc+CHULeXv4446Gog4Ljx+Qz
d4MdFHYt2Jfqh+D3RnT7MwbIQ/gTgx2+7Pu4Nf2bHJyv/knl5ayXsg7aVpNO
129B8F1VS5lm7YDq34Dg/wcBeRk4Px3sESaHA7WyFuknEHzOnwvSN98Khvgv
ks1hTfftDIbnwQ59IPMMWBwmLPhh+OxfsMOSW8sfGx5mhKhTDIHzPaub9X2S
EHxYeIH5zBwO6OEJAEm3lQs=
     "], CompressedData["
1:eJxTTMoPSmViYGCQAmIQXRDPfk4yN8QhWjVC5pyMgAOMv+TW8seGh/ng/BiQ
vA2XA+fPBembo2B8doclk6wYfT1CHGQ2is1nSmBxOFAra5FuEOJwBgR6mB0+
bQjIniWP4Et4BPyRYEfwOUDmfQp2ONi9r8lEmdVB+JPj+bSnwRDzFrA7BMiJ
ZfneD3b4su/j1vRrHHB+Ggg8Q/DtSxxrT8twwfkilZNKzroIw/kMIPAAwe+N
6PZn/CDssKb7dgbDc6j9zSIOCo4fk898DXboA8lvEHXY2lJzYTNviMObttxu
o2gxhw0PX07dpILgmxgDgT2CD/ZfcIjDWiEdvvQ4UYcfbPEzfGJDHDQ+qbyc
lSniYKNzZdaz1BAHhV0L9qX2CcPDtx9kX4GQA3p8AAAswaN9
     "]}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0,
     1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 
    3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
    1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxdlGtIFFEUx9cHmUSCr93Z2plVfJQkSLlKSsUx0PJVpnNtjRXJWI3KB2Sx
pqa52ge1MCPUxcIPgQVmoqgZIUJKVLumWFAqaGG+wmQlRKG0uXdm56IH7ocf
c+fcc/7/c69/dkGq0UWhUDgJyyAsZ2ENjR8yqhsQ3JpenwjfowYHF0vcU1U6
2v0AQeryuL3pohqCZ81PbDWUSzt6s8urKXd+X3zUVYXgz4C9JzdSDaudKVct
ZgRbJBgIiW74WG5CUIrz/1LC+q6spqRMBDk4gpVQl7Dkqkum7L7Rmtt9gvLT
hminZB0CK452yn6vWweMHSqZB2sHKnUBDMwMeLSERyI4sBq4aHnOiP1ESfWU
q+FY6GfLXCwCQ5BeM9KiAb8Y+yVrPAITrq+WBUPe8GZXIoKWZiE2WMjEnCad
X8dBYZbbiDoDwau0aP3WPAfxJeawpGwpn0ELlefiH1fkUx4sY4/mFlKe9WHf
/yyhTOoX9OOxnk5aqG9dPzx3U+rnLSfuv45gOjYrxuJJmejdy27/bpf6KZPq
e6cBXbgQZsoJuN77lL1WYz7lNCNoxP1msDIT/eI5mUmeh1oIwvNQiQBjuLcf
pHDKK8kFlPWqvjFFOuXd2M84BCz26zcn6nMSQRM+r5iDMjxPx6X83lpor528
rAij/xN9vSgTf+d4me+2nf9wxMqDFuc/w8oc2z7cpjBpZBb704jzYOMhBevt
rwHmdMpfZpwy8esrZfxb8zcejHge4zTifE7w8MIr1CP3tkb0b5YX+8vnRH03
edlfMi+eO/wPoEzyhyA4hett4mQm/YywMvsUNxTZqtjt34V+iZ7BCO7pa886
1Uv9sdJ8pO+DNXzffCU/Qxjon6j5Z/RGoMAxoxL375X2rynF+rZ4+f6Z9M8i
bCuUiV/LlMk8/KBM/Bf0IfN8RwkLfS9d5hd4mMHzOaYU9y1J+rSoZCb3y0rZ
hvEaI+e/gPe/YUS/JikTv0Ypk/OGeKj2cwuy6ihbsG5RKpnJ+VO+wBcFNm5N
OfzyFedvhTLZ74pkjgu64Wzxkd7PREmf/QgOYn3dVfBlOE9XIfjbj++Xm1J8
byLo/473ZVt+E2XHe0ze1xgGdr7X/wEtnXhs
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0,
      1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 
     3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}}}, {CompressedData["
1:eJxTTMoPSmViYGDQBGIQ/YZ3n8FMqwgHYxBIVnSA8ffm17ydOVXZQfVJ87yz
QhEOP9++PmCprOpQu25bUv3NcDh/a0vNhc0bEXwFx4/JZ3rDHTbp5S1mlFFx
MAGZWx/u0GnjuSttkbLDmu7bGQzbwx30FeW/5EzTcqiMWGF6Fshn4eyST16n
5fCNLX6Gz85wiL7LCL7/LemaxE8I/vPEhddM9LUd2paHnzLagJt/5LJ2qmRb
uIPMvDjN0wLaDgXx7OckK8Mdtpj/OJTCpe0wEwRywx1OHHZam/lPy+GJiOzJ
p/HhDimxd9yYf2hB/Osb7vCieKvo79daDh0g8z3CHVp4/ddPeYrgg9VXIPg1
nzYEZFtpOVSA/OeP4F87mmvSEI7gNwV6zm2ow+T/AIUnM4KfngYExzTh/PNX
w97oz9Z0WDLJitG3ItxhM8g/rzQg4VMa7rARFP41Gg4TFvwwfJYE9b+BmoOr
ainTLJ1wh5C3lz/OOCjncAYENMIdeiO6/RknyML5f/8DwX4ZOD8ApF4RwQ8C
8R3FHQ7Uylqkh4RDwnGnCDy8YXxw+rmH4MPSl/uao8sZbkg7oKc/AN4JJcU=

     "], CompressedData["
1:eJxTTMoPSmViYGAQAWIQvWiSFaPvg3CHMyDQI+XQ4/WKxeRsuMNMEPgp7hAh
vv0iwyqo/BpRhwkLfhg+a0Pw00AgD8H/tCEge1ZwuIOJMRBcFoPzYebD+AFv
L3+coSjjYKNzZdaz0HAH9U8qL2dxyjrE5h79tyk53GHlt5cVZwwUHL6xxc/w
KQ13cF9zdDlDhJKD6pPmeWfLwh3eL1qvcLZDyeGJiOzJp4vDHRp+WxWcW6EC
4V9H8CH+QPBfbF/P/JwjwkHl2qNghjnKcH7p4W2uM2OV4HywfRaKDleP5po0
fEa4Dz28AFA+nSU=
     "]}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
     3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGI9IGYC4lA+3U1z6yMd1D+pvJyVKeUA4z9wjXectVHK
wb93ep5QdaRDf0S3P+MHKYf/IFCO4DOHATWUIvgbijImvi2JdDjQva/J5LGU
wzr3h1UieZEO7QrsqmdKpBxaXgfukLONdBCpnFRyNkXMQctq0un6LxEOZ0Bg
jajDzltdf1OvI/hvePcZzFyE4Cs4fkw+MzHCofL+j1vG3RJwPsx+GP9NW263
0WwZB9UnzfPOzotwCOcUazeer+CQBgK7oHx7JYf7+/jmGJ+LcFgrpMOXHqfs
cO1orknD9wiHht9WBedWqDiAnL9OPRLOnwkChgj+/lMLXbdFRzpMaW+NujxH
xSFulycPU3akw978mrczpyo7CIMCIAbBF2o+cGphKIJfLQJU4BXpoHLtUTCD
j7IDSNrVLdKh/PA215m6yg43z30PfgwMr04bz11pl5TgfHA85CP4YPO+Kjo8
ADrX3TPSQRlk3hpFB5moFOv74Qi+BAswwrIQ/M9/r1S8rIt0SAeFi5oSnF8N
Cl9pZTj/UYT49osOCP/+fPv6gKWyKkReDcEHh/ehCDj/LSj+4iIc3i9ar3B2
hyKcvyPYKuL/chk4H+yfegmHxyKyJ5+2R0DCeaeIg7XOlVnPriL4MP/C+Cjp
96SkA3p6BgChQFw0
    "]]},
  AspectRatio->Automatic,
  BaselinePosition->Scaled[0.314853952067989],
  ImageSize->{103.07277708592777`, 16.833723536737235`},
  PlotRange->{{0., 103.07}, {0., 16.830000000000002`}}]], "Output",
 CellChangeTimes->{{3.9513014364258327`*^9, 3.9513014603034286`*^9}, 
   3.951304547140326*^9, {3.9513045969728403`*^9, 3.951304621358926*^9}, {
   3.951304726335907*^9, 3.951304764823063*^9}},
 CellLabel->
  "Out[504]=",ExpressionUUID->"73985cf9-ac33-4a8c-945c-4846b5fd8a91"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"False", ",", "True"}], "}"}], "}"}]], "Print",
 CellChangeTimes->{{3.951300871421281*^9, 3.951300919135776*^9}, {
   3.951301127497387*^9, 3.951301167029838*^9}, 3.951301237080329*^9, 
   3.95130128581881*^9, 3.9513013470021544`*^9, {3.9513014287506742`*^9, 
   3.951301460301876*^9}, 3.951304547137569*^9, {3.9513045969629498`*^9, 
   3.951304621354989*^9}, {3.9513047263336906`*^9, 3.951304764825294*^9}},
 CellLabel->
  "During evaluation of \
In[502]:=",ExpressionUUID->"696bb22b-57c5-43b4-8630-8d7542d4d007"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"x", "\[Rule]", 
    RowBox[{"-", "y"}]}], "\[InvisibleSpace]", 
   RowBox[{"y", "\[Rule]", 
    RowBox[{"-", "x"}]}]}],
  SequenceForm[$CellContext`x -> -$CellContext`y, $CellContext`y -> \
-$CellContext`x],
  Editable->False]], "Print",
 CellChangeTimes->{{3.951300871421281*^9, 3.951300919135776*^9}, {
   3.951301127497387*^9, 3.951301167029838*^9}, 3.951301237080329*^9, 
   3.95130128581881*^9, 3.9513013470021544`*^9, {3.9513014287506742`*^9, 
   3.951301460301876*^9}, 3.951304547137569*^9, {3.9513045969629498`*^9, 
   3.951304621354989*^9}, {3.9513047263336906`*^9, 3.951304764825932*^9}},
 CellLabel->
  "During evaluation of \
In[502]:=",ExpressionUUID->"7ab833e8-9371-419a-a482-54897052292c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\[Gamma]", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cb", ",", "c"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "x"}], ",", 
      RowBox[{"-", "y"}]}], "}"}]}], "]"}], "}"}]], "Print",
 CellChangeTimes->{{3.951300871421281*^9, 3.951300919135776*^9}, {
   3.951301127497387*^9, 3.951301167029838*^9}, 3.951301237080329*^9, 
   3.95130128581881*^9, 3.9513013470021544`*^9, {3.9513014287506742`*^9, 
   3.951301460301876*^9}, 3.951304547137569*^9, {3.9513045969629498`*^9, 
   3.951304621354989*^9}, {3.9513047263336906`*^9, 3.951304764826909*^9}},
 CellLabel->
  "During evaluation of \
In[502]:=",ExpressionUUID->"41d54087-9e45-4f2d-92a0-f5eff9da8bd6"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reduce FTerms and FEqs, fix Indices", "Subsection",
 CellChangeTimes->{{3.950867995958111*^9, 3.9508679992839813`*^9}, {
  3.951108367695386*^9, 3.9511083702282677`*^9}, {3.951108500371646*^9, 
  3.95110850408386*^9}},ExpressionUUID->"e5244ec3-f22c-466c-9873-\
92eb903637b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Given", " ", "a", " ", "user"}], "-", 
     RowBox[{
     "defined", " ", "term", " ", "or", " ", "master", " ", "equation"}]}], 
    ",", " ", 
    RowBox[{"give", " ", "all", " ", 
     RowBox[{"(", "closed", ")"}], " ", "indices", " ", "unique", " ", 
     RowBox[{"names", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FixIndices", "[", 
     RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "indices", ",", "newIndices", ",", "replacements", ",", 
        "indexedObjects", ",", "\[IndentingNewLine]", 
        RowBox[{"ret", "=", "expr"}]}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AssertFSetup", "[", "setup", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Indices", " ", "should", " ", "be", " ", "fixed", " ", "on", " ", 
          "a", " ", "per"}], "-", 
         RowBox[{
         "term", " ", "basis", " ", "to", " ", "ensure", " ", "we", " ", "do",
           " ", "not", " ", "mess", " ", "up", " ", "things"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FEqQ", "[", "ret", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Return", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"FixIndices", "[", 
              RowBox[{"setup", ",", "#"}], "]"}], "&"}], "/@", "ret"}], "]"}],
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FTermQ", "[", "ret", "]"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"First", ",", " ", 
           RowBox[{
            RowBox[{
            "take", " ", "care", " ", "of", " ", "nested", " ", "sub"}], "-", 
            "terms"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ret", "=", 
           RowBox[{"FTerm", "@@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"List", "@@", "ret"}], ")"}], "/.", 
              RowBox[{
               RowBox[{"FTerm", "[", "a__", "]"}], ":>", 
               RowBox[{"FixIndices", "[", 
                RowBox[{"setup", ",", 
                 RowBox[{"FTerm", "[", "a", "]"}]}], "]"}]}]}], ")"}]}]}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Now", " ", "check", " ", "if", " ", "everything", " ", "is", " ", 
            "alright"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Not", "@", 
             RowBox[{"SuperIndicesValid", "[", 
              RowBox[{"setup", ",", "ret"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Invalid superindices: \>\"", ",", "ret"}], "]"}], 
             ";", 
             RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"indices", "=", 
           RowBox[{"GetClosedSuperIndices", "[", 
            RowBox[{"setup", ",", "ret"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"newIndices", "=", 
           RowBox[{"Map", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Unique", "[", "\[IndentingNewLine]", 
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", "#", "]"}], ",", 
                 RowBox[{
                  RowBox[{"i", ":", 
                   RowBox[{"DigitCharacter", ".."}]}], ":>", "\"\<\>\""}]}], 
                "]"}], "\[IndentingNewLine]", "]"}], "&"}], ",", 
             "\[IndentingNewLine]", "indices"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"replacements", "=", 
           RowBox[{"Thread", "[", 
            RowBox[{"indices", "->", "newIndices"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"ret", "/.", "replacements"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Expression \\\"\>\"", ",", "expr", ",", 
         "\"\<\\\" is neither a term nor a master equation!\>\""}], "]"}], 
       ";", 
       RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950861714841454*^9, 3.950861755216401*^9}, {
   3.950862487948318*^9, 3.950862798308673*^9}, {3.950862895840537*^9, 
   3.9508630357163677`*^9}, {3.9508724419777927`*^9, 
   3.9508724466302547`*^9}, {3.950872529157947*^9, 3.9508725448503036`*^9}, {
   3.9508725902304573`*^9, 3.950872613199347*^9}, {3.950872648512635*^9, 
   3.950872688616452*^9}, 3.950874347073372*^9, {3.950964034760331*^9, 
   3.950964062155575*^9}, {3.950964146531177*^9, 3.95096414932693*^9}, {
   3.950964196491962*^9, 3.950964291440217*^9}, {3.9510571582595263`*^9, 
   3.9510571726616507`*^9}, {3.95105728303815*^9, 3.951057297698251*^9}, {
   3.951106831163007*^9, 3.951106891415176*^9}, {3.951107069173294*^9, 
   3.951107093464375*^9}, {3.951107127992262*^9, 3.9511071448735332`*^9}, 
   3.951107181155599*^9, {3.9512004831787*^9, 3.951200640317047*^9}, {
   3.9512006715440273`*^9, 3.9512006882442102`*^9}, {3.95120072501525*^9, 
   3.95120073073527*^9}, {3.9512007738520927`*^9, 3.9512007765353394`*^9}, 
   3.951200836520123*^9, {3.951200877343849*^9, 3.951200929974958*^9}, {
   3.95120098569306*^9, 3.951201005326355*^9}, {3.951201043734188*^9, 
   3.951201076755189*^9}, {3.951201114535118*^9, 3.951201142462575*^9}, {
   3.9512873792240334`*^9, 3.951287432812272*^9}, {3.9512876999094963`*^9, 
   3.951287703906385*^9}, 3.9512877776883593`*^9},
 CellLabel->
  "In[132]:=",ExpressionUUID->"3500ee75-7244-4321-ae5e-82e6897e10d7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FDOp", "::", "cannotProcess"}], "=", 
   "\"\<The FDOp in `1` cannot be processed. Please expand the term \
first\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FDOpCount", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "i", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"expr", "//.", 
       RowBox[{
        RowBox[{
         RowBox[{"Power", "[", 
          RowBox[{
           RowBox[{"FDOp", "[", "a__", "]"}], ",", "n_Integer"}], "]"}], "/;", 
         RowBox[{"n", "<", "0"}]}], ":>", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"FDOp", "::", "cannotProcess"}], ",", "expr"}], "]"}], 
          ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"expr", "//.", 
        RowBox[{
         RowBox[{"Power", "[", 
          RowBox[{
           RowBox[{"FDOp", "[", "a__", "]"}], ",", "n_Integer"}], "]"}], ":>", 
         RowBox[{"NonCommutativeMultiply", "@@", 
          RowBox[{"(", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"FDOp", "[", "a", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ")"}]}]}]}], 
       "//", 
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{
          RowBox[{"{", "#", "}"}], ",", 
          RowBox[{"FDOp", "[", "___", "]"}], ",", "Infinity"}], "]"}], 
        "&"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951282331983509*^9, 3.951282593647258*^9}, {
  3.951282798787737*^9, 3.951282799895976*^9}, {3.951283469783621*^9, 
  3.951283582313293*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"ec93a3ae-c758-4d49-9ec4-9c2ae2983898"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FTerm", "::", "GrassmannCountError"}], "=", 
   "\"\<The factor `1` has multiple Grassmanns in a single factor.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FTerm", "::", "FDOpCountError"}], "=", 
    "\"\<The factor `1` has multiple FDOps in a single factor.\>\""}], ";", 
   RowBox[{
    RowBox[{"FTerm", "::", "GrassmannOpen"}], "=", 
    "\"\<The factor `1` has open Grassmann factors.\>\""}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Simplify", " ", "a", " ", "term", " ", "appearing", " ", "in", " ", "an",
      " ", 
     RowBox[{"equation", ".", " ", "Try"}], " ", "to", " ", "merge", " ", 
     "as", " ", "many", " ", "factors", " ", "as", " ", "possible"}], ",", 
    " ", 
    RowBox[{
    "while", " ", "not", " ", "changing", " ", "the", " ", "Grassmann", " ", 
     "structure", " ", "of", " ", "the", " ", 
     RowBox[{"term", "."}]}]}], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReduceFTerm", "[", 
    RowBox[{"setup_", ",", "term_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"reduced", "=", 
        RowBox[{"List", "@@", "term"}]}], ",", "mergeGrassmanFactors", ",", 
       "i"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AssertFSetup", "[", "setup", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AssertFTerm", "[", "term", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Reduce", " ", "nested", " ", "FTerms", " ", "and", " ", "such", " ", 
        "first"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"reduced", "=", 
       RowBox[{"reduced", "//.", 
        RowBox[{
         RowBox[{"FEq", "[", "a__", "]"}], ":>", 
         RowBox[{"ReduceFEq", "[", 
          RowBox[{"setup", ",", 
           RowBox[{"FEq", "[", "a", "]"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"TODO", ":", " ", 
        RowBox[{
        "find", " ", "a", " ", "way", " ", "to", " ", "not", " ", "reduce", 
         " ", "terms", " ", "twice"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"reduced", "=", 
       RowBox[{"reduced", "//.", 
        RowBox[{
         RowBox[{"FTerm", "[", "a__", "]"}], ":>", 
         RowBox[{"ReduceFTerm", "[", 
          RowBox[{"setup", ",", 
           RowBox[{"FTerm", "[", "a", "]"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"TODO", ":", " ", 
        RowBox[{
         RowBox[{
         "Ensure", " ", "that", " ", "nested", " ", "terms", " ", "are", " ", 
          "Grassmann"}], "-", "neutral"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"reduced", "//.", 
       RowBox[{
        RowBox[{"FTerm", "[", "a__", "]"}], ":>", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"GrassmannCount", "[", 
              RowBox[{"setup", ",", 
               RowBox[{"FTerm", "[", "a", "]"}]}], "]"}], ",", "2"}], "]"}], "=!=",
            "0"}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"FTerm", "::", "GrassmannOpen"}], ",", 
             RowBox[{"FTerm", "[", "a", "]"}]}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Merge", " ", "scalar", " ", "terms", " ", "with", " ", "the", " ", 
         "closest", " ", "Grassman", " ", 
         RowBox[{"term", ".", " ", "We"}], " ", "need", " ", "to", " ", 
         "\"\<vanish\>\"", " ", "nested", " ", "FTerms"}], ",", " ", 
        RowBox[{
        "to", " ", "make", " ", "sure", " ", "we", " ", "do", " ", "not", " ", 
         RowBox[{"overcount", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"i", "<", 
         RowBox[{"Length", "[", "reduced", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"FDOpCount", "[", 
             RowBox[{
              RowBox[{"reduced", "[", 
               RowBox[{"[", 
                RowBox[{"-", "i"}], "]"}], "]"}], "//.", 
              RowBox[{
               RowBox[{"FTerm", "[", "__", "]"}], ":>", "1"}]}], "]"}], ">", 
            "1"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{
              RowBox[{"FTerm", "::", "FDOpCountError"}], ",", 
              RowBox[{"reduced", "[", 
               RowBox[{"[", 
                RowBox[{"-", "i"}], "]"}], "]"}]}], "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"GrassmannCount", "[", 
             RowBox[{"setup", ",", 
              RowBox[{
               RowBox[{"reduced", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "i"}], "]"}], "]"}], "//.", 
               RowBox[{
                RowBox[{"FTerm", "[", "__", "]"}], ":>", "1"}]}]}], "]"}], 
            ">", "1"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{
              RowBox[{"FTerm", "::", "GrassmannCountError"}], ",", 
              RowBox[{"reduced", "[", 
               RowBox[{"[", 
                RowBox[{"-", "i"}], "]"}], "]"}]}], "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"GrassmannCount", "[", 
               RowBox[{"setup", ",", 
                RowBox[{
                 RowBox[{"reduced", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "i"}], "]"}], "]"}], "//.", 
                 RowBox[{
                  RowBox[{"FTerm", "[", "__", "]"}], ":>", "1"}]}]}], "]"}], "==",
               "0"}], "||", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"GrassmannCount", "[", 
               RowBox[{"setup", ",", 
                RowBox[{
                 RowBox[{"reduced", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"-", "i"}], "-", "1"}], "]"}], "]"}], "//.", 
                 RowBox[{
                  RowBox[{"FTerm", "[", "__", "]"}], ":>", "1"}]}]}], "]"}], "==",
               "0"}]}], ")"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"FDOpCount", "[", 
                  RowBox[{
                   RowBox[{"reduced", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "i"}], "]"}], "]"}], "//.", 
                   RowBox[{
                    RowBox[{"FTerm", "[", "__", "]"}], ":>", "1"}]}], "]"}], "==",
                  "0"}], "&&", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"FDOpCount", "[", 
                  RowBox[{
                   RowBox[{"reduced", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"i", "+", "1"}], ")"}]}], "]"}], "]"}], "//.", 
                   RowBox[{
                    RowBox[{"FTerm", "[", "__", "]"}], ":>", "1"}]}], "]"}], "==",
                  "0"}]}], ")"}], ",", "\[IndentingNewLine]", 
              RowBox[{"reduced", "=", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"reduced", "[", 
                  RowBox[{"[", 
                   RowBox[{";;", 
                    RowBox[{
                    RowBox[{"-", "i"}], "-", "2"}]}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"reduced", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "i"}], "-", "1"}], "]"}], "]"}], "*", 
                   RowBox[{"reduced", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "i"}], "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"reduced", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "i"}], "+", "1"}], ";;"}], "]"}], "]"}]}], 
                "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"i", "++"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"i", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FDOpCount", "[", 
          RowBox[{
           RowBox[{"reduced", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "//.", 
           RowBox[{
            RowBox[{"FTerm", "[", "__", "]"}], ":>", "1"}]}], "]"}], ">", 
         "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"FTerm", "::", "FDOpCountError"}], ",", 
           RowBox[{"reduced", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GrassmannCount", "[", 
          RowBox[{"setup", ",", 
           RowBox[{
            RowBox[{"reduced", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "//.", 
            RowBox[{
             RowBox[{"FTerm", "[", "__", "]"}], ":>", "1"}]}]}], "]"}], ">", 
         "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"FTerm", "::", "GrassmannCountError"}], ",", 
           RowBox[{"reduced", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"reduced", "=", 
       RowBox[{"OrderFields", "[", 
        RowBox[{"setup", ",", "reduced"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"FTerm", "@@", "reduced"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950868021337243*^9, 3.950868021665371*^9}, {
   3.95086835724666*^9, 3.9508683710297613`*^9}, 3.9508700517983923`*^9, 
   3.950870106727509*^9, {3.9508701471559877`*^9, 3.9508701622890987`*^9}, 
   3.950872629945331*^9, {3.9509518447947407`*^9, 3.950951851247134*^9}, {
   3.950952161983356*^9, 3.950952217083837*^9}, {3.950953229162822*^9, 
   3.950953297847208*^9}, {3.950953495548379*^9, 3.950953510434524*^9}, 
   3.950953659948514*^9, {3.9509537192506933`*^9, 3.9509537569466476`*^9}, 
   3.95095976117029*^9, {3.950960003047349*^9, 3.950960004176173*^9}, {
   3.9509615265046177`*^9, 3.950961540864068*^9}, {3.950963643675329*^9, 
   3.9509636614251423`*^9}, {3.950963711154449*^9, 3.950963717584083*^9}, {
   3.950963775682248*^9, 3.950963816155239*^9}, {3.950963860300707*^9, 
   3.950963929362384*^9}, {3.951107234846871*^9, 3.951107272579007*^9}, {
   3.951107477640152*^9, 3.951107555487331*^9}, {3.951107981249464*^9, 
   3.951108000501011*^9}, {3.951108345993602*^9, 3.9511083754220457`*^9}, {
   3.951108466123753*^9, 3.951108473001584*^9}, {3.951120018973323*^9, 
   3.951120141322135*^9}, {3.951120175696308*^9, 3.951120258293839*^9}, {
   3.9511993173301573`*^9, 3.951199386830797*^9}, {3.951199702330996*^9, 
   3.951199863935121*^9}, {3.951199941828017*^9, 3.951200206596088*^9}, {
   3.9512007873999853`*^9, 3.951200800152265*^9}, {3.951211180189704*^9, 
   3.9512112247413692`*^9}, {3.951211306550591*^9, 3.951211312108625*^9}, {
   3.9512817944598837`*^9, 3.951281852923716*^9}, {3.951282267880844*^9, 
   3.9512822700840063`*^9}, {3.95128232715619*^9, 3.951282327704615*^9}, {
   3.95128239842417*^9, 3.951282398833179*^9}, {3.95128262267912*^9, 
   3.9512826941777477`*^9}, {3.9512827249420967`*^9, 3.951282770800105*^9}, {
   3.9512828635885363`*^9, 3.951282875043973*^9}, {3.9512829247327137`*^9, 
   3.951283058689929*^9}, {3.951283170556365*^9, 3.951283180253006*^9}, {
   3.951283286916153*^9, 3.95128336262862*^9}, {3.951287326417925*^9, 
   3.9512873368029137`*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"c85cfa76-e8b5-439f-9ca0-f24e64c44725"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ReduceFEq", "[", 
    RowBox[{"setup_", ",", "equation_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reduced", "=", "equation"}], "}"}], ",", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AssertFSetup", "[", "setup", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AssertFEq", "[", "equation", "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Amend", " ", "the", " ", "index", " ", "structure"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"reduced", "=", 
       RowBox[{"FixIndices", "[", 
        RowBox[{"setup", ",", "reduced"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Make", " ", "sure", " ", "all", " ", "terms", " ", "are", " ", 
        "reduced"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"reduced", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ReduceFTerm", "[", 
          RowBox[{"setup", ",", "#"}], "]"}], "&"}], "/@", "reduced"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "reduced", "]"}], ";"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.95087005673455*^9, 3.9508700859297953`*^9}, {
   3.95087011800534*^9, 3.950870131605879*^9}, {3.950870213341543*^9, 
   3.950870277473693*^9}, {3.950870399615657*^9, 3.950870405389082*^9}, {
   3.950870442661482*^9, 3.950870496553628*^9}, {3.950870560603696*^9, 
   3.95087057682275*^9}, {3.950870622601573*^9, 3.9508706298192472`*^9}, {
   3.950870882690217*^9, 3.950870893085442*^9}, {3.950872136372311*^9, 
   3.9508721384388733`*^9}, {3.95087218393355*^9, 3.950872184825736*^9}, {
   3.950872366461809*^9, 3.950872410282044*^9}, 3.9508726043827133`*^9, {
   3.950872638854124*^9, 3.9508726391619997`*^9}, 3.950874165123219*^9, {
   3.9508742127501917`*^9, 3.950874219718197*^9}, 3.9508742837279673`*^9, {
   3.950875436534375*^9, 3.9508754560376596`*^9}, {3.950953413239159*^9, 
   3.9509534267784367`*^9}, {3.950953462892211*^9, 3.950953463787467*^9}, 
   3.950953644035307*^9, {3.9509639545923243`*^9, 3.95096400898311*^9}, {
   3.951108380757312*^9, 3.951108460175194*^9}, {3.951200372211622*^9, 
   3.951200414587019*^9}, {3.951201152993251*^9, 3.951201155424082*^9}, {
   3.9512111606396103`*^9, 3.951211178344079*^9}, {3.9512113174774103`*^9, 
   3.951211319144833*^9}, {3.951287340601552*^9, 3.951287349949945*^9}, {
   3.9512876915578947`*^9, 3.951287692487217*^9}, {3.9512877897524633`*^9, 
   3.9512877927314177`*^9}, {3.951287940608549*^9, 3.951287983978196*^9}, 
   3.951288027197757*^9},
 CellLabel->
  "In[138]:=",ExpressionUUID->"52021b7e-bece-436c-b228-076b6c722055"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Power expansions", "Subsection",
 CellChangeTimes->{{3.9511983853072557`*^9, 
  3.951198388520007*^9}},ExpressionUUID->"82ef4885-2b2a-47d1-8963-\
133ee7a68a33"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FExpand", "[", 
    RowBox[{"setup_", ",", "expr_", ",", "order_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ret", "=", "expr"}], ",", "n", ",", "i"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ret", "=", 
       RowBox[{"ret", "//.", 
        RowBox[{
         RowBox[{"Power", "[", 
          RowBox[{"a_FTerm", ",", "b_"}], "]"}], ":>", 
         RowBox[{"FEq", "@@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"FTerm", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"SeriesCoefficient", "[", 
               RowBox[{
                RowBox[{"a", "^", "b"}], ",", 
                RowBox[{"{", 
                 RowBox[{"a", ",", "0", ",", "n"}], "}"}]}], "]"}], 
              RowBox[{"NonCommutativeMultiply", "@@", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"FixIndices", "[", 
                  RowBox[{"setup", ",", "a"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "0", ",", "order"}], "}"}]}], "]"}]}]}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ret", "=", 
       RowBox[{"ret", "//.", 
        RowBox[{
         RowBox[{"Power", "[", 
          RowBox[{"a_", ",", "b_FTerm"}], "]"}], ":>", 
         RowBox[{"FEq", "@@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"FTerm", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"SeriesCoefficient", "[", 
               RowBox[{
                RowBox[{"a", "^", "b"}], ",", 
                RowBox[{"{", 
                 RowBox[{"b", ",", "0", ",", "n"}], "}"}]}], "]"}], 
              RowBox[{"NonCommutativeMultiply", "@@", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"FixIndices", "[", 
                  RowBox[{"setup", ",", "b"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "0", ",", "order"}], "}"}]}], "]"}]}]}]}]}], 
      ";", "\[IndentingNewLine]", "ret"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951198400665941*^9, 3.951198539982102*^9}, {
   3.95119858122998*^9, 3.951198629997539*^9}, {3.951198840630013*^9, 
   3.951199103563139*^9}, {3.951199144182513*^9, 3.951199153264168*^9}, {
   3.951285293951795*^9, 3.951285618155931*^9}, {3.951285751815961*^9, 
   3.951285790905162*^9}, {3.951286919623252*^9, 3.9512869715228977`*^9}, 
   3.951287309293539*^9, 3.951288307317803*^9},
 CellLabel->
  "In[158]:=",ExpressionUUID->"c5f93900-11a5-40d3-92c2-259b2094122d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DerivativeExpand", "[", 
    RowBox[{"setup_", ",", "expr_", ",", "order_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ret", "=", "expr"}], ",", "n", ",", "i"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "We", " ", "need", " ", "to", " ", "block", " ", "the", " ", "FDOp", 
       " ", "definitions", " ", "to", " ", "use", " ", "SeriesCoefficient", 
       " ", "with", " ", "FDOp"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "FDOp", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ret", "=", 
          RowBox[{"ret", "//.", 
           RowBox[{
            RowBox[{
             RowBox[{"Power", "[", 
              RowBox[{"a_FTerm", ",", "b_"}], "]"}], "/;", 
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"{", "a", "}"}], ",", 
               RowBox[{"FDOp", "[", "__", "]"}], ",", "Infinity"}], "]"}]}], ":>", 
            RowBox[{"FEq", "@@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"FTerm", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"SeriesCoefficient", "[", 
                  RowBox[{
                   RowBox[{"a", "^", "b"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "0", ",", "n"}], "}"}]}], "]"}], "**", 
                 RowBox[{"NonCommutativeMultiply", "@@", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"FixIndices", "[", 
                    RowBox[{"setup", ",", "a"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}], 
                "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "0", ",", "order"}], "}"}]}], "]"}]}]}]}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"ret", "=", 
          RowBox[{"ret", "//.", 
           RowBox[{
            RowBox[{
             RowBox[{"Power", "[", 
              RowBox[{"a_", ",", "b_FTerm"}], "]"}], "/;", 
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"{", "b", "}"}], ",", 
               RowBox[{"FDOp", "[", "__", "]"}], ",", "Infinity"}], "]"}]}], ":>", 
            RowBox[{"FEq", "@@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"FTerm", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"SeriesCoefficient", "[", 
                  RowBox[{
                   RowBox[{"a", "^", "b"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"b", ",", "0", ",", "n"}], "}"}]}], "]"}], "**", 
                 RowBox[{"NonCommutativeMultiply", "@@", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"FixIndices", "[", 
                    RowBox[{"setup", ",", "b"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}], 
                "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "0", ",", "order"}], "}"}]}], "]"}]}]}]}]}],
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "ret"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9512858144958143`*^9, 3.951285815620013*^9}, {
  3.951286835188345*^9, 3.9512868784211693`*^9}, {3.951286911623101*^9, 
  3.951286917760015*^9}, {3.95128697645728*^9, 3.951287305262067*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"c8e3186f-3d3b-492c-8b02-56053c948bd0"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"FExpand", "[", 
   RowBox[{"Setup", ",", 
    RowBox[{"FTerm", "[", 
     RowBox[{"Exp", "[", 
      RowBox[{"FTerm", "[", 
       RowBox[{
        RowBox[{"A", "[", "x", "]"}], 
        RowBox[{"A", "[", 
         RowBox[{"-", "x"}], "]"}]}], "]"}], "]"}], "]"}], ",", "2"}], 
   "]"}]}]], "Input",ExpressionUUID->"87287bca-0606-4a37-8cec-767710657f9b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ResolveFDOp", "[", 
  RowBox[{"Setup", ",", 
   RowBox[{"FTerm", "[", 
    RowBox[{
     RowBox[{"FDOp", "[", 
      RowBox[{"A", "[", "h", "]"}], "]"}], ",", 
     RowBox[{"GammaN", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"AnyField", ",", "A"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "x"}], ",", "g"}], "}"}]}], "]"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9512865969346733`*^9, 3.95128666406367*^9}, {
  3.9512867678195963`*^9, 3.951286794064334*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"513ad122-b877-49e8-a3ea-d96e8be9b21e"],

Cell[BoxData[
 RowBox[{"ResolveFDOp", "[", 
  RowBox[{"Setup", ",", 
   RowBox[{"FTerm", "[", 
    RowBox[{
     RowBox[{"FDOp", "[", 
      RowBox[{"A", "[", "h", "]"}], "]"}], ",", 
     RowBox[{"GammaN", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"AnyField", ",", "A"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "x"}], ",", "g"}], "}"}]}], "]"}]}], "]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.951286601978271*^9, 3.951286664430045*^9}, 
   3.951286729208035*^9, {3.951286761016094*^9, 3.951286794810369*^9}, 
   3.95128828560432*^9},
 CellLabel->
  "Out[142]=",ExpressionUUID->"36d61d18-3063-4622-9cb6-4ff899926126"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FEq", "[", 
   RowBox[{"FTerm", "[", 
    RowBox[{"Exp", "[", 
     RowBox[{"FTerm", "[", 
      RowBox[{
       RowBox[{"FDOp", "[", 
        RowBox[{"JA", "[", "x", "]"}], "]"}], ",", 
       RowBox[{"G", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"GA", ",", "GA"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "x"}], ",", 
           RowBox[{"-", "y"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"FDOp", "[", 
        RowBox[{"JA", "[", "y", "]"}], "]"}]}], "]"}], "]"}], "]"}], "]"}], "//", 
  RowBox[{
   RowBox[{"FPrint", "[", 
    RowBox[{"Setup", ",", "#"}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.95128588158747*^9, 3.951285894491994*^9}, {
  3.951285926511264*^9, 3.951285939323969*^9}, {3.951286090875435*^9, 
  3.9512860927070436`*^9}, {3.951286497671545*^9, 3.9512865573876333`*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"281301ac-dffb-4d5e-bbd1-6b3edb5983f7"],

Cell[BoxData[
 RowBox[{"FPrint", "[", 
  RowBox[{"Setup", ",", 
   RowBox[{"FEq", "[", 
    RowBox[{"FTerm", "[", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"FTerm", "[", 
       RowBox[{
        RowBox[{"FDOp", "[", 
         RowBox[{"JA", "[", "x", "]"}], "]"}], ",", 
        RowBox[{"G", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"GA", ",", "GA"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "x"}], ",", 
            RowBox[{"-", "y"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"FDOp", "[", 
         RowBox[{"JA", "[", "y", "]"}], "]"}]}], "]"}]], "]"}], "]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{
  3.951285883505773*^9, {3.951285930362904*^9, 3.95128596883426*^9}, {
   3.951286081597411*^9, 3.951286094023354*^9}, 3.951286272649108*^9, {
   3.951286481651016*^9, 3.95128655805203*^9}, 3.951288285620202*^9},
 CellLabel->
  "Out[143]=",ExpressionUUID->"773dc129-9e4e-4d12-a3a3-6c2bea7d52e7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DerivativeExpand", "[", 
  RowBox[{"Setup", ",", 
   RowBox[{"FTerm", "[", 
    RowBox[{"Exp", "[", 
     RowBox[{"FTerm", "[", 
      RowBox[{"FDOp", "[", 
       RowBox[{
        RowBox[{"A", "[", "x", "]"}], ",", 
        RowBox[{"FDOp", "[", 
         RowBox[{"A", "[", 
          RowBox[{"-", "x"}], "]"}], "]"}]}], "]"}], "]"}], "]"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.951285827015435*^9, 3.951285875811627*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"4295c899-7890-4d08-8905-98f26dddfa74"],

Cell[BoxData[
 TemplateBox[{
  "FDOp", "invalidArguments", 
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"FDOp[A[x], FDOp[A[-x]]]\\\\\\\"\\\"}]\\) \
is not a valid FDOp. FDOp takes a single field with an index as argument.\"", 
   2, 144, 3, 24594055516011077763, "Local", "Global`FDOp"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.95128828563551*^9},
 CellLabel->
  "During evaluation of \
In[144]:=",ExpressionUUID->"a83126d6-ddae-4225-8348-e9eb85e63588"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.951285876328587*^9, 3.951288285635816*^9},
 CellLabel->
  "Out[144]=",ExpressionUUID->"14ccad15-74ec-411e-bae3-2c17953e78ff"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"ReduceFTerm", "[", 
   RowBox[{"Setup", ",", 
    RowBox[{"FTerm", "[", 
     RowBox[{
      RowBox[{"cb", "[", "x", "]"}], ",", 
      RowBox[{"FDOp", "[", 
       RowBox[{"A", "[", "c", "]"}], "]"}], ",", 
      RowBox[{"cb", "[", "x", "]"}], ",", 
      RowBox[{"A", "[", "c", "]"}], ",", 
      RowBox[{"FDOp", "[", 
       RowBox[{"A", "[", "b", "]"}], "]"}], ",", 
      RowBox[{"cb", "[", "x", "]"}], ",", 
      RowBox[{"cb", "[", "x", "]"}], ",", 
      RowBox[{"A", "[", "b", "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[145]:=",ExpressionUUID->"47687bc9-4adb-47ae-af03-f85ea04c7388"],

Cell[BoxData["\<\"A valid setup must be an Association!\"\>"], "Print",
 CellChangeTimes->{3.95128828565156*^9},
 CellLabel->
  "During evaluation of \
In[145]:=",ExpressionUUID->"63e50008-60b5-48e9-9e2c-41eb853451be"],

Cell[BoxData[
 TemplateBox[{
  "FSetup", "notFSetup", "\"The given setup is not valid!\"", 2, 145, 4, 
   24594055516011077763, "Local", "Global`FSetup"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.9512882856518993`*^9},
 CellLabel->
  "During evaluation of \
In[145]:=",ExpressionUUID->"71a3c43a-99bf-4661-9979-1a859e83f450"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.951288285654338*^9},
 CellLabel->
  "Out[145]=",ExpressionUUID->"ed9d9fe8-c65e-4480-a462-a3aea57b3149"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Algorithm", "Section",
 CellChangeTimes->{{3.932177970725307*^9, 3.9321779720559883`*^9}, {
  3.9508509057472887`*^9, 
  3.950850909097567*^9}},ExpressionUUID->"be19843a-e765-47f1-9747-\
2d6834a73a9e"],

Cell[CellGroupData[{

Cell["Resolve a single FDOp", "Subsection",
 CellChangeTimes->{{3.9512328702638407`*^9, 
  3.951232879465557*^9}},ExpressionUUID->"e3f3669e-621b-4b13-b56e-\
3deed41d0aba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Resolve", " ", "a", " ", "single", " ", "occurence", " ", "of", " ", 
    "FDOp"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ResolveFDOp", "[", 
      RowBox[{"setup_", ",", "feq_FEq"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Return", "[", 
         RowBox[{"FEq", "@@", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ResolveFDOp", "[", 
              RowBox[{"setup", ",", "#"}], "]"}], "&"}], ",", 
            RowBox[{"List", "@@", "feq"}]}], "]"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ResolveFDOp", "[", 
     RowBox[{"setup_", ",", "term_FTerm"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rTerm", "=", 
         RowBox[{"ReduceFTerm", "[", 
          RowBox[{"setup", ",", "term"}], "]"}]}], ",", "\[IndentingNewLine]",
         "FDOpPos", ",", "\[IndentingNewLine]", "termsNoFDOp", ",", "dF", ",",
         "\[IndentingNewLine]", "dTerms", ",", "nPre", ",", "nPost"}], "}"}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "If", " ", "no", " ", "derivatives", " ", "are", " ", "present"}], 
        ",", " ", 
        RowBox[{"do", " ", "nothing"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{"rTerm", ",", "FDOp", ",", "Infinity"}], "]"}], ",", 
         RowBox[{"Return", "[", "rTerm", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"FDOpPos", "=", 
        RowBox[{
         RowBox[{"Length", "[", "rTerm", "]"}], "-", 
         RowBox[{
          RowBox[{"FirstPosition", "[", 
           RowBox[{
            RowBox[{"Reverse", "@", 
             RowBox[{"(", 
              RowBox[{"List", "@@", "rTerm"}], ")"}]}], ",", 
            RowBox[{"FDOp", "[", "_", "]"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"termsNoFDOp", "=", 
        RowBox[{
         RowBox[{"rTerm", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", 
            RowBox[{"FDOpPos", "-", "1"}]}], "]"}], "]"}], "**", 
         RowBox[{"rTerm", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"FDOpPos", "+", "1"}], ";;"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "If", " ", "the", " ", "derivative", " ", "operator", " ", "is", " ",
           "trailing"}], ",", " ", 
         RowBox[{"simply", " ", "remove", " ", "it"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FDOpPos", ">=", 
          RowBox[{"Length", "[", "rTerm", "]"}]}], ",", 
         RowBox[{"Return", "[", "termsNoFDOp", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dF", "=", 
        RowBox[{"rTerm", "[", 
         RowBox[{"[", 
          RowBox[{"FDOpPos", ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Perform", " ", "the", " ", "product", " ", "rule"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"nPre", "=", 
        RowBox[{"FDOpPos", "-", "1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nPost", "=", 
        RowBox[{
         RowBox[{"Length", "[", "rTerm", "]"}], "-", "FDOpPos"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dTerms", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"termsNoFDOp", "[", 
            RowBox[{"[", 
             RowBox[{";;", 
              RowBox[{"nPre", "+", "idx", "-", "1"}]}], "]"}], "]"}], "**", 
           RowBox[{"FTerm", "[", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"idx", "+", "1"}]], 
             RowBox[{"FunctionalD", "[", 
              RowBox[{
               RowBox[{"termsNoFDOp", "[", 
                RowBox[{"[", 
                 RowBox[{"nPre", "+", "idx"}], "]"}], "]"}], ",", "dF"}], 
              "]"}]}], "]"}], "**", 
           RowBox[{"termsNoFDOp", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"nPre", "+", "idx", "+", "1"}], ";;"}], "]"}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"idx", ",", "1", ",", "nPost"}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"ReduceFEq", "[", 
         RowBox[{"setup", ",", 
          RowBox[{"FEq", "@@", "dTerms"}]}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9511105533495092`*^9, 3.9511105648525476`*^9}, {
   3.951119455805057*^9, 3.9511195617211657`*^9}, {3.951119676282247*^9, 
   3.951119712474145*^9}, {3.951119753961474*^9, 3.951119965018001*^9}, {
   3.951120276792581*^9, 3.9511205887782927`*^9}, {3.951120670947592*^9, 
   3.951120778348651*^9}, {3.951120826438107*^9, 3.951120906614008*^9}, {
   3.951120939999701*^9, 3.951120956314575*^9}, {3.951121009242169*^9, 
   3.951121081510736*^9}, {3.951121127768268*^9, 3.951121329433323*^9}, {
   3.951121359899194*^9, 3.951121425034974*^9}, {3.9511224825381813`*^9, 
   3.951122501258943*^9}, {3.951123573189911*^9, 3.951123598725543*^9}, {
   3.951123637357983*^9, 3.9511238544580727`*^9}, {3.951123926802017*^9, 
   3.9511240059898977`*^9}, {3.9511240423102016`*^9, 3.951124131010861*^9}, {
   3.9511241648535767`*^9, 3.951124227324479*^9}, {3.951199174459216*^9, 
   3.951199180926196*^9}, {3.951200228052285*^9, 3.951200273018259*^9}, {
   3.951200422144641*^9, 3.951200425300118*^9}, 3.95120094844139*^9, {
   3.9512011642699833`*^9, 3.951201182694016*^9}, 3.951201274960949*^9, {
   3.9512015178111143`*^9, 3.951201562510607*^9}, {3.9512095086440887`*^9, 
   3.951209512939533*^9}, {3.951209684117496*^9, 3.951209732155652*^9}, {
   3.95120994522215*^9, 3.951209973936924*^9}, {3.9512110641082573`*^9, 
   3.95121111673773*^9}, 3.951211153997551*^9, {3.951211324253121*^9, 
   3.951211350271022*^9}, {3.951211627960374*^9, 3.951211709649838*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"ac348a0a-7a6e-409c-9a98-56e5170bdbb5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ResolveDerivatives", "::", "argument"}], "=", 
    "\"\<The given argument is neither an FTerm nor a FEq.\nThe argument was \
`1`\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Iteratively", " ", "resolve", " ", "all", " ", "derivative", " ", 
    "operators", " ", "in", " ", "an", " ", "FTerm", " ", "or", " ", "FEq"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ResolveDerivatives", "[", 
    RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ret", "=", "expr"}], ",", 
       RowBox[{"i", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AssertFSetup", "[", "setup", "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{"ret", ",", 
          RowBox[{"FDOp", "[", "__", "]"}], ",", "Infinity"}], "]"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"ReduceFEq", "[", 
          RowBox[{"setup", ",", "ret"}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FTermQ", "[", "ret", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"ret", ",", 
              RowBox[{"FDOp", "[", "__", "]"}], ",", "Infinity"}], "]"}], "&&", 
            RowBox[{"i", "<", "$MaxDerivativeIterations"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ret", "=", 
             RowBox[{"ResolveFDOp", "[", 
              RowBox[{"setup", ",", "ret"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "ret", "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FEqQ", "[", "ret", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Return", "[", 
          RowBox[{"FEq", "@@", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ResolveDerivatives", "[", 
               RowBox[{"setup", ",", "#"}], "]"}], "&"}], ",", 
             RowBox[{"List", "@@", "ret"}]}], "]"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"ResolveDerivatives", "::", "argument"}], ",", "ret"}], "]"}],
       ";", 
      RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951109126796526*^9, 3.951109162803561*^9}, {
   3.951109195696103*^9, 3.9511092753420467`*^9}, {3.951109641851746*^9, 
   3.951109708704658*^9}, {3.951109745518846*^9, 3.951109820791531*^9}, {
   3.951119472303504*^9, 3.951119473407467*^9}, {3.951201291788858*^9, 
   3.9512015119676657`*^9}, {3.951201569206512*^9, 3.951201586086426*^9}, {
   3.951206148564587*^9, 3.951206211857237*^9}, {3.9512062440841913`*^9, 
   3.951206321742989*^9}, {3.951206368639289*^9, 3.951206475591106*^9}, 
   3.951207767500757*^9, 3.9512094609041777`*^9, {3.9512095311450663`*^9, 
   3.951209577983329*^9}, {3.951209618249853*^9, 3.951209633863234*^9}, {
   3.9512097690861053`*^9, 3.9512099352835913`*^9}, {3.951209996511508*^9, 
   3.9512100677197866`*^9}, {3.9512102840601892`*^9, 3.951210369806964*^9}, 
   3.95121047975072*^9, {3.951210516428762*^9, 3.951210536552635*^9}, {
   3.951211721416297*^9, 3.9512117303764887`*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"b0835c23-2d69-40a7-9251-be3d8571a3bb"]
}, Closed]],

Cell[CellGroupData[{

Cell["Take several functional derivatives", "Subsection",
 CellChangeTimes->{{3.9508680530500927`*^9, 
  3.950868063045309*^9}},ExpressionUUID->"a8f64e7a-d885-45c2-99d7-\
7e2e4dc385f7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Protect", "[", 
   RowBox[{"OutputLevel", ",", "SuperIndexForm"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "TakeDerivatives", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"OutputLevel", "->", "SuperIndexForm"}], "}"}]}], ";"}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.951227336083239*^9, 3.951227337862597*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"bba04405-f573-40fc-9a19-18ca7de811ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Perform", " ", "multiple", " ", "functional", " ", "derivatives", " ", 
    "on", " ", "a", " ", "master", " ", 
    RowBox[{"equation", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TakeDerivatives", "[", 
     RowBox[{"setup_", ",", "expr_", ",", "derivativeList_", ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "result", ",", "\[IndentingNewLine]", "externalIndexNames", ",", 
        "outputReplacements", ",", "\[IndentingNewLine]", 
        "derivativeListSIDX"}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AssertFSetup", "[", "setup", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AssertFEq", "[", "expr", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AssertDerivativeList", "[", 
        RowBox[{"setup", ",", "derivativeList"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"While", " ", "doing", " ", "the", " ", "derivatives"}], ",",
          " ", 
         RowBox[{
          RowBox[{"we", " ", "want", " ", "to", " ", "use", " ", "super"}], 
          "-", 
          RowBox[{"indices", ".", " ", "Afterwards"}]}], ",", " ", 
         RowBox[{
         "we", " ", "can", " ", "replace", " ", "these", " ", "again", " ", 
          "with", " ", "the", " ", "given", " ", "indices"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"externalIndexNames", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<eI\>\"", "]"}], "&"}], ",", 
          "derivativeList"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"outputReplacements", "=", 
        RowBox[{"Thread", "[", 
         RowBox[{"externalIndexNames", "->", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"FieldIndices", "@@", "#"}], "&"}], ",", 
            "derivativeList"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"derivativeListSIDX", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", 
            RowBox[{"derivativeList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
           RowBox[{"externalIndexNames", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "derivativeList", "]"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "We", " ", "take", " ", "them", " ", "in", " ", "reverse", " ", 
         RowBox[{"order", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"derivativeListSIDX", "=", 
        RowBox[{"Reverse", "[", "derivativeListSIDX", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"First", ",", " ", 
         RowBox[{
         "fix", " ", "the", " ", "indices", " ", "in", " ", "the", " ", 
          "input", " ", "equation"}], ",", " ", 
         RowBox[{
          RowBox[{"i", ".", "e", ".", " ", "make"}], " ", "everything", " ", 
          "have", " ", "unique", " ", "names"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"FixIndices", "[", 
         RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Perform", " ", "all", " ", "the", " ", "derivatives"}], ",",
          " ", 
         RowBox[{"one", " ", "after", " ", "the", " ", "other"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"result", "=", 
          RowBox[{"ResolveDerivatives", "[", 
           RowBox[{"setup", ",", 
            RowBox[{
             RowBox[{"FTerm", "[", 
              RowBox[{"FDOp", "[", 
               RowBox[{"derivativeListSIDX", "[", 
                RowBox[{"[", "pass", "]"}], "]"}], "]"}], "]"}], "**", 
             "result"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"pass", ",", "1", ",", 
           RowBox[{"Length", "[", "derivativeList", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"OptionValue", "[", "OutputLevel", "]"}], "===", 
          "SuperIndexForm"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Return", "[", " ", 
           RowBox[{"{", 
            RowBox[{"result", ",", "outputReplacements"}], "}"}], "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"result", "//.", "outputReplacements"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.95086807399784*^9, 3.950868101837797*^9}, {
   3.950868135961317*^9, 3.950868153423587*^9}, {3.950868228217888*^9, 
   3.950868269490148*^9}, {3.95086841046174*^9, 3.950868424387451*^9}, {
   3.950873786052535*^9, 3.950873787662897*^9}, {3.950874377585595*^9, 
   3.950874378821952*^9}, {3.950875285850876*^9, 3.950875301335219*^9}, {
   3.950875343786489*^9, 3.9508753492991743`*^9}, {3.9508754834989862`*^9, 
   3.950875487444517*^9}, {3.9508932689591846`*^9, 3.950893303250742*^9}, {
   3.950893467838776*^9, 3.950893530412135*^9}, {3.950951875092435*^9, 
   3.950951917051467*^9}, {3.950951969983094*^9, 3.950951982885131*^9}, {
   3.950953049415739*^9, 3.9509530566618147`*^9}, {3.9509576893692417`*^9, 
   3.950957693641984*^9}, {3.950957869930423*^9, 3.9509578703743134`*^9}, {
   3.951205890224668*^9, 3.951205922452134*^9}, {3.9512059655680513`*^9, 
   3.951205987956233*^9}, {3.9512060250926027`*^9, 3.951206037771141*^9}, {
   3.9512060757270203`*^9, 3.9512061056706333`*^9}, {3.951210129116617*^9, 
   3.951210160246964*^9}, {3.951210230711794*^9, 3.951210261583102*^9}, {
   3.951210487269314*^9, 3.9512104881636333`*^9}, 3.951210648908422*^9, {
   3.951210922739853*^9, 3.951210952732194*^9}, {3.9512110036490707`*^9, 
   3.9512110540158043`*^9}, {3.951211364096175*^9, 3.951211371087821*^9}, {
   3.9512114169092283`*^9, 3.951211492808696*^9}, {3.951211535712715*^9, 
   3.951211602095957*^9}, {3.951211800213296*^9, 3.951211815568632*^9}, {
   3.9512134241932383`*^9, 3.951213498323842*^9}, {3.9512273400034513`*^9, 
   3.9512273627572317`*^9}, {3.9512928826295767`*^9, 
   3.951292884973175*^9}},ExpressionUUID->"fcb7ecd2-adb3-4b5a-a94f-\
8080924ea319"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing", "Title",
 CellChangeTimes->{{3.9508681098093233`*^9, 
  3.950868110913395*^9}},ExpressionUUID->"7a24c792-7a48-4e73-8b88-\
7b56966e439b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<FunKit`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.951280802995201*^9, 3.951280805886263*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"45787101-b7c2-46b3-828f-0dde391998ab"],

Cell[CellGroupData[{

Cell[BoxData["\<\"\\!\\(\\*\\nStyleBox[\\\"Loading\\\",\\nFontSize->10,\\\
nFontWeight->\\\"Plain\\\",\\nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\\
nStyleBox[\\\" \
\\\",\\nFontSize->10,\\nFontWeight->\\\"Plain\\\",\\nFontSlant->\\\"Italic\\\"\
]\\)\\!\\(\\*\\nStyleBox[\\\"modules\\\",\\nFontSize->10,\\nFontWeight->\\\"\
Plain\\\",\\nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"...\\\",\\\
nFontSize->10,\\nFontWeight->\\\"Plain\\\",\\nFontSlant->\\\"Italic\\\"]\\)\"\
\>"], "Print",
 CellChangeTimes->{3.9512808080301123`*^9, 3.9512882856954603`*^9, 
  3.951293259266097*^9},
 CellLabel->
  "During evaluation of \
In[3]:=",ExpressionUUID->"dcbee3e8-b796-462f-badf-295e96d96acf"],

Cell[BoxData["\<\"\\!\\(\\*\\nStyleBox[\\\"...\\\",\\nFontSize->10,\\\
nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"TensorBases\\\",\\\
nFontSize->10,\\nFontWeight->\\\"Bold\\\",\\nFontSlant->\\\"Italic\\\"]\\)\\!\
\\(\\*\\nStyleBox[\\\" \
\\\",\\nFontSize->10,\\nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\
loaded\\\",\\nFontSize->10,\\nFontWeight->\\\"Plain\\\",\\nFontSlant->\\\"\
Italic\\\"]\\)\"\>"], "Print",
 CellChangeTimes->{3.9512808080301123`*^9, 3.9512882856954603`*^9, 
  3.951293260801409*^9},
 CellLabel->
  "During evaluation of \
In[3]:=",ExpressionUUID->"44165c13-a8f1-4101-984b-366e85be4fb5"],

Cell[BoxData["\<\"\\!\\(\\*\\nStyleBox[\\\"...\\\",\\nFontSize->10,\\\
nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"FEDeriK\\\",\\\
nFontSize->10,\\nFontWeight->\\\"Bold\\\",\\nFontSlant->\\\"Italic\\\"]\\)\\!\
\\(\\*\\nStyleBox[\\\" \
\\\",\\nFontSize->10,\\nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\
loaded\\\",\\nFontSize->10,\\nFontWeight->\\\"Plain\\\",\\nFontSlant->\\\"\
Italic\\\"]\\)\"\>"], "Print",
 CellChangeTimes->{3.9512808080301123`*^9, 3.9512882856954603`*^9, 
  3.9512932609616623`*^9},
 CellLabel->
  "During evaluation of \
In[3]:=",ExpressionUUID->"4cba829c-d89a-42d7-b321-0bc1809751f0"],

Cell[BoxData["\<\"\\!\\(\\*\\nStyleBox[\\\"...\\\",\\nFontSize->10,\\\
nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"DiANE\\\",\\nFontSize->\
10,\\nFontWeight->\\\"Bold\\\",\\nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\\\
nStyleBox[\\\" \\\",\\nFontSize->10,\\nFontSlant->\\\"Italic\\\"]\\)\\!\\(\\*\
\\nStyleBox[\\\"loaded\\\",\\nFontSize->10,\\nFontWeight->\\\"Plain\\\",\\\
nFontSlant->\\\"Italic\\\"]\\)\"\>"], "Print",
 CellChangeTimes->{3.9512808080301123`*^9, 3.9512882856954603`*^9, 
  3.951293261183301*^9},
 CellLabel->
  "During evaluation of \
In[3]:=",ExpressionUUID->"1066258f-aecb-45c3-8b2f-0ebd17f1a517"],

Cell[BoxData["\<\"Welcome to  \
\\!\\(\\*\\nStyleBox[\\\"\:2588\:2580\\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\
\\*\\nStyleBox[\\\" \
\\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\\\"\:2590\:2584\:2588\
\\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\\\" \
\\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\\\"\:2588\:259a\:258c\
\\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\\\" \
\\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\\\"\:2590\
\[FilledLeftTriangle]\\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\
\\\" \\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\\\"\:2588\\\",\\\
nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\\\" \
\\\",\\nFontColor->GrayLevel[0]]\\)\\!\\(\\*\\nStyleBox[\\\"\:2580\:2588\:2580\
\\\",\\nFontColor->GrayLevel[0]]\\)\\n\\!\\(\\*\\nStyleBox[\\\"Author\\\",\\\
nFontWeight->\\\"Bold\\\"]\\): Franz Richard \
Sattler\\n\\!\\(\\*\\nStyleBox[\\\"Version\\\",\\nFontWeight->\\\"Bold\\\"]\\)\
: 1.0\\n\\!\\(\\*\\nStyleBox[\\\"Year\\\",\\nFontWeight->\\\"Bold\\\"]\\): \
2025\\nFor more information, call \
\\!\\(\\*\\nStyleBox[\\\"FunKitInfo\\\",\\nFontColor->RGBColor[1, 0.5, \
0]]\\)[].\"\>"], "Print",
 CellChangeTimes->{3.9512808080301123`*^9, 3.9512882856954603`*^9, 
  3.9512932611843243`*^9},
 CellLabel->
  "During evaluation of \
In[3]:=",ExpressionUUID->"a7869ce4-5d28-4b20-aecd-d5eb3ec045d9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fields", "=", " ", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<cField\>\"", "\[Rule]", " ", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"p", ",", 
          RowBox[{"{", 
           RowBox[{"v", ",", " ", "c"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Phi]", "[", "p", "]"}], ",", 
          RowBox[{"\[Phi]x", "[", "p", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Grassmann\>\"", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cb", "[", 
          RowBox[{"p", ",", 
           RowBox[{"{", "c", "}"}]}], "]"}], ",", 
         RowBox[{"c", "[", 
          RowBox[{"p", ",", 
           RowBox[{"{", "c", "}"}]}], "]"}]}], "}"}], "\[IndentingNewLine]", 
       "}"}]}]}], "\[IndentingNewLine]", "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"masterEquation", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"A", "[", "x", "]"}], 
        RowBox[{"VBasis", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", "A"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "x"}], ",", 
            RowBox[{"-", "y"}]}], "}"}]}], "]"}], 
        RowBox[{"A", "[", "y", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"cb", "[", "x", "]"}]}], 
         RowBox[{"VBasis", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"cb", ",", "c"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "x"}], ",", 
             RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], ",", 
        RowBox[{"c", "[", "y", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Setup", "=", 
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<MasterEquation\>\"", "->", "masterEquation"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<FieldSpace\>\"", "->", "fields"}]}], "\[IndentingNewLine]",
      "|>"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TakeDerivatives", "[", 
    RowBox[{"Setup", ",", "\[IndentingNewLine]", 
     RowBox[{"FEq", "[", "\[IndentingNewLine]", 
      RowBox[{"FTerm", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Propagator", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"AnyField", ",", "AnyField"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}]}], "]"}], 
        RowBox[{"Rdot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"AnyField", ",", "AnyField"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
       "]"}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"A", "[", 
       RowBox[{"p", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}]}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], "//", 
  RowBox[{
   RowBox[{"FPrint", "[", 
    RowBox[{"Setup", ",", "#"}], "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.9507856762700357`*^9, 3.9507858002547617`*^9}, {
  3.9509731139899683`*^9, 3.950973140087144*^9}, {3.9512274397433567`*^9, 
  3.951227441558628*^9}, {3.951227486267386*^9, 3.951227497450511*^9}, {
  3.951227632078931*^9, 3.951227677663128*^9}, {3.951228330842969*^9, 
  3.951228340299478*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"2632f66f-a425-44c8-b21c-333bdd8417c4"],

Cell[BoxData[
 GraphicsBox[
  {Thickness[0.007887679444707366], 
   FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1,
     3, 3}}}, {{{9.29219, 8.2875}, {9.29219, 8.526560000000002}, {
    9.065629999999997, 8.526560000000002}, {8.898439999999999, 
    8.526560000000002}, {2.3859399999999997`, 8.526560000000002}, {
    2.2187499999999996`, 8.526560000000002}, {1.99219, 8.526560000000002}, {
    1.99219, 8.2875}, {1.99219, 8.04844}, {2.2187499999999996`, 8.04844}, {
    2.3859399999999997`, 8.04844}, {8.898439999999999, 8.04844}, {
    9.065629999999997, 8.04844}, {9.29219, 8.04844}, {9.29219, 8.2875}}}], 
   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0,
     1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
    0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 
    1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIlIGYC4mgFx4/JMoYOMybwV5l1qzqcAQMDh/8gcF/L
ITP/Q+vJKaoYfBbOLvlkPS0IzacG53vsr5W1OK4O588EgZvqDhLz4jRPf9CE
85nB+hD8NgV21TNXJOD8vohuf0YBcbh5X/Z93Jo+TQxuH4wPcw8638QYBEQh
+tXVHKru/7hl7C3qMGeR8s4/7hpwvtzyFx56/xF8nxPstrOvasL5x3ft6GX7
oA3nP4gQ335xgQ7cfBgfZn98SJD6gpfacD7MPBi//rdVwbkTmg4an1ReztIU
h/OD317+OOOhBJw/AxQOlppw/o+3rw9YMmvBzYOFr8TUK5wZj7QQfFA4F+jC
+cVbRX+fjjOA80HOZVhn4OB3cWLMv8caDhpvefcZ3DSAxz96egAAjjnr7A==

    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
     0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1,
      3, 3}}, {{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {CompressedData["
1:eJxTTMoPSmViYGBwAGIQPSG4RGX6enOH67y3xVLNOB1g/DkzgUCSy+GOdE2i
0VQE/0CtrEV6CRqfBcGXmHqFM4PJ3OF57ePs82u4HDbq5S1m/GPm0CBey5rp
xuOg+qR53tkoMweQ8pkvFRwMtFYKXwgxczAGAWdFh4Nty8NPBZk5/AeBeEWQ
MxkYDBB8h6ZHx2dwI/hPEhdeM/lv6sAfG3DfyFzR4RBI/ydTh7VCOnzpfFDz
hIwdvuz7uDV9Gr/DbZB/tho59Ed0+zN+4HL48630wZxEI4czIODD5ZAce8eN
WcII7p/F9/fxzWE2clD/pPJyFieXw/QJ/FVmrw0dtnttsJjzkxPOP9i9r8nk
MQecD/bPZg6I+94bQtz7n93h84aA7FnsRnA+t5tqKZMUgp+eBgRqRg59IPcZ
cMDdC+OD48feGM4v2Sr6+3SeMVx/7W+rgnMVCL4JyB3NCD7Yvwsx+bD4h/Fh
/m1kOdpv2G4MDw9wONUg+MtfeOj9DzR24HHk85qhCVWvbgyPfxjf/4nnJVNh
HjhfA2w+LyQ8zI0d7Esca0/f4XU4fdhpbWYc1D3b+B3qQf55YewQoxohcy5G
2OELSL24GZwPTm9OZhB/fuaG80uWl2z4x8/tECG+/SKDnBncvZEg/j5TOB8c
P/MRfHB6bMHkw+IXxj8A5d8Q+uR4vs0UHp6fQO5bjuCD0/8eBB+c7jnNHGQ2
is1nUuCApGdpM3h8xig4fkyeg+AvAaW/YHM4H5Q80srM4eZB7EfwwemhD8GH
5Wd0Piy+AR2Fz5Q=
     "], {{22.060899999999997`, 5.10313}, {20.0766, 5.10313}, {
     21.726599999999998`, 7.72344}, {22.060899999999997`, 5.10313}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0,
      1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{0, 2, 
     0}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGBQAGIQvUUvbzHjHyuHB67xjrMEJRxg/PsgvqGEg/pb3n0G
P60cWhXYVc+USDg8SVx4zeQ+gj9lAn+V2WkEPyX2jhvzCSuHvohuf8YACYfl
Lzz0/h+0ckhPAwI2CQefixNj/k22cmAAAQcxhx6vVywmilYOZ8BA1EH9SfO8
s7cs4XyQtrQ2BP/UYae1mXaWDiKVk0rOpog5LL6/j2+OsKVD0NvLH2c4ijuo
gvVbQPiJEnD+l30ft6Z/k4Tz37TldhvNlnI4ATLvnBWc/x8E3iP4sPBA58vv
WrAvVU8azk8F+0/WYYv5j0Mpu6wc1gjp8KXfk4fI77GE871PsNvOfmoB588E
AU8Lh15weMnC+f0gfoEUnH8W5P0ccQj/J8w/Ig5/vpU+mHPREs4PF99+kWGd
FZwPc1/l/R+3jLvFHdDjGwBBP+jn
     "], {{26.5484, 6.831250000000001}, {24.867199999999997`, 
     6.831250000000001}, {24.9328, 7.632809999999998}, {25.4828, 7.77656}, {
     25.728099999999998`, 7.77656}, {26.499999999999996`, 7.77656}, {
     26.542199999999994`, 7.00469}, {26.5484, 6.831250000000001}}}], 
   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0,
     1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 
    3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
    0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJpIGYC4qdZ2t+m19o6mBiDgKgDjB/y9vLHGYpiDj1e
r1hMAhF88alXODMu2WDwq+7/uGWcjeB/2fdxa7qZOJx/W1N2zf/DinD+TBDQ
VILz1wrp8KX7KcHtg/Fh7kHn78mveTvzqJKDzwl229mtNg4zQObtVHJ4DpLv
tYbLw/gw/RxuqqVMuxB89be8+wwsbTD4MPfB+DD3w/gw/8H4MP/D+LDwgdkH
48Pcg86HhT/MP2DzvBHxAZMHAFCds8s=
    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 
    3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 
    1, 0}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJZIGYCYnnHj8lnSh0cTIxBQNQBxg95e/njDEUxB9bF
k6wYQxH8CPHtFxnYMPkPXOMdZxUi+G/acruNrMXh/G4bz11pRkpw/lohHb70
PiWH3zG5R/8xIfgJsXfcmG/Yw/lgdxXbOzhPaBZKO6XocFXok+P5a3Zwfm9w
icr0+Zh8sHeCFR0+bAjInnUcwY9RAHpQxx7O5/FfPyW1w97hw6L1CmdXIPgw
98P4MP/B+DD/qz5pnnf2lR2cX/vbquDcCkw+LHxtKiNWmP61c6i6/+OWsbeo
w/5aWYv0Ens4f4v5j0MppxD8/yDA7wDnVwC1n/VG8NHjDwAq07tn
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGDQBmIQrfqked7ZJCeHdgV21TMiUg4wvkjlpJKzT6Qcjmta
TTod7+RwBgRyZByCS1Sm/zdwclD/pPJy1klZB90JC34Yijk5yO9asC+1T85h
yje2+BlfHCH6U+Qdsjl/LkjfjODLO35MPlOL4BdvFf19OszRYXuwVcT/djmI
PTaODmuFdPjS5WQdvE+w2862dXR44BrvOCtQzuFx4sJrJvaODulpQKCm4LD8
hYfe/0hHB2GwexUcHJoeHZ9R7ehQfnib68yzig76IPetc3SYCQKaSg4b9fIW
M95B8MHmv0Xwwf4TgPpXRsnBGASUnRz4YwPuGx1XdFjTfTuDgd0JYt8WRQfx
qVc4M5icHPbm17ydmYrg39GUXfPfGMGHuc/82tFcE6D590H+Wajg8ATkH3UE
P1J8+0UGOwR/Mig8fZwcqu//uGV8G8F3ntAslGalCOeDzf+i6JBw+LJ2qqYT
JPz6lCDhf9sRzgfHTwqCD3bPBweHld9eVpz5oADnQ+JXBs73WHN0OcMPMUh8
uTk6mIDCZbOIQ0XECtOzqxF8cDieRPDB8f3XEaL/hojD/lpZi3QdJwcGEHAQ
c2BZPMmK0RWa3ljE4ekPbM5PBB+WPgHIcB5/
     "], CompressedData["
1:eJxTTMoPSmViYGAQBmIQrTthwQ9DMSeHdgV21TMiUg4wvvyuBftS8yQczoCA
iJPDWiEdvvR54g5vePcZzPzl6KDxSeXlrJViDrz+66ekvnB0eOAa7zjro6jD
cU2rSafPOzoogPT3iTr8jsk9+m8Vgv84ceE1E3tMPtieNZJw/pu23G6j2VJw
virYPhkH9SfN885mOTr8B4H5cg6fNwRkz1qP4O+81fU39TqCn54GBO+gfHk5
h/rfVgXnGJwg5kfLwv0Ltj9HBs6fPhMIIqUd0MMHAA89k40=
     "]}], 
   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0,
      1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
     0}}}, {CompressedData["
1:eJxTTMoPSmViYGAwBmIQ7XWC3Xb2UxeHGNUImXN7eB1g/LVCOnzp8wQcIsS3
X2Q4hsmHqYfxZTaKzWdS4HYo2Sr6+/Q2F4c5M4FAkssh8fBl7dSFCL5D06Pj
M6ox+RqfVF7O4uSF82Hmw/hg++tEUfnzJBxUnzTPOyvl4vBl38et6WZSDpEg
9+xzhvMTQPZnOqPKyzk73HeNd5xlKAnng+XFxOH8kLeXP85QFHPI4fy5IN3Y
2UFh14J9qX2iDgqOH5PP+CL4ElOvcGZkocnXOjs8AJsvBueD5fnEUeUvijuk
pwFBnrNDNMi/MRIODCAQ4ewgUjmp5GyLBFz9Q5D6QEmHMyCwBcHfqJe3mHEP
gs+6eJIV41cEX2/Cgh+Gei4OxiAgLAHng/1bJgrng6JjZqWIw++Y3KP/Pjk7
BIH8nyjisMBG58qsdc4OO4OtIv67izjsvNX1NzXdGRI/McIO3qD0wusM8Yea
kEP78vBTRn+cIO70EYDzwf5q4IPzm8RrWTPZOB1MQO5KdnawK3GsPR3DDnHH
SgQf7L8vCP6KFx56/xVdHLZ7bbCY85PTgcd//ZRUCxeHFpB5bTwOQp8cz6fZ
ItIXJDxdHPoiuv0ZN7BD3NWC4K/pvp3B0I/gw9I/mP8BwYelRwDiu0tY
     "], {{40.3609, 4.1234399999999996`}, {40.3609, 3.3499999999999996`}, {
     39.70779999999999, 3.14375}, {39.38909999999999, 3.14375}, {
     38.974999999999994`, 3.14375}, {38.623400000000004`, 3.42188}, {
     38.623400000000004`, 3.8046899999999995`}, {38.623400000000004`, 
     4.32969}, {39.1172, 4.871880000000001}, {40.3609, 4.912500000000001}, {
     40.3609, 4.1234399999999996`}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1,
      3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 
     3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGAQA2IQDQYa7g7Bby9/nPFQyAHGTwOBZ2IOa7pvZzDsd3M4
AwI8Ug5vePcZzHRC8Je98ND7/9EVzre4djTX5ICrg/yuBftS10k4lGwV/X16
navDm7bcbiNpBH+tkA5fOp8ihC/m6vDANd5x1kMFOL/6/o9bxtEKDm3Lw08Z
xSD4B2plLdJToPrtEHyw/W/k4Pz/YMDusFEvbzFjC4LvplrKNGuFq4OJMRB8
5nbo8XrFYnLQ1UH9k8rLWSc5HUJKVKb//+DqYFfiWHs6hh0SDmZucP4JTatJ
p7cj+LDwsgXx5/A6oIcnAKIslqg=
     "], CompressedData["
1:eJxTTMoPSmViYGCQAmIQLfLJ8XzaWTcH9U8qL2e9FHKA8eV3LdiXqofgf933
cWv6NX4HN9VSplkr3By+gPk8DhURK0zPNrs5bPfaYDHnJ6fDRr28xYwhbg5p
IKDG6SAx9QpnhhGCn3j4snYqI4LvCjLvhqtDjGqEzLk9XA6R4tsvMuxzddgK
Ms+S1+Fifjz7uY2uDr0R3f6MBXxwPgMINCD413lvi6Vu44fzH7jGO84SFIPz
z4DAGgQ/CmyfmEOP1ysWk4OuDn0g8wPEHUq2iv4+fc/VIRokXyPhsMBG58os
PjeHHcFWEf/VJR2mfGOLn2GD4M8EgUIEPwHkv5luDlX3f9wy1pZwUHD8mHxm
LTS8zMQd1nTfzmDY7+bwpi232yhaDB6+YP/biDqgxwcA9GGvkA==
     "]}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
     3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJzIGYCYvGpVzgzdnk5+Jxgt529VcUBnR9SojL9/w4v
hzQQeKbiYGIMBKsx+alQPo//+impCxDyIp8cz6fN9XLYoPqked5ZqPmzvBzM
bPYGTTuo4nAGBFK8HO67xjvOUlR2WNN9O4PB3MvhAYjfqOjwHwTkofyNCg4J
hy9rpzJ6OcSoRsics5GHqD/v6bA92CriP7u0Q3nECtOzpz0dGEAgQdah/rdV
wbkTnhD3tSk4zLfRuTKrz9Oh/PA215lrlSDm53s6hHOKtRvfV3bYqJe3mNHG
0+Hn29cHLJVVHfbXylqkn/GA88H+E0DwL+bHs59b6e4ACgbjZEU4/7am7Jr/
hxXgfLA/exQcpnxji5+xBcHv8XrFYrITwQf75zgm/8Oi9QpnZyg4LAC5/xyU
/wLKf+fucAdkX7KSg6tqKdOsAA+I/ycoOyx74aH3fyeCD/M/jH9DuibRaK2n
w5d9H7emb5OH89+05XYb/ZaC82eCwE9xh/e8+wxmLvJ08FhzdDnDDzFIfMz0
dDjYva/JhFkMEl41ng5nQe7nEYb439MTEs72XHB+wBPPS6aT2eF8sH/PsEHS
jZ8nJF19ZnV4A7IvCsEHu6MQwd95q+tvaj3UfZKcDubXjuaaTPB0eFH7OPv8
Gx4HlsWTrBi3ejpU3/9xy3i1kEO4+PaLDPs8HUQqJ5WcPSLiIO/4MfnMUU8H
hV0L9qWuE4Okz1OeDm0K7KpnrohD/KfoBQ8fWPpVufYomGGOMsT8pV6Q9PRX
GZ5/wOljMWZ+AgCLvYDY
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{
     0, 2, 0}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGBQAGIQ/R8Elvs4nNi1o5ctQM0BxmcAgQQ1B5bFk6wYl/o4
1P62KjjXoeZwVNNq0unpCP6Ub2zxM3oQfPGpVzgzunwcXhVvFf2drebA479+
SmqHj4Noj9crlhA1h4qIFaZnk30c5ixS3vnnuIrDBr28xYw8PhB6j4rDjJlA
8NMbzi8HqT+N4IPdM9fb4e+30gdzBFUd0tOAoA4or/qked5ZVYfjIPfFe8Pd
A+OD5XvV4fzZIPvZNRxyOH8uSO/2gfOXvvDQ+78QwYeFBzo/DQwQfJl5cZqn
L2g6RIhvv8hQ5uNgbrM3aFqjNsR9z7zhfLD96Qg+2D+s3g4vsrS/Tb+rCef/
evv6gOVjdTjf6wS77eyrqg4mxkBQDFVvq+Jg3/To+IzPCD5YfakPnA9zX+At
6ZrET6oO6PENACKx65Q=
     "], {{56.771899999999995`, 12.2234}, {54.7563, 12.2234}, {54.8281, 
     13.3391}, {55.504699999999985`, 13.529699999999998`}, {
     55.800000000000004`, 13.529699999999998`}, {56.731300000000005`, 
     13.529699999999998`}, {56.76249999999999, 12.4063}, {56.771899999999995`,
      12.2234}}}], 
   FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1,
      3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
     0}, {0, 1, 0}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}, {1, 3, 3}, {0, 1, 0}}}, {CompressedData["
1:eJxTTMoPSmViYGCQAmIQ/R8Elvs5pKeBAJMDjM8AAg0sDqpPmuedTULw3/Lu
M5gZ5edgYgwEnxF8/yeel0yFOeD83ohuf8YAeQj/kK/Dl30ft6Z/k4Pz1T+p
vJz1UhZiH7sfnG9+7WiuiQBU/wYEH6xOXgbO3xFsFfE/XdRhb62sRfobX4cY
1QiZc3PEHKZ8Y4ufsccX4l4HcYcvGwKyZ7Uj+BD7EPySraK/T0/zcdAA2a8p
AuefPQMEPAJw/pJbyx8bOnM4gITP/IHyDzM6iHxyPJ9W6wvnJxy+rJ26E8HP
4fy5IP21L0RfD7MDy+JJVoy8fg4t4rWsmcdY4XyYevT4AAAdWrpE
     "], CompressedData["
1:eJxTTMoPSmViYGAQB2IQzbJ4khUjr5/DGRDw4XKA8dNAQI0Tlf+Mw0He8WPy
mb++DjIbxeYzLWB36PF6xWLy0Nch4InnJVNhVgfxqVc4Mzb5QszrYXaQAPGb
EHz7pkfHZwQj+CpPmued1ULov7uPb46xkK9DX0S3P2MBu0PJVtHfp7/5OLyo
fZx9/g2nw4yZQPDRx0Hjk8rLWZy8cL5w5aSSsywCcP5aIR2+9HuCDqog83/5
QOzTEYabD9bvKQK332PN0eUMFaIOLqqlTLMifB3etOV2G0WLOUz5xhY/owfB
9znBbjt7L4KfCgqXd74ObiD9M0Th4dULcv8HYQf08AUAX+WeQQ==
     "]}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1,
     3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 
    3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
    1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 
    3}, {1, 3, 3}}}, CompressedData["
1:eJx11H0slVEYAPAr1q0/aIuLS3jvuHJdRT5LaY9K3CLvKeO2yCIfkbRVIlcM
sbpapS8fZcoaTT7GZKl8zKzymam7pjUSQ9iipkzUPe9773u2rLOdP3475z3P
Oc95ziuKSDwYpcvj8XTUPVjdV6m7LDXL0f8hgphodVNRoLULboYimNZvdios
Ii7L99QJKCAOtDSOC1ASd+OmQLAujB5y5ougUvkxlpdI3JCteFvvQ+wrPreq
aJTmvmfGPxEz4+9W+mWiYqbwEcXZ90lHOS+WgrULpTH1gzQod8iaoiNW2sp7
NrJ7hnio2eCeiz1a4cfzk8ndTsTJQ78GXSqtOJ/XODShY7nOHIECu8sMlPu+
6rnqI5jKSVA6HxGC+dSIu9k3Gqim0uaoamMIw/PrabhE8cXdtwRsfnOImfX2
E3uoOhJcPwRC1XoHg5iLJpxblc2Zru1WnFNx/FQR6OELWgqEhZmp1m3WYvDB
+fGjwUFk9eOkaiN7P8k0jB17oHK9JoEvRhZvxlpo6HsfPO343J7Nsy7inFb9
NCI9jLgQtzQEZiVHJV20HefO9l1VJyxtOdduPlWm80IMWUh2P+MCAv/XfK9i
N2IebsM2nDMWPU/3Vtiw+c0klnrmd6VnE0801uiO5xEz8a4iGMXnqbGB2s+T
t+uuI5iIk87ftRCz81u18aWcJ840CBbjpSA3aeznNf3fIRqPa2w4590X3UDG
mfqvUY/j+I5S7jxMHl0ksAbXXxKCA/03QpcjJfBs8MpSVIy6XuZq6XhPTT5l
CPxa0iy2vrKHGrx/O7J+irzCrYdPzLy/3zRnZr6cOA/X3+FA2ITv292WM7Od
mxTnNlw/u4Xs+ro0DPuEexdtMWL3n0TM7K+KmFnnOw178XuTC9h8CLX1bgoU
fl8iBHZzNpNFl43Z+nbW3DcI4A9uHsTJOP524p+rwwv8vRAYpeSf7Tm+0u0D
0ijhTgShYvmGXoUAcstDOp33aOJJTNj1fREY4vl6pmy+ghDk4vdkZA7i0ayS
nggEQTMDswVtlux54xAUM/dAsd/HI7BWjRzihVJsPdwh/4fEcH6vsJBY+7/8
19r/6V+rfzzx
    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
     0}}}, {CompressedData["
1:eJxTTMoPSmViYGAwBmIQ/XlDQPas+0EOXifYbWdfVXWA8X1A/K1qDhURK0zP
nsfkw9TD+CycXfLJeqoO7cvDTxmdCHI4AwJvVBxq121Lqt+L4L/h3WcwcxUm
v+G3VcG5FapwPsx8GL+F13/9FFVNOB/iHi2H+/v45hhXBTmY2+wNmtaoDXGP
N4IPtl8RTf53oIP88hceev+14Pw/30ofzPmoCec3sBztNyzXdGgO9JzbwBbk
sF71SfM8XU2H2Nyj/zYJI/gR4tsvMigh+DEgee0gBzmQ+fUIPlj+LYL/JHHh
NRN/LYf/IKAc5JCR/6H15BQtSLhIBDnUg8NDC1U9v7aDMQi4I/jqQGPPeiH4
/nJiWb7pCP5jEdmTT5uDHI7v2tHLVqAF55uCwkNRE87/+fb1AcvFGg7e1c36
PmlBDo0g/0/XcJB+/chMyiXIYYv5j0MpXRoO2laTTtcrBDlkgtwrogFJL58D
HWbMBIJKdYcJC34YPnsVCPFHjxqcn5oGBGwI/pxFyjv/LFdxSAeJywU5vMjS
/jbdVsUBZMxMRwQfFGxn0xB8ecePyWdqgxwMtFYKX3ii4hBcojL9f0cQxLx2
VYfrR3NNGroR6QtMzwhyCLglXZMYpAIJv/UI/uJJVoy+WxB8WPqXmHqFMyMJ
wYelRwDk23f2
     "], {{74.06089999999999, 11.3234}, {74.06089999999999, 
     10.549999999999999`}, {73.4078, 10.343800000000002`}, {73.08909999999999,
      10.343800000000002`}, {72.675, 10.343800000000002`}, {72.32339999999999,
      10.6219}, {72.32339999999999, 11.0047}, {72.32339999999999, 11.5297}, {
     72.8172, 12.0719}, {74.06089999999999, 12.112499999999997`}, {
     74.06089999999999, 11.3234}}}], 
   FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1,
      3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
     0}, {0, 1, 0}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}, {1, 3, 3}, {0, 1, 0}}}, {CompressedData["
1:eJxTTMoPSmViYGCQAmIQfQYEGEIc0sBAxQHGB9NvVBwe7OObY3wvGM4/clk7
VfJWsENCSJD6Ak5VOP/vt9IHcy4i+Bn5H1pPluhD+H3BDnMWKe/8447gm9rs
DZp2UA9i7gYE/8X29czPtwQ76GqtFL6wBMGf0t4adfmOLpz/IEJ8+8UGLYc1
3bczGBYHO5y/GvZGX1rbQcIj4I9EN9S9OdoO7qqlTLMKEHwwbYDgty8PP2X0
I8jBHGT/Q00438gYCC6rw/kvsrS/Tb+r6gASNtYOhvBtVRyuH801achG8GvX
bUuq70TwmwM95zYsCnY4sWtHL9sGFYcAObEs383BDqcOO63NtFOF82Hq0eMD
ANr5xkg=
     "], CompressedData["
1:eJxTTMoPSmViYGAQB2IQHSAnluW7OdiBAQQS1BxgfF1F+S85Ygh+ahoQsKk5
xOQe/bdpdbBDZv6H1pNbVB1EPjmeT5sb7PD3W+mDOYKqDhHi2y8ytAU7nNi1
o5dtg4pDJIifh+C/4d1nMDMMwX+wj2+OsRNCv43OlVnPTIMdGn5bFZxboerQ
vjz8lJFGsMOcRco7/7irOcwEAdVgh6eJC6+Z8Kuj8s8j+Bv08hYz7tFwuA8y
XyvY4dfb1wcskzXh5v8B2fdRE25/Pci+Di2Hgnj2c5KRwQ41nzYEZP/ScpDw
CPgjUYzgfwZSs7oRfHC4LQl22O7Q9Oj4DC14eOlrrRS+cETTAT18AdhPnKw=

     "]}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1,
     3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 
    3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
    1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 
    3}, {1, 3, 3}}}, CompressedData["
1:eJx11HtIU1EYAPBrr0FQgu2l+bjDXXPOWjqTFIXPwtKwWnXPzcqyLNfDrCAj
w1n2Jv2jN+oqMSJStBo9yWol9iJ1JuWC+kMLy5kKNUwMe+3cu50DSQfuHz/O
4zvnO9+5mpztS3PHMgzj5/kEzzfG8ynTTD/ViwXYaPY0Jws+G3GbooF770p/
5c6n3pEtcwSmUgf3fYwPmk1diZtOAP/Vps5YmQYKM2tmtU6lPrAk/UKJGxHL
3Slt5pOIzBf7S6nF/v2j/XC7ZaDyMks8v/7pFWYTC86n+XElRxGUJaU3mHNG
u3+SfWallbq+7P0m5u1o1w71FrbMpC7sHH5nrAsj3u21LvFU874XCCzYzUGQ
qbrbzjQg6DuSXxa7KhBcd6+P7TmPgG2otudeU0IUHr8WwWFWxrWcUUj5NVKL
6w3zxOL8Ch6uBkRP3rhXRfy4zH4grimMuAjHL9KAKVS5ZWEdDz8G+h4nhHMQ
gPPznYdoTdjgVuc06X44BJ/WXXTGHdeB7UPv2RtbEbR1CP2G+1HA4GajXlB0
0JAxUSDGZWKOEiCoao2u2RRJ/LJpztXNoRHEthnbLvk94KT9TBMg44Us+dws
ajFOl5a4ZCRxh6NGK+XXQD08IbsiI4b69iHLq5sJ1GK8RAG68Xmua6H42p2c
fckCuLboh8pDOGl8vi++nti187ZiJE8PXPfBqlbz/631usfrLvvk88Yc2i/W
f5anH8c36Ml5xHo16qAD11+4AIvaT2b9Xq+DI1eWv4yVC2Bx20x5id58DiFI
e1QcMvt5FFjw/jsQWX8et2uM9Ra1+P5qqcXx46nF+17Bw3R83/ERxOJ2TrPE
jbh+5gZK69t46ErNTrHGyKX9hyNicX8rqcV7q0YwD7+3TIWUj2e+elfDAH5f
DgSRbm2v9ZhSqu9OJM0DBbTg1k2diuO7qJ+81ucGfkEg33OqoHXDaJ+oHo75
7HEWlxnssCiAL9CW//nqjadTSesPIpiCx49TS/nyE+Aofk/yqYDTbvUXgB94
/a2iMVQ6r0qAc/hdpLPSfLUA4c6Py5gsVqqHOQL5PyRFv7F+TqX2/S//te9/
+he9fTGC
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 
    3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGINIGYC4jMgkBDucGLXjl62ADUHGP9RhPj2iw1qDg/2
8c0xjkLwNzx8OXVTBIJfEM9+TjIUwW8K9JzbEBTuMKW9NepyjZpDSInK9P8B
4Q6iPV6vWELUHEQ+OZ5P8w13OHXYaW3mP1UHE2MgsA932KCXt5hxj4pD2/Lw
U0Y8CL6rainTrDdhcD5Y/f4wBwYQaFCF8y9cDXujf1sdzk9PAwI1LYcX29cz
P38S5vDj7esDlszaEP9whcP5nD8XpG/mQ/AVHD8mn9FE8D9tCMieZR3uMGMm
EOzUcvjBFj/DRzfcISP/Q+vJKVoOAXJiWb7a4Q4NLEf7Dc0RfLD9bAh+cuwd
N+YZmpDwMAl3SAXJu2lC5J0RfC2rSafrAxB8sH+iwx2Og+JnAoK/xfzHoRQu
LTjffX+trAW7toMmSL9FuIO5zd6gaY3akPDjQPDB/jsYhsqfGAaJrz2acH4j
yD/X1eH8v99KH8y5qOowYcEPw2fHwhxeZGl/m26r4iDhEfBHgj0czl/TfTuD
wR/Bh6Un2eUvPPTkEekLlt4AVPQIbg==
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
     0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}}, {{
     1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGAQA2IQPRMEeiMcGlmO9hteV3eA8WeA6JuaDvnx7OckIyMc
zoBAjrbDhAU/DJ9JIfhvePcZzPwUDudvbam5sPlmuMPzLO1v0/dqOYSUqEz/
fyHcQaTH6xVLCYKfkf+h9WSJPoTfEu4wZ5Hyzj/uCL6pzd6gaQf1HGJzj/7b
tBzBr4hYYXp2dbiDrtZK4QtLEPwp7a1Rl+/owvlpYKDi8GlDQPas3Qi+jc6V
Wc/Ohjv8evv6gGWyqsODfXxzjG+FO+xwaHp0/IaKw5HL2qmSQP+8ALnfVgXi
L5EIOL9m3bak+lAEHxZeG1SfNM87q+qAHp4AA56r4Q==
     "], CompressedData["
1:eJxTTMoPSmViYGCQAmIQvWiSFaNvQoTDhathb/RvqzvA+C+ytL9Nr0XwN+nl
LWaMUXOw0bky65kvlD9H1eHa0VyTBusIBwOtlcIXnqg4fNoQkD1LOcLhxK4d
vWwbVBxUnzTPOyuE4HtVN+v7/AqH88HmPQ138DnBbjtbVNXBVbWUadaNcIfM
/A+tJ7eoOjQFes5tuBTuIDH1CmcGkxqcn5oGBGwIvmiP1yuWEAT/ceLCayb5
mnD+lPbWqMt7EHx9kHuPaDo82Mc3x/hWuAMLZ5d8Mp+WQ0iJyvT/L6DyS7Qc
Xmxfz/ycIcKhBuSxX1oOj0VkTz4VR/BBzkgzQvDB/nOLcNgCCp8aLQctq0mn
6wMiHMxt9gZNY9RyyI9nPycZGQFx7xRNePiCw48FwYfFBwDKJK4R
     "]}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}}}, {CompressedData["
1:eJxTTMoPSmViYGBQBWIQ/eXvlYqXaVEOKbF33JhnqDrA+LW/rQrOcWg6mHc6
JjzViHI4vmtHL9sGbYfjZfvmSx2PhPOvVrxUM4xA8Oe+X37M2zzSIQ0ElmnA
+WY2e4OmMSL4W8x/HEo5pe4wxbk757l1pIPvxYkx/5zVHR5WiaxzD0Tws/aU
TJbIQfCLMya+rSmPdJi9SHnnH3YNOP8YyP4CBH+96pPmebqaDtrtYjfPxSP4
N859D34ciuCDvKNfGungf0u6JvGTlsMckPvWRzpMaW+Nuiyj7VAO9B7HEQQf
LM8eBeerG3KskTGKcpCeF6d5ukATzv/19vUBy8NqcP4GvbzFjDaqDndU2Bqn
Kkc5CMQG3DcqV3YwMQYC6SgH4cpJJWenKDnY3PfvnS4W5VB9/8ct49fKDhtA
AfY70qGF13/9lFZVhycXlG7/3Ibgg7QbeyP4+fHs5yTvRjg4T2gWSpNSgvPf
tOV2G82WgfMfuMY7ztoo6dDt9YrF5C+UbygCCY/USDh/xkwgkIyC82HpA8wP
VHJATz8AuwEDjA==
     "], {{104.233, 8.932809999999998}, {104.233, 8.04844}, {103.456, 
     5.371880000000001}, {101.617, 5.371880000000001}, {100.49399999999999`, 
     5.371880000000001}, {100.30299999999998`, 6.2562500000000005`}, {
     100.30299999999998`, 6.757809999999998}, {100.30299999999998`, 
     7.282809999999998}, {100.63799999999999`, 8.514059999999999}, {
     100.81599999999999`, 8.956249999999999}, {100.972, 9.31406}, {
     101.65299999999999`, 10.521900000000002`}, {102.89499999999998`, 
     10.521900000000002`}, {103.983, 10.521900000000002`}, {104.233, 
     9.57813}, {104.233, 8.932809999999998}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0,
     1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 
    1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIzIGYCYnVDjjUyv6Ic5Hct2JfaJ+QA4+8Mtor4/1zI
Qf+uClvj1ygH9zVHlzP8EHI4r3T7Z90nBH99UcbEt28QfBWgdBaMf0PIwWXb
579XXkQ5RKtGyJyLEXKwue/fO/1elMOXfR+3pl8TcGh5HbhD7miUQ2oaEKjx
OuwpmSzBsgzBF7957nvwbAS/fN98Kf2pUQ7qn1RezuLkg/MfuMY7zhIUgPPP
gMAaAQf5VqAF06Ic0kH62QQdrlS8VDOcAVVfKAjx316o/9dJOTRMde7OeY/g
8zBpt4v9RPDXyESlWP/H5IPd4ykN579py+022i3tUJ8F9NEPBB8kff89gr8d
GDwVBxH8KUDrn1+Oclj57WXFGQUFhxtA7z++GuWwVkiHLz0OwQf7pww3X/na
o2CGMwoOz3+v/HjpbJSDcOWkkrNfFODhDeNvmPt++bHNCD44fDZEOfDHBtw3
aldw2HKibN/8VVD758k7tDsmPL0wC+HegB1yra8zEXyw/gQ0/0Vi8v+DgDyC
DwtPmH4YH5x+MhB8WHzC+E+Wzj6iUAFNr+zCEP+VQtObjZBDz/Q8oeYCmH2C
cD4sfcD4LeK1rJltvBD3dEY52Jc41p6O4XYQWef+sGoJgh+/y5OH6TaCD8sv
YPN0EPkHlp8A37SR5w==
    "]], FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 
     0}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}}}, {{{116.36999999999999`, 11.8719}, {116.36999999999999`, 
     11.262499999999998`}, {116.06099999999998`, 9.50625}, {
     113.65799999999997`, 9.50625}, {112.30799999999998`, 9.50625}, {
     113.09699999999998`, 12.6484}, {113.20499999999998`, 
     13.090600000000002`}, {113.25200000000001`, 13.1141}, {113.719, 
     13.1141}, {114.57799999999997`, 13.1141}, {115.60599999999998`, 
     13.1141}, {116.36999999999999`, 12.803099999999999`}, {
     116.36999999999999`, 11.8719}}, CompressedData["
1:eJx11HtIU1EYAPClkUmWom5utrlNnTL1H5slWtYnZUss5gub7l4bos7yRQ/C
JKLS1FhGEWY+KBVDivlAXOiQ9SDNRCVEgtJIiVDREk1C07B77t29BzY6MMZv
Z+fxfd85R55VnJzjxOPxTlMf9P204a2sK4uEOrqJgLXU0mTN+SmC1b8TJfOZ
JESoqOblC5vPlsdPZWDn9V96IEzF7hm6bH2STELwSuB8/XsRuDmFVgqSSOhN
idZuGUQgubWQ1HuYhNdG680IZwFcrzlqLJCSkItaEB+O7M+0xLth0+PXCc6d
F/Lu/1gkYAQ1E3aFzEUxMuHDmQ5nXQjt6plS798Es78UCRMP5WqtUbPtngRa
Ubx/CChH41OlnHPQehXY9P5nsY2H4i253XLwKHs13DxKwBZqxf5wp7bIs6yL
gEdo/T5/aFxqG0xwJ6HdM2yPITMAzL+oDaST0NgS0LepVnAOk0tXC9KCOavo
poRyKl1+EhLmLpr5GwshUBWr//6hm+A8FbjjRs03HWc6fxPYJyNvx+pHHZ1N
Th13LsG+utKVmB8dAm0ovnHs6VLvDvUM9juqvL7uhIP1qcnBTa7YBpS/QSUM
2JntTxhyiWmoUTLnx82WryglU79WHWQotOKxfiGg7u2PdXAX1cvDBwIn16+d
a9TBqnXZbHgoAFTeDgN2J/ohDVvvoY3qSXQ0e35Y0+dDxQdUrsh0bBeTOCNb
Z9d/FpvOzxUdlH5d+6xK4ENYpeDTWCX2MWPB7MaMXf8SNjX7wa9beD76PO0m
OL8cbo574YVN50vs6MWKQuO+vQLObLxaanoNH7vQk1rAFZueZ1Ln4BOmgTbe
GvZ03JnY+vM+/zV7/+aCwneapmzzHRAy8VH1XmrplI1W+TPx5GPHoPPag62g
hovf2O6vSM6Zvl8aGWf2Pn7RVNcWWQgoQfnc5cfcF7PtfRgRM/sx2c5XnS/z
/+cE916xpusRKuJMvzeDfOa9+kgw8YZ7M/V0JTnT8amx2feTXn5RCPbv6z8a
31wU
     "]}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
     3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGINIGYC4vKXaoYcIXEOJ3bt6GULUHOA8R9FiG+/2KDm
4GPe6Zjgi+BPce7Oee6N4G+Xa30d6IHgs4Tx6W5yjXOY0t4adbkGqD9JIMLS
Jc5BtMfrFUuImkNt1p6SyQ5xDqcOO63N/KfqcNe/d3qeUZzDBr28xYx7VBwa
pgIt+B8L5+u0i908dx/BB6vfFOvAAAINqnD+hathb/Rvq8P56WlAoKbl8GTp
7CMKN2Idfrx9fcCSWRvin78IfsAOoAcY4+D8Ba7bPv+VQfD5Iyy3nNCLc5gx
Ewh2ajn0TM8TalaIc8jI/9B6coqWgwcPk3a7XJxDA8vRfkNzBB9sPxuCnxx7
x415hqbDlQpgAGvEOaSC5N00IfJmCP7+Uwtdtzkj+GDaL87hOCh+JiD4W8x/
HErh0oLz3ffXylqwa0P0a8c5mNvsDZrWqO2wYe775cd+x8L5YP9tQeO3xELi
a48mnN8I8s91dTj/77fSB3MuqjqoGnKskdkV6/AiS/vbdFsVhz8rP17y/YXg
i4MSgFMcnA9LT7LLX3joySPSFyy9AQCTSw6i
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{
     0, 2, 0}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGBQAGIQ7bLt898rDvEOJ3bt6GULUHOA8RlAIEHNYc775ce8
7eMdan9bFZzrUHNIEIiw3GKB4Pv3Ts8TMkbwXbpznv82jHd4VbxV9He2moOE
/l0VNiBftMfrFUuImoNs6+vAHXLxDnMWKe/8c1zFocMx4emFT3EOG/TyFjPu
UXGYMRMIXiL4S2cfUdhwCcEXvXnue/DuOIe/30ofzBFUdSh/qWbIsQYor/qk
ed5ZVYcXIO6cOLh7YHywfK86nD8bZD+7hsN5pds/64zi4fynv1d+vGSL4MPC
A52fBgYIvsy8OM3TFzQddNrFbp5Tj3cwt9kbNK1R2+E/CNyPg/PB4bcAwQeH
b36cw4ss7W/T72rC+b/evj5g+Vgdzvc6wW47+6qqQyrI2mVQ9bYqDjb3gTHw
DMEHqwfaD+PD3Bd4S7om8ZOqA3p8AwCUz/Dd
     "], {{124.47199999999998`, 12.2234}, {122.45599999999997`, 12.2234}, {
     122.52799999999998`, 13.3391}, {123.20499999999998`, 
     13.529699999999998`}, {123.49999999999999`, 13.529699999999998`}, {
     124.43099999999998`, 13.529699999999998`}, {124.46299999999997`, 
     12.4063}, {124.47199999999998`, 12.2234}}}]},
  AspectRatio->Automatic,
  BaselinePosition->Scaled[0.3169380676693431],
  ImageSize->{126.77974595267746`, 16.723028642590286`},
  PlotRange->{{0., 126.78}, {0., 16.72}}]], "Output",
 CellChangeTimes->{{3.951227480607923*^9, 3.951227498508594*^9}, 
   3.951227590723441*^9, {3.951227661082717*^9, 3.9512276785464973`*^9}, 
   3.951228233968712*^9, {3.951228327360218*^9, 3.951228340718918*^9}, 
   3.9512283821936007`*^9, 3.9512284290396833`*^9, 3.951228862779323*^9, 
   3.951229355860683*^9, 3.951231936508786*^9, 3.951233653649911*^9, 
   3.95128087556818*^9, 3.9512882867962017`*^9, 3.951293282666851*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"f85da458-948c-4a19-a9c3-44fd722838d3"]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->"FEDeriK.m",
WindowSize->{1200, 750},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.9 Inherited,
FrontEndVersion->"14.1 for Linux x86 (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"dfc92765-bf29-47cf-bd50-cf1f31dcd525"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 530, 10, 28, "Input",ExpressionUUID->"33cd48af-4550-42b3-9c95-127f2f1ee635"],
Cell[CellGroupData[{
Cell[1109, 34, 259, 4, 59, "Section",ExpressionUUID->"d65e8f2b-6500-4348-8918-912b67b13cd9"],
Cell[1371, 40, 1182, 29, 181, "Input",ExpressionUUID->"0a00f2e0-9e12-4855-8a8a-da6773cee6a6",
 InitializationCell->True],
Cell[2556, 71, 1049, 27, 120, "Input",ExpressionUUID->"f9a54712-bc7e-4f67-94ba-c436d6c2a287",
 InitializationCell->True],
Cell[3608, 100, 951, 23, 147, "Input",ExpressionUUID->"9f23e5c2-affb-4cab-9de6-acd7510a1543",
 InitializationCell->True],
Cell[4562, 125, 1863, 48, 144, "Input",ExpressionUUID->"66c68510-764b-433f-bf11-01c5d6a5e9c2",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[6462, 178, 230, 4, 59, "Section",ExpressionUUID->"e03db448-7a6c-4e73-9ddc-3b1976a84a81"],
Cell[CellGroupData[{
Cell[6717, 186, 190, 3, 47, "Subsection",ExpressionUUID->"35360acd-1ab3-48dc-b387-960ef784c1b9"],
Cell[6910, 191, 4727, 129, 560, "Input",ExpressionUUID->"9610d6bd-1c3a-4143-88dc-cb4244676cae",
 InitializationCell->True],
Cell[11640, 322, 10226, 259, 741, "Input",ExpressionUUID->"d8c7ad92-008a-409f-951b-580a3ca827cd",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[21903, 586, 218, 4, 33, "Subsection",ExpressionUUID->"23b7e69d-dcbb-4fb0-a77e-b8638a031ad4"],
Cell[CellGroupData[{
Cell[22146, 594, 217, 4, 39, "Subsubsection",ExpressionUUID->"d438b387-4f31-41ce-a117-795b628d69b9"],
Cell[22366, 600, 1698, 50, 183, "Input",ExpressionUUID->"63fbe29b-4af8-405d-80e3-5cbc9aa8d1d5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[24101, 655, 212, 4, 32, "Subsubsection",ExpressionUUID->"f52392a8-ad40-44db-871d-0651868db7ca"],
Cell[24316, 661, 7271, 167, 779, "Input",ExpressionUUID->"d2be4365-2a9f-4170-90b1-81e044dec426",
 InitializationCell->True],
Cell[31590, 830, 5708, 132, 672, "Input",ExpressionUUID->"ffdc8015-4beb-4a8a-9712-899076a5bcad",
 InitializationCell->True],
Cell[37301, 964, 145, 2, 26, "Input",ExpressionUUID->"e6fda6fb-9bcb-45a5-b801-7e006569f014"]
}, Closed]],
Cell[CellGroupData[{
Cell[37483, 971, 210, 4, 32, "Subsubsection",ExpressionUUID->"432ab124-4161-47f8-a56b-8db469a3db21"],
Cell[37696, 977, 4130, 102, 635, "Input",ExpressionUUID->"11470f5d-e2db-4aaa-9b7e-0a8c11da0687",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[41863, 1084, 270, 4, 32, "Subsubsection",ExpressionUUID->"73595dfd-e53e-4d4e-a700-40ff68a78e58"],
Cell[42136, 1090, 4286, 99, 389, "Input",ExpressionUUID->"8025941a-3caa-4a8b-a6f7-d19c65a09782",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[46459, 1194, 217, 4, 32, "Subsubsection",ExpressionUUID->"4586692a-ee51-46b9-b58e-43bcdb604423"],
Cell[46679, 1200, 3210, 77, 406, "Input",ExpressionUUID->"d04f551f-63ba-4c59-827e-89539a889eb6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[49926, 1282, 250, 3, 32, "Subsubsection",ExpressionUUID->"bb6d67ae-94ea-4de9-ad33-f49796906916"],
Cell[50179, 1287, 5049, 140, 360, "Input",ExpressionUUID->"cec32202-2ccb-4a54-a11b-3d74e2fc5239",
 InitializationCell->True]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[55289, 1434, 156, 3, 59, "Section",ExpressionUUID->"bdee160a-1c91-4de1-b52d-86eb572207e3"],
Cell[55448, 1439, 521, 11, 42, "Input",ExpressionUUID->"8b16408f-667b-4fec-b260-6fb6db16586b",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[55994, 1454, 168, 3, 39, "Subsubsection",ExpressionUUID->"d002c263-ec1e-44d9-8d95-a0c4fe2e8e78"],
Cell[56165, 1459, 1396, 36, 124, "Input",ExpressionUUID->"f4704157-c7f9-402c-bf7c-77513ac8ecc7",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[57598, 1500, 208, 4, 33, "Subsection",ExpressionUUID->"5193f3f7-8901-4525-bbbc-d3fa4695bea7"],
Cell[57809, 1506, 15597, 362, 922, "Input",ExpressionUUID->"428f55da-c8db-4d63-89da-51a880a4e13f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[73443, 1873, 223, 4, 33, "Subsection",ExpressionUUID->"a703f905-419d-403f-a28c-a63b6e5d0fbc"],
Cell[CellGroupData[{
Cell[73691, 1881, 159, 3, 39, "Subsubsection",ExpressionUUID->"807846d5-0a8e-42e1-8499-9436b99fe5c0"],
Cell[73853, 1886, 3735, 96, 376, "Input",ExpressionUUID->"3518af78-5ff7-49ca-9232-57a8cda2059b",
 InitializationCell->True],
Cell[77591, 1984, 5577, 155, 672, "Input",ExpressionUUID->"51b5119b-7ed2-4d4e-8157-9da88d9e51a3",
 InitializationCell->True],
Cell[83171, 2141, 2347, 59, 267, "Input",ExpressionUUID->"f9e7b8dd-479d-4f1c-b30c-43e82a8f1466",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[85555, 2205, 190, 3, 39, "Subsubsection",ExpressionUUID->"d2a5f7e9-fbf3-48fd-896b-3c3a13529cd2"],
Cell[85748, 2210, 2129, 55, 229, "Input",ExpressionUUID->"84ac980c-3e5a-487b-a821-389318a8bd26",
 InitializationCell->True],
Cell[87880, 2267, 2296, 54, 273, "Input",ExpressionUUID->"e0675219-06d7-4260-b88e-aecc77330bb2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[90213, 2326, 206, 4, 32, "Subsubsection",ExpressionUUID->"4d34a9f6-835b-4d0e-bded-e4ef20d68c82"],
Cell[90422, 2332, 8147, 206, 585, "Input",ExpressionUUID->"935d09a0-331b-40fc-a467-f0134b7e4304",
 InitializationCell->True],
Cell[98572, 2540, 6089, 134, 525, "Input",ExpressionUUID->"f8e80e20-24a8-4ec6-ba4f-132db5be82fc",
 InitializationCell->True],
Cell[104664, 2676, 10825, 272, 953, "Input",ExpressionUUID->"9f3b0ea7-2af5-48b1-84b3-46146be887b3",
 InitializationCell->True],
Cell[115492, 2950, 2104, 53, 225, "Input",ExpressionUUID->"3edfcfc0-c624-46bc-ab09-a08de412f0d7",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[117645, 3009, 253, 4, 47, "Subsection",ExpressionUUID->"1785af53-7c89-486a-9e5f-2cc90ee5d4f8"],
Cell[CellGroupData[{
Cell[117923, 3017, 181, 3, 39, "Subsubsection",ExpressionUUID->"6b5ad42c-f028-4331-8dd5-edca6279d9c9"],
Cell[118107, 3022, 3693, 79, 693, "Input",ExpressionUUID->"8223ffc8-f59e-4c33-b04f-02db6763d2e2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[121837, 3106, 171, 3, 32, "Subsubsection",ExpressionUUID->"25f821ed-484b-44c3-bb3d-2285af151ba5"],
Cell[122011, 3111, 4843, 109, 565, "Input",ExpressionUUID->"4b678c74-7d06-4764-a1d3-b462e6b01ccf",
 InitializationCell->True],
Cell[126857, 3222, 2618, 65, 204, "Input",ExpressionUUID->"18065f13-e208-4ab7-83f1-35e867d53bcb",
 InitializationCell->True],
Cell[129478, 3289, 7194, 158, 584, "Input",ExpressionUUID->"4a073111-7191-4734-b32b-1a96840d6461",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[136721, 3453, 168, 3, 47, "Subsection",ExpressionUUID->"94391a5f-eb5e-4478-a534-7016e4a3f9d1"],
Cell[136892, 3458, 5023, 125, 588, "Input",ExpressionUUID->"ac314d00-9b25-4da1-be23-eabaa3a126f2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[141952, 3588, 316, 5, 33, "Subsection",ExpressionUUID->"ff235384-733f-4abf-8f02-504f4ee478e5"],
Cell[CellGroupData[{
Cell[142293, 3597, 381, 10, 28, "Input",ExpressionUUID->"b7565136-1813-4aac-8c91-9bf6bcafcf8b"],
Cell[142677, 3609, 196, 4, 32, "Output",ExpressionUUID->"3a9e13f0-4685-4ac4-8f49-f04440f744c6"]
}, Open  ]],
Cell[142888, 3616, 21574, 507, 1996, "Input",ExpressionUUID->"4b71f7d2-f04e-43f5-b54d-39e57cffabf7"],
Cell[164465, 4125, 6808, 182, 766, "Input",ExpressionUUID->"b7774a84-ac87-42fd-842d-b4b0fef4ae7a"],
Cell[171276, 4309, 1206, 29, 190, "Input",ExpressionUUID->"c9003c35-4657-4bce-afe4-e0f49513a564"],
Cell[CellGroupData[{
Cell[172507, 4342, 322, 8, 28, "Input",ExpressionUUID->"20ecc2f0-10c5-4d34-85b0-76fc7ccdb97b"],
Cell[172832, 4352, 285, 7, 31, "Output",ExpressionUUID->"7bcc71a3-8fd0-4a3f-9044-3da1b16e4767"]
}, Open  ]],
Cell[CellGroupData[{
Cell[173154, 4364, 10860, 270, 973, "Input",ExpressionUUID->"43985720-cee5-4d43-b10f-0ff857cd9f45"],
Cell[CellGroupData[{
Cell[184039, 4638, 570, 11, 21, "Print",ExpressionUUID->"52894274-6c25-446c-a400-455bcaaaff9d"],
Cell[184612, 4651, 761, 17, 20, "Print",ExpressionUUID->"4e1591df-aba9-49a1-a4b2-991798ccfaa4"],
Cell[185376, 4670, 722, 17, 21, "Print",ExpressionUUID->"48c514ec-81cb-4f07-a252-5918c0327fbd"]
}, Open  ]],
Cell[186113, 4690, 22528, 381, 31, "Output",ExpressionUUID->"73985cf9-ac33-4a8c-945c-4846b5fd8a91"],
Cell[CellGroupData[{
Cell[208666, 5075, 570, 11, 21, "Print",ExpressionUUID->"696bb22b-57c5-43b4-8630-8d7542d4d007"],
Cell[209239, 5088, 761, 17, 20, "Print",ExpressionUUID->"7ab833e8-9371-419a-a482-54897052292c"],
Cell[210003, 5107, 722, 17, 21, "Print",ExpressionUUID->"41d54087-9e45-4f2d-92a0-f5eff9da8bd6"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[210786, 5131, 281, 4, 47, "Subsection",ExpressionUUID->"e5244ec3-f22c-466c-9873-92eb903637b0"],
Cell[211070, 5137, 6288, 139, 689, "Input",ExpressionUUID->"3500ee75-7244-4321-ae5e-82e6897e10d7",
 InitializationCell->True],
Cell[217361, 5278, 1916, 53, 125, "Input",ExpressionUUID->"ec93a3ae-c758-4d49-9ec4-9c2ae2983898",
 InitializationCell->True],
Cell[219280, 5333, 13045, 303, 945, "Input",ExpressionUUID->"c85cfa76-e8b5-439f-9ca0-f24e64c44725",
 InitializationCell->True],
Cell[232328, 5638, 2866, 55, 303, "Input",ExpressionUUID->"52021b7e-bece-436c-b228-076b6c722055",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[235231, 5698, 166, 3, 47, "Subsection",ExpressionUUID->"82ef4885-2b2a-47d1-8963-133ee7a68a33"],
Cell[235400, 5703, 3070, 73, 250, "Input",ExpressionUUID->"c5f93900-11a5-40d3-92c2-259b2094122d",
 InitializationCell->True],
Cell[238473, 5778, 3902, 89, 311, "Input",ExpressionUUID->"c8e3186f-3d3b-492c-8b02-56053c948bd0",
 InitializationCell->True],
Cell[242378, 5869, 412, 11, 47, "Input",ExpressionUUID->"87287bca-0606-4a37-8cec-767710657f9b"],
Cell[CellGroupData[{
Cell[242815, 5884, 628, 18, 28, "Input",ExpressionUUID->"513ad122-b877-49e8-a3ea-d96e8be9b21e"],
Cell[243446, 5904, 674, 19, 32, "Output",ExpressionUUID->"36d61d18-3063-4622-9cb6-4ff899926126"]
}, Open  ]],
Cell[CellGroupData[{
Cell[244157, 5928, 976, 26, 28, "Input",ExpressionUUID->"281301ac-dffb-4d5e-bbd1-6b3edb5983f7"],
Cell[245136, 5956, 980, 26, 41, "Output",ExpressionUUID->"773dc129-9e4e-4d12-a3a3-6c2bea7d52e7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[246153, 5987, 543, 15, 28, "Input",ExpressionUUID->"4295c899-7890-4d08-8905-98f26dddfa74"],
Cell[246699, 6004, 466, 10, 23, "Message",ExpressionUUID->"a83126d6-ddae-4225-8348-e9eb85e63588"],
Cell[247168, 6016, 182, 3, 30, "Output",ExpressionUUID->"14ccad15-74ec-411e-bae3-2c17953e78ff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[247387, 6024, 686, 17, 66, "Input",ExpressionUUID->"47687bc9-4adb-47ae-af03-f85ea04c7388"],
Cell[248076, 6043, 218, 4, 20, "Print",ExpressionUUID->"63e50008-60b5-48e9-9e2c-41eb853451be"],
Cell[248297, 6049, 346, 8, 23, "Message",ExpressionUUID->"71a3c43a-99bf-4661-9979-1a859e83f450"],
Cell[248646, 6059, 160, 3, 30, "Output",ExpressionUUID->"ed9d9fe8-c65e-4480-a462-a3aea57b3149"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[248867, 6069, 207, 4, 59, "Section",ExpressionUUID->"be19843a-e765-47f1-9747-2d6834a73a9e"],
Cell[CellGroupData[{
Cell[249099, 6077, 171, 3, 47, "Subsection",ExpressionUUID->"e3f3669e-621b-4b13-b56e-3deed41d0aba"],
Cell[249273, 6082, 6805, 156, 693, "Input",ExpressionUUID->"ac348a0a-7a6e-409c-9a98-56e5170bdbb5",
 InitializationCell->True],
Cell[256081, 6240, 3904, 88, 448, "Input",ExpressionUUID->"b0835c23-2d69-40a7-9251-be3d8571a3bb",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[260022, 6333, 185, 3, 33, "Subsection",ExpressionUUID->"a8f64e7a-d885-45c2-99d7-7e2e4dc385f7"],
Cell[260210, 6338, 498, 14, 63, "Input",ExpressionUUID->"bba04405-f573-40fc-9a19-18ca7de811ab",
 InitializationCell->True],
Cell[260711, 6354, 6968, 148, 706, "Input",ExpressionUUID->"fcb7ecd2-adb3-4b5a-a94f-8080924ea319",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[267728, 6508, 152, 3, 86, "Title",ExpressionUUID->"7a24c792-7a48-4e73-8b88-7b56966e439b"],
Cell[CellGroupData[{
Cell[267905, 6515, 214, 3, 28, "Input",ExpressionUUID->"45787101-b7c2-46b3-828f-0dde391998ab"],
Cell[CellGroupData[{
Cell[268144, 6522, 691, 12, 20, "Print",ExpressionUUID->"dcbee3e8-b796-462f-badf-295e96d96acf"],
Cell[268838, 6536, 633, 11, 20, "Print",ExpressionUUID->"44165c13-a8f1-4101-984b-366e85be4fb5"],
Cell[269474, 6549, 631, 11, 20, "Print",ExpressionUUID->"4cba829c-d89a-42d7-b321-0bc1809751f0"],
Cell[270108, 6562, 625, 10, 20, "Print",ExpressionUUID->"1066258f-aecb-45c3-8b2f-0ebd17f1a517"],
Cell[270736, 6574, 1398, 23, 89, "Print",ExpressionUUID->"a7869ce4-5d28-4b20-aecd-d5eb3ec045d9"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[272183, 6603, 3983, 107, 597, "Input",ExpressionUUID->"2632f66f-a425-44c8-b21c-333bdd8417c4"],
Cell[276169, 6712, 25942, 428, 52, "Output",ExpressionUUID->"f85da458-948c-4a19-a9c3-44fd722838d3"]
}, Open  ]]
}, Open  ]]
}
]
*)

