(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    228033,       5642]
NotebookOptionsPosition[    216186,       5425]
NotebookOutlinePosition[    216640,       5443]
CellTagsIndexPosition[    216597,       5440]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"AutoGeneratedPackage", "->", "\"\<FEDeriK.m\>\""}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.933907062001917*^9, 3.933907088477437*^9}, 
   3.9356618434708548`*^9, 3.935744927606638*^9, {3.935833716539812*^9, 
   3.93583371672362*^9}, {3.9507222866535883`*^9, 3.95072228934137*^9}, {
   3.950850838405504*^9, 3.950850842475651*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"33cd48af-4550-42b3-9c95-127f2f1ee635"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<TensorBases`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.950768816457233*^9, 3.950768819804626*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"33eb1d48-8ad0-4069-9a69-cc11336e7f19"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Mathematica package \
\\!\\(\\*\\nStyleBox[\\\"TensorBases\\\",\\nFontWeight->\\\"Bold\\\"]\\)\\!\\(\
\\*\\nStyleBox[\\\" \
\\\",\\nFontWeight->\\\"Bold\\\"]\\)loaded\\n\\!\\(\\*\\nStyleBox[\\\"Authors\
\\\",\\nFontWeight->\\\"Bold\\\"]\\): Andreas Gei\[SZ]el, Franz Richard \
Sattler\\n\\!\\(\\*\\nStyleBox[\\\"Version\\\",\\nFontWeight->\\\"Bold\\\"]\\)\
: 1.0\\n\\!\\(\\*\\nStyleBox[\\\"Year\\\",\\nFontWeight->\\\"Bold\\\"]\\): \
2025\\n\\nFor a list of available bases, call \\!\\(\\*\\nStyleBox[\\\"TBInfo\
\\\",\\nFontColor->RGBColor[1, 0.5, 0]]\\)[]. For further information on a \
particular basis, call \
\\!\\(\\*\\nStyleBox[\\\"TBInfo\\\",\\nFontColor->RGBColor[1, 0.5, \
0]]\\)[\\\"\\!\\(\\*\\nStyleBox[\\\"BasisName\\\",\\nFontColor->GrayLevel[0.5]\
]\\)\\\"].\\n\\nThis package provides the methods \
\\!\\(\\*\\nStyleBox[\\\"TBGetBasisElement\\\",\\nFontColor->RGBColor[1, 0.5, \
0]]\\), \\!\\(\\*\\nStyleBox[\\\"TBGetInnerProduct\\\",\\nFontColor->RGBColor[\
1, 0.5, 0]]\\), \
\\!\\(\\*\\nStyleBox[\\\"TBGetMetric\\\",\\nFontColor->RGBColor[1, 0.5, \
0]]\\), \\!\\(\\*\\nStyleBox[\\\"TBGetInverseMetric\\\",\\nFontColor->\
RGBColor[1, 0.5, 0]]\\), \
\\!\\(\\*\\nStyleBox[\\\"TBGetProjector\\\",\\nFontColor->RGBColor[1, 0.5, \
0]]\\) for every tensor basis available.\\nFor closer explanations, please \
call their usage messages, e.g. \
\\!\\(\\*\\nStyleBox[\\\"TBGetProjector\\\",\\nFontColor->RGBColor[1, 0.5, \
0]]\\)::\\!\\(\\*\\nStyleBox[\\\"usage\\\",\\nFontColor->RGBColor[0, 0, \
1]]\\).\\n\\nOther useful tools include \
\\!\\(\\*\\nStyleBox[\\\"TBGetIdentityMatrix\\\",\\nFontColor->RGBColor[1, \
0.5, 0]]\\), \
\\!\\(\\*\\nStyleBox[\\\"TBGetBasisSize\\\",\\nFontColor->RGBColor[1, 0.5, \
0]]\\),\\!\\(\\*\\nStyleBox[\\\" \\\",\\nFontColor->RGBColor[1, 0.5, \
0]]\\)\\!\\(\\*\\nStyleBox[\\\"TBGetIndexSet\\\",\\nFontColor->RGBColor[1, \
0.5, 0]]\\),\\!\\(\\*\\nStyleBox[\\\" \\\",\\nFontColor->RGBColor[1, 0.5, 0]]\
\\)\\!\\(\\*\\nStyleBox[\\\"TBMakePropagator\\\",\\nFontColor->RGBColor[1, \
0.5, 0]]\\).\\n\\nTo build or manipulate bases, please call \
\\!\\(\\*\\nStyleBox[\\\"TBInfo\\\",\\nFontColor->RGBColor[1, 0.5, \
0]]\\)[\\\"BaseBuilder\\\"].\\n\\nTo show information on the used notation, \
call \\!\\(\\*\\nStyleBox[\\\"TBInfo\\\",\\nFontColor->RGBColor[1, 0.5, \
0]]\\)[\\\"Notation\\\"].\\n\"\>"], "Print",
 CellChangeTimes->{
  3.950768820119334*^9, 3.950774987706017*^9, 3.9507843265150957`*^9, 
   3.950784373354507*^9, {3.9507844128909073`*^9, 3.9507844315247583`*^9}, {
   3.950784471743929*^9, 3.950784506376987*^9}, 3.950784570678767*^9, {
   3.950784619092307*^9, 3.950784629770219*^9}, {3.950784661267223*^9, 
   3.950784685069392*^9}, 3.950784732100133*^9, 3.950784836023178*^9, {
   3.9507849299884863`*^9, 3.950784965333905*^9}, {3.950785004974284*^9, 
   3.950785015994617*^9}, {3.950785051484831*^9, 3.950785068076728*^9}, {
   3.950785183704587*^9, 3.950785197975553*^9}, {3.950785273838151*^9, 
   3.950785293445387*^9}},
 CellLabel->
  "During evaluation of \
In[26]:=",ExpressionUUID->"df9ee9f3-8c28-4396-b639-438f47eb1edb"],

Cell[BoxData["\<\"\\!\\(\\*\\nStyleBox[\\\"FormTracer\\\",\\nFontWeight->\\\"\
Bold\\\"]\\) package already loaded. \"\>"], "Print",
 CellChangeTimes->{
  3.950768820119334*^9, 3.950774987706017*^9, 3.9507843265150957`*^9, 
   3.950784373354507*^9, {3.9507844128909073`*^9, 3.9507844315247583`*^9}, {
   3.950784471743929*^9, 3.950784506376987*^9}, 3.950784570678767*^9, {
   3.950784619092307*^9, 3.950784629770219*^9}, {3.950784661267223*^9, 
   3.950784685069392*^9}, 3.950784732100133*^9, 3.950784836023178*^9, {
   3.9507849299884863`*^9, 3.950784965333905*^9}, {3.950785004974284*^9, 
   3.950785015994617*^9}, {3.950785051484831*^9, 3.950785068076728*^9}, {
   3.950785183704587*^9, 3.950785197975553*^9}, {3.950785273838151*^9, 
   3.9507852934465437`*^9}},
 CellLabel->
  "During evaluation of \
In[26]:=",ExpressionUUID->"9785ca40-19d8-4052-83c0-c56ae87fbc23"],

Cell[BoxData["\<\"Clearing all extra variables for compatibility!\\n\"\>"], \
"Print",
 CellChangeTimes->{
  3.950768820119334*^9, 3.950774987706017*^9, 3.9507843265150957`*^9, 
   3.950784373354507*^9, {3.9507844128909073`*^9, 3.9507844315247583`*^9}, {
   3.950784471743929*^9, 3.950784506376987*^9}, 3.950784570678767*^9, {
   3.950784619092307*^9, 3.950784629770219*^9}, {3.950784661267223*^9, 
   3.950784685069392*^9}, 3.950784732100133*^9, 3.950784836023178*^9, {
   3.9507849299884863`*^9, 3.950784965333905*^9}, {3.950785004974284*^9, 
   3.950785015994617*^9}, {3.950785051484831*^9, 3.950785068076728*^9}, {
   3.950785183704587*^9, 3.950785197975553*^9}, {3.950785273838151*^9, 
   3.9507852934474277`*^9}},
 CellLabel->
  "During evaluation of \
In[26]:=",ExpressionUUID->"7d8148c7-6518-4575-8448-465200632c46"],

Cell[BoxData["\<\"To see all (user-defined and package-defined) FormTracer \
definitions, call \
\\!\\(\\*\\nStyleBox[\\\"TBInfo\\\",\\nFontColor->RGBColor[1, 0.5, \
0]]\\)[\\\"FormTracer\\\"].\\nFurthermore, \
\\!\\(\\*\\nStyleBox[\\\"TensorBases\\\",\\nFontWeight->\\\"Bold\\\"]\\)\\!\\(\
\\*\\nStyleBox[\\\" \\\",\\nFontWeight->\\\"Bold\\\"]\\)extends \
\\!\\(\\*\\nStyleBox[\\\"FormTracer\\\",\\nFontWeight->\\\"Bold\\\"]\\). To \
see all extensions, call \
\\!\\(\\*\\nStyleBox[\\\"TBInfo\\\",\\nFontColor->RGBColor[1, 0.5, \
0]]\\)[\\\"Extensions\\\"]\"\>"], "Print",
 CellChangeTimes->{
  3.950768820119334*^9, 3.950774987706017*^9, 3.9507843265150957`*^9, 
   3.950784373354507*^9, {3.9507844128909073`*^9, 3.9507844315247583`*^9}, {
   3.950784471743929*^9, 3.950784506376987*^9}, 3.950784570678767*^9, {
   3.950784619092307*^9, 3.950784629770219*^9}, {3.950784661267223*^9, 
   3.950784685069392*^9}, 3.950784732100133*^9, 3.950784836023178*^9, {
   3.9507849299884863`*^9, 3.950784965333905*^9}, {3.950785004974284*^9, 
   3.950785015994617*^9}, {3.950785051484831*^9, 3.950785068076728*^9}, {
   3.950785183704587*^9, 3.950785197975553*^9}, {3.950785273838151*^9, 
   3.950785293447832*^9}},
 CellLabel->
  "During evaluation of \
In[26]:=",ExpressionUUID->"1ef81d0d-0e28-427d-bcc5-2c028847bcf9"],

Cell[BoxData["\<\"\\nTo see all momentum transformations that can be \
performed by \\!\\(\\*\\nStyleBox[\\\"TensorBases\\\",\\nFontWeight->\\\"Bold\
\\\"]\\), call \\!\\(\\*\\nStyleBox[\\\"TBInfo\\\",\\nFontColor->RGBColor[1, \
0.5, 0]]\\)[\\\"Momenta\\\"].\\n\"\>"], "Print",
 CellChangeTimes->{
  3.950768820119334*^9, 3.950774987706017*^9, 3.9507843265150957`*^9, 
   3.950784373354507*^9, {3.9507844128909073`*^9, 3.9507844315247583`*^9}, {
   3.950784471743929*^9, 3.950784506376987*^9}, 3.950784570678767*^9, {
   3.950784619092307*^9, 3.950784629770219*^9}, {3.950784661267223*^9, 
   3.950784685069392*^9}, 3.950784732100133*^9, 3.950784836023178*^9, {
   3.9507849299884863`*^9, 3.950784965333905*^9}, {3.950785004974284*^9, 
   3.950785015994617*^9}, {3.950785051484831*^9, 3.950785068076728*^9}, {
   3.950785183704587*^9, 3.950785197975553*^9}, {3.950785273838151*^9, 
   3.9507852934483843`*^9}},
 CellLabel->
  "During evaluation of \
In[26]:=",ExpressionUUID->"651ca95b-12e3-402c-be17-c5c86b0d666c"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fields", "=", " ", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<cField\>\"", "\[Rule]", " ", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"p", ",", 
          RowBox[{"{", 
           RowBox[{"v", ",", " ", "c"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Phi]", "[", "p", "]"}], ",", 
          RowBox[{"\[Phi]x", "[", "p", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Grassmann\>\"", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cb", "[", 
          RowBox[{"p", ",", 
           RowBox[{"{", "c", "}"}]}], "]"}], ",", 
         RowBox[{"c", "[", 
          RowBox[{"p", ",", 
           RowBox[{"{", "c", "}"}]}], "]"}]}], "}"}], "\[IndentingNewLine]", 
       "}"}]}]}], "\[IndentingNewLine]", "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"masterEquation", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"A", "[", "x", "]"}], 
        RowBox[{"VBasis", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", "A"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "x"}], ",", 
            RowBox[{"-", "y"}]}], "}"}]}], "]"}], 
        RowBox[{"A", "[", "y", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"cb", "[", "x", "]"}]}], 
         RowBox[{"VBasis", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"cb", ",", "c"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "x"}], ",", 
             RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], ",", 
        RowBox[{"c", "[", "y", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Setup", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<MasterEquation\>\"", "->", "masterEquation"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<FieldSpace\>\"", "->", "fields"}]}], "\[IndentingNewLine]", 
    "|>"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9507856762700357`*^9, 3.9507858002547617`*^9}, {
  3.9509731139899683`*^9, 3.950973140087144*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"2632f66f-a425-44c8-b21c-333bdd8417c4"],

Cell[CellGroupData[{

Cell["FTerm and FEq definitions ", "Section",
 CellChangeTimes->{{3.9509597231601686`*^9, 
  3.950959732923991*^9}},ExpressionUUID->"e03db448-7a6c-4e73-9ddc-\
3b1976a84a81"],

Cell[CellGroupData[{

Cell["Basic definitions", "Subsection",
 CellChangeTimes->{{3.950959776616251*^9, 3.950959779850823*^9}, 
   3.9509598524176817`*^9},ExpressionUUID->"35360acd-1ab3-48dc-b387-\
960ef784c1b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", 
   RowBox[{"FEq", ",", "FTerm"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"FEq", ",", "FTerm"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FTerm", "::", "TimesError"}], "=", 
   "\"\<An FTerm cannot be multiplied using Times[__]. To multiply FTerms, \
use term1**term2, also with scalars, a**term.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FEq", "::", "TimesError"}], "=", 
    "\"\<A FEq cannot be multiplied using Times[__]. To multiply FEqs, use \
eq1**eq2, also with scalars, a**eq.\>\""}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Multiplication", " ", "of", " ", "FTerms"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"FTerm", "/:", 
  RowBox[{"Times", "[", 
   RowBox[{"pre___", ",", 
    RowBox[{"FTerm", "[", "a__", "]"}], ",", "post___"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{"FTerm", "::", "TimesError"}], "]"}], ";", 
    RowBox[{"Abort", "[", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTerm", "/:", 
   RowBox[{"NonCommutativeMultiply", "[", 
    RowBox[{
     RowBox[{"FTerm", "[", "a__", "]"}], ",", 
     RowBox[{"FTerm", "[", "b__", "]"}]}], "]"}], ":=", 
   RowBox[{"FTerm", "[", 
    RowBox[{"a", ",", "b"}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Reduction", " ", "of", " ", "immediately", " ", "nested", " ", "FTerms"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FTerm", "[", 
    RowBox[{"pre___", ",", 
     RowBox[{"FTerm", "[", "in__", "]"}], ",", "post___"}], "]"}], ":=", 
   RowBox[{"FTerm", "[", 
    RowBox[{"pre", ",", "in", ",", "post"}], "]"}]}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Sum", " ", "splitting", " ", "of", " ", "FTerms"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FEq", "[", 
    RowBox[{"preEq___", ",", 
     RowBox[{"FTerm", "[", 
      RowBox[{"preTerm___", ",", 
       RowBox[{"Plus", "[", 
        RowBox[{"a_", ",", "b__"}], "]"}], ",", "postTerm___"}], "]"}], ",", 
     "postEq___"}], "]"}], ":=", 
   RowBox[{"FEq", "[", 
    RowBox[{"preEq", ",", 
     RowBox[{"FTerm", "[", 
      RowBox[{"preTerm", ",", "a", ",", "postTerm"}], "]"}], ",", 
     RowBox[{"FTerm", "[", 
      RowBox[{"preTerm", ",", 
       RowBox[{"Plus", "[", "b", "]"}], ",", "postTerm"}], "]"}], ",", 
     "postEq"}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Sums", " ", "of", " ", "FTerms"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FEq", "[", 
    RowBox[{"preEq___", ",", 
     RowBox[{"Plus", "[", 
      RowBox[{
       RowBox[{"FTerm", "[", "a__", "]"}], ",", 
       RowBox[{"FTerm", "[", "b__", "]"}], ",", "c___"}], "]"}], ",", 
     "postEq___"}], "]"}], ":=", 
   RowBox[{"FEq", "[", 
    RowBox[{"preEq", ",", 
     RowBox[{"FTerm", "[", "a", "]"}], ",", 
     RowBox[{"Plus", "[", 
      RowBox[{
       RowBox[{"FTerm", "[", "b", "]"}], ",", "c"}], "]"}], ",", "postEq"}], 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Sums", " ", "of", " ", "FEqs"}], "*)"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{"FEq", "/:", 
   RowBox[{"Plus", "[", 
    RowBox[{"preEq___", ",", 
     RowBox[{"FEq", "[", "terms1___", "]"}], ",", "midEq___", ",", 
     RowBox[{"FEq", "[", "terms2___", "]"}], ",", "postEq___"}], "]"}], ":=", 
   
   RowBox[{"Plus", "[", 
    RowBox[{"preEq", ",", "midEq", ",", "postEq", ",", 
     RowBox[{"FEq", "[", 
      RowBox[{"terms1", ",", "terms2"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Multiplication", " ", "of", " ", "FEqs"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"FEq", "/:", 
  RowBox[{"Times", "[", 
   RowBox[{"pre___", ",", 
    RowBox[{"FEq", "[", "a__", "]"}], ",", "post___"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{"FEq", "::", "TimesError"}], "]"}], ";", 
    RowBox[{"Abort", "[", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"FEq", "/:", 
  RowBox[{"NonCommutativeMultiply", "[", 
   RowBox[{
    RowBox[{"FTerm", "[", "b__", "]"}], ",", 
    RowBox[{"FEq", "[", "c__", "]"}]}], "]"}], ":=", 
  RowBox[{"FEq", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"FTerm", "[", "b", "]"}], "**", "#"}], "&"}], ",", 
     RowBox[{"FEq", "[", "c", "]"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{"FEq", "/:", 
   RowBox[{"NonCommutativeMultiply", "[", 
    RowBox[{
     RowBox[{"FEq", "[", "a__", "]"}], ",", 
     RowBox[{"FEq", "[", "b__", "]"}]}], "]"}], ":=", 
   RowBox[{"FEq", "@@", 
    RowBox[{"(", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"FEq", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "a", "}"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "**", 
          RowBox[{
           RowBox[{"{", "b", "}"}], "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"{", "a", "}"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"{", "b", "}"}], "]"}]}], "}"}]}], "]"}]}], ")"}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Reduction", " ", "of", " ", "immediately", " ", "nested", " ", "FEqs"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FEq", "[", 
   RowBox[{"pre___", ",", 
    RowBox[{"FEq", "[", "in___", "]"}], ",", "post___"}], "]"}], ":=", 
  RowBox[{"FEq", "[", 
   RowBox[{"pre", ",", "in", ",", "post"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FEq", "[", 
    RowBox[{"pre___", ",", 
     RowBox[{"FTerm", "[", "]"}], ",", "post___"}], "]"}], ":=", 
   RowBox[{"FEq", "[", 
    RowBox[{"pre", ",", "post"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", 
   RowBox[{"FEq", ",", "FTerm"}], "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9509578761709423`*^9, 3.950957973036676*^9}, {
   3.9509590689899607`*^9, 3.9509591157318487`*^9}, {3.9509591472919817`*^9, 
   3.950959252858809*^9}, {3.9509592907067623`*^9, 3.9509592957039757`*^9}, {
   3.950959501450481*^9, 3.95095951130514*^9}, {3.950959686410345*^9, 
   3.950959714174095*^9}, 3.950959773470724*^9, {3.951034884384832*^9, 
   3.951034890869*^9}, {3.951035198689001*^9, 3.951035207408928*^9}, {
   3.951035268197209*^9, 3.951035301400906*^9}, {3.951035981870775*^9, 
   3.9510360006370783`*^9}, {3.951036246658142*^9, 3.95103626460588*^9}, {
   3.95103649033849*^9, 3.951036598302443*^9}, {3.951036633594223*^9, 
   3.951036785006905*^9}, {3.9510368169549932`*^9, 3.951036830730741*^9}, {
   3.951037206113153*^9, 3.95103734490982*^9}, {3.951037380987048*^9, 
   3.951037383677424*^9}, {3.951037439125901*^9, 3.951037496838653*^9}, {
   3.95103754050202*^9, 3.9510375690137587`*^9}, {3.9510376206837482`*^9, 
   3.951037625335888*^9}, {3.95103780882169*^9, 3.951037937002328*^9}, {
   3.951045322817977*^9, 3.95104532318824*^9}, {3.9510453867665377`*^9, 
   3.9510456103940287`*^9}, {3.95104564974853*^9, 3.951045666800379*^9}, {
   3.9510457134141083`*^9, 3.951045873397193*^9}, {3.951045915058331*^9, 
   3.9510460013306837`*^9}, {3.95104607626162*^9, 3.951046274552978*^9}, {
   3.951046466112495*^9, 3.951046728989846*^9}, {3.951046767530278*^9, 
   3.951046934066455*^9}},
 CellLabel->
  "In[1104]:=",ExpressionUUID->"d8c7ad92-008a-409f-951b-580a3ca827cd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Checks and assertions", "Subsection",
 CellChangeTimes->{{3.932178009618313*^9, 3.932178022055203*^9}, {
  3.950801118933737*^9, 
  3.950801121691584*^9}},ExpressionUUID->"23b7e69d-dcbb-4fb0-a77e-\
b8638a031ad4"],

Cell[CellGroupData[{

Cell["FTerm and FEq", "Subsubsection",
 CellChangeTimes->{{3.9508642163296537`*^9, 3.950864226113566*^9}, {
  3.950964433513967*^9, 
  3.9509644360831413`*^9}},ExpressionUUID->"d438b387-4f31-41ce-a117-\
795b628d69b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FTermQ", "[", "expr_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Head", "[", "expr", "]"}], "===", "FTerm"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FTerm", "::", "notFTerm"}], "=", 
   "\"\<The term `1` is not an FTerm.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AssertFTerm", "[", "expr_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"Not", "@", 
       RowBox[{"FTermQ", "[", "expr", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{
         RowBox[{"FTerm", "::", "notFTerm"}], ",", "expr"}], "]"}], ";", 
       RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FEqQ", "[", "expr_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Head", "[", "expr", "]"}], "===", "FEq"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FEq", "::", "notFEq"}], "=", 
   "\"\<The term `1` is not an FEq.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AssertFEq", "[", "expr_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"FEqQ", "[", "expr", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"FEq", "::", "notFEq"}], ",", "expr"}], "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950959791226129*^9, 3.950959819925836*^9}, {
  3.950959877202113*^9, 3.950959965968995*^9}},
 CellLabel->
  "In[1120]:=",ExpressionUUID->"63fbe29b-4af8-405d-80e3-5cbc9aa8d1d5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Field Space", "Subsubsection",
 CellChangeTimes->{{3.950801271735565*^9, 3.95080128037481*^9}, {
  3.9508933727376747`*^9, 
  3.950893373722165*^9}},ExpressionUUID->"f52392a8-ad40-44db-871d-\
0651868db7ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Check", " ", "if", " ", "a", " ", "given", " ", "field", " ", 
     "definition", " ", "is", " ", 
     RowBox[{"valid", ".", " ", "Can"}], " ", "be", " ", "either", " ", "its",
      " ", "own", " ", "anti"}], "-", 
    RowBox[{"field", " ", "or", " ", "a", " ", "pair", " ", 
     RowBox[{"{", 
      RowBox[{"af", ",", "f"}], "}"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FieldDefQ", "[", "expr_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "expr", "]"}], "===", "List"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "expr", "]"}], "=!=", "2"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<A field definition must be either of form f[x...] or \
{af[x...],f[x...]}. \\\"\>\"", ",", "expr", ",", 
                "\"\<\\\" does not fit.\>\""}], "]"}], ";", 
              RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", 
               RowBox[{"expr", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"Head", "[", 
               RowBox[{"expr", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<A field definition {af[x...],f[x...]} must have different \
field names af and f. \\\"\>\"", ",", "expr", ",", 
                "\"\<\\\" does not fit.\>\""}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Not", "@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"List", "@@", 
                 RowBox[{"(", 
                  RowBox[{"expr", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "===", 
                RowBox[{"List", "@@", 
                 RowBox[{"(", 
                  RowBox[{"expr", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ")"}]}]}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<A field definition {af[x...],f[x...]} must have identical \
indices. \\\"\>\"", ",", "expr", ",", "\"\<\\\" does not fit.\>\""}], "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Not", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"MatchQ", "[", 
                   RowBox[{
                    RowBox[{"expr", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"_Symbol", "[", 
                    RowBox[{"_", ",", 
                    RowBox[{"{", "__Symbol", "}"}]}], "]"}]}], "]"}], "||", 
                  RowBox[{"MatchQ", "[", 
                   RowBox[{
                    RowBox[{"expr", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"_Symbol", "[", "_", "]"}]}], "]"}]}], ")"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<A field definition f[x...] must have indices f[p] or \
f[p,{a,b,...}]. \\\"\>\"", ",", 
                  RowBox[{"expr", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  "\"\<\\\" does not fit.\>\""}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "True", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{"expr", ",", 
               RowBox[{"_Symbol", "[", 
                RowBox[{"_", ",", 
                 RowBox[{"{", "__Symbol", "}"}]}], "]"}]}], "]"}], "||", 
             RowBox[{"MatchQ", "[", 
              RowBox[{"expr", ",", 
               RowBox[{"_Symbol", "[", "_", "]"}]}], "]"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<A field definition f[x...] must have indices f[p] or \
f[p,{a,b,...}]. \\\"\>\"", ",", "expr", ",", "\"\<\\\" does not fit.\>\""}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FieldDef", "::", "invalidFieldDefinition"}], "=", 
     "\"\<The given field definition `1` is not valid.\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AssertFieldDef", "[", "expr_", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "@", 
        RowBox[{"FieldDefQ", "[", "expr", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"FieldDefinition", "::", "invalidFieldDefinition"}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9509723959533377`*^9, 3.950972498533544*^9}, {
  3.9509725391754503`*^9, 3.950972839103818*^9}, {3.95097289590053*^9, 
  3.950973043727556*^9}, {3.9509730775238113`*^9, 3.9509730807717524`*^9}, {
  3.950973155496664*^9, 3.950973196313613*^9}, {3.950973268996133*^9, 
  3.950973292848659*^9}, {3.950973323914188*^9, 3.950973407746553*^9}, {
  3.9509734394970713`*^9, 3.950973519577339*^9}, {3.950973729052182*^9, 
  3.9509737667166567`*^9}, {3.950976938011018*^9, 3.950976940198797*^9}},
 CellLabel->
  "In[1126]:=",ExpressionUUID->"d2be4365-2a9f-4170-90b1-81e044dec426"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Check", " ", "if", " ", "a", " ", "given", " ", "field", " ", "space", 
    " ", "definition", " ", "is", " ", "valid"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FieldSpaceDefQ", "[", "fieldSpace_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "fieldSpace", "]"}], "=!=", "Association"}], 
          ",", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<An FSetup must be an association\>\"", "]"}], 
           ";", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Keys", "[", "fieldSpace", "]"}], "===", 
             RowBox[{"{", 
              RowBox[{"\"\<cField\>\"", ",", "\"\<Grassmann\>\""}], "}"}]}], 
            ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<fields must contain the two keys \
{\\\"cField\\\",\\\"Grassmann\\\"}!\>\"", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"ListQ", "[", 
            RowBox[{"fieldSpace", "[", "\"\<cField\>\"", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<fields[\\\"cField\\\"] must be a list!\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"(", 
            RowBox[{"And", "@@", 
             RowBox[{"Map", "[", 
              RowBox[{"FieldDefQ", ",", 
               RowBox[{"fieldSpace", "[", "\"\<cField\>\"", "]"}]}], "]"}]}], 
            ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<fields[\\\"cField\\\"] must contain valid fields!\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"ListQ", "[", 
            RowBox[{"fieldSpace", "[", "\"\<Grassmann\>\"", "]"}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<fields[\\\"Grassmann\\\"] must be a list!\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"(", 
            RowBox[{"And", "@@", 
             RowBox[{"Map", "[", 
              RowBox[{"FieldDefQ", ",", 
               RowBox[{"fieldSpace", "[", "\"\<Grassmann\>\"", "]"}]}], 
              "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<fields[\\\"Grassmann\\\"] must contain valid fields!\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FieldSpaceDefinition", "::", "invalidFieldDefinition"}], "=", 
     "\"\<The given field space definition is invalid.\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AssertFieldSpaceDef", "[", "fields_", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "@", 
        RowBox[{"FieldSpaceDefQ", "[", "fields", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"FieldSpaceDefinition", "::", "invalidFieldDefinition"}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950785803281868*^9, 3.950785830855114*^9}, {
   3.950786297997837*^9, 3.9507864029709253`*^9}, {3.950787129958323*^9, 
   3.9507871301602573`*^9}, {3.950795998774166*^9, 3.950796005485301*^9}, {
   3.9507965324786587`*^9, 3.950796562931445*^9}, {3.950796680245487*^9, 
   3.950796684703451*^9}, 3.950801142187722*^9, {3.9508637092253017`*^9, 
   3.950863710048918*^9}, {3.9508933587966433`*^9, 3.950893362683991*^9}, {
   3.950964560883992*^9, 3.9509647260060463`*^9}, 3.9509709919521027`*^9, {
   3.95097119902899*^9, 3.950971269684161*^9}, {3.950972406057185*^9, 
   3.950972419055738*^9}, {3.9509729891057043`*^9, 3.9509729901532373`*^9}, {
   3.950973052932276*^9, 3.950973069072235*^9}, {3.950973542193096*^9, 
   3.9509735933051243`*^9}, {3.9509736291278887`*^9, 
   3.9509737236713676`*^9}, {3.950973781220873*^9, 3.950973802678894*^9}, {
   3.950973984287372*^9, 3.950974058340818*^9}},
 CellLabel->
  "In[1129]:=",ExpressionUUID->"ffdc8015-4beb-4a8a-9712-899076a5bcad"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.9509737011024*^9},
 CellLabel->
  "In[1132]:=",ExpressionUUID->"e6fda6fb-9bcb-45a5-b801-7e006569f014"]
}, Closed]],

Cell[CellGroupData[{

Cell["FSetup", "Subsubsection",
 CellChangeTimes->{{3.9508642163296537`*^9, 3.950864226113566*^9}, 
   3.950964437586562*^9, 
   3.9509736149796743`*^9},ExpressionUUID->"432ab124-4161-47f8-a56b-\
8db469a3db21"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FSetup", "::", "notFSetup"}], "=", 
    "\"\<The given setup is not valid!\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FSetupQ", "[", "setup_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Head", "[", "setup", "]"}], "===", "Association"}], 
           ")"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<A valid setup must be an Association!\>\"", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "@", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Keys", "[", "setup", "]"}], ",", "\"\<FieldSpace\>\""}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<A valid setup must have the key \\\"FieldSpace\\\"!\>\"", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "@", 
          RowBox[{"FieldSpaceDefQ", "[", 
           RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AssertFSetup", "[", "setup_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "setup", "]"}], "===", "Association"}], 
          ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<A valid setup must be an Association!\>\"", "]"}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"Message", "[", 
          RowBox[{"FSetup", "::", "notFSetup"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "@", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"Keys", "[", "setup", "]"}], ",", "\"\<FieldSpace\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<A valid setup must have the key \\\"FieldSpace\\\"!\>\"", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Message", "[", 
          RowBox[{"FSetup", "::", "notFSetup"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"AssertFieldSpaceDef", "[", 
       RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950864013876114*^9, 3.950864178121345*^9}, {
  3.950866123517272*^9, 3.9508661552146883`*^9}, {3.95096155740795*^9, 
  3.950961589920692*^9}, {3.9509635332623377`*^9, 3.95096359322543*^9}, {
  3.9509709220279417`*^9, 3.950970986439794*^9}, {3.9509710317799788`*^9, 
  3.950971170043336*^9}, {3.950973871588525*^9, 3.950973901835678*^9}, {
  3.9509739679684*^9, 3.950973970944644*^9}},
 CellLabel->
  "In[1133]:=",ExpressionUUID->"11470f5d-e2db-4aaa-9b7e-0a8c11da0687"]
}, Closed]],

Cell[CellGroupData[{

Cell["Derivative List", "Subsubsection",
 CellChangeTimes->{{3.9508642163296537`*^9, 3.950864226113566*^9}, {
  3.950893338644219*^9, 
  3.950893340478217*^9}},ExpressionUUID->"4586692a-ee51-46b9-b58e-\
43bcdb604423"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Check", " ", "if", " ", "a", " ", "given", " ", "field", " ", 
     "definition", " ", "is", " ", 
     RowBox[{"valid", ".", " ", "Can"}], " ", "be", " ", "either", " ", "its",
      " ", "own", " ", "anti"}], "-", 
    RowBox[{"field", " ", "or", " ", "a", " ", "pair", " ", 
     RowBox[{"{", 
      RowBox[{"af", ",", "f"}], "}"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FieldQ", "[", 
      RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{"expr", ",", 
               RowBox[{"_Symbol", "[", 
                RowBox[{"_", ",", 
                 RowBox[{"{", "__Symbol", "}"}]}], "]"}]}], "]"}], "||", 
             RowBox[{"MatchQ", "[", 
              RowBox[{"expr", ",", 
               RowBox[{"_Symbol", "[", "_", "]"}]}], "]"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<A field f[x...] must have indices f[p] or f[p,{a,b,...}]. \\\
\"\>\"", ",", "expr", ",", "\"\<\\\" does not fit.\>\""}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"(", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{"Head", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "//", 
                  "Values"}], "//", "Flatten"}]}], "]"}], ",", 
              RowBox[{"Head", "[", "expr", "]"}]}], "]"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<The field \\\"\>\"", ",", "expr", ",", 
             "\"\<\\\" is not contained in the field space.\>\""}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Field", "::", "invalidField"}], "=", 
     "\"\<The given field `1` does not exist.\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AssertField", "[", 
      RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "@", 
        RowBox[{"FieldQ", "[", 
         RowBox[{"setup", ",", "expr"}], "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"FieldDefinition", "::", "invalidField"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9509723959533377`*^9, 3.950972498533544*^9}, {
  3.9509725391754503`*^9, 3.950972839103818*^9}, {3.95097289590053*^9, 
  3.950973043727556*^9}, {3.9509730775238113`*^9, 3.9509730807717524`*^9}, {
  3.950973155496664*^9, 3.950973196313613*^9}, {3.950973268996133*^9, 
  3.950973292848659*^9}, {3.950973323914188*^9, 3.950973407746553*^9}, {
  3.9509734394970713`*^9, 3.950973519577339*^9}, {3.950973729052182*^9, 
  3.9509737667166567`*^9}, {3.9509741552332573`*^9, 3.9509741985720987`*^9}, {
  3.9509742355449142`*^9, 3.9509742565395184`*^9}, {3.9509766019032183`*^9, 
  3.9509766041301928`*^9}, {3.9509766344861717`*^9, 3.950976637210259*^9}, {
  3.9509766769979153`*^9, 3.950976779031054*^9}, {3.9509769256787357`*^9, 
  3.9509769282539797`*^9}, {3.9510498517763968`*^9, 
  3.951049854349081*^9}},ExpressionUUID->"8025941a-3caa-4a8b-a6f7-\
d19c65a09782"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Check", " ", "a", " ", "derivative", " ", "list", " ", "for", " ", 
    "correct", " ", 
    RowBox[{"formatting", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"DerivativeListQ", "[", 
      RowBox[{"setup_", ",", "derivativeList_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", "derivativeList", "]"}], "===", "List"}], 
            ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<A valid derivativeList must be an List!\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"AllTrue", "[", 
            RowBox[{"derivativeList", ",", 
             RowBox[{
              RowBox[{"FieldQ", "[", 
               RowBox[{"setup", ",", "#"}], "]"}], "&"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<A valid derivativeList must be an List of fields \
f_[p_,{___}] of f_[p_] which have been defined in the setup!\>\"", "]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DeriveEquation", "::", "invalidDerivativeList"}], "=", 
     "\"\<The given derivativeList `1` is not valid.\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AssertDerivativeList", "[", 
      RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "@", 
        RowBox[{"DerivativeListQ", "[", 
         RowBox[{"setup", ",", "expr"}], "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"DeriveEquation", "::", "invalidDerivativeList"}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950864234236211*^9, 3.9508644603567677`*^9}, {
   3.950864514373273*^9, 3.950864523736723*^9}, {3.950865674724793*^9, 
   3.9508656803898973`*^9}, {3.950866001476939*^9, 3.950866011277586*^9}, {
   3.950866277809552*^9, 3.950866291301694*^9}, 3.9508663653146677`*^9, 
   3.95086639713623*^9, {3.95097396076858*^9, 3.950973963799748*^9}, {
   3.9509740743483953`*^9, 3.95097409846065*^9}, {3.9509767888540382`*^9, 
   3.95097688937116*^9}},
 CellLabel->
  "In[1139]:=",ExpressionUUID->"d04f551f-63ba-4c59-827e-89539a889eb6"]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Utilities", "Section",
 CellChangeTimes->{{3.932177970725307*^9, 
  3.9321779720559883`*^9}},ExpressionUUID->"bdee160a-1c91-4de1-b52d-\
86eb572207e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Protect", "[", 
   RowBox[{
   "GammaN", ",", "Propagator", ",", "AnyField", ",", "ABasis", ",", 
    "VBasis"}], "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950894219634593*^9, 3.950894225625526*^9}, {
   3.9508945494140673`*^9, 3.9508945506586037`*^9}, 3.950940101789105*^9, {
   3.95097703546941*^9, 3.95097703915795*^9}},
 CellLabel->
  "In[1142]:=",ExpressionUUID->"8b16408f-667b-4fec-b260-6fb6db16586b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"exclusions", "[", "a_", "]"}], ":=", 
  RowBox[{"And", "@@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "=!=", "List"}], ",", 
     RowBox[{"a", "=!=", "Complex"}], ",", 
     RowBox[{"a", "=!=", "Plus"}], ",", 
     RowBox[{"a", "=!=", "Power"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetAllSymbols", "[", "expr_", "]"}], ":=", 
  RowBox[{"DeleteDuplicates", "@", 
   RowBox[{"Cases", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "expr", "}"}], "//.", 
        RowBox[{
         RowBox[{"Times", "[", 
          RowBox[{"a_", ",", "b__"}], "]"}], ":>", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}]}]}], "//.", 
       RowBox[{
        RowBox[{
         RowBox[{"a_Symbol", "[", "b__", "]"}], "/;", 
         RowBox[{"exclusions", "[", "a", "]"}]}], ":>", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", "_Symbol", ",", "\[IndentingNewLine]", 
     "Infinity"}], "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9510242717398663`*^9, 3.951024280343438*^9}, 
   3.951024444887616*^9},
 CellLabel->
  "In[1143]:=",ExpressionUUID->"f4704157-c7f9-402c-bf7c-77513ac8ecc7"],

Cell[CellGroupData[{

Cell["FunctionalD", "Subsection",
 CellChangeTimes->{{3.932178009618313*^9, 3.932178022055203*^9}, {
  3.950801118933737*^9, 
  3.950801154023693*^9}},ExpressionUUID->"5193f3f7-8901-4525-bbbc-\
d3fa4695bea7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FunctionalD", "[", 
     RowBox[{"expr_", ",", 
      RowBox[{"v", ":", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f_", "[", "_", "]"}], "|", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"f_", "[", "_", "]"}], ",", "_Integer"}], "}"}]}], ")"}], 
        ".."}]}], ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"Internal`InheritedBlock", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"f", ",", "GammaN", ",", "Propagator", ",", "nonConst"}], 
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nonConst", "=", 
        RowBox[{"{", 
         RowBox[{"f", ",", "GammaN", ",", "Propagator"}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Rule", " ", "for", " ", "normal", " ", "functional", " ", 
         "derivatives"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"f", "/:", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"f", "[", "x_", "]"}], ",", 
          RowBox[{"f", "[", "y_", "]"}], ",", 
          RowBox[{"NonConstants", "->", "nonConst"}]}], "]"}], ":=", 
        RowBox[{"\[Gamma]", "[", 
         RowBox[{
          RowBox[{"-", "y"}], ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Ignore", " ", "fields", " ", "without", " ", 
         RowBox[{"indices", ".", " ", "These"}], " ", "are", " ", "usually", 
         " ", "tags"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"f", "/:", 
        RowBox[{"D", "[", 
         RowBox[{"f", ",", 
          RowBox[{"f", "[", "y_", "]"}], ",", 
          RowBox[{"NonConstants", "->", "nonConst"}]}], "]"}], ":=", "0"}], 
       ";", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Delta]", "[", 
           RowBox[{"#", ",", "y"}], "]"}], "&"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Unprotect", "[", 
        RowBox[{"GammaN", ",", "Propagator"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Derivative", " ", "rule", " ", "for", " ", "GammaN"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"GammaN", "/:", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"GammaN", "[", 
           RowBox[{
            RowBox[{"{", "a__", "}"}], ",", 
            RowBox[{"{", "b__", "}"}]}], "]"}], ",", 
          RowBox[{"f", "[", "y_", "]"}], ",", 
          RowBox[{"NonConstants", "->", "nonConst"}]}], "]"}], ":=", 
        RowBox[{"GammaN", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"f", ",", "a"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "b"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Derivative", " ", "rule", " ", "for", " ", "Propagators"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Propagator", "/:", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"Propagator", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"b_", ",", "a_"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"ib_", ",", "ia_"}], "}"}]}], "]"}], ",", 
          RowBox[{"f", "[", "if_", "]"}], ",", 
          RowBox[{"NonConstants", "->", "nonConst"}]}], "]"}], ":=", 
        RowBox[{"Module", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ic", ",", "id", ",", "ie"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Propagator", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"b", ",", "AnyField"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"ib", ",", "ic"}], "}"}]}], "]"}], 
           RowBox[{"GammaN", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"f", ",", "AnyField", ",", "AnyField"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "if"}], ",", 
               RowBox[{"-", "ic"}], ",", 
               RowBox[{"-", "id"}]}], "}"}]}], "]"}], 
           RowBox[{"Propagator", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"AnyField", ",", "a"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"id", ",", "ie"}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"\[Gamma]", "[", 
            RowBox[{"ia", ",", 
             RowBox[{"-", "ie"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Protect", "[", 
        RowBox[{"GammaN", ",", "Propagator"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"D", "[", 
        RowBox[{"expr", ",", "v", ",", 
         RowBox[{"NonConstants", "->", "nonConst"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FunctionalD", "::", "badArgumentFTerm"}], "=", 
   "\"\<Cannot take derivative of an FTerm. Use DeriveFunctional \
instead.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FunctionalD", "[", 
     RowBox[{
      RowBox[{"FTerm", "[", "expr_", "]"}], ",", 
      RowBox[{"v", ":", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f_", "[", "_", "]"}], "|", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"f_", "[", "_", "]"}], ",", "_Integer"}], "}"}]}], ")"}], 
        ".."}]}], ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"FunctionalD", "::", "badArgumentFTerm"}], "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FunctionalD", "::", "badArgumentFEq"}], "=", 
   "\"\<Cannot take derivative of an FEq. Use DeriveFunctional \
instead.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FunctionalD", "[", 
    RowBox[{
     RowBox[{"FEq", "[", "___", "]"}], ",", 
     RowBox[{"v", ":", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"f_", "[", "_", "]"}], "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"f_", "[", "_", "]"}], ",", "_Integer"}], "}"}]}], ")"}], 
       ".."}]}], ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"FunctionalD", "::", "badArgumentFEq"}], "]"}], ";", 
     RowBox[{"Abort", "[", "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950801155924999*^9, 3.950801156180604*^9}, 
   3.9508745541091022`*^9, {3.950874630546281*^9, 3.9508746344224*^9}, {
   3.9508746716147623`*^9, 3.950874843953817*^9}, {3.950874911320944*^9, 
   3.950874967970771*^9}, {3.9508750098040237`*^9, 3.9508750233744373`*^9}, {
   3.9508750787554817`*^9, 3.950875148206582*^9}, 3.9508752181802464`*^9, {
   3.9508940369998207`*^9, 3.9508941754057407`*^9}, {3.950894207218882*^9, 
   3.950894268707493*^9}, {3.9508943099823914`*^9, 3.950894364887673*^9}, {
   3.950894405287778*^9, 3.9508945587833138`*^9}, {3.9508969076834803`*^9, 
   3.9508969664507713`*^9}, {3.950897004655106*^9, 3.950897015070427*^9}, 
   3.9508971564032593`*^9, {3.950897870040359*^9, 3.950897884551845*^9}, {
   3.950897973224579*^9, 3.9508980022919607`*^9}, {3.9509326427332706`*^9, 
   3.95093266159977*^9}, {3.950939662750992*^9, 3.950939674049011*^9}, {
   3.950939753193946*^9, 3.950939895705489*^9}, {3.95093993866444*^9, 
   3.950939957812808*^9}, {3.9509401218698893`*^9, 3.9509401363101273`*^9}, {
   3.950952533276232*^9, 3.950952545138974*^9}, {3.95095258820336*^9, 
   3.950952722829163*^9}, {3.950952869771017*^9, 3.950953031163056*^9}, {
   3.950977047894329*^9, 3.950977350633822*^9}},
 CellLabel->
  "In[1145]:=",ExpressionUUID->"428f55da-c8db-4d63-89da-51a880a4e13f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Field and index information", "Subsection",
 CellChangeTimes->{{3.932178009618313*^9, 3.932178022055203*^9}, {
  3.95097752282972*^9, 
  3.950977525821363*^9}},ExpressionUUID->"a703f905-419d-403f-a28c-\
a63b6e5d0fbc"],

Cell[CellGroupData[{

Cell["Fields", "Subsubsection",
 CellChangeTimes->{{3.950977858978568*^9, 
  3.9509778685688467`*^9}},ExpressionUUID->"807846d5-0a8e-42e1-8499-\
9436b99fe5c0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetcFields", "[", "setup_", "]"}], ":=", 
   RowBox[{"Map", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "#", "]"}], "===", "List"}], ",", 
        RowBox[{"Head", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
        RowBox[{"Head", "[", "#", "]"}]}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
      "\"\<cField\>\"", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetAnticFields", "[", "setup_", "]"}], ":=", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Map", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "#", "]"}], "===", "List"}], ",", 
           RowBox[{"Head", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", "}"}]}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
         "\"\<cField\>\"", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{
       RowBox[{"#", "=!=", 
        RowBox[{"{", "}"}]}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetGrassmanns", "[", "setup_", "]"}], ":=", 
   RowBox[{"Map", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "#", "]"}], "===", "List"}], ",", 
        RowBox[{"Head", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
        RowBox[{"Head", "[", "#", "]"}]}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
      "\"\<Grassmann\>\"", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetAntiGrassmanns", "[", "setup_", "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Map", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "#", "]"}], "===", "List"}], ",", 
          RowBox[{"Head", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", "}"}]}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
        "\"\<Grassmann\>\"", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{
      RowBox[{"#", "=!=", 
       RowBox[{"{", "}"}]}], "&"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.932178093219666*^9, {3.932220707851465*^9, 3.932220747249592*^9}, {
   3.950800893485785*^9, 3.950800987632131*^9}, {3.9508016274975567`*^9, 
   3.950801660952232*^9}, {3.95086373016462*^9, 3.95086377625705*^9}, {
   3.950977908402094*^9, 3.9509779098545*^9}, {3.95097858078232*^9, 
   3.950978634866104*^9}, {3.950978675954303*^9, 3.9509786993099747`*^9}, 
   3.950978744078698*^9, {3.951022968366856*^9, 3.951023141306739*^9}, {
   3.9510232320318317`*^9, 3.951023236902824*^9}, {3.951023401747789*^9, 
   3.951023405927434*^9}, {3.951023697339532*^9, 3.9510237141319427`*^9}, {
   3.9510240171202173`*^9, 3.951024058934989*^9}},
 CellLabel->
  "In[1206]:=",ExpressionUUID->"3518af78-5ff7-49ca-9232-57a8cda2059b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetFieldPairs", "[", "setup_", "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Head", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Head", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Select", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
           "\"\<Grassmann\>\"", "]"}], ",", 
          RowBox[{
           RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
           "\"\<cField\>\"", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "#", "]"}], "===", "List"}], "&"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetSingleFields", "[", "setup_", "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Head", "[", "#", "]"}], "&"}], ",", 
      RowBox[{"Select", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
           "\"\<Grassmann\>\"", "]"}], ",", 
          RowBox[{
           RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
           "\"\<cField\>\"", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "#", "]"}], "=!=", "List"}], "&"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetAllFields", "[", "setup_", "]"}], ":=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Flatten", "@", 
       RowBox[{"GetFieldPairs", "[", "setup", "]"}]}], ",", 
      RowBox[{"GetSingleFields", "[", "setup", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HasPartnerField", "[", 
    RowBox[{"setup_", ",", "field_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Flatten", "@", 
      RowBox[{"GetFieldPairs", "[", "setup", "]"}]}], ",", 
     "\[IndentingNewLine]", "field"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HasPartnerField", "[", 
     RowBox[{"setup_", ",", 
      RowBox[{"field_", "[", "__", "]"}]}], "]"}], ":=", 
    RowBox[{"HasPartnerField", "[", 
     RowBox[{"setup", ",", "field"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IsGrassmann", "[", 
    RowBox[{"setup_", ",", "field_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"GetGrassmanns", "[", "setup", "]"}], ",", "field", ",", 
     "Infinity"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsGrassmann", "[", 
     RowBox[{"setup_", ",", 
      RowBox[{"field_", "[", "__", "]"}]}], "]"}], ":=", 
    RowBox[{"IsGrassmann", "[", 
     RowBox[{"setup", ",", "field"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IsAntiGrassmann", "[", 
    RowBox[{"setup_", ",", "field_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"GetAntiGrassmanns", "[", "setup", "]"}], ",", "field", ",", 
     "Infinity"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsAntiGrassmann", "[", 
     RowBox[{"setup_", ",", 
      RowBox[{"field_", "[", "__", "]"}]}], "]"}], ":=", 
    RowBox[{"IsAntiGrassmann", "[", 
     RowBox[{"setup", ",", "field"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IscField", "[", 
    RowBox[{"setup_", ",", "field_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"GetcFields", "[", "setup", "]"}], ",", "field", ",", 
     "Infinity"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IscField", "[", 
     RowBox[{"setup_", ",", 
      RowBox[{"field_", "[", "__", "]"}]}], "]"}], ":=", 
    RowBox[{"IscField", "[", 
     RowBox[{"setup", ",", "field"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IsAnticField", "[", 
    RowBox[{"setup_", ",", "field_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"GetAnticFields", "[", "setup", "]"}], ",", "field", ",", 
     "Infinity"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IsAnticField", "[", 
    RowBox[{"setup_", ",", 
     RowBox[{"field_", "[", "__", "]"}]}], "]"}], ":=", 
   RowBox[{"IsAnticField", "[", 
    RowBox[{"setup", ",", "field"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951023163939932*^9, 3.951023253706765*^9}, {
  3.9510232893183107`*^9, 3.9510233580953617`*^9}, {3.951023414375457*^9, 
  3.951023635439684*^9}, {3.951023724604463*^9, 3.951023800417603*^9}, {
  3.951024061485753*^9, 3.9510240986479816`*^9}},
 CellLabel->
  "In[1150]:=",ExpressionUUID->"51b5119b-7ed2-4d4e-8157-9da88d9e51a3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetPartnerField", "[", 
    RowBox[{"setup_", ",", "field_Symbol"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pairs", ",", "sel"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "@", 
         RowBox[{"HasPartnerField", "[", 
          RowBox[{"setup", ",", "field"}], "]"}]}], ",", 
        RowBox[{"Return", "[", "field", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pairs", "=", 
       RowBox[{"GetFieldPairs", "[", "setup", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"sel", "=", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"pairs", ",", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"#", ",", "field", ",", "Infinity"}], "]"}], "&"}]}], 
         "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sel", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"sel", ",", "field"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "sel", "]"}], ">", "0"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"sel", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<field \>\"", ",", "field", ",", "\"\< not found!\>\""}], 
       "]"}], ";", 
      RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetPartnerField", "[", 
   RowBox[{"setup_", ",", 
    RowBox[{"field_Symbol", "[", "i__", "]"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"GetPartnerField", "[", 
    RowBox[{"setup", ",", "field"}], "]"}], "[", "i", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.932310703182301*^9, {3.9508008732217073`*^9, 3.950800905255765*^9}, 
   3.950874299413641*^9, {3.951023598531598*^9, 3.951023612563867*^9}, {
   3.951023642999547*^9, 3.9510236672477427`*^9}, {3.951023815416168*^9, 
   3.951023941927535*^9}},
 CellLabel->
  "In[1163]:=",ExpressionUUID->"f9e7b8dd-479d-4f1c-b30c-43e82a8f1466"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Checking field content of expressions", "Subsubsection",
 CellChangeTimes->{{3.9510239782885523`*^9, 
  3.951023985187344*^9}},ExpressionUUID->"d2a5f7e9-fbf3-48fd-896b-\
3c3a13529cd2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExtractFields", "[", 
    RowBox[{"setup_Association", ",", "expr_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "symbols", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"symbols", "=", 
       RowBox[{"GetAllSymbols", "[", "expr", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "@", 
       RowBox[{"Select", "[", 
        RowBox[{"symbols", ",", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"GetAllFields", "[", "setup", "]"}], ",", "#"}], "]"}], 
          "&"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtractFieldsWithIndex", "[", 
    RowBox[{"setup_Association", ",", "expr_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fields", ",", "extracted"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fields", "=", 
       RowBox[{"ExtractFields", "[", 
        RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"extracted", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"expr", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"a_", "[", "b_", "]"}], "/;", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"fields", ",", "a"}], "]"}]}], ":>", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"extracted", ",", 
             RowBox[{"a", "[", "b", "]"}]}], "]"}], ";", "1"}], ")"}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "extracted", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.951024006516164*^9, 3.951024008440085*^9}, {
  3.951024116163844*^9, 3.951024187756226*^9}, {3.951024231427863*^9, 
  3.951024239820277*^9}, {3.951024468384468*^9, 3.951024487333744*^9}},
 CellLabel->
  "In[1165]:=",ExpressionUUID->"84ac980c-3e5a-487b-a821-389318a8bd26"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ContainsGrassmann", "[", 
   RowBox[{"setup_Association", ",", "expr_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "fields", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fields", "=", 
      RowBox[{"ExtractFields", "[", 
       RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "\[IndentingNewLine]", 
      RowBox[{"AnyTrue", "[", 
       RowBox[{"fields", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"IsGrassmann", "[", 
           RowBox[{"setup", ",", "#"}], "]"}], "||", 
          RowBox[{"IsAntiGrassmann", "[", 
           RowBox[{"setup", ",", "#"}], "]"}]}], "&"}]}], "]"}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GrassmannCount", "[", 
   RowBox[{"setup_Association", ",", "expr_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "fields", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fields", "=", 
      RowBox[{"ExtractFieldsWithIndex", "[", 
       RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"Length", "@", "\[IndentingNewLine]", 
       RowBox[{"Select", "[", 
        RowBox[{"fields", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"IsGrassmann", "[", 
            RowBox[{"setup", ",", 
             RowBox[{"Head", "[", "#", "]"}]}], "]"}], "||", 
           RowBox[{"IsAntiGrassmann", "[", 
            RowBox[{"setup", ",", 
             RowBox[{"Head", "[", "#", "]"}]}], "]"}]}], "&"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950801014829342*^9, 3.950801089487433*^9}, {
   3.9508016734862947`*^9, 3.950801789647143*^9}, {3.950802396390094*^9, 
   3.95080251586098*^9}, {3.9508025705613623`*^9, 3.9508025986163673`*^9}, {
   3.950802685581463*^9, 3.950802850019553*^9}, {3.95080288950806*^9, 
   3.950802891116541*^9}, 3.950977841322421*^9, 3.9510239548515882`*^9, {
   3.951047050359741*^9, 3.951047092694622*^9}},
 CellLabel->
  "In[1167]:=",ExpressionUUID->"e0675219-06d7-4260-b88e-aecc77330bb2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Indices", "Subsubsection",
 CellChangeTimes->{{3.950801271735565*^9, 3.95080128037481*^9}, {
  3.950854198551154*^9, 
  3.950854199116568*^9}},ExpressionUUID->"4d34a9f6-835b-4d0e-bded-\
e4ef20d68c82"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$indexedObjects", "=", 
   RowBox[{"{", 
    RowBox[{"ABasis", ",", "VBasis", ",", "GammaN", ",", "Propagator"}], 
    "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9510495294953012`*^9, 3.951049535619205*^9}},
 CellLabel->
  "In[1253]:=",ExpressionUUID->"0ee308e1-0add-4c99-8e44-6281687c59ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Get", " ", "a", " ", "list", " ", "of", " ", "all", " ", "unique", " ", 
     "super"}], "-", 
    RowBox[{
    "indices", " ", "within", " ", "the", " ", "expression", " ", "expr"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GetAllSuperIndices", "[", 
     RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fields", ",", "indices"}], "}"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"fields", "=", 
        RowBox[{"ExtractFieldsWithIndex", "[", 
         RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"indices", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fields", "//.", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"p_", "[", 
            RowBox[{"Times", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "a_"}], "]"}], "]"}], "/;", 
           RowBox[{"exclusions", "[", "p", "]"}]}], ":>", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"indices", ",", "a"}], "]"}], ";", "1"}], ")"}]}]}], "//.",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"p_", "[", "a_", "]"}], "/;", 
          RowBox[{"exclusions", "[", "p", "]"}]}], ":>", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"indices", ",", "a"}], "]"}], ";", "1"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"expr", "//.", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"extObj", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{
               RowBox[{"{", "f__", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 TagBox[
                  StyleBox[
                   RowBox[{"Times", "[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "a_Symbol"}], "]"}],
                   ShowSpecialCharacters->False,
                   ShowStringCharacters->True,
                   NumberMarks->True],
                  FullForm], ",", "b___"}], "}"}]}], "]"}], ":>", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"indices", ",", "a"}], "]"}], ";", 
               RowBox[{
                RowBox[{"extObj", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{
                 RowBox[{"{", "f", "}"}], ",", 
                 RowBox[{"{", "b", "}"}]}], "]"}]}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"extObj", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{
               RowBox[{"{", "f__", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 TagBox[
                  StyleBox["a_Symbol",
                   ShowSpecialCharacters->False,
                   ShowStringCharacters->True,
                   NumberMarks->True],
                  FullForm], ",", "b___"}], "}"}]}], "]"}], ":>", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"indices", ",", "a"}], "]"}], ";", 
               RowBox[{
                RowBox[{"extObj", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{
                 RowBox[{"{", "f", "}"}], ",", 
                 RowBox[{"{", "b", "}"}]}], "]"}]}], ")"}]}]}], 
           "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "$indexedObjects", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"expr", "//.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Delta]", "[", 
            RowBox[{
             TagBox[
              StyleBox[
               RowBox[{"Times", "[", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "a_Symbol"}], "]"}],
               ShowSpecialCharacters->False,
               ShowStringCharacters->True,
               NumberMarks->True],
              FullForm], ",", "b___"}], "]"}], ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"indices", ",", "a"}], "]"}], ";", 
             RowBox[{"\[Delta]", "[", "b", "]"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[Delta]", "[", 
            RowBox[{"a_Symbol", ",", "b___"}], "]"}], ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"indices", ",", "a"}], "]"}], ";", 
             RowBox[{"\[Delta]", "[", "b", "]"}]}], ")"}]}]}], 
         "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"expr", "//.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Gamma]", "[", 
            RowBox[{
             TagBox[
              StyleBox[
               RowBox[{"Times", "[", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "a_Symbol"}], "]"}],
               ShowSpecialCharacters->False,
               ShowStringCharacters->True,
               NumberMarks->True],
              FullForm], ",", "b___"}], "]"}], ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"indices", ",", "a"}], "]"}], ";", 
             RowBox[{"\[Gamma]", "[", "b", "]"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[Gamma]", "[", 
            RowBox[{"a_Symbol", ",", "b___"}], "]"}], ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"indices", ",", "a"}], "]"}], ";", 
             RowBox[{"\[Gamma]", "[", "b", "]"}]}], ")"}]}]}], 
         "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"indices", "//", "DeleteDuplicates"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[1259]:=",ExpressionUUID->"935d09a0-331b-40fc-a467-f0134b7e4304"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtractObjectsWithIndex", "[", 
    RowBox[{"setup_Association", ",", "expr_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"indices", ",", "flattened", ",", "objects"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"indices", "=", 
       RowBox[{"GetAllSuperIndices", "[", 
        RowBox[{"Setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FTermQ", "[", "expr", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"flattened", "=", 
          RowBox[{"Times", "@@", "expr"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"objects", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"flattened", "//.", 
          RowBox[{
           RowBox[{
            RowBox[{"a_Symbol", "[", "b__", "]"}], "/;", 
            RowBox[{
             RowBox[{"ContainsAny", "[", 
              RowBox[{
               RowBox[{"{", "b", "}"}], ",", 
               RowBox[{"indices", "\[Union]", 
                RowBox[{"(", 
                 RowBox[{"-", "indices"}], ")"}]}]}], "]"}], "&&", 
             RowBox[{"exclusions", "[", "a", "]"}]}]}], ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"objects", ",", 
               RowBox[{"a", "[", "b", "]"}]}], "]"}], ";", "1"}], ")"}]}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "objects", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FEqQ", "[", "expr", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"flattened", "=", 
          RowBox[{"Times", "@@", 
           RowBox[{"(", 
            RowBox[{"Join", "@@", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"List", "@@", "#"}], "&"}], ",", "expr"}], "]"}]}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"objects", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"flattened", "//.", 
          RowBox[{
           RowBox[{
            RowBox[{"a_Symbol", "[", "b__", "]"}], "/;", 
            RowBox[{
             RowBox[{"ContainsAny", "[", 
              RowBox[{
               RowBox[{"{", "b", "}"}], ",", 
               RowBox[{"indices", "\[Union]", 
                RowBox[{"(", 
                 RowBox[{"-", "indices"}], ")"}]}]}], "]"}], "&&", 
             RowBox[{"exclusions", "[", "a", "]"}]}]}], ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"objects", ",", 
               RowBox[{"a", "[", "b", "]"}]}], "]"}], ";", "1"}], ")"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"flattened", "//.", 
          RowBox[{
           RowBox[{
            RowBox[{"a_Symbol", "[", 
             RowBox[{
              RowBox[{"{", "f__", "}"}], ",", 
              RowBox[{"{", "i__", "}"}]}], "]"}], "/;", 
            RowBox[{
             RowBox[{"ContainsAny", "[", 
              RowBox[{
               RowBox[{"{", "i", "}"}], ",", 
               RowBox[{"indices", "\[Union]", 
                RowBox[{"(", 
                 RowBox[{"-", "indices"}], ")"}]}]}], "]"}], "&&", 
             RowBox[{"exclusions", "[", "a", "]"}]}]}], ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"objects", ",", 
               RowBox[{"a", "[", 
                RowBox[{
                 RowBox[{"{", "f", "}"}], ",", 
                 RowBox[{"{", "i", "}"}]}], "]"}]}], "]"}], ";", "1"}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "objects", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Expression \\\"\>\"", ",", "expr", ",", 
        "\"\<\\\" is neither an FTerm nor an FEq!\>\""}], "]"}], ";", 
      RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950854493144973*^9, 3.950854569452779*^9}, {
   3.950854604452739*^9, 3.950854680324503*^9}, {3.950854996656869*^9, 
   3.9508550481848717`*^9}, {3.950859645548572*^9, 3.950859785007856*^9}, {
   3.950860303344551*^9, 3.9508603107335377`*^9}, {3.950861168268649*^9, 
   3.950861274048501*^9}, {3.950861304120777*^9, 3.9508613153605413`*^9}, {
   3.950861367012312*^9, 3.9508614126049147`*^9}, {3.950861453960935*^9, 
   3.9508615591409407`*^9}, {3.950861602551324*^9, 3.9508616765664988`*^9}, {
   3.950873227322419*^9, 3.950873227634747*^9}, {3.9508733445328627`*^9, 
   3.9508733890321093`*^9}, {3.9508734300279284`*^9, 
   3.9508735030787888`*^9}, {3.950873533774803*^9, 3.950873574626863*^9}, {
   3.950873628353125*^9, 3.950873634368539*^9}, {3.9508736653917418`*^9, 
   3.950873725638062*^9}, {3.950977542870824*^9, 3.950977615051394*^9}, 
   3.950977666576852*^9, {3.950977824426978*^9, 3.950977824803349*^9}, {
   3.951048475057866*^9, 3.9510485002012367`*^9}, {3.951048586276622*^9, 
   3.951048595044265*^9}, {3.95104863795863*^9, 3.951048654139003*^9}, {
   3.951048871382616*^9, 3.951049094164*^9}, {3.951049522508106*^9, 
   3.951049543225523*^9}, {3.95104967655072*^9, 3.9510497051863403`*^9}},
 CellLabel->
  "In[1260]:=",ExpressionUUID->"f8e80e20-24a8-4ec6-ba4f-132db5be82fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Get", " ", "a", " ", "list", " ", "of", " ", "all", " ", "open", " ", 
     "super"}], "-", 
    RowBox[{
    "indices", " ", "within", " ", "the", " ", "expression", " ", "expr"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GetOpenSuperIndices", "[", 
      RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"objects", ",", "indices", ",", "count", ",", "pick"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"objects", "=", 
         RowBox[{"ExtractObjectsWithIndex", "[", 
          RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"GetAllSuperIndices", "[", 
          RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"count", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Count", "[", 
             RowBox[{"objects", ",", "#", ",", "Infinity"}], "]"}], "&"}], 
           ",", "indices"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pick", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", " ", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"count", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "2"}], "]"}], "==", 
              "0"}], ",", "False", ",", "True"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "indices", "]"}]}], "}"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"AnyTrue", "[", 
           RowBox[{"count", ",", 
            RowBox[{
             RowBox[{"#", ">", "2"}], "&"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<There are indices with count > 2. This is not allowed for \
valid terms/equations!\>\"", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"Pick", "[", 
          RowBox[{"indices", ",", "pick"}], "]"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Get", " ", "a", " ", "list", " ", "of", " ", "all", " ", "closed", " ", 
      "super"}], "-", 
     RowBox[{
     "indices", " ", "within", " ", "the", " ", "expression", " ", "expr"}]}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GetClosedSuperIndices", "[", 
      RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"objects", ",", "indices", ",", "count", ",", "pick"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"objects", "=", 
         RowBox[{"ExtractObjectsWithIndex", "[", 
          RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"GetAllSuperIndices", "[", 
          RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"count", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Count", "[", 
             RowBox[{"objects", ",", "#", ",", "Infinity"}], "]"}], "&"}], 
           ",", "indices"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"AnyTrue", "[", 
           RowBox[{"count", ",", 
            RowBox[{
             RowBox[{"#", ">", "2"}], "&"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            
            "\"\<There are indices with count > 2. This is not allowed for \
valid terms/equations!\>\"", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"pick", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", " ", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"count", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "2"}], "]"}], "!=", 
              "0"}], ",", "False", ",", "True"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "indices", "]"}]}], "}"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"Pick", "[", 
          RowBox[{"indices", ",", "pick"}], "]"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Get", " ", "a", " ", "list", " ", "of", " ", "all", " ", "open", " ", 
      "super"}], "-", 
     RowBox[{
     "indices", " ", "within", " ", "the", " ", "expression", " ", "expr"}]}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SuperIndicesValid", "[", 
      RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"objects", ",", "indices", ",", "count"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"objects", "=", 
         RowBox[{"ExtractObjectsWithIndex", "[", 
          RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"GetAllSuperIndices", "[", 
          RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"count", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Count", "[", 
             RowBox[{"objects", ",", "#", ",", "Infinity"}], "]"}], "&"}], 
           ",", "indices"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"AnyTrue", "[", 
           RowBox[{"count", ",", 
            RowBox[{
             RowBox[{"#", ">", "2"}], "&"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<There are indices with count > 2. This is not allowed for \
valid terms/equations!\>\"", "]"}], ";", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9508542004410467`*^9, 3.9508544749252157`*^9}, {
   3.950861781076435*^9, 3.950861866017157*^9}, {3.950861904572686*^9, 
   3.950862122741899*^9}, 3.950862250128793*^9, {3.9508623533294363`*^9, 
   3.950862473344803*^9}, {3.950862503549046*^9, 3.950862504168859*^9}, {
   3.950862808761071*^9, 3.95086284882382*^9}, {3.9508724621909122`*^9, 
   3.9508725163422728`*^9}, {3.950872679755715*^9, 3.950872742486643*^9}, {
   3.950873274979582*^9, 3.9508733202595463`*^9}, {3.9508736487671967`*^9, 
   3.950873654067449*^9}, {3.9510491583749323`*^9, 3.951049163421998*^9}, {
   3.951049235218823*^9, 3.951049243994762*^9}, {3.951049428748899*^9, 
   3.951049437502572*^9}, {3.951049503039259*^9, 3.951049505389997*^9}, 
   3.9510495609135113`*^9, {3.9510495984105787`*^9, 3.9510496300825567`*^9}, {
   3.9510497431225443`*^9, 3.951049751762602*^9}, 3.951049797343923*^9},
 CellLabel->
  "In[1284]:=",ExpressionUUID->"9f3b0ea7-2af5-48b1-84b3-46146be887b3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Check", " ", "whether", " ", "all", " ", "indices", " ", "are", " ", 
     "closed", " ", "within", " ", 
     RowBox[{"expr", ".", " ", "\[IndentingNewLine]", "This"}], " ", 
     "disallows", " ", "also", " ", "multiple", " ", "use", " ", "of", " ", 
     "a", " ", "single", " ", "index", " ", "name"}], ",", " ", 
    RowBox[{"!", 
     RowBox[{"anywhere", "!"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"AllIndicesClosed", "[", 
     RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"objects", ",", "indices", ",", "count", ",", "valid"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"objects", "=", 
        RowBox[{"ExtractObjectsWithIndex", "[", 
         RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"indices", "=", 
        RowBox[{"GetAllSuperIndices", "[", 
         RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"count", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{"objects", ",", "#", ",", "Infinity"}], "]"}], "&"}], ",",
           "indices"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"valid", "=", 
        RowBox[{"AllTrue", "[", 
         RowBox[{"count", ",", 
          RowBox[{
           RowBox[{"#", "==", "2"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "valid", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.950862410027896*^9, {3.9508628529163237`*^9, 3.9508628920401497`*^9}, 
   3.9510491668196583`*^9},
 CellLabel->
  "In[1287]:=",ExpressionUUID->"3edfcfc0-c624-46bc-ab09-a08de412f0d7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ordering", "Subsection",
 CellChangeTimes->{{3.932178009618313*^9, 3.932178022055203*^9}, {
  3.950801118933737*^9, 3.950801154023693*^9}, {3.9509401502822638`*^9, 
  3.950940151040942*^9}},ExpressionUUID->"1785af53-7c89-486a-9e5f-\
2cc90ee5d4f8"],

Cell[CellGroupData[{

Cell["Setting the canonical ordering", "Subsubsection",
 CellChangeTimes->{{3.950940652516369*^9, 
  3.950940658984301*^9}},ExpressionUUID->"6b5ad42c-f028-4331-8dd5-\
edca6279d9c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$CanonicalOrdering", "=", "\"\<f>af>b\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$AvailableCanonicalOrderings", "=", 
    RowBox[{"{", 
     RowBox[{
     "\"\<f>af>b\>\"", ",", "\"\<af>f>b\>\"", ",", "\"\<b>f>af\>\"", ",", 
      "\"\<b>af>f\>\""}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CanonicalOrdering", "::", "unknownInteger"}], "=", 
   "\"\<The integer `1` should be between 1 and 4.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CanonicalOrdering", "::", "unknownString"}], "=", 
    RowBox[{"\"\<The expression `1` should be one of \>\"", "<>", 
     RowBox[{"ToString", "[", "$AvailableCanonicalOrderings", "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetCanonicalOrdering", "[", "a_Integer", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Switch", "[", 
        RowBox[{"a", ",", "\[IndentingNewLine]", "1", ",", 
         RowBox[{"$CanonicalOrdering", "=", "\"\<f>af>b\>\""}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "2", ",", 
         RowBox[{"$CanonicalOrdering", "=", "\"\<af>f>b\>\""}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "3", ",", 
         RowBox[{"$CanonicalOrdering", "=", "\"\<b>f>af\>\""}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "4", ",", 
         RowBox[{"$CanonicalOrdering", "=", "\"\<b>af>f\>\""}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "_", ",", 
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"CanonicalOrdering", "::", "unknownInteger"}], ",", "a"}], 
          "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Canonical ordering set to \>\"", ",", "$CanonicalOrdering"}], 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetCanonicalOrdering", "[", "a_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Switch", "[", 
       RowBox[{"a", ",", "\[IndentingNewLine]", "\"\<f>af>b\>\"", ",", 
        RowBox[{"$CanonicalOrdering", "=", "\"\<f>af>b\>\""}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<af>f>b\>\"", ",", 
        RowBox[{"$CanonicalOrdering", "=", "\"\<af>f>b\>\""}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<b>f>af\>\"", ",", 
        RowBox[{"$CanonicalOrdering", "=", "\"\<b>f>af\>\""}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<b>af>f\>\"", ",", 
        RowBox[{"$CanonicalOrdering", "=", "\"\<b>af>f\>\""}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "_", ",", 
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"CanonicalOrdering", "::", "unknownString"}], ",", "a"}], 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Canonical ordering set to \>\"", ",", "$CanonicalOrdering"}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950940153137643*^9, 3.950940313248869*^9}, {
  3.950940364396865*^9, 3.950940626082654*^9}, {3.950947877407638*^9, 
  3.9509478851616173`*^9}, {3.950947925430534*^9, 3.950947963989278*^9}},
 CellLabel->
  "In[240]:=",ExpressionUUID->"8223ffc8-f59e-4c33-b04f-02db6763d2e2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Ordering expressions", "Subsubsection",
 CellChangeTimes->{{3.950940652516369*^9, 
  3.950940676916478*^9}},ExpressionUUID->"25f821ed-484b-44c3-bb3d-\
2285af151ba5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Returns", " ", "true", " ", "if", " ", "f1"}], " ", "<", " ", 
     "f2"}], ",", " ", 
    RowBox[{
     RowBox[{"and", " ", "false", " ", "if", " ", "f1"}], " ", ">", " ", 
     "f2"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FieldOrderLess", "[", 
     RowBox[{"setup_", ",", "f1_Symbol", ",", "f2_Symbol"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "kind1", ",", "kind2", ",", "\[IndentingNewLine]", "idxHigh", ",", 
        "idxMid", ",", "idxLow", ",", "\[IndentingNewLine]", "lessLow", ",", 
        "lessMid", ",", "lessHigh"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kind1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IsFermion", "[", 
             RowBox[{"setup", ",", "#"}], "]"}], ",", 
            RowBox[{"IsAntiFermion", "[", 
             RowBox[{"setup", ",", "#"}], "]"}], ",", 
            RowBox[{"IsBoson", "[", 
             RowBox[{"setup", ",", "#"}], "]"}]}], "}"}], "&"}], "[", "f1", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"kind2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IsFermion", "[", 
             RowBox[{"setup", ",", "#"}], "]"}], ",", 
            RowBox[{"IsAntiFermion", "[", 
             RowBox[{"setup", ",", "#"}], "]"}], ",", 
            RowBox[{"IsBoson", "[", 
             RowBox[{"setup", ",", "#"}], "]"}]}], "}"}], "&"}], "[", "f2", 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "$CanonicalOrdering", ",", "\[IndentingNewLine]", "\"\<f>af>b\>\"", 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"idxHigh", "=", "1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"idxMid", "=", "2"}], ";", "\[IndentingNewLine]", 
          RowBox[{"idxLow", "=", "3"}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<af>f>b\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"idxHigh", "=", "2"}], ";", "\[IndentingNewLine]", 
          RowBox[{"idxMid", "=", "1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"idxLow", "=", "3"}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<b>f>af\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"idxHigh", "=", "3"}], ";", "\[IndentingNewLine]", 
          RowBox[{"idxMid", "=", "1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"idxLow", "=", "2"}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<b>af>f\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"idxHigh", "=", "3"}], ";", "\[IndentingNewLine]", 
          RowBox[{"idxMid", "=", "2"}], ";", "\[IndentingNewLine]", 
          RowBox[{"idxLow", "=", "1"}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Order failure: order \\\"\>\"", "<>", "$CanonicalOrdering", 
            "<>", "\"\<\\\" unknown.\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"lessLow", "=", 
        RowBox[{
         RowBox[{"kind1", "[", 
          RowBox[{"[", "idxLow", "]"}], "]"}], "&&", 
         RowBox[{"Not", "[", 
          RowBox[{"kind2", "[", 
           RowBox[{"[", "idxLow", "]"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"lessMid", "=", 
        RowBox[{
         RowBox[{"kind1", "[", 
          RowBox[{"[", "idxMid", "]"}], "]"}], "&&", 
         RowBox[{"kind2", "[", 
          RowBox[{"[", "idxHigh", "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"lessHigh", "=", "False"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"lessLow", "||", "lessMid", "||", "lessHigh"}], ",", 
         RowBox[{"Return", "[", "True", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "False", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9509469386341343`*^9, 3.9509471834252987`*^9}, {
   3.950947223313903*^9, 3.950947224742805*^9}, {3.950947263353957*^9, 
   3.950947275621757*^9}, {3.950947319094739*^9, 3.9509474205587378`*^9}, 
   3.95094746109451*^9, {3.950947500069725*^9, 3.950947678289824*^9}, {
   3.950947722074582*^9, 3.950947766347187*^9}, {3.950947800639678*^9, 
   3.9509478705099792`*^9}, {3.9509479131384983`*^9, 3.950947918497128*^9}, {
   3.950947973835105*^9, 3.950948031631962*^9}, 3.950948064688114*^9},
 CellLabel->
  "In[246]:=",ExpressionUUID->"4b678c74-7d06-4764-a1d3-b462e6b01ccf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Returns", " ", "the", " ", "sign", " ", "that", " ", "results", " ", 
    "from", " ", "exchanging", " ", "the", " ", "two", " ", "fields", " ", 
    "f1", " ", "and", " ", "f2"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CommuteSign", "[", 
     RowBox[{"setup_", ",", "f1_", ",", "f2_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"kind1", ",", "kind2"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kind1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IsGrassmann", "[", 
             RowBox[{"setup", ",", "#"}], "]"}], ",", 
            RowBox[{"IsBoson", "[", 
             RowBox[{"setup", ",", "#"}], "]"}]}], "}"}], "&"}], "[", "f1", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"kind2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IsGrassmann", "[", 
             RowBox[{"setup", ",", "#"}], "]"}], ",", 
            RowBox[{"IsBoson", "[", 
             RowBox[{"setup", ",", "#"}], "]"}]}], "}"}], "&"}], "[", "f2", 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"kind1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "&&", 
           RowBox[{"kind2", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9509491238971243`*^9, 3.950949126229731*^9}, {
  3.950949179705824*^9, 3.950949242101665*^9}, {3.9509494626505527`*^9, 
  3.950949470925414*^9}, {3.950951603853833*^9, 3.9509516215042048`*^9}},
 CellLabel->
  "In[247]:=",ExpressionUUID->"18065f13-e208-4ab7-83f1-35e867d53bcb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Find", " ", "all", " ", "instances", " ", "of", " ", "$OrderedObjects", 
    " ", "and", " ", "order", " ", "their", " ", "field", " ", "value", " ", 
    "according", " ", "to", " ", "the", " ", "canonical", " ", "scheme"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"$OrderedObjects", "=", 
     RowBox[{"{", 
      RowBox[{"Propagator", ",", "GammaN"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OrderObject", "[", 
      RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", "expr"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OrderObject", "[", 
      RowBox[{"setup_", ",", 
       RowBox[{
        RowBox[{"obj_", "[", 
         RowBox[{"fields_List", ",", "indices_List"}], "]"}], "/;", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"$OrderedObjects", ",", "obj"}], "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "i", ",", "j", ",", "curi", ",", "prefactor", ",", "pref", ",", 
         "reverse", ",", "\[IndentingNewLine]", 
         RowBox[{"nfields", "=", "fields"}], ",", 
         RowBox[{"nindices", "=", "indices"}], ",", "\[IndentingNewLine]", 
         "trackedField"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "The", " ", "propagator", " ", "gets", " ", "a", " ", "reverse", " ", 
         "ordering"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"reverse", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"obj", "===", "Propagator"}], ",", "True", ",", "False"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pref", "=", 
         RowBox[{"If", "[", 
          RowBox[{"reverse", ",", "Identity", ",", "Not"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"prefactor", "=", "1"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Always", " ", "compare", " ", "the", " ", "ith", " ", "field", " ",
            "with", " ", "all", " ", "previous", " ", "fields", " ", "and", 
           " ", "put", " ", "it", " ", "in", " ", "the", " ", "right", " ", 
           RowBox[{"place", ".", "\[IndentingNewLine]", "Iterate"}], " ", 
           "until", " ", "one", " ", "reaches", " ", "the", " ", "end", " ", 
           "of", " ", "the", " ", "array"}], ",", " ", 
          RowBox[{"then", " ", "it", " ", "is", " ", 
           RowBox[{"sorted", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "<=", 
           RowBox[{"Length", "[", "nfields", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"curi", "=", "i"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "Check", " ", "if", " ", "we", " ", "should", " ", "switch", " ",
               "curi", " ", "and", " ", "curi"}], "-", "1"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"curi", ">=", "2"}], "&&", 
              RowBox[{"pref", "@", 
               RowBox[{"FieldOrderLess", "[", 
                RowBox[{"setup", ",", 
                 RowBox[{"nfields", "[", 
                  RowBox[{"[", "curi", "]"}], "]"}], ",", 
                 RowBox[{"nfields", "[", 
                  RowBox[{"[", 
                   RowBox[{"curi", "-", "1"}], "]"}], "]"}]}], "]"}]}]}], ",",
              "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"nfields", "[", 
                RowBox[{"[", 
                 RowBox[{"{", 
                  RowBox[{"curi", ",", 
                   RowBox[{"curi", "-", "1"}]}], "}"}], "]"}], "]"}], "=", 
               RowBox[{"nfields", "[", 
                RowBox[{"[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"curi", "-", "1"}], ",", "curi"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"nindices", "[", 
                RowBox[{"[", 
                 RowBox[{"{", 
                  RowBox[{"curi", ",", 
                   RowBox[{"curi", "-", "1"}]}], "}"}], "]"}], "]"}], "=", 
               RowBox[{"nindices", "[", 
                RowBox[{"[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"curi", "-", "1"}], ",", "curi"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"prefactor", "*=", 
               RowBox[{"CommuteSign", "[", 
                RowBox[{"setup", ",", 
                 RowBox[{"nfields", "[", 
                  RowBox[{"[", "curi", "]"}], "]"}], ",", 
                 RowBox[{"nfields", "[", 
                  RowBox[{"[", 
                   RowBox[{"curi", "-", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"curi", "--"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"prefactor", "*", 
          RowBox[{"obj", "[", 
           RowBox[{"nfields", ",", "nindices"}], "]"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OrderFields", "[", 
      RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"OrderObject", "[", 
         RowBox[{"setup", ",", "#"}], "]"}], "&"}], ",", "expr", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQvTJTxPFS/lvHJ89fOYPo+Ae6XiC60SDGB0RXhE4O
AtHP4t4Hg+hQ43K3q0CaT7kGTH8UuO0NoiflTPUB0wuY74Hor7sbGa8B6SVF
TzlB9K5V/twguuZksgmIZtueA6aNvndbgGhX905LEM1Xpu0Iop/0azmB6O+C
qW4g+uO1db4g2mZ5RCiIni4dkAyi13jcKATRSb1cJSC64Y9iBYjmdHKvAdEV
OSENIHqayuZ2EF3F+6AHRB/Z3LkURO/QW7kFRCt9KDkMouUzdjBdB9J2Sups
IHrX6e8xIPp1r2kciN6X8C8RRDfN+dQGopfMaJwEom2qv00Bq9eSnAWiDcIE
F4Foq9ZykydA+sCBdjANANcBx3U=
  "],
 CellLabel->
  "In[256]:=",ExpressionUUID->"4a073111-7191-4734-b32b-1a96840d6461"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["QMeS Compatibility", "Subsection",
 CellChangeTimes->{{3.950951779978003*^9, 
  3.9509517862440367`*^9}},ExpressionUUID->"94391a5f-eb5e-4478-a534-\
7016e4a3f9d1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Compatibility", ":", " ", 
    RowBox[{
    "Output", " ", "any", " ", "expression", " ", "in", " ", "a", " ", "Form",
      " ", "which", " ", "looks", " ", "like", " ", "QMeS", " ", "output"}]}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"QMeSNaming", "[", 
      RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", "expr"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"QMeSNaming", "[", 
      RowBox[{"setup_", ",", 
       RowBox[{
        RowBox[{"obj_", "[", 
         RowBox[{"fields_List", ",", "indices_List"}], "]"}], "/;", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"$OrderedObjects", ",", "obj"}], "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "oldCanonicalOrdering", ",", "transf", ",", "prefactor", ",", 
         "\[IndentingNewLine]", "mobj", ",", "mfields", ",", "mindices", ",", 
         "\[IndentingNewLine]", "prefix", ",", "fieldPart", ",", 
         "indexPart"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"QMeS", " ", "follows", " ", "b"}], ">", "af", ">", "f"}], 
         ",", " ", 
         RowBox[{"so", " ", "we", " ", "switch", " ", 
          RowBox[{"temporarily", "!"}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", "$CanonicalOrdering", "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"$CanonicalOrdering", "=", "\"\<b>af>f\>\""}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"transf", "=", 
            RowBox[{"OrderObject", "[", 
             RowBox[{"setup", ",", 
              RowBox[{"obj", "[", 
               RowBox[{"fields", ",", "indices"}], "]"}]}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"prefactor", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"transf", ",", 
            RowBox[{"Times", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "a_"}], "]"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"prefactor", "=", 
            RowBox[{"-", "1"}]}], ";", 
           RowBox[{"transf", "=", 
            RowBox[{"-", "transf"}]}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mobj", "=", 
         RowBox[{"Head", "[", "transf", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mfields", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"List", "@@", "transf"}], ")"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mindices", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"List", "@@", "transf"}], ")"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"prefix", "=", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "obj", ",", "\[IndentingNewLine]", "Propagator", ",", "\"\<G\>\"", 
           ",", "\[IndentingNewLine]", "GammaN", ",", 
           "\"\<\[CapitalGamma]\>\""}], "\[IndentingNewLine]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"fieldPart", "=", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"Map", "[", 
           RowBox[{"ToString", ",", "mfields"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"indexPart", "=", 
         RowBox[{"Flatten", "[", "mindices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"prefactor", "*", 
          RowBox[{
           RowBox[{"Symbol", "[", 
            RowBox[{"prefix", "<>", "fieldPart"}], "]"}], "[", "indexPart", 
           "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"QMeSForm", "[", 
      RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"QMeSNaming", "[", 
         RowBox[{"setup", ",", "#"}], "]"}], "&"}], ",", "expr", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"QMeSForm", "[", 
      RowBox[{"Setup", ",", "#"}], "]"}], "&"}], "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"GammaN", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"A", ",", "cb", ",", "c"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], 
       RowBox[{"A", "[", "c", "]"}], 
       RowBox[{"GammaN", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"c", ",", "cb", ",", "c", ",", "cb"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z", ",", "k"}], "}"}]}], "]"}]}], 
      "}"}], "}"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950950511202754*^9, 3.950950754493911*^9}, {
  3.9509507857536583`*^9, 3.9509511203631363`*^9}, {3.950951490001182*^9, 
  3.950951554042407*^9}, {3.950951710976829*^9, 3.950951737477071*^9}},
 CellLabel->
  "In[252]:=",ExpressionUUID->"ac314d00-9b25-4da1-be23-eabaa3a126f2"],

Cell[BoxData[
 TemplateBox[{
  "StringJoin", "string", 
   "\"String expected at position \\!\\(\\*RowBox[{\\\"1\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"StringJoin\\\", \\\"[\\\", RowBox[{\\\"GammaN\\\", \\\"[\
\\\", RowBox[{\\\"\\\\\\\"{c, cb, A}\\\\\\\"\\\", \\\",\\\", \\\"\\\\\\\"{z, \
y, x}\\\\\\\"\\\"}], \\\"]\\\"}], \\\"]\\\"}]\\).\"", 2, 255, 25, 
   24591933742665804598, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.950977401868363*^9},
 CellLabel->
  "During evaluation of \
In[252]:=",ExpressionUUID->"2310a13c-eeb4-4560-a45b-5520363374ea"],

Cell[BoxData[
 TemplateBox[{
  "StringJoin", "string", 
   "\"String expected at position \\!\\(\\*RowBox[{\\\"2\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"\\\\\\\"\[CapitalGamma]\\\\\\\"\\\", \\\"<>\\\", \
RowBox[{\\\"GammaN\\\", \\\"[\\\", RowBox[{\\\"\\\\\\\"{c, cb, \
A}\\\\\\\"\\\", \\\",\\\", \\\"\\\\\\\"{z, y, x}\\\\\\\"\\\"}], \\\"]\\\"}]}]\
\\).\"", 2, 255, 26, 24591933742665804598, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.950977401868844*^9},
 CellLabel->
  "During evaluation of \
In[252]:=",ExpressionUUID->"9a5f5e3f-c8a4-4f88-8ce8-9606991788bb"],

Cell[BoxData[
 TemplateBox[{
  "Symbol", "string", 
   "\"String expected at position \\!\\(\\*RowBox[{\\\"1\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"Symbol\\\", \\\"[\\\", RowBox[{\\\"\\\\\\\"\
\[CapitalGamma]\\\\\\\"\\\", \\\"<>\\\", RowBox[{\\\"GammaN\\\", \\\"[\\\", \
RowBox[{\\\"\\\\\\\"{c, cb, A}\\\\\\\"\\\", \\\",\\\", \\\"\\\\\\\"{z, y, \
x}\\\\\\\"\\\"}], \\\"]\\\"}]}], \\\"]\\\"}]\\).\"", 2, 255, 27, 
   24591933742665804598, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9509774018880053`*^9},
 CellLabel->
  "During evaluation of \
In[252]:=",ExpressionUUID->"a24ce705-c816-469c-9132-aadaa1580957"],

Cell[BoxData[
 TemplateBox[{
  "StringJoin", "string", 
   "\"String expected at position \\!\\(\\*RowBox[{\\\"1\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"StringJoin\\\", \\\"[\\\", RowBox[{\\\"GammaN\\\", \\\"[\
\\\", RowBox[{\\\"\\\\\\\"{cb, c, cb, c}\\\\\\\"\\\", \\\",\\\", \
\\\"\\\\\\\"{k, z, y, x}\\\\\\\"\\\"}], \\\"]\\\"}], \\\"]\\\"}]\\).\"", 2, 
   255, 28, 24591933742665804598, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.950977401890397*^9},
 CellLabel->
  "During evaluation of \
In[252]:=",ExpressionUUID->"91deaf55-1d8e-4812-a89c-b66149e2ac98"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"StringJoin\\\", \
\\\"::\\\", \\\"string\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"", 2, 255, 29, 24591933742665804598, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9509774018939466`*^9},
 CellLabel->
  "During evaluation of \
In[252]:=",ExpressionUUID->"dbb8fbfc-9e1a-4374-9989-d9df7ee10430"],

Cell[BoxData[
 TemplateBox[{
  "Symbol", "string", 
   "\"String expected at position \\!\\(\\*RowBox[{\\\"1\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"Symbol\\\", \\\"[\\\", RowBox[{\\\"\\\\\\\"\
\[CapitalGamma]\\\\\\\"\\\", \\\"<>\\\", RowBox[{\\\"GammaN\\\", \\\"[\\\", \
RowBox[{\\\"\\\\\\\"{cb, c, cb, c}\\\\\\\"\\\", \\\",\\\", \\\"\\\\\\\"{k, z, \
y, x}\\\\\\\"\\\"}], \\\"]\\\"}]}], \\\"]\\\"}]\\).\"", 2, 255, 30, 
   24591933742665804598, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.950977401896245*^9},
 CellLabel->
  "During evaluation of \
In[252]:=",ExpressionUUID->"f0db91a0-970d-4263-8742-569ecc702aa0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"A", "[", "c", "]"}], " ", 
    RowBox[{
     RowBox[{"Symbol", "[", 
      RowBox[{"\<\"\[CapitalGamma]\"\>", "<>", 
       RowBox[{"GammaN", "[", 
        RowBox[{"\<\"{cb, c, cb, c}\"\>", ",", "\<\"{k, z, y, x}\"\>"}], 
        "]"}]}], "]"}], "[", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"IsGrassmann", "[", 
         RowBox[{
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"MasterEquation\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 FractionBox["1", "2"], " ", 
                 RowBox[{"A", "[", "x", "]"}], " ", 
                 RowBox[{"A", "[", "y", "]"}], " ", 
                 RowBox[{"VBasis", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"A", ",", "A"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "x"}], ",", 
                    RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"cb", "[", "x", "]"}]}], " ", 
                  RowBox[{"VBasis", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"cb", ",", "c"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "x"}], ",", 
                    RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], ",", 
                 RowBox[{"c", "[", "y", "]"}]}], "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"FieldSpace\"\>", "\[Rule]", 
             RowBox[{"\[LeftAssociation]", 
              RowBox[{
               RowBox[{"\<\"cField\"\>", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"A", "[", 
                   RowBox[{"p", ",", 
                    RowBox[{"{", 
                    RowBox[{"v", ",", "c"}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Phi]", "[", "p", "]"}], ",", 
                    RowBox[{"\[Phi]x", "[", "p", "]"}]}], "}"}]}], "}"}]}], 
               ",", 
               RowBox[{"\<\"Grassmann\"\>", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"cb", "[", 
                    RowBox[{"p", ",", 
                    RowBox[{"{", "c", "}"}]}], "]"}], ",", 
                   RowBox[{"c", "[", 
                    RowBox[{"p", ",", 
                    RowBox[{"{", "c", "}"}]}], "]"}]}], "}"}], "}"}]}]}], 
              "\[RightAssociation]"}]}]}], "\[RightAssociation]"}], ",", 
          "c"}], "]"}], "&&", 
        RowBox[{"IsGrassmann", "[", 
         RowBox[{
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"MasterEquation\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 FractionBox["1", "2"], " ", 
                 RowBox[{"A", "[", "x", "]"}], " ", 
                 RowBox[{"A", "[", "y", "]"}], " ", 
                 RowBox[{"VBasis", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"A", ",", "A"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "x"}], ",", 
                    RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"cb", "[", "x", "]"}]}], " ", 
                  RowBox[{"VBasis", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"cb", ",", "c"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "x"}], ",", 
                    RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], ",", 
                 RowBox[{"c", "[", "y", "]"}]}], "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"FieldSpace\"\>", "\[Rule]", 
             RowBox[{"\[LeftAssociation]", 
              RowBox[{
               RowBox[{"\<\"cField\"\>", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"A", "[", 
                   RowBox[{"p", ",", 
                    RowBox[{"{", 
                    RowBox[{"v", ",", "c"}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Phi]", "[", "p", "]"}], ",", 
                    RowBox[{"\[Phi]x", "[", "p", "]"}]}], "}"}]}], "}"}]}], 
               ",", 
               RowBox[{"\<\"Grassmann\"\>", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"cb", "[", 
                    RowBox[{"p", ",", 
                    RowBox[{"{", "c", "}"}]}], "]"}], ",", 
                   RowBox[{"c", "[", 
                    RowBox[{"p", ",", 
                    RowBox[{"{", "c", "}"}]}], "]"}]}], "}"}], "}"}]}]}], 
              "\[RightAssociation]"}]}]}], "\[RightAssociation]"}], ",", 
          "c"}], "]"}]}], ",", 
       RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], " ", 
    RowBox[{
     RowBox[{"Symbol", "[", 
      RowBox[{"\<\"\[CapitalGamma]\"\>", "<>", 
       RowBox[{"GammaN", "[", 
        RowBox[{"\<\"{c, cb, A}\"\>", ",", "\<\"{z, y, x}\"\>"}], "]"}]}], 
      "]"}], "[", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"IsGrassmann", "[", 
         RowBox[{
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"MasterEquation\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 FractionBox["1", "2"], " ", 
                 RowBox[{"A", "[", "x", "]"}], " ", 
                 RowBox[{"A", "[", "y", "]"}], " ", 
                 RowBox[{"VBasis", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"A", ",", "A"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "x"}], ",", 
                    RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"cb", "[", "x", "]"}]}], " ", 
                  RowBox[{"VBasis", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"cb", ",", "c"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "x"}], ",", 
                    RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], ",", 
                 RowBox[{"c", "[", "y", "]"}]}], "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"FieldSpace\"\>", "\[Rule]", 
             RowBox[{"\[LeftAssociation]", 
              RowBox[{
               RowBox[{"\<\"cField\"\>", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"A", "[", 
                   RowBox[{"p", ",", 
                    RowBox[{"{", 
                    RowBox[{"v", ",", "c"}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Phi]", "[", "p", "]"}], ",", 
                    RowBox[{"\[Phi]x", "[", "p", "]"}]}], "}"}]}], "}"}]}], 
               ",", 
               RowBox[{"\<\"Grassmann\"\>", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"cb", "[", 
                    RowBox[{"p", ",", 
                    RowBox[{"{", "c", "}"}]}], "]"}], ",", 
                   RowBox[{"c", "[", 
                    RowBox[{"p", ",", 
                    RowBox[{"{", "c", "}"}]}], "]"}]}], "}"}], "}"}]}]}], 
              "\[RightAssociation]"}]}]}], "\[RightAssociation]"}], ",", 
          "A"}], "]"}], "&&", 
        RowBox[{"IsGrassmann", "[", 
         RowBox[{
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"MasterEquation\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 FractionBox["1", "2"], " ", 
                 RowBox[{"A", "[", "x", "]"}], " ", 
                 RowBox[{"A", "[", "y", "]"}], " ", 
                 RowBox[{"VBasis", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"A", ",", "A"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "x"}], ",", 
                    RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"cb", "[", "x", "]"}]}], " ", 
                  RowBox[{"VBasis", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"cb", ",", "c"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "x"}], ",", 
                    RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], ",", 
                 RowBox[{"c", "[", "y", "]"}]}], "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"FieldSpace\"\>", "\[Rule]", 
             RowBox[{"\[LeftAssociation]", 
              RowBox[{
               RowBox[{"\<\"cField\"\>", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"A", "[", 
                   RowBox[{"p", ",", 
                    RowBox[{"{", 
                    RowBox[{"v", ",", "c"}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Phi]", "[", "p", "]"}], ",", 
                    RowBox[{"\[Phi]x", "[", "p", "]"}]}], "}"}]}], "}"}]}], 
               ",", 
               RowBox[{"\<\"Grassmann\"\>", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"cb", "[", 
                    RowBox[{"p", ",", 
                    RowBox[{"{", "c", "}"}]}], "]"}], ",", 
                   RowBox[{"c", "[", 
                    RowBox[{"p", ",", 
                    RowBox[{"{", "c", "}"}]}], "]"}]}], "}"}], "}"}]}]}], 
              "\[RightAssociation]"}]}]}], "\[RightAssociation]"}], ",", 
          "c"}], "]"}]}], ",", 
       RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], "}"}], "}"}]], "Output",\

 CellChangeTimes->{{3.950950894630046*^9, 3.950950907901114*^9}, 
   3.950950994712831*^9, {3.950951045813529*^9, 3.9509510991424007`*^9}, {
   3.9509515182257338`*^9, 3.950951559462948*^9}, {3.950951738683292*^9, 
   3.950951765578772*^9}, 3.950977401899288*^9},
 CellLabel->
  "Out[255]=",ExpressionUUID->"bf125174-2cbb-4492-858d-812d23727d5b"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Processing", "Subsection",
 CellChangeTimes->{{3.9508617031605787`*^9, 
  3.950861711169072*^9}},ExpressionUUID->"6b372331-85d1-493a-abd0-\
807b92a55bd4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"OrderFields", "[", 
  RowBox[{"Setup", ",", 
   RowBox[{"FEq", "[", 
    RowBox[{"FTerm", "[", 
     RowBox[{"GammaN", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"A", ",", "cb", ",", "c"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "]"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.950977462769767*^9, 3.9509774803937674`*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"4ce9bf53-d697-4934-8c17-2e3e34220601"],

Cell[BoxData[
 RowBox[{"FEq", "[", 
  RowBox[{"FTerm", "[", 
   RowBox[{
    RowBox[{"GammaN", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c", ",", "cb", ",", "A"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", "y", ",", "x"}], "}"}]}], "]"}], " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"IsGrassmann", "[", 
        RowBox[{
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"\<\"MasterEquation\"\>", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                FractionBox["1", "2"], " ", 
                RowBox[{"A", "[", "x", "]"}], " ", 
                RowBox[{"A", "[", "y", "]"}], " ", 
                RowBox[{"VBasis", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"A", ",", "A"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "x"}], ",", 
                    RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"cb", "[", "x", "]"}]}], " ", 
                 RowBox[{"VBasis", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"cb", ",", "c"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "x"}], ",", 
                    RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], ",", 
                RowBox[{"c", "[", "y", "]"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"\<\"FieldSpace\"\>", "\[Rule]", 
            RowBox[{"\[LeftAssociation]", 
             RowBox[{
              RowBox[{"\<\"cField\"\>", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"A", "[", 
                  RowBox[{"p", ",", 
                   RowBox[{"{", 
                    RowBox[{"v", ",", "c"}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\[Phi]", "[", "p", "]"}], ",", 
                   RowBox[{"\[Phi]x", "[", "p", "]"}]}], "}"}]}], "}"}]}], 
              ",", 
              RowBox[{"\<\"Grassmann\"\>", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"cb", "[", 
                   RowBox[{"p", ",", 
                    RowBox[{"{", "c", "}"}]}], "]"}], ",", 
                  RowBox[{"c", "[", 
                   RowBox[{"p", ",", 
                    RowBox[{"{", "c", "}"}]}], "]"}]}], "}"}], "}"}]}]}], 
             "\[RightAssociation]"}]}]}], "\[RightAssociation]"}], ",", "A"}],
         "]"}], "&&", 
       RowBox[{"IsGrassmann", "[", 
        RowBox[{
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"\<\"MasterEquation\"\>", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                FractionBox["1", "2"], " ", 
                RowBox[{"A", "[", "x", "]"}], " ", 
                RowBox[{"A", "[", "y", "]"}], " ", 
                RowBox[{"VBasis", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"A", ",", "A"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "x"}], ",", 
                    RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"cb", "[", "x", "]"}]}], " ", 
                 RowBox[{"VBasis", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"cb", ",", "c"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "x"}], ",", 
                    RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], ",", 
                RowBox[{"c", "[", "y", "]"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"\<\"FieldSpace\"\>", "\[Rule]", 
            RowBox[{"\[LeftAssociation]", 
             RowBox[{
              RowBox[{"\<\"cField\"\>", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"A", "[", 
                  RowBox[{"p", ",", 
                   RowBox[{"{", 
                    RowBox[{"v", ",", "c"}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\[Phi]", "[", "p", "]"}], ",", 
                   RowBox[{"\[Phi]x", "[", "p", "]"}]}], "}"}]}], "}"}]}], 
              ",", 
              RowBox[{"\<\"Grassmann\"\>", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"cb", "[", 
                   RowBox[{"p", ",", 
                    RowBox[{"{", "c", "}"}]}], "]"}], ",", 
                  RowBox[{"c", "[", 
                   RowBox[{"p", ",", 
                    RowBox[{"{", "c", "}"}]}], "]"}]}], "}"}], "}"}]}]}], 
             "\[RightAssociation]"}]}]}], "\[RightAssociation]"}], ",", "c"}],
         "]"}]}], ",", 
      RowBox[{"-", "1"}], ",", "1"}], "]"}], " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"IsGrassmann", "[", 
        RowBox[{
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"\<\"MasterEquation\"\>", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                FractionBox["1", "2"], " ", 
                RowBox[{"A", "[", "x", "]"}], " ", 
                RowBox[{"A", "[", "y", "]"}], " ", 
                RowBox[{"VBasis", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"A", ",", "A"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "x"}], ",", 
                    RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"cb", "[", "x", "]"}]}], " ", 
                 RowBox[{"VBasis", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"cb", ",", "c"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "x"}], ",", 
                    RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], ",", 
                RowBox[{"c", "[", "y", "]"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"\<\"FieldSpace\"\>", "\[Rule]", 
            RowBox[{"\[LeftAssociation]", 
             RowBox[{
              RowBox[{"\<\"cField\"\>", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"A", "[", 
                  RowBox[{"p", ",", 
                   RowBox[{"{", 
                    RowBox[{"v", ",", "c"}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\[Phi]", "[", "p", "]"}], ",", 
                   RowBox[{"\[Phi]x", "[", "p", "]"}]}], "}"}]}], "}"}]}], 
              ",", 
              RowBox[{"\<\"Grassmann\"\>", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"cb", "[", 
                   RowBox[{"p", ",", 
                    RowBox[{"{", "c", "}"}]}], "]"}], ",", 
                  RowBox[{"c", "[", 
                   RowBox[{"p", ",", 
                    RowBox[{"{", "c", "}"}]}], "]"}]}], "}"}], "}"}]}]}], 
             "\[RightAssociation]"}]}]}], "\[RightAssociation]"}], ",", "A"}],
         "]"}], "&&", 
       RowBox[{"IsGrassmann", "[", 
        RowBox[{
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"\<\"MasterEquation\"\>", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                FractionBox["1", "2"], " ", 
                RowBox[{"A", "[", "x", "]"}], " ", 
                RowBox[{"A", "[", "y", "]"}], " ", 
                RowBox[{"VBasis", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"A", ",", "A"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "x"}], ",", 
                    RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"cb", "[", "x", "]"}]}], " ", 
                 RowBox[{"VBasis", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"cb", ",", "c"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "x"}], ",", 
                    RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], ",", 
                RowBox[{"c", "[", "y", "]"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"\<\"FieldSpace\"\>", "\[Rule]", 
            RowBox[{"\[LeftAssociation]", 
             RowBox[{
              RowBox[{"\<\"cField\"\>", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"A", "[", 
                  RowBox[{"p", ",", 
                   RowBox[{"{", 
                    RowBox[{"v", ",", "c"}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\[Phi]", "[", "p", "]"}], ",", 
                   RowBox[{"\[Phi]x", "[", "p", "]"}]}], "}"}]}], "}"}]}], 
              ",", 
              RowBox[{"\<\"Grassmann\"\>", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"cb", "[", 
                   RowBox[{"p", ",", 
                    RowBox[{"{", "c", "}"}]}], "]"}], ",", 
                  RowBox[{"c", "[", 
                   RowBox[{"p", ",", 
                    RowBox[{"{", "c", "}"}]}], "]"}]}], "}"}], "}"}]}]}], 
             "\[RightAssociation]"}]}]}], "\[RightAssociation]"}], ",", 
         "cb"}], "]"}]}], ",", 
      RowBox[{"-", "1"}], ",", "1"}], "]"}], " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"IsGrassmann", "[", 
        RowBox[{
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"\<\"MasterEquation\"\>", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                FractionBox["1", "2"], " ", 
                RowBox[{"A", "[", "x", "]"}], " ", 
                RowBox[{"A", "[", "y", "]"}], " ", 
                RowBox[{"VBasis", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"A", ",", "A"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "x"}], ",", 
                    RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"cb", "[", "x", "]"}]}], " ", 
                 RowBox[{"VBasis", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"cb", ",", "c"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "x"}], ",", 
                    RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], ",", 
                RowBox[{"c", "[", "y", "]"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"\<\"FieldSpace\"\>", "\[Rule]", 
            RowBox[{"\[LeftAssociation]", 
             RowBox[{
              RowBox[{"\<\"cField\"\>", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"A", "[", 
                  RowBox[{"p", ",", 
                   RowBox[{"{", 
                    RowBox[{"v", ",", "c"}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\[Phi]", "[", "p", "]"}], ",", 
                   RowBox[{"\[Phi]x", "[", "p", "]"}]}], "}"}]}], "}"}]}], 
              ",", 
              RowBox[{"\<\"Grassmann\"\>", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"cb", "[", 
                   RowBox[{"p", ",", 
                    RowBox[{"{", "c", "}"}]}], "]"}], ",", 
                  RowBox[{"c", "[", 
                   RowBox[{"p", ",", 
                    RowBox[{"{", "c", "}"}]}], "]"}]}], "}"}], "}"}]}]}], 
             "\[RightAssociation]"}]}]}], "\[RightAssociation]"}], ",", 
         "cb"}], "]"}], "&&", 
       RowBox[{"IsGrassmann", "[", 
        RowBox[{
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"\<\"MasterEquation\"\>", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                FractionBox["1", "2"], " ", 
                RowBox[{"A", "[", "x", "]"}], " ", 
                RowBox[{"A", "[", "y", "]"}], " ", 
                RowBox[{"VBasis", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"A", ",", "A"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "x"}], ",", 
                    RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"cb", "[", "x", "]"}]}], " ", 
                 RowBox[{"VBasis", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"cb", ",", "c"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "x"}], ",", 
                    RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], ",", 
                RowBox[{"c", "[", "y", "]"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"\<\"FieldSpace\"\>", "\[Rule]", 
            RowBox[{"\[LeftAssociation]", 
             RowBox[{
              RowBox[{"\<\"cField\"\>", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"A", "[", 
                  RowBox[{"p", ",", 
                   RowBox[{"{", 
                    RowBox[{"v", ",", "c"}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\[Phi]", "[", "p", "]"}], ",", 
                   RowBox[{"\[Phi]x", "[", "p", "]"}]}], "}"}]}], "}"}]}], 
              ",", 
              RowBox[{"\<\"Grassmann\"\>", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"cb", "[", 
                   RowBox[{"p", ",", 
                    RowBox[{"{", "c", "}"}]}], "]"}], ",", 
                  RowBox[{"c", "[", 
                   RowBox[{"p", ",", 
                    RowBox[{"{", "c", "}"}]}], "]"}]}], "}"}], "}"}]}]}], 
             "\[RightAssociation]"}]}]}], "\[RightAssociation]"}], ",", "c"}],
         "]"}]}], ",", 
      RowBox[{"-", "1"}], ",", "1"}], "]"}]}], "]"}], "]"}]], "Output",
 CellChangeTimes->{3.950977480978176*^9},
 CellLabel->
  "Out[260]=",ExpressionUUID->"7c5f778a-1d4b-4d53-a726-16a42b48d56e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Given", " ", "a", " ", "user"}], "-", 
     RowBox[{
     "defined", " ", "term", " ", "or", " ", "master", " ", "equation"}]}], 
    ",", " ", 
    RowBox[{"give", " ", "all", " ", 
     RowBox[{"(", "closed", ")"}], " ", "indices", " ", "unique", " ", 
     RowBox[{"names", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FixIndices", "[", 
      RowBox[{"setup_", ",", "expr_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
        "indices", ",", "newIndices", ",", "replacements", ",", 
         "indexedObjects"}], "\[IndentingNewLine]", "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AssertFSetup", "[", "setup", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"FTermQ", "[", "expr", "]"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"FEqQ", "[", "expr", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Return", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"FixIndices", "[", 
               RowBox[{"setup", ",", "#"}], "]"}], "&"}], "/@", "expr"}], 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"FTermQ", "[", "expr", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<hi\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Not", "@", 
              RowBox[{"TermSuperIndicesValid", "[", 
               RowBox[{"setup", ",", "expr"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"Print", "[", "\"\<oi\>\"", "]"}], ";", 
              RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<df\>\"", "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"indices", "=", 
            RowBox[{"GetClosedSuperIndices", "[", 
             RowBox[{"setup", ",", "expr"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"newIndices", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Unique", "[", 
                RowBox[{"ToString", "[", "#", "]"}], "]"}], "&"}], ",", 
              "indices"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"replacements", "=", 
            RowBox[{"Thread", "[", 
             RowBox[{"indices", "->", "newIndices"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{"expr", "/.", "replacements"}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Expression \\\"\>\"", ",", "expr", ",", 
          "\"\<\\\" is neither a term nor a master equation!\>\""}], "]"}], 
        ";", 
        RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"FEq", "[", 
    RowBox[{
     RowBox[{"FTerm", "[", "a", "]"}], ",", 
     RowBox[{"FTerm", "[", 
      RowBox[{"b", ",", 
       RowBox[{"c", "+", "d"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FixIndices", "[", 
       RowBox[{"Setup", ",", "#"}], "]"}], "&"}], ",", "%"}], 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950861714841454*^9, 3.950861755216401*^9}, {
   3.950862487948318*^9, 3.950862798308673*^9}, {3.950862895840537*^9, 
   3.9508630357163677`*^9}, {3.9508724419777927`*^9, 
   3.9508724466302547`*^9}, {3.950872529157947*^9, 3.9508725448503036`*^9}, {
   3.9508725902304573`*^9, 3.950872613199347*^9}, {3.950872648512635*^9, 
   3.950872688616452*^9}, 3.950874347073372*^9, {3.950964034760331*^9, 
   3.950964062155575*^9}, {3.950964146531177*^9, 3.95096414932693*^9}, {
   3.950964196491962*^9, 3.950964291440217*^9}},
 CellLabel->
  "In[2762]:=",ExpressionUUID->"3500ee75-7244-4321-ae5e-82e6897e10d7"],

Cell[BoxData[
 RowBox[{"FEq", "[", 
  RowBox[{
   RowBox[{"FTerm", "[", "a", "]"}], ",", 
   RowBox[{"FTerm", "[", 
    RowBox[{"b", ",", "c"}], "]"}], ",", 
   RowBox[{"FTerm", "[", 
    RowBox[{"b", ",", "d"}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.9509642918275843`*^9},
 CellLabel->
  "Out[2763]=",ExpressionUUID->"9cda2b45-eac4-4ded-bc68-0060b6ec0d42"],

Cell[CellGroupData[{

Cell[BoxData["True"], "Print",
 CellChangeTimes->{3.9509642918291492`*^9},
 CellLabel->
  "During evaluation of \
In[2762]:=",ExpressionUUID->"951f31a2-f37f-4256-96af-2ac25d2a0bc5"],

Cell[BoxData["\<\"hi\"\>"], "Print",
 CellChangeTimes->{3.950964291829566*^9},
 CellLabel->
  "During evaluation of \
In[2762]:=",ExpressionUUID->"1215c6cf-7f93-4385-8f13-dc29faa514f2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Expression \\\"\"\>", "\[InvisibleSpace]", 
   RowBox[{"FTerm", "[", "a", "]"}], 
   "\[InvisibleSpace]", "\<\"\\\" is neither a term nor a master \
equation!\"\>"}],
  SequenceForm["Expression \"", 
   $CellContext`FTerm[$CellContext`a], 
   "\" is neither a term nor a master equation!"],
  Editable->False]], "Print",
 CellChangeTimes->{3.950964291830295*^9},
 CellLabel->
  "During evaluation of \
In[2762]:=",ExpressionUUID->"e26c65dd-c7b7-48ef-80ce-3a20abf77f07"]
}, Open  ]],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.9509642918307323`*^9},
 CellLabel->
  "Out[2764]=",ExpressionUUID->"97d25ade-c428-4883-957e-639c6e0816f2"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Algorithm", "Section",
 CellChangeTimes->{{3.932177970725307*^9, 3.9321779720559883`*^9}, {
  3.9508509057472887`*^9, 
  3.950850909097567*^9}},ExpressionUUID->"be19843a-e765-47f1-9747-\
2d6834a73a9e"],

Cell[CellGroupData[{

Cell["Reduce a term", "Subsection",
 CellChangeTimes->{{3.950867995958111*^9, 
  3.9508679992839813`*^9}},ExpressionUUID->"e5244ec3-f22c-466c-9873-\
92eb903637b0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"FTerm", "[", 
   RowBox[{"a", ",", "b", ",", "c"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.950963676192027*^9, 3.950963683450602*^9}},
 CellLabel->
  "In[2702]:=",ExpressionUUID->"a73c0a6c-a60e-47c9-95e2-4be9d2bbe2ec"],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{{3.950963680282667*^9, 3.950963683948655*^9}},
 CellLabel->
  "Out[2702]=",ExpressionUUID->"f10dca3c-cfe9-41b8-8103-6189f74c57e8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Simplify", " ", "a", " ", "term", " ", "appearing", " ", "in", " ", "an",
      " ", 
     RowBox[{"equation", ".", " ", "Remove"}], " ", "all", " ", "parts", " ", 
     "that", " ", "are", " ", "multiplied", " ", "with", " ", "0", " ", "and",
      " ", "try", " ", "to", " ", "merge", " ", "as", " ", "many", " ", 
     "factors", " ", "as", " ", "possible"}], ",", " ", 
    RowBox[{
    "while", " ", "not", " ", "changing", " ", "the", " ", "Grassmann", " ", 
     "structure", " ", "of", " ", "the", " ", 
     RowBox[{"term", ".", "\[IndentingNewLine]", "Returns"}], " ", 
     RowBox[{"{", "0", "}"}], " ", "if", " ", "the", " ", "term", " ", "is", 
     " ", 
     RowBox[{"trivial", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ReduceTerm", "[", 
     RowBox[{"setup_", ",", "term_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"reduced", "=", 
         RowBox[{"List", "@@", "term"}]}], ",", "mergeGrassmanFactors", ",", 
        "i"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AssertFSetup", "[", "setup", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AssertFTerm", "[", "term", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"reduced", ",", 
           RowBox[{"Plus", "[", 
            RowBox[{"a_", ",", "b__"}], "]"}], ",", "Infinity"}], "]"}], ",", 
         
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "reduced", ",", 
            "\"\< is not a valid term! A term cannot contain a \
Plus[___].\>\""}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "reduced", "]"}], "===", "0"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "0", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"reduced", ",", "0"}], "]"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "0", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Merge", " ", "scalar", " ", "terms", " ", "with", " ", "the", " ", 
         "closest", " ", "Grassman", " ", "term"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"GrassmannCount", "[", 
           RowBox[{"setup", ",", 
            RowBox[{"reduced", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ">", "1"}], ",", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<Grassmann count is > 1, error!\>\"", "]"}], ";", 
          
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"GrassmannCount", "[", 
             RowBox[{"setup", ",", 
              RowBox[{"reduced", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "===", "0"}], ")"}], "&&", 
          RowBox[{
           RowBox[{"Length", "[", "reduced", "]"}], ">", "1"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"reduced", "=", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"reduced", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", 
               RowBox[{"reduced", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"reduced", "[", 
              RowBox[{"[", 
               RowBox[{"3", ";;"}], "]"}], "]"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"i", "=", "2"}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"i", "<=", 
          RowBox[{"Length", "[", "reduced", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"GrassmannCount", "[", 
              RowBox[{"setup", ",", 
               RowBox[{"reduced", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ">", "1"}], ",", 
            RowBox[{
             RowBox[{
             "Print", "[", "\"\<Grassmann count is > 1, error!\>\"", "]"}], 
             ";", 
             RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"GrassmannCount", "[", 
              RowBox[{"setup", ",", 
               RowBox[{"reduced", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "==", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"reduced", "=", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"reduced", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", 
                   RowBox[{"i", "-", "2"}]}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"reduced", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "*", 
                  RowBox[{"reduced", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"reduced", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ";;"}], "]"}], "]"}]}], "]"}]}], 
             ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"i", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"reduced", "=", 
        RowBox[{"OrderEquation", "[", 
         RowBox[{"setup", ",", "reduced"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"FTerm", "@@", "reduced"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950868021337243*^9, 3.950868021665371*^9}, {
   3.95086835724666*^9, 3.9508683710297613`*^9}, 3.9508700517983923`*^9, 
   3.950870106727509*^9, {3.9508701471559877`*^9, 3.9508701622890987`*^9}, 
   3.950872629945331*^9, {3.9509518447947407`*^9, 3.950951851247134*^9}, {
   3.950952161983356*^9, 3.950952217083837*^9}, {3.950953229162822*^9, 
   3.950953297847208*^9}, {3.950953495548379*^9, 3.950953510434524*^9}, 
   3.950953659948514*^9, {3.9509537192506933`*^9, 3.9509537569466476`*^9}, 
   3.95095976117029*^9, {3.950960003047349*^9, 3.950960004176173*^9}, {
   3.9509615265046177`*^9, 3.950961540864068*^9}, {3.950963643675329*^9, 
   3.9509636614251423`*^9}, {3.950963711154449*^9, 3.950963717584083*^9}, {
   3.950963775682248*^9, 3.950963816155239*^9}, {3.950963860300707*^9, 
   3.950963929362384*^9}},
 CellLabel->
  "In[2725]:=",ExpressionUUID->"c85cfa76-e8b5-439f-9ca0-f24e64c44725"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ReduceEquation", "[", 
    RowBox[{"setup_", ",", "equation_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reduced", "=", "equation"}], "}"}], ",", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AssertFSetup", "[", "setup", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AssertFEq", "[", "equation", "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Make", " ", "sure", " ", "all", " ", "terms", " ", "are", " ", 
        "reduced"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"reduced", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ReduceTerm", "[", 
          RowBox[{"setup", ",", "#"}], "]"}], "&"}], "/@", "reduced"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Remove", " ", "all", " ", "terms", " ", "that", " ", "are", " ", 
        "0"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"reduced", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"reduced", ",", 
         RowBox[{
          RowBox[{"#", "=!=", 
           RowBox[{"{", "0", "}"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "reduced", "]"}], "===", "0"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Amend", " ", "the", " ", "index", " ", "structure"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"reduced", "=", 
       RowBox[{"FixIndices", "[", 
        RowBox[{"setup", ",", "reduced"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "reduced", "]"}], ";"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ReduceEquation", "[", 
  RowBox[{"Setup", ",", 
   RowBox[{"FEq", "[", 
    RowBox[{"FTerm", "[", 
     RowBox[{"a", ",", "b"}], "]"}], "]"}]}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.95087005673455*^9, 3.9508700859297953`*^9}, {
   3.95087011800534*^9, 3.950870131605879*^9}, {3.950870213341543*^9, 
   3.950870277473693*^9}, {3.950870399615657*^9, 3.950870405389082*^9}, {
   3.950870442661482*^9, 3.950870496553628*^9}, {3.950870560603696*^9, 
   3.95087057682275*^9}, {3.950870622601573*^9, 3.9508706298192472`*^9}, {
   3.950870882690217*^9, 3.950870893085442*^9}, {3.950872136372311*^9, 
   3.9508721384388733`*^9}, {3.95087218393355*^9, 3.950872184825736*^9}, {
   3.950872366461809*^9, 3.950872410282044*^9}, 3.9508726043827133`*^9, {
   3.950872638854124*^9, 3.9508726391619997`*^9}, 3.950874165123219*^9, {
   3.9508742127501917`*^9, 3.950874219718197*^9}, 3.9508742837279673`*^9, {
   3.950875436534375*^9, 3.9508754560376596`*^9}, {3.950953413239159*^9, 
   3.9509534267784367`*^9}, {3.950953462892211*^9, 3.950953463787467*^9}, 
   3.950953644035307*^9, {3.9509639545923243`*^9, 3.95096400898311*^9}},
 CellLabel->
  "In[2729]:=",ExpressionUUID->"52021b7e-bece-436c-b228-076b6c722055"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Expression \\\"\"\>", "\[InvisibleSpace]", 
   RowBox[{"FEq", "[", 
    RowBox[{"FTerm", "[", 
     RowBox[{"a", " ", "b"}], "]"}], "]"}], 
   "\[InvisibleSpace]", "\<\"\\\" is neither a term nor a master \
equation!\"\>"}],
  SequenceForm["Expression \"", 
   $CellContext`FEq[
    $CellContext`FTerm[$CellContext`a $CellContext`b]], 
   "\" is neither a term nor a master equation!"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.950964000387329*^9, 3.950964009364892*^9}},
 CellLabel->
  "During evaluation of \
In[2729]:=",ExpressionUUID->"15caeff1-b9ba-4520-a865-789b95ed3e8e"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.950964000403769*^9, 3.950964009365965*^9}},
 CellLabel->
  "Out[2730]=",ExpressionUUID->"d176177b-3142-40a0-b148-f6f86105af41"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Take a single derivative", "Subsection",
 CellChangeTimes->{{3.950867995958111*^9, 
  3.950868028741364*^9}},ExpressionUUID->"034e0a42-0fa4-4f9f-b5da-\
98a83e4d3f58"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Perform", " ", "a", " ", "single", " ", "functional", " ", "derivative", 
    " ", "on", " ", "a", " ", 
    RowBox[{"term", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TermDerivative", "[", 
      RowBox[{"setup_", ",", "term_", ",", "field_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"newTerms", ",", "prefactor", ",", "splitTerms"}], "}"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Simplify", " ", "the", " ", "input", " ", "and", " ", "copy", " ", 
         "it", " ", "as", " ", "many", " ", "times", " ", "as", " ", "the", 
         " ", "product", " ", "rule", " ", "will", " ", "be", " ", 
         "applied"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"newTerms", "=", 
         RowBox[{"ReduceTerm", "[", 
          RowBox[{"setup", ",", "term"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"newTerms", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"newTerms", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "term", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Perform", " ", "the", " ", "product", " ", 
           RowBox[{"rule", ".", " ", "Each"}], " ", "factor", " ", "in", " ", 
           "the", " ", "term", " ", "contains", " ", "one", " ", 
           "Grassmann"}], ",", " ", 
          RowBox[{
          "so", " ", "appropriately", " ", "add", " ", "the", " ", "minus", 
           " ", "signs"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"prefactor", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"IsGrassmann", "[", 
               RowBox[{"setup", ",", "field"}], "]"}], ",", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"-", "1"}], ")"}], 
               RowBox[{"i", "+", "1"}]], ",", "1"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newTerms", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "i"}], "]"}], "]"}], "=", 
            RowBox[{"prefactor", " ", 
             RowBox[{"FunctionalD", "[", 
              RowBox[{
               RowBox[{"newTerms", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", "field"}], 
              "]"}]}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "term", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "newTerms", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Perform", " ", "a", " ", "single", " ", "functional", " ", "derivative", 
     " ", "on", " ", "an", " ", 
     RowBox[{"equation", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"EquationDerivative", "[", 
      RowBox[{"setup_", ",", "equation_", ",", "field_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "newTerms", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"IsMasterEq", "[", "equation", "]"}]}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<The expression \\\"\>\"", ",", "equation", ",", 
             "\"\<\\\" is not a master equation!\>\""}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Take", " ", "derivatives", " ", "of", " ", "all", " ", "terms", " ",
           "in", " ", "the", " ", "equation"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"newTerms", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"TermDerivative", "[", 
            RowBox[{"setup", ",", "#", ",", "field"}], "]"}], "&"}], "/@", 
          "equation"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "A", " ", "term", " ", "derivative", " ", "yields", " ", "an", " ", 
           "equation"}], ";", " ", 
          RowBox[{
          "join", " ", "these", " ", "equations", " ", "to", " ", "obtain", 
           " ", "the", " ", "full", " ", "equation"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"newTerms", "=", 
         RowBox[{"Join", "@@", "newTerms"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Simplify", " ", "the", " ", "resulting", " ", "equation"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"ReduceEquation", "[", 
          RowBox[{"setup", ",", "newTerms"}], "]"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950785328813733*^9, 3.9507853292322893`*^9}, {
   3.9507853649655313`*^9, 3.950785400756113*^9}, {3.950785475505719*^9, 
   3.95078561148064*^9}, {3.950785668129586*^9, 3.950785670449685*^9}, 
   3.950785834800116*^9, {3.950785866793786*^9, 3.950785879826662*^9}, {
   3.950785948397665*^9, 3.950786002954245*^9}, {3.9507860823580637`*^9, 
   3.950786294172735*^9}, {3.9507863859546747`*^9, 3.9507864098082647`*^9}, {
   3.9507864826971273`*^9, 3.950786572451742*^9}, {3.95078660893367*^9, 
   3.95078683736561*^9}, {3.95078689070532*^9, 3.950786939020823*^9}, {
   3.9507869711808434`*^9, 3.950786998526334*^9}, {3.950787063958152*^9, 
   3.950787150248983*^9}, {3.9507871899146547`*^9, 3.9507872585292187`*^9}, {
   3.950787316474839*^9, 3.9507873271398087`*^9}, {3.950795827159062*^9, 
   3.950795950809372*^9}, {3.9508011845761757`*^9, 3.9508011891799717`*^9}, {
   3.950801220131068*^9, 3.950801250624531*^9}, 3.950801289214658*^9, {
   3.950801387480373*^9, 3.9508015029411297`*^9}, {3.950801536640973*^9, 
   3.9508016130166807`*^9}, {3.950801819205099*^9, 3.950801909237475*^9}, {
   3.950802013268509*^9, 3.950802136501171*^9}, {3.9508031409439983`*^9, 
   3.950803156438019*^9}, {3.950850922427371*^9, 3.9508509226105747`*^9}, {
   3.950851088467449*^9, 3.95085120472631*^9}, {3.9508512372954493`*^9, 
   3.9508512794838133`*^9}, {3.950852099412034*^9, 3.950852163516177*^9}, 
   3.9508522111190968`*^9, {3.95085246591319*^9, 3.950852470284113*^9}, {
   3.950852593378767*^9, 3.950852599545302*^9}, {3.950852633647019*^9, 
   3.950852717945573*^9}, {3.9508531704778347`*^9, 3.950853182524847*^9}, {
   3.950853280832035*^9, 3.950853388577367*^9}, {3.950853531229333*^9, 
   3.950853553277614*^9}, {3.950853776976849*^9, 3.950853841251507*^9}, {
   3.950853871423477*^9, 3.950853927029393*^9}, {3.950853958357534*^9, 
   3.950853969103477*^9}, {3.950854032367011*^9, 3.950854113343445*^9}, {
   3.9508541640306177`*^9, 3.95085417503258*^9}, {3.950863073020713*^9, 
   3.950863197133018*^9}, {3.9508632364734507`*^9, 3.9508632747380447`*^9}, {
   3.950863317121522*^9, 3.950863353293499*^9}, {3.95086339815306*^9, 
   3.95086365807091*^9}, {3.9508638175580177`*^9, 3.9508639822868433`*^9}, 
   3.9508660363917093`*^9, {3.950866086093605*^9, 3.950866094623272*^9}, {
   3.95086614017236*^9, 3.950866248193507*^9}, {3.950866317494445*^9, 
   3.9508663181058197`*^9}, {3.950866351922537*^9, 3.9508663782309427`*^9}, {
   3.950866408749732*^9, 3.950866644510489*^9}, {3.950866680744398*^9, 
   3.95086698475417*^9}, {3.950867035674296*^9, 3.9508670864974957`*^9}, {
   3.950867139286553*^9, 3.950867234542913*^9}, {3.95086728450457*^9, 
   3.9508673889138947`*^9}, {3.950867476474524*^9, 3.95086750143443*^9}, {
   3.950867551422817*^9, 3.950867896941835*^9}, {3.9508679648021193`*^9, 
   3.950868044954802*^9}, {3.95086831033525*^9, 3.950868328259528*^9}, {
   3.950868473213935*^9, 3.950868485718224*^9}, {3.9508685732823133`*^9, 
   3.950868595789912*^9}, {3.950868626517832*^9, 3.95086869231001*^9}, {
   3.95086872251787*^9, 3.9508687809518127`*^9}, {3.95086881540172*^9, 
   3.950868817009437*^9}, {3.950873804886675*^9, 3.950873941013299*^9}, {
   3.950873973990065*^9, 3.9508739966909103`*^9}, {3.950874030651667*^9, 
   3.950874133676622*^9}, 3.95087417329946*^9, 3.950874233862101*^9, {
   3.9508742776874638`*^9, 3.9508742783745832`*^9}, 3.950874362670842*^9, {
   3.950875375784315*^9, 3.950875405402588*^9}, {3.950875467587735*^9, 
   3.950875471159446*^9}, {3.950952242087275*^9, 3.9509522764028482`*^9}, {
   3.950952367082053*^9, 3.9509524213634043`*^9}, {3.950952468618765*^9, 
   3.950952475655017*^9}, {3.9509531798601294`*^9, 3.95095318224263*^9}, 
   3.9509534859323807`*^9, {3.950953586040846*^9, 3.950953649807308*^9}},
 CellLabel->
  "In[2633]:=",ExpressionUUID->"a436e083-e4fe-421f-aba5-b198287ec130"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Perform", " ", "a", " ", "single", " ", "functional", " ", "derivative", 
    " ", "on", " ", "a", " ", 
    RowBox[{"term", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TermDerivative", "[", 
      RowBox[{"setup_", ",", "term_", ",", "field_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"newTerms", ",", "prefactor", ",", "splitTerms"}], "}"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"FEqQ", "[", "term", "]"}]}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"FEq", "::", "notFEq"}], ",", "term"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Simplify", " ", "the", " ", "input", " ", "and", " ", "copy", " ", 
          "it", " ", "as", " ", "many", " ", "times", " ", "as", " ", "the", 
          " ", "product", " ", "rule", " ", "will", " ", "be", " ", 
          "applied"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"newTerms", "=", 
         RowBox[{"ReduceTerm", "[", 
          RowBox[{"setup", ",", "term"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"newTerms", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"newTerms", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "term", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Perform", " ", "the", " ", "product", " ", 
           RowBox[{"rule", ".", " ", "Each"}], " ", "factor", " ", "in", " ", 
           "the", " ", "term", " ", "contains", " ", "one", " ", 
           "Grassmann"}], ",", " ", 
          RowBox[{
          "so", " ", "appropriately", " ", "add", " ", "the", " ", "minus", 
           " ", "signs"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"prefactor", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"IsGrassmann", "[", 
               RowBox[{"setup", ",", "field"}], "]"}], ",", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"-", "1"}], ")"}], 
               RowBox[{"i", "+", "1"}]], ",", "1"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newTerms", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "i"}], "]"}], "]"}], "=", 
            RowBox[{"prefactor", " ", 
             RowBox[{"FunctionalD", "[", 
              RowBox[{
               RowBox[{"newTerms", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", "field"}], 
              "]"}]}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "term", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "newTerms", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Perform", " ", "a", " ", "single", " ", "functional", " ", "derivative", 
     " ", "on", " ", "an", " ", 
     RowBox[{"equation", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"EquationDerivative", "[", 
      RowBox[{"setup_", ",", "equation_", ",", "field_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "newTerms", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"IsMasterEq", "[", "equation", "]"}]}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<The expression \\\"\>\"", ",", "equation", ",", 
             "\"\<\\\" is not a master equation!\>\""}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Take", " ", "derivatives", " ", "of", " ", "all", " ", "terms", " ",
           "in", " ", "the", " ", "equation"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"newTerms", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"TermDerivative", "[", 
            RowBox[{"setup", ",", "#", ",", "field"}], "]"}], "&"}], "/@", 
          "equation"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "A", " ", "term", " ", "derivative", " ", "yields", " ", "an", " ", 
           "equation"}], ";", " ", 
          RowBox[{
          "join", " ", "these", " ", "equations", " ", "to", " ", "obtain", 
           " ", "the", " ", "full", " ", "equation"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"newTerms", "=", 
         RowBox[{"Join", "@@", "newTerms"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Simplify", " ", "the", " ", "resulting", " ", "equation"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"ReduceEquation", "[", 
          RowBox[{"setup", ",", "newTerms"}], "]"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950785328813733*^9, 3.9507853292322893`*^9}, {
   3.9507853649655313`*^9, 3.950785400756113*^9}, {3.950785475505719*^9, 
   3.95078561148064*^9}, {3.950785668129586*^9, 3.950785670449685*^9}, 
   3.950785834800116*^9, {3.950785866793786*^9, 3.950785879826662*^9}, {
   3.950785948397665*^9, 3.950786002954245*^9}, {3.9507860823580637`*^9, 
   3.950786294172735*^9}, {3.9507863859546747`*^9, 3.9507864098082647`*^9}, {
   3.9507864826971273`*^9, 3.950786572451742*^9}, {3.95078660893367*^9, 
   3.95078683736561*^9}, {3.95078689070532*^9, 3.950786939020823*^9}, {
   3.9507869711808434`*^9, 3.950786998526334*^9}, {3.950787063958152*^9, 
   3.950787150248983*^9}, {3.9507871899146547`*^9, 3.9507872585292187`*^9}, {
   3.950787316474839*^9, 3.9507873271398087`*^9}, {3.950795827159062*^9, 
   3.950795950809372*^9}, {3.9508011845761757`*^9, 3.9508011891799717`*^9}, {
   3.950801220131068*^9, 3.950801250624531*^9}, 3.950801289214658*^9, {
   3.950801387480373*^9, 3.9508015029411297`*^9}, {3.950801536640973*^9, 
   3.9508016130166807`*^9}, {3.950801819205099*^9, 3.950801909237475*^9}, {
   3.950802013268509*^9, 3.950802136501171*^9}, {3.9508031409439983`*^9, 
   3.950803156438019*^9}, {3.950850922427371*^9, 3.9508509226105747`*^9}, {
   3.950851088467449*^9, 3.95085120472631*^9}, {3.9508512372954493`*^9, 
   3.9508512794838133`*^9}, {3.950852099412034*^9, 3.950852163516177*^9}, 
   3.9508522111190968`*^9, {3.95085246591319*^9, 3.950852470284113*^9}, {
   3.950852593378767*^9, 3.950852599545302*^9}, {3.950852633647019*^9, 
   3.950852717945573*^9}, {3.9508531704778347`*^9, 3.950853182524847*^9}, {
   3.950853280832035*^9, 3.950853388577367*^9}, {3.950853531229333*^9, 
   3.950853553277614*^9}, {3.950853776976849*^9, 3.950853841251507*^9}, {
   3.950853871423477*^9, 3.950853927029393*^9}, {3.950853958357534*^9, 
   3.950853969103477*^9}, {3.950854032367011*^9, 3.950854113343445*^9}, {
   3.9508541640306177`*^9, 3.95085417503258*^9}, {3.950863073020713*^9, 
   3.950863197133018*^9}, {3.9508632364734507`*^9, 3.9508632747380447`*^9}, {
   3.950863317121522*^9, 3.950863353293499*^9}, {3.95086339815306*^9, 
   3.95086365807091*^9}, {3.9508638175580177`*^9, 3.9508639822868433`*^9}, 
   3.9508660363917093`*^9, {3.950866086093605*^9, 3.950866094623272*^9}, {
   3.95086614017236*^9, 3.950866248193507*^9}, {3.950866317494445*^9, 
   3.9508663181058197`*^9}, {3.950866351922537*^9, 3.9508663782309427`*^9}, {
   3.950866408749732*^9, 3.950866644510489*^9}, {3.950866680744398*^9, 
   3.95086698475417*^9}, {3.950867035674296*^9, 3.9508670864974957`*^9}, {
   3.950867139286553*^9, 3.950867234542913*^9}, {3.95086728450457*^9, 
   3.9508673889138947`*^9}, {3.950867476474524*^9, 3.95086750143443*^9}, {
   3.950867551422817*^9, 3.950867896941835*^9}, {3.9508679648021193`*^9, 
   3.950868044954802*^9}, {3.95086831033525*^9, 3.950868328259528*^9}, {
   3.950868473213935*^9, 3.950868485718224*^9}, {3.9508685732823133`*^9, 
   3.950868595789912*^9}, {3.950868626517832*^9, 3.95086869231001*^9}, {
   3.95086872251787*^9, 3.9508687809518127`*^9}, {3.95086881540172*^9, 
   3.950868817009437*^9}, {3.950873804886675*^9, 3.950873941013299*^9}, {
   3.950873973990065*^9, 3.9508739966909103`*^9}, {3.950874030651667*^9, 
   3.950874133676622*^9}, 3.95087417329946*^9, 3.950874233862101*^9, {
   3.9508742776874638`*^9, 3.9508742783745832`*^9}, 3.950874362670842*^9, {
   3.950875375784315*^9, 3.950875405402588*^9}, {3.950875467587735*^9, 
   3.950875471159446*^9}, {3.950952242087275*^9, 3.9509522764028482`*^9}, {
   3.950952367082053*^9, 3.9509524213634043`*^9}, {3.950952468618765*^9, 
   3.950952475655017*^9}, {3.9509531798601294`*^9, 3.95095318224263*^9}, 
   3.9509534859323807`*^9, {3.950953586040846*^9, 3.950953649807308*^9}, {
   3.95095954204025*^9, 
   3.950959680703517*^9}},ExpressionUUID->"340eb28e-df7e-4492-8bd5-\
f7971346541d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Take several functional derivatives", "Subsection",
 CellChangeTimes->{{3.9508680530500927`*^9, 
  3.950868063045309*^9}},ExpressionUUID->"a8f64e7a-d885-45c2-99d7-\
7e2e4dc385f7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Protect", "[", 
   RowBox[{"OutputLevel", ",", "SuperIndexForm"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "DeriveFunctionalEquation", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"OutputLevel", "->", "SuperIndexForm"}], "}"}]}], ";"}]}], "Input",\

 InitializationCell->
  True,ExpressionUUID->"bba04405-f573-40fc-9a19-18ca7de811ab"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Perform", " ", "multiple", " ", "functional", " ", "derivatives", " ", 
    "on", " ", "a", " ", "master", " ", 
    RowBox[{"equation", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"DeriveFunctionalEquation", "[", 
      RowBox[{"setup_", ",", "expr_", ",", "derivativeList_", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "result", ",", "\[IndentingNewLine]", "externalIndexNames", ",", 
         "outputReplacements", ",", "\[IndentingNewLine]", 
         "derivativeListSIDX"}], "\[IndentingNewLine]", "}"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"IsValidSetup", "[", "setup", "]"}]}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<The expression \\\"\>\"", ",", "setup", ",", 
             "\"\<\\\" is not a valid setup!\>\""}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"IsValidMasterEq", "[", "expr", "]"}]}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<The expression \\\"\>\"", ",", "expr", ",", 
             "\"\<\\\" is not a master equation!\>\""}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"IsValidDerivativeList", "[", 
            RowBox[{"setup", ",", "derivativeList"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<The expression \\\"\>\"", ",", "derivativeList", ",", 
             "\"\<\\\" is not a derivative list!\>\""}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"While", " ", "doing", " ", "the", " ", "derivatives"}], 
          ",", " ", 
          RowBox[{
           RowBox[{"we", " ", "want", " ", "to", " ", "use", " ", "super"}], 
           "-", 
           RowBox[{"indices", ".", " ", "Afterwards"}]}], ",", " ", 
          RowBox[{
          "we", " ", "can", " ", "replace", " ", "these", " ", "again", " ", 
           "with", " ", "the", " ", "given", " ", "indices"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"externalIndexNames", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Unique", "[", "\"\<eI\>\"", "]"}], "&"}], ",", 
           "derivativeList"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"outputReplacements", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"externalIndexNames", "->", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"FieldIndices", "@@", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Head", "[", "#", "]"}], ",", 
                 RowBox[{"List", "@@", "#"}]}], "]"}]}], "&"}], ",", 
             "derivativeList"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"derivativeListSIDX", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"derivativeList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
            RowBox[{"externalIndexNames", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "derivativeList", "]"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "take", " ", "them", " ", "in", " ", "reverse", " ", 
          RowBox[{"order", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"derivativeListSIDX", "=", 
         RowBox[{"Reverse", "[", "derivativeListSIDX", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"First", ",", " ", 
          RowBox[{
          "fix", " ", "the", " ", "indices", " ", "in", " ", "the", " ", 
           "input", " ", "equation"}], ",", " ", 
          RowBox[{
           RowBox[{"i", ".", "e", ".", " ", "make"}], " ", "everything", " ", 
           "have", " ", "unique", " ", "names"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"result", "=", 
         RowBox[{"FixIndices", "[", 
          RowBox[{"setup", ",", "expr"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Perform", " ", "all", " ", "the", " ", "derivatives"}], 
          ",", " ", 
          RowBox[{"one", " ", "after", " ", "the", " ", "other"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"result", "=", 
           RowBox[{"EquationDerivative", "[", 
            RowBox[{"setup", ",", "result", ",", 
             RowBox[{"derivativeListSIDX", "[", 
              RowBox[{"[", "pass", "]"}], "]"}]}], "]"}]}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"pass", ",", "1", ",", 
            RowBox[{"Length", "[", "derivativeList", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "OutputLevel", "]"}], "===", 
           "SuperIndexForm"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Return", "[", " ", 
            RowBox[{"{", 
             RowBox[{"result", ",", "outputReplacements"}], "}"}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"result", "//.", "outputReplacements"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"DeriveFunctionalEquation", "[", 
    RowBox[{"Setup", ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"c", "[", "x", "]"}], ",", 
        RowBox[{
         RowBox[{"GammaN", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"c", ",", "cb"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}], "]"}], 
         RowBox[{"c", "[", "y", "]"}]}]}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "[", 
        RowBox[{
         RowBox[{"-", "f"}], ",", 
         RowBox[{"{", "a", "}"}]}], "]"}], ",", 
       RowBox[{"cb", "[", 
        RowBox[{"f", ",", 
         RowBox[{"{", "a", "}"}]}], "]"}]}], "}"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.95086807399784*^9, 3.950868101837797*^9}, {
  3.950868135961317*^9, 3.950868153423587*^9}, {3.950868228217888*^9, 
  3.950868269490148*^9}, {3.95086841046174*^9, 3.950868424387451*^9}, {
  3.950873786052535*^9, 3.950873787662897*^9}, {3.950874377585595*^9, 
  3.950874378821952*^9}, {3.950875285850876*^9, 3.950875301335219*^9}, {
  3.950875343786489*^9, 3.9508753492991743`*^9}, {3.9508754834989862`*^9, 
  3.950875487444517*^9}, {3.9508932689591846`*^9, 3.950893303250742*^9}, {
  3.950893467838776*^9, 3.950893530412135*^9}, {3.950951875092435*^9, 
  3.950951917051467*^9}, {3.950951969983094*^9, 3.950951982885131*^9}, {
  3.950953049415739*^9, 3.9509530566618147`*^9}, {3.9509576893692417`*^9, 
  3.950957693641984*^9}, {3.950957869930423*^9, 
  3.9509578703743134`*^9}},ExpressionUUID->"fcb7ecd2-adb3-4b5a-a94f-\
8080924ea319"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Gamma]", "[", 
        RowBox[{
         RowBox[{"-", "eI732"}], ",", "x734736"}], "]"}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"c", "[", "y735737738", "]"}]}], " ", 
        RowBox[{"GammaN", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c", ",", "cb", ",", "cb"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x734736", ",", "y735737738", ",", "eI733"}], "}"}]}], 
         "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "[", "x734736739", "]"}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"c", "[", "y735737740", "]"}]}], " ", 
        RowBox[{"GammaN", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c", ",", "c", ",", "cb", ",", "cb"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "x734736739", ",", "eI732", ",", "y735737740", ",", "eI733"}], 
           "}"}]}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "[", "x734736741", "]"}], ",", 
       RowBox[{
        RowBox[{"GammaN", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c", ",", "cb", ",", "cb"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x734736741", ",", "y735737", ",", "eI733"}], "}"}]}], 
         "]"}], " ", 
        RowBox[{"\[Gamma]", "[", 
         RowBox[{
          RowBox[{"-", "eI732"}], ",", "y735737"}], "]"}]}]}], "}"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"eI732", "\[Rule]", 
      RowBox[{"FieldIndices", "[", 
       RowBox[{"c", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "f"}], ",", 
          RowBox[{"{", "a", "}"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"eI733", "\[Rule]", 
      RowBox[{"FieldIndices", "[", 
       RowBox[{"cb", ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", 
          RowBox[{"{", "a", "}"}]}], "}"}]}], "]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.950953186634725*^9, 3.950953769584841*^9},
 CellLabel->
  "Out[2636]=",ExpressionUUID->"66133275-1c8b-4433-9d57-7e6bfff5470a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Join", "@@", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Gamma]", "[", 
        RowBox[{
         RowBox[{"-", "eI602"}], ",", "x604606"}], "]"}], ",", 
       RowBox[{
        RowBox[{"c", "[", "y605607", "]"}], " ", 
        RowBox[{"GammaN", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c", ",", "cb", ",", "cb"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x604606", ",", "eI603", ",", "y605607"}], "}"}]}], 
         "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "[", "x604606", "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"c", "[", "y605607", "]"}], " ", 
         RowBox[{"GammaN", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"c", ",", "c", ",", "cb", ",", "cb"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x604606", ",", "eI602", ",", "eI603", ",", "y605607"}], 
            "}"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"GammaN", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"c", ",", "cb", ",", "cb"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x604606", ",", "eI603", ",", "y605607"}], "}"}]}], "]"}],
          " ", 
         RowBox[{"\[Gamma]", "[", 
          RowBox[{
           RowBox[{"-", "eI602"}], ",", "y605607"}], "]"}]}]}]}], "}"}]}], 
    "}"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.9509531382783546`*^9, 3.950953160909773*^9}},
 CellLabel->
  "In[2578]:=",ExpressionUUID->"df84b937-624b-441e-80f4-fe957a4c1e1f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Gamma]", "[", 
      RowBox[{
       RowBox[{"-", "eI602"}], ",", "x604606"}], "]"}], ",", 
     RowBox[{
      RowBox[{"c", "[", "y605607", "]"}], " ", 
      RowBox[{"GammaN", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"c", ",", "cb", ",", "cb"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x604606", ",", "eI603", ",", "y605607"}], "}"}]}], 
       "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"c", "[", "x604606", "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"c", "[", "y605607", "]"}], " ", 
       RowBox[{"GammaN", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"c", ",", "c", ",", "cb", ",", "cb"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x604606", ",", "eI602", ",", "eI603", ",", "y605607"}], 
          "}"}]}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"GammaN", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"c", ",", "cb", ",", "cb"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x604606", ",", "eI603", ",", "y605607"}], "}"}]}], "]"}], 
       " ", 
       RowBox[{"\[Gamma]", "[", 
        RowBox[{
         RowBox[{"-", "eI602"}], ",", "y605607"}], "]"}]}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.95087548799365*^9, {3.950893261447979*^9, 3.950893303767733*^9}, 
   3.950893388236874*^9, {3.9508934864120207`*^9, 3.950893531169341*^9}, {
   3.950951865114262*^9, 3.950951917914597*^9}, {3.9509519705210323`*^9, 
   3.9509519831358557`*^9}, 3.9509522260192738`*^9, 3.950952279708961*^9, 
   3.950952394030134*^9, 3.950952427210351*^9, 3.9509524786066837`*^9, {
   3.950953040788166*^9, 3.950953057307907*^9}, 3.950953162039349*^9},
 CellLabel->
  "Out[2578]=",ExpressionUUID->"b0cd4754-812a-40e8-851f-7fc2e606f6ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.950952011579446*^9, 3.95095202610972*^9}, {
  3.950952318952292*^9, 3.950952323842063*^9}, {3.9509524946207533`*^9, 
  3.9509525268687553`*^9}},ExpressionUUID->"95284580-dad7-4ea5-addd-\
27a440b30ac9"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.950952016399808*^9, 3.950952026427526*^9}, 
   3.950952324219462*^9, {3.950952510785212*^9, 3.950952521210383*^9}},
 CellLabel->
  "Out[2544]=",ExpressionUUID->"68df726f-94c3-4aff-a3e1-6feb1b27d16c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Delta]", "[", 
     RowBox[{
      RowBox[{"Times", "[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "a_Symbol"}], "]"}], ",", "b_Symbol"}], 
     "]"}], ":>", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "c", "}"}], ",", 
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"c", ",", "b"}], "]"}], 
       RowBox[{"\[Gamma]", "[", 
        RowBox[{
         RowBox[{"-", "c"}], ",", 
         RowBox[{"-", "a"}]}], "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Delta]", "[", 
     RowBox[{"a_Symbol", ",", 
      RowBox[{"Times", "[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "b_Symbol"}], "]"}]}], "]"}], ":>", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "c", "}"}], ",", 
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a", ",", "c"}], "]"}], 
       RowBox[{"\[Gamma]", "[", 
        RowBox[{
         RowBox[{"-", "c"}], ",", 
         RowBox[{"-", "b"}]}], "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
  "}"}]], "Input",
 CellChangeTimes->{{3.950893672699964*^9, 3.9508937057744913`*^9}, {
  3.950893889353174*^9, 
  3.950894013554228*^9}},ExpressionUUID->"fb3bec6b-3478-4efd-939b-\
ace7c9cbb372"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"c", "[", "x", "]"}], "=", 
  RowBox[{
   RowBox[{"\[Gamma]", "[", 
    RowBox[{"x", ",", "y"}], "]"}], 
   RowBox[{"c", "[", 
    RowBox[{"-", "y"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "[", 
   RowBox[{"-", "x"}], "]"}], "=", 
  RowBox[{
   RowBox[{"c", "[", "y", "]"}], 
   RowBox[{"\[Gamma]", "[", 
    RowBox[{
     RowBox[{"-", "y"}], ",", 
     RowBox[{"-", "x"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.9508937467843847`*^9, 3.950893777865147*^9}, {
  3.950893817393927*^9, 
  3.950893840609949*^9}},ExpressionUUID->"b54de7fb-f597-486d-ae2c-\
b763a4606e0e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing", "Title",
 CellChangeTimes->{{3.9508681098093233`*^9, 
  3.950868110913395*^9}},ExpressionUUID->"7a24c792-7a48-4e73-8b88-\
7b56966e439b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fields", "=", " ", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<bosonic\>\"", "\[Rule]", " ", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"A", "[", 
        RowBox[{"p", ",", 
         RowBox[{"{", 
          RowBox[{"v", ",", " ", "c"}], "}"}]}], "]"}], "\[IndentingNewLine]",
        "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<fermionic\>\"", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cb", "[", 
          RowBox[{"p", ",", 
           RowBox[{"{", "c", "}"}]}], "]"}], ",", 
         RowBox[{"c", "[", 
          RowBox[{"p", ",", 
           RowBox[{"{", "c", "}"}]}], "]"}]}], "}"}], "\[IndentingNewLine]", 
       "}"}]}]}], "\[IndentingNewLine]", "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"masterEquation", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"A", "[", "x", "]"}], 
        RowBox[{"VBasis", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", "A"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "x"}], ",", 
            RowBox[{"-", "y"}]}], "}"}]}], "]"}], 
        RowBox[{"A", "[", "y", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"cb", "[", "x", "]"}]}], 
         RowBox[{"VBasis", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"cb", ",", "c"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "x"}], ",", 
             RowBox[{"-", "y"}]}], "}"}]}], "]"}]}], ",", 
        RowBox[{"c", "[", "y", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Setup", "=", 
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<MasterEquation\>\"", "->", "masterEquation"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<FieldSpace\>\"", "->", "fields"}]}], "\[IndentingNewLine]",
      "|>"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"DeriveFunctionalEquation", "[", 
  RowBox[{"Setup", ",", "masterEquation", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"f", ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "v"}], "}"}]}], "]"}], ",", 
     RowBox[{"c", "[", 
      RowBox[{"f", ",", 
       RowBox[{"{", "a", "}"}]}], "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"DeriveFunctionalEquation", "[", 
  RowBox[{"Setup", ",", "masterEquation", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"f", ",", 
       RowBox[{"{", "a", "}"}]}], "]"}], ",", 
     RowBox[{"cb", "[", 
      RowBox[{"f", ",", 
       RowBox[{"{", "b", "}"}]}], "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.950868127048699*^9, 3.950868127689237*^9}, {
   3.950874387672369*^9, 3.950874426778116*^9}, {3.950874481138794*^9, 
   3.950874500521943*^9}, 3.9508752602022943`*^9, {3.950875335374179*^9, 
   3.950875335550284*^9}},
 CellLabel->
  "In[1982]:=",ExpressionUUID->"fc1deefb-2176-49e3-895a-575f08b7cb88"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"A", "[", "y437440", "]"}], " ", 
     RowBox[{"VBasis", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"A", ",", "A"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "x436"}], ",", 
         RowBox[{"-", "y437440"}]}], "}"}]}], "]"}], " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"x436", ",", "eI434"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"A", "[", "x436441", "]"}], " ", 
     RowBox[{"VBasis", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"A", ",", "A"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "x436441"}], ",", 
         RowBox[{"-", "y437"}]}], "}"}]}], "]"}], " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"y437", ",", "eI434"}], "]"}]}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.950875261774631*^9, {3.950875329244927*^9, 3.95087535144167*^9}},
 CellLabel->
  "During evaluation of \
In[1982]:=",ExpressionUUID->"7562a7d5-a5b8-430c-98bb-2a135a6152a2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Expression \\\"\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "}"}], 
   "\[InvisibleSpace]", "\<\"\\\" is neither a term nor a master \
equation!\"\>"}],
  SequenceForm[
  "Expression \"", {}, "\" is neither a term nor a master equation!"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.950875261774631*^9, {3.950875329244927*^9, 3.950875351442688*^9}},
 CellLabel->
  "During evaluation of \
In[1982]:=",ExpressionUUID->"96b4a4ff-b892-4d71-9ea3-82d321dd29b0"]
}, Open  ]],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.9508681608007402`*^9, {3.950868234472204*^9, 3.9508682524459867`*^9}, 
   3.950868318985805*^9, 3.9508683788162613`*^9, 3.950868426270503*^9, 
   3.950868491071589*^9, 3.950873756482444*^9, {3.950873789675522*^9, 
   3.950873872251165*^9}, {3.950874382447857*^9, 3.950874427272276*^9}, 
   3.950874502592249*^9, 3.950875222668562*^9, 3.950875261777555*^9, {
   3.950875329247876*^9, 3.9508753514438143`*^9}},
 CellLabel->
  "Out[1985]=",ExpressionUUID->"6534f23d-7cf0-4351-9afc-a5cc3f02123e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"cb", "[", "x447448", "]"}], " ", 
    RowBox[{"VBasis", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cb", ",", "c"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "x447448"}], ",", 
        RowBox[{"-", "y446"}]}], "}"}]}], "]"}], " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"y446", ",", "eI442"}], "]"}]}], "}"}], "}"}]], "Print",
 CellChangeTimes->{
  3.950875261774631*^9, {3.950875329244927*^9, 3.9508753514452744`*^9}},
 CellLabel->
  "During evaluation of \
In[1982]:=",ExpressionUUID->"23e350ab-392c-4d79-9538-0ee2738b782b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"VBasis", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cb", ",", "c"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "x447448"}], ",", 
        RowBox[{"-", "y446"}]}], "}"}]}], "]"}], " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"x447448", ",", "eI443"}], "]"}], " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"y446", ",", "eI442"}], "]"}]}], "}"}], "}"}]], "Print",
 CellChangeTimes->{
  3.950875261774631*^9, {3.950875329244927*^9, 3.9508753514461927`*^9}},
 CellLabel->
  "During evaluation of \
In[1982]:=",ExpressionUUID->"b716322f-895c-4a70-a611-d5b4fb8e447c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"VBasis", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"cb", ",", "c"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "x447448"}], ",", 
          RowBox[{"-", "y446"}]}], "}"}]}], "]"}], " ", 
      RowBox[{"\[Delta]", "[", 
       RowBox[{"x447448", ",", "eI443"}], "]"}], " ", 
      RowBox[{"\[Delta]", "[", 
       RowBox[{"y446", ",", "eI442"}], "]"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"eI442", "\[Rule]", 
      RowBox[{"FieldIndices", "[", 
       RowBox[{"c", ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", 
          RowBox[{"{", "a", "}"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"eI443", "\[Rule]", 
      RowBox[{"FieldIndices", "[", 
       RowBox[{"cb", ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", 
          RowBox[{"{", "b", "}"}]}], "}"}]}], "]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.9508681608007402`*^9, {3.950868234472204*^9, 3.9508682524459867`*^9}, 
   3.950868318985805*^9, 3.9508683788162613`*^9, 3.950868426270503*^9, 
   3.950868491071589*^9, 3.950873756482444*^9, {3.950873789675522*^9, 
   3.950873872251165*^9}, {3.950874382447857*^9, 3.950874427272276*^9}, 
   3.950874502592249*^9, 3.950875222668562*^9, 3.950875261777555*^9, {
   3.950875329247876*^9, 3.950875351447452*^9}},
 CellLabel->
  "Out[1986]=",ExpressionUUID->"2e26796c-df6f-4688-8ec8-1d0e61c3083c"]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->"FEDeriK.m",
WindowSize->{1200, 750},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.9 Inherited,
FrontEndVersion->"14.1 for Linux x86 (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"dfc92765-bf29-47cf-bd50-cf1f31dcd525"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 530, 10, 28, "Input",ExpressionUUID->"33cd48af-4550-42b3-9c95-127f2f1ee635"],
Cell[CellGroupData[{
Cell[1109, 34, 220, 3, 28, "Input",ExpressionUUID->"33eb1d48-8ad0-4069-9a69-cc11336e7f19"],
Cell[CellGroupData[{
Cell[1354, 41, 3102, 49, 269, "Print",ExpressionUUID->"df9ee9f3-8c28-4396-b639-438f47eb1edb"],
Cell[4459, 92, 870, 14, 20, "Print",ExpressionUUID->"9785ca40-19d8-4052-83c0-c56ae87fbc23"],
Cell[5332, 108, 824, 14, 36, "Print",ExpressionUUID->"7d8148c7-6518-4575-8448-465200632c46"],
Cell[6159, 124, 1309, 22, 37, "Print",ExpressionUUID->"1ef81d0d-0e28-427d-bcc5-2c028847bcf9"],
Cell[7471, 148, 1015, 16, 53, "Print",ExpressionUUID->"651ca95b-12e3-402c-be17-c5c86b0d666c"]
}, Open  ]]
}, Open  ]],
Cell[8513, 168, 2647, 73, 411, "Input",ExpressionUUID->"2632f66f-a425-44c8-b21c-333bdd8417c4"],
Cell[CellGroupData[{
Cell[11185, 245, 173, 3, 59, "Section",ExpressionUUID->"e03db448-7a6c-4e73-9ddc-3b1976a84a81"],
Cell[CellGroupData[{
Cell[11383, 252, 190, 3, 47, "Subsection",ExpressionUUID->"35360acd-1ab3-48dc-b387-960ef784c1b9"],
Cell[11576, 257, 7966, 205, 689, "Input",ExpressionUUID->"d8c7ad92-008a-409f-951b-580a3ca827cd",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[19579, 467, 218, 4, 47, "Subsection",ExpressionUUID->"23b7e69d-dcbb-4fb0-a77e-b8638a031ad4"],
Cell[CellGroupData[{
Cell[19822, 475, 217, 4, 39, "Subsubsection",ExpressionUUID->"d438b387-4f31-41ce-a117-795b628d69b9"],
Cell[20042, 481, 1703, 51, 183, "Input",ExpressionUUID->"63fbe29b-4af8-405d-80e3-5cbc9aa8d1d5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[21782, 537, 212, 4, 32, "Subsubsection",ExpressionUUID->"f52392a8-ad40-44db-871d-0651868db7ca"],
Cell[21997, 543, 7276, 168, 792, "Input",ExpressionUUID->"d2be4365-2a9f-4170-90b1-81e044dec426",
 InitializationCell->True],
Cell[29276, 713, 5713, 133, 685, "Input",ExpressionUUID->"ffdc8015-4beb-4a8a-9712-899076a5bcad",
 InitializationCell->True],
Cell[34992, 848, 150, 3, 39, "Input",ExpressionUUID->"e6fda6fb-9bcb-45a5-b801-7e006569f014"]
}, Closed]],
Cell[CellGroupData[{
Cell[35179, 856, 210, 4, 32, "Subsubsection",ExpressionUUID->"432ab124-4161-47f8-a56b-8db469a3db21"],
Cell[35392, 862, 4135, 103, 647, "Input",ExpressionUUID->"11470f5d-e2db-4aaa-9b7e-0a8c11da0687",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[39564, 970, 217, 4, 32, "Subsubsection",ExpressionUUID->"4586692a-ee51-46b9-b58e-43bcdb604423"],
Cell[39784, 976, 4267, 100, 389, "Input",ExpressionUUID->"8025941a-3caa-4a8b-a6f7-d19c65a09782",
 InitializationCell->True],
Cell[44054, 1078, 3215, 78, 418, "Input",ExpressionUUID->"d04f551f-63ba-4c59-827e-89539a889eb6",
 InitializationCell->True]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[47330, 1163, 156, 3, 59, "Section",ExpressionUUID->"bdee160a-1c91-4de1-b52d-86eb572207e3"],
Cell[47489, 1168, 473, 11, 55, "Input",ExpressionUUID->"8b16408f-667b-4fec-b260-6fb6db16586b",
 InitializationCell->True],
Cell[47965, 1181, 1311, 36, 137, "Input",ExpressionUUID->"f4704157-c7f9-402c-bf7c-77513ac8ecc7",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[49301, 1221, 208, 4, 47, "Subsection",ExpressionUUID->"5193f3f7-8901-4525-bbbc-d3fa4695bea7"],
Cell[49512, 1227, 8298, 205, 674, "Input",ExpressionUUID->"428f55da-c8db-4d63-89da-51a880a4e13f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[57847, 1437, 223, 4, 33, "Subsection",ExpressionUUID->"a703f905-419d-403f-a28c-a63b6e5d0fbc"],
Cell[CellGroupData[{
Cell[58095, 1445, 159, 3, 39, "Subsubsection",ExpressionUUID->"807846d5-0a8e-42e1-8499-9436b99fe5c0"],
Cell[58257, 1450, 3740, 97, 389, "Input",ExpressionUUID->"3518af78-5ff7-49ca-9232-57a8cda2059b",
 InitializationCell->True],
Cell[62000, 1549, 5582, 156, 685, "Input",ExpressionUUID->"51b5119b-7ed2-4d4e-8157-9da88d9e51a3",
 InitializationCell->True],
Cell[67585, 1707, 2348, 59, 280, "Input",ExpressionUUID->"f9e7b8dd-479d-4f1c-b30c-43e82a8f1466",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[69970, 1771, 190, 3, 39, "Subsubsection",ExpressionUUID->"d2a5f7e9-fbf3-48fd-896b-3c3a13529cd2"],
Cell[70163, 1776, 2130, 55, 242, "Input",ExpressionUUID->"84ac980c-3e5a-487b-a821-389318a8bd26",
 InitializationCell->True],
Cell[72296, 1833, 2297, 54, 286, "Input",ExpressionUUID->"e0675219-06d7-4260-b88e-aecc77330bb2",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[74630, 1892, 206, 4, 39, "Subsubsection",ExpressionUUID->"4d34a9f6-835b-4d0e-bded-e4ef20d68c82"],
Cell[74839, 1898, 358, 9, 55, "Input",ExpressionUUID->"0ee308e1-0add-4c99-8e44-6281687c59ed",
 InitializationCell->True],
Cell[75200, 1909, 6735, 176, 532, "Input",ExpressionUUID->"935d09a0-331b-40fc-a467-f0134b7e4304",
 InitializationCell->True],
Cell[81938, 2087, 5817, 130, 538, "Input",ExpressionUUID->"f8e80e20-24a8-4ec6-ba4f-132db5be82fc",
 InitializationCell->True],
Cell[87758, 2219, 7880, 195, 727, "Input",ExpressionUUID->"9f3b0ea7-2af5-48b1-84b3-46146be887b3",
 InitializationCell->True],
Cell[95641, 2416, 1957, 50, 238, "Input",ExpressionUUID->"3edfcfc0-c624-46bc-ab09-a08de412f0d7",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[97647, 2472, 253, 4, 47, "Subsection",ExpressionUUID->"1785af53-7c89-486a-9e5f-2cc90ee5d4f8"],
Cell[CellGroupData[{
Cell[97925, 2480, 181, 3, 39, "Subsubsection",ExpressionUUID->"6b5ad42c-f028-4331-8dd5-edca6279d9c9"],
Cell[98109, 2485, 3743, 81, 712, "Input",ExpressionUUID->"8223ffc8-f59e-4c33-b04f-02db6763d2e2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[101889, 2571, 171, 3, 32, "Subsubsection",ExpressionUUID->"25f821ed-484b-44c3-bb3d-2285af151ba5"],
Cell[102063, 2576, 5210, 114, 898, "Input",ExpressionUUID->"4b678c74-7d06-4764-a1d3-b462e6b01ccf",
 InitializationCell->True],
Cell[107276, 2692, 2064, 52, 204, "Input",ExpressionUUID->"18065f13-e208-4ab7-83f1-35e867d53bcb",
 InitializationCell->True],
Cell[109343, 2746, 6605, 156, 605, "Input",ExpressionUUID->"4a073111-7191-4734-b32b-1a96840d6461",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[115997, 2908, 168, 3, 47, "Subsection",ExpressionUUID->"94391a5f-eb5e-4478-a534-7016e4a3f9d1"],
Cell[CellGroupData[{
Cell[116190, 2915, 5522, 141, 622, "Input",ExpressionUUID->"ac314d00-9b25-4da1-be23-eabaa3a126f2",
 InitializationCell->True],
Cell[121715, 3058, 575, 12, 70, "Message",ExpressionUUID->"2310a13c-eeb4-4560-a45b-5520363374ea"],
Cell[122293, 3072, 584, 12, 70, "Message",ExpressionUUID->"9a5f5e3f-c8a4-4f88-8ce8-9606991788bb"],
Cell[122880, 3086, 634, 13, 70, "Message",ExpressionUUID->"a24ce705-c816-469c-9132-aadaa1580957"],
Cell[123517, 3101, 582, 12, 70, "Message",ExpressionUUID->"91deaf55-1d8e-4812-a89c-b66149e2ac98"],
Cell[124102, 3115, 461, 10, 70, "Message",ExpressionUUID->"dbb8fbfc-9e1a-4374-9989-d9df7ee10430"],
Cell[124566, 3127, 639, 13, 70, "Message",ExpressionUUID->"f0db91a0-970d-4263-8742-569ecc702aa0"],
Cell[125208, 3142, 11199, 275, 70, "Output",ExpressionUUID->"bf125174-2cbb-4492-858d-812d23727d5b"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[136456, 3423, 160, 3, 33, "Subsection",ExpressionUUID->"6b372331-85d1-493a-abd0-807b92a55bd4"],
Cell[CellGroupData[{
Cell[136641, 3430, 508, 14, 28, "Input",ExpressionUUID->"4ce9bf53-d697-4934-8c17-2e3e34220601"],
Cell[137152, 3446, 15511, 390, 516, "Output",ExpressionUUID->"7c5f778a-1d4b-4d53-a726-16a42b48d56e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152700, 3841, 4479, 106, 595, "Input",ExpressionUUID->"3500ee75-7244-4321-ae5e-82e6897e10d7",
 InitializationCell->True],
Cell[157182, 3949, 367, 10, 31, "Output",ExpressionUUID->"9cda2b45-eac4-4ded-bc68-0060b6ec0d42"],
Cell[CellGroupData[{
Cell[157574, 3963, 181, 4, 20, "Print",ExpressionUUID->"951f31a2-f37f-4256-96af-2ac25d2a0bc5"],
Cell[157758, 3969, 185, 4, 20, "Print",ExpressionUUID->"1215c6cf-7f93-4385-8f13-dc29faa514f2"],
Cell[157946, 3975, 518, 13, 21, "Print",ExpressionUUID->"e26c65dd-c7b7-48ef-80ce-3a20abf77f07"]
}, Open  ]],
Cell[158479, 3991, 163, 3, 30, "Output",ExpressionUUID->"97d25ade-c428-4883-957e-639c6e0816f2"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[158703, 4001, 207, 4, 59, "Section",ExpressionUUID->"be19843a-e765-47f1-9747-2d6834a73a9e"],
Cell[CellGroupData[{
Cell[158935, 4009, 163, 3, 47, "Subsection",ExpressionUUID->"e5244ec3-f22c-466c-9873-92eb903637b0"],
Cell[CellGroupData[{
Cell[159123, 4016, 275, 6, 28, "Input",ExpressionUUID->"a73c0a6c-a60e-47c9-95e2-4be9d2bbe2ec"],
Cell[159401, 4024, 178, 3, 30, "Output",ExpressionUUID->"f10dca3c-cfe9-41b8-8103-6189f74c57e8"]
}, Open  ]],
Cell[159594, 4030, 7534, 181, 687, "Input",ExpressionUUID->"c85cfa76-e8b5-439f-9ca0-f24e64c44725",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[167153, 4215, 3303, 72, 422, "Input",ExpressionUUID->"52021b7e-bece-436c-b228-076b6c722055",
 InitializationCell->True],
Cell[170459, 4289, 638, 16, 21, "Print",ExpressionUUID->"15caeff1-b9ba-4520-a865-789b95ed3e8e"],
Cell[171100, 4307, 185, 3, 30, "Output",ExpressionUUID->"d176177b-3142-40a0-b148-f6f86105af41"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[171334, 4316, 172, 3, 47, "Subsection",ExpressionUUID->"034e0a42-0fa4-4f9f-b5da-98a83e4d3f58"],
Cell[171509, 4321, 9239, 181, 632, "Input",ExpressionUUID->"a436e083-e4fe-421f-aba5-b198287ec130",
 InitializationCell->True],
Cell[180751, 4504, 9711, 192, 710, "Input",ExpressionUUID->"340eb28e-df7e-4492-8bd5-f7971346541d",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[190499, 4701, 185, 3, 47, "Subsection",ExpressionUUID->"a8f64e7a-d885-45c2-99d7-7e2e4dc385f7"],
Cell[190687, 4706, 416, 12, 63, "Input",ExpressionUUID->"bba04405-f573-40fc-9a19-18ca7de811ab",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[191128, 4722, 8115, 186, 746, "Input",ExpressionUUID->"fcb7ecd2-adb3-4b5a-a94f-8080924ea319",
 InitializationCell->True],
Cell[199246, 4910, 2210, 67, 95, "Output",ExpressionUUID->"66133275-1c8b-4433-9d57-7e6bfff5470a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[201493, 4982, 1604, 46, 49, "Input",ExpressionUUID->"df84b937-624b-441e-80f4-fe957a4c1e1f"],
Cell[203100, 5030, 1864, 50, 53, "Output",ExpressionUUID->"b0cd4754-812a-40e8-851f-7fc2e606f6ba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[205001, 5085, 250, 4, 26, "Input",ExpressionUUID->"95284580-dad7-4ea5-addd-27a440b30ac9"],
Cell[205254, 5091, 250, 4, 30, "Output",ExpressionUUID->"68df726f-94c3-4aff-a3e1-6feb1b27d16c"]
}, Open  ]],
Cell[205519, 5098, 1303, 40, 91, "Input",ExpressionUUID->"fb3bec6b-3478-4efd-939b-ace7c9cbb372"],
Cell[206825, 5140, 631, 20, 49, "Input",ExpressionUUID->"b54de7fb-f597-486d-ae2c-b763a4606e0e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[207505, 5166, 152, 3, 86, "Title",ExpressionUUID->"7a24c792-7a48-4e73-8b88-7b56966e439b"],
Cell[CellGroupData[{
Cell[207682, 5173, 3341, 93, 450, "Input",ExpressionUUID->"fc1deefb-2176-49e3-895a-575f08b7cb88"],
Cell[CellGroupData[{
Cell[211048, 5270, 1145, 35, 45, "Print",ExpressionUUID->"7562a7d5-a5b8-430c-98bb-2a135a6152a2"],
Cell[212196, 5307, 516, 13, 20, "Print",ExpressionUUID->"96b4a4ff-b892-4d71-9ea3-82d321dd29b0"]
}, Open  ]],
Cell[212727, 5323, 552, 9, 30, "Output",ExpressionUUID->"6534f23d-7cf0-4351-9afc-a5cc3f02123e"],
Cell[CellGroupData[{
Cell[213304, 5336, 642, 19, 21, "Print",ExpressionUUID->"23e350ab-392c-4d79-9538-0ee2738b782b"],
Cell[213949, 5357, 678, 20, 21, "Print",ExpressionUUID->"b716322f-895c-4a70-a611-d5b4fb8e447c"]
}, Open  ]],
Cell[214642, 5380, 1516, 41, 32, "Output",ExpressionUUID->"2e26796c-df6f-4688-8ec8-1d0e61c3083c"]
}, Open  ]]
}, Open  ]]
}
]
*)

